!function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=11)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.emojiWithJoiners=t.emojiJoinersRegEx=t.imgEmoji=t.cssEmoji=void 0,t.emojiToHTML=function(e){return(0,i.emojiMap)(e,l,{replaceSymbols:!0})},t.getEmojiHTML=l;var i=n(71),o=t.cssEmoji={D83DDE0A:[0,":-)"],D83DDE03:[1,":-D"],D83DDE09:[2,";-)"],D83DDE06:[3,"xD"],D83DDE1C:[4,";-P"],D83DDE0B:[5,":-p"],D83DDE0D:[6,"8-)"],D83DDE0E:[7,"B-)"],D83DDE12:[8,":-("],D83DDE0F:[9,";-]"],D83DDE14:[10,"3("],D83DDE22:[11,":'("],D83DDE2D:[12,":_("],D83DDE29:[13,":(("],D83DDE28:[14,":o"],D83DDE10:[15,":|"],D83DDE0C:[16,"3-)"],D83DDE20:[17,">("],D83DDE21:[18,">(("],D83DDE07:[19,"O:)"],D83DDE30:[20,";o"],D83DDE33:[21,"8|"],D83DDE32:[22,"8o"],D83DDE37:[23,":X"],D83DDE1A:[24,":-*"],D83DDE08:[25,"}:)"],2764:[26,"<3"],D83DDC4D:[27,":like:"],D83DDC4E:[28,":dislike:"],"261D":[29,":up:"],"270C":[30,":v:"],D83DDC4C:[31,":ok:"]},r=t.imgEmoji={D83DDE15:1,D83DDE1F:1,D83DDE2E:1,D83DDE34:1},a=t.emojiJoinersRegEx=/2640|2642|200D|200C/g,s=t.emojiWithJoiners=["D83DDC71200D2640FE0F","D83DDC6E200D2640FE0F","D83DDC77200D2640FE0F","D83DDD75200D2640FE0F","D83DDE47200D2640FE0F","D83DDC81200D2642FE0F","D83DDE45200D2642FE0F","D83DDE46200D2642FE0F","D83DDE4E200D2642FE0F","D83DDE4D200D2642FE0F","D83DDC86200D2642FE0F","D83DDC87200D2642FE0F","D83DDEB6200D2640FE0F","D83CDFC3200D2640FE0F","D83CDFCB200D2640FE0F","26F9200D2640FE0F","D83CDFC4200D2640FE0F","D83CDFCA200D2640FE0F","D83DDEB5200D2640FE0F","D83DDEB4200D2640FE0F","D83DDC6F200D2642FE0F","D83CDFCC200D2640FE0F","D83DDE4B200D2642FE0F","D83DDC73200D2640FE0F","D83DDC82200D2640FE0F","D83CDFF3200DD83CDF08FE0F","D83EDD26D83CDFFB200D2642FE0F","D83EDD37D83CDFFB200D2640FE0F","D83EDD37D83CDFFB200D2642FE0F","D83EDD3DD83CDFFB200D2642FE0F","D83EDD3DD83CDFFB200D2640FE0F","D83EDD3ED83CDFFB200D2642FE0F","D83EDD3C200D2642FE0F","D83EDD38D83CDFFB200D2642FE0F","D83EDD37200D2642FE0F","D83EDD37D83CDFFC200D2642FE0F","D83EDD37D83CDFFD200D2642FE0F","D83EDD37D83CDFFE200D2642FE0F","D83EDD37D83CDFFF200D2642FE0F","D83EDD26200D2642FE0F","D83EDD26D83CDFFC200D2642FE0F","D83EDD26D83CDFFD200D2642FE0F","D83EDD26D83CDFFE200D2642FE0F","D83EDD26D83CDFFF200D2642FE0F","D83EDD37200D2640FE0F","D83EDD37D83CDFFC200D2640FE0F","D83EDD37D83CDFFD200D2640FE0F","D83EDD37D83CDFFE200D2640FE0F","D83EDD37D83CDFFF200D2640FE0F","D83EDD3D200D2642FE0F","D83EDD3DD83CDFFC200D2642FE0F","D83EDD3DD83CDFFD200D2642FE0F","D83EDD3DD83CDFFE200D2642FE0F","D83EDD3DD83CDFFF200D2642FE0F","D83EDD3D200D2640FE0F","D83EDD3DD83CDFFC200D2640FE0F","D83EDD3DD83CDFFD200D2640FE0F","D83EDD3DD83CDFFE200D2640FE0F","D83EDD3DD83CDFFF200D2640FE0F","D83EDD3E200D2642FE0F","D83EDD3ED83CDFFC200D2642FE0F","D83EDD3ED83CDFFD200D2642FE0F","D83EDD3ED83CDFFE200D2642FE0F","D83EDD3ED83CDFFF200D2642FE0F","D83EDD38200D2642FE0F","D83EDD38D83CDFFC200D2642FE0F","D83EDD38D83CDFFD200D2642FE0F","D83EDD38D83CDFFE200D2642FE0F","D83EDD38D83CDFFF200D2642FE0F","D83EDD19D83CDFFB","D83EDD19D83CDFFC","D83EDD19D83CDFFD","D83EDD19D83CDFFE","D83EDD19D83CDFFF","D83EDD1BD83CDFFB","D83EDD1BD83CDFFC","D83EDD1BD83CDFFD","D83EDD1BD83CDFFE","D83EDD1BD83CDFFF","D83EDD1CD83CDFFB","D83EDD1CD83CDFFC","D83EDD1CD83CDFFD","D83EDD1CD83CDFFE","D83EDD1CD83CDFFF","D83EDD26200D2640FE0F","D83EDD39200D2642FE0F","D83EDD39200D2640FE0F","D83DDC68200DD83DDE92FE0F","D83DDC69200DD83DDE92FE0F","D83DDC68200DD83CDFA4FE0F","D83DDC69200DD83CDFA4FE0F","D83DDC68200D2695FE0F","D83DDC69200D2695FE0F","D83DDC68200DD83CDF93FE0F","D83DDC69200DD83CDF93FE0F","D83DDC68200DD83CDFEBFE0F","D83DDC69200DD83CDFEBFE0F","D83DDC68200D2696FE0F","D83DDC69200D2696FE0F","D83DDC68200DD83CDF3EFE0F","D83DDC69200DD83CDF3EFE0F","D83DDC68200DD83CDF73FE0F","D83DDC69200DD83CDF73FE0F","D83DDC68200DD83DDD27FE0F","D83DDC69200DD83DDD27FE0F","D83DDC68200DD83CDFEDFE0F","D83DDC69200DD83CDFEDFE0F","D83DDC68200DD83DDCBCFE0F","D83DDC69200DD83DDCBCFE0F","D83DDC68200DD83DDD2CFE0F","D83DDC69200DD83DDD2CFE0F","D83DDC68200DD83DDCBBFE0F","D83DDC69200DD83DDCBBFE0F","D83DDC68200DD83CDFA8FE0F","D83DDC69200DD83CDFA8FE0F","D83DDC68200D2708FE0F","D83DDC69200D2708FE0F","D83DDC68200DD83DDE80FE0F","D83DDC69200DD83DDE80FE0F"];function l(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(e.match(a)){if(e=e.replace("FE0F","")+"FE0F",-1===s.indexOf(e)){for(var c=e.replace("FE0F","").split(a),d="",f=0;f<c.length;f++)c[f]&&(d+=l(c[f],u(c[f]),n));return d}t&&(t=t.replace(/\uFE0F/g,""),t+=u("FE0F"))}var p=window.devicePixelRatio>=2?"_2x":"";if(i&&void 0!=o[e]){var _=17*-o[e][0];return'<img src="/images/blank.gif" emoji="'+e+'" '+(t?'alt="'+t+'"':t)+' class="emoji_css" style="background-position: 0px '+_+'px;" />'}return r[e]||!t||n?'<img class="emoji" '+(t?'alt="'+t+'"':"")+' src="/images/emoji/'+e+p+'.png" />':t}function u(e){for(var t=Math.round(e.length/4),n="",i=0;t--;)n+=String.fromCharCode(parseInt(e.substr(i,4),16)),i+=4;return n}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.resizePosters=exports.rs=exports.domCreate=exports.openApp=exports.irand=exports.domInsert=exports.groupBy=exports.toArray=exports.toInt=exports.last=exports.first=exports.unique=exports.desc=exports.asc=exports.arrayIntersects=exports.arrayRemove=exports.ajaxRequest=exports.statlogsValueEvent=exports.isVkWebView=exports.isAndroidWebView=exports.isIosWebView=exports.ceFromString=exports.isString=exports.need=exports.alwaysArray=exports.domInsertBefore=exports.domInsertAfter=exports.domFC=exports.domQuery1=exports.domQuery=exports.disableFlex=exports.safeGet=exports.domChildren=exports.domChildIndex=exports.scrollGetY=exports.scrollGetX=exports.debounce=exports.throttle=exports.domData=exports.getLang=exports.domCA=exports.domPN=exports.blinkItem=exports.copyToClipboard=exports.domClosestOverflowHidden=exports.trim=exports.registeredEvents=exports.readFile=exports.uploadFile=exports.canUploadFile=exports.getNotify=exports.setNotify=exports.langDate=exports.langWordNumeric=exports.langNumeric=exports.langSex=exports.indexOf=exports.ajx2q=exports.getHref=exports.alLoadingFix=exports.evalJs=exports.getCh=exports.getCw=exports.getSize=exports.getH=exports.getW=exports.getY=exports.getX=exports.getXY=exports.switchClass=exports.replaceClass=exports.toggleClass=exports.removeClass=exports.addClass=exports.hasClass=exports.setStyle=exports.getStyle=exports.cssValue=exports.getCssPropertyName=exports.cssToJs=exports.attr=exports.val=exports.elblur=exports.elfocus=exports.ce=exports.toggle=exports.isVisible=void 0,exports.hide=exports.show=exports.outer=exports.tag=exports.reflow=exports.clone=exports.remove=exports.replace=exports.after=exports.before=exports.append=exports.domPS=exports.domNS=exports.geBySel1=exports.geBySel=exports.gpeByTag=exports.geByTag1=exports.geByTag=exports.gpeByClass=exports.geByClass1=exports.geByClass=exports.ge=exports.extend=exports.unlockButton=exports.lockButton=exports.scrollToHash=exports.scrollToEl=exports.autoScroll=exports.initAutoScroll=exports.initPostsStats=exports.checkPostsSeen=exports.initObjectsHideByScroll=exports.hideUnvisibleItems=exports.sgFix=exports.onBodyScrollForce=exports.se=exports.scrollTop=exports.scrollLeft=exports.parseLatKeys=exports.parseRusKeys=exports.parseLat=exports.parseCyr=exports.checkTouchHover=exports.checkElementNav=exports.checkNav=exports.shortCurrency=exports.winToUtf=exports.createIframe=exports.submitBtn=exports.onCtrlEnter=exports.checkEvent=exports.cancelEvent=exports.stopEvent=exports.preventEvent=exports.removeEvent=exports.addEvent=exports.copy=exports.each=exports.formatNum=exports.hashCode=exports.realSubstr=exports.len=exports.getValues=exports.ssGet=exports.ssSet=exports.ssCheck=exports.lsGet=exports.lsSet=exports.lsCheck=exports.parseJSON=exports.obj2qs=exports.qs2obj=exports.floatval=exports.intval=exports.bind=exports.vkNow=exports.isHttpHref=exports.utf2win=exports.srand=exports.rand=exports.stripTags=exports.escapeStr=exports.replaceEntities=exports.unescapeAttr=exports.escapeAttr=exports.htsc=exports.escapeRE=exports.isEmpty=exports.isObject=exports.isArray=exports.isFunction=exports.isUndefined=exports.setDocumentDomain=exports.formatTime=exports.flatArray=exports.flatten=exports.ariaMode=exports.re=exports.onBodyResize=exports.onBodyScroll=void 0;var _Dollars=__webpack_require__(322),_select=__webpack_require__(205),_select2=_interopRequireDefault(_select);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var registeredEvents=[],onBodyScroll=se(scrollTop),onBodyResize=se(),re=remove,_logTimer;function need(e){var t=safeGet(window,e);if(void 0===t)throw"Unable to get `window."+e+"`";return t}function setDocumentDomain(){var e=(document.domain||"").match(/(m\.)?([a-zA-Z]+\.[a-zA-Z]+\.?)$/);window.locDomain="https:"==location.protocol?e[2]:e[0];var t=navigator.userAgent.toLowerCase();!/opera/i.test(t)&&/msie 6/i.test(t)&&document.domain==window.locDomain||(document.domain=window.locDomain)}function rand(e,t){return Math.random()*(t-e+1)+e}function isUndefined(e){return void 0===e}function isFunction(e){return"[object Function]"===Object.prototype.toString.call(e)}function isString(e){return"string"==typeof e}function isArray(e){return"[object Array]"===Object.prototype.toString.call(e)}function isObject(e){return"[object Object]"===Object.prototype.toString.call(e)}function isEmpty(e){if("[object Object]"!==Object.prototype.toString.call(e))return!1;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function escapeRE(e){return e?e.replace(/([.*+?^${}()|[\]\/\\])/g,"\\$1"):""}function htsc(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/\'/g,"&#39;").replace(/%/g,"&#37;")}function escapeAttr(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/\'/g,"&#39;")}function unescapeAttr(e){return e.replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&#39;/g,"'")}function replaceEntities(e){return ce("textarea",{innerHTML:(e||"").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}).value}function escapeStr(e){return e.replace(/\'/g,"\\'")}function stripTags(e){return e.replace(/<[^>]+>/g,"")}function srand(){return Math.random().toString(36).substr(2)}function irand(e,t){return Math.floor(rand(e,t))}function utf2win(e){return unescape(encodeURIComponent(e))}function isHttpHref(e){var t=(e+"").split(":"),n=t[1]&&t[0]?t[0]+":":location.protocol;return"http:"==n||"https:"==n}function vkNow(){return+new Date}function bind(){var e=Array.prototype.slice.call(arguments),t=e.shift(),n=e.shift();return function(){var i=Array.prototype.slice.call(arguments);return t.apply(n,e.concat(i))}}function intval(e){return!0===e?1:parseInt(e)||0}function floatval(e){return!0===e?1:parseFloat(e)||0}function qs2obj(e){if(!e)return{};for(var t={},n=e.toString().split("&"),i=0,o=n.length;i<o;i++){var r=n[i].split("=");r[0]&&(t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]||""))}return t}function obj2qs(e){if(!e)return"";var t=[];for(var n in e)t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n].toString()||""));return t.length?"?"+t.join("&"):""}function parseJSON(obj){try{return JSON.parse(obj)}catch(e){return eval("("+obj+")")}}function lsCheck(){return void 0!==window.localStorage&&null!==window.localStorage&&void 0!==window.JSON}function lsSet(e,t){if(void 0!==t)try{return localStorage.setItem(e,JSON.stringify(t))}catch(e){}else try{return localStorage.removeItem(e)}catch(e){}return!1}function lsGet(e){try{return JSON.parse(localStorage.getItem(e))}catch(e){}return!1}function ssCheck(){return void 0!==window.sessionStorage&&void 0!==window.JSON}function ssSet(e,t){if(void 0!==t)try{return sessionStorage.setItem(e,JSON.stringify(t))}catch(e){}else try{return sessionStorage.removeItem(e)}catch(e){}return!1}function ssGet(e){try{return JSON.parse(sessionStorage.getItem(e))}catch(e){}return!1}function getValues(e){if(!isArray(e))return e.call?e():e;for(var t=[],n=0,i=e.length;n<i;n++)t.push(getValues(e[n]));return t}function len(e){if(isArray(e))return e.length;if(isObject(e)){var t=0;for(var n in e)t++;return t}return 0}function realSubstr(e,t){return(e=e||"").length>t&&(e=(e=(e=(e=e.substr(0,t-3)).replace(/&[^;]{0,6}$/,"")).replace(/<[^>]*$/,"")).replace(/(\s|<br\s*\/?>)+$/,""),e+=".."),e}function hashCode(e){var t=0;if(0===e.length)return t;for(var n=0,i=e.length;n<i;n++){t=(t<<5)-t+e.charCodeAt(n),t|=0}return t}function formatNum(e){if(!window.langConfig)return e;for(var t=e.toString().split("."),n=[],i=t[0].length-3;i>-3;i-=3)n.unshift(t[0].slice(i>0?i:0,i+3));return t[0]=n.join(window.langConfig.numDel),e=t.join(window.langConfig.numDec)}function each(e,t){if(!e)return e;if(isObject(e)||void 0===e.length){for(var n in e)if(e.hasOwnProperty(n)&&!1===t.call(e[n],n,e[n]))break}else for(var i=0,o=e.length;i<o&&!1!==t.call(e[i],i,e[i]);i++);return e}function copy(e){return isArray(e)?e.concat([]):isObject(e)?extend({},e):e}exports.onBodyScroll=onBodyScroll,exports.onBodyResize=onBodyResize,exports.re=re,exports.ariaMode=ariaMode,exports.flatten=flatten,exports.flatArray=flatArray,exports.formatTime=formatTime,exports.setDocumentDomain=setDocumentDomain,exports.isUndefined=isUndefined,exports.isFunction=isFunction,exports.isArray=isArray,exports.isObject=isObject,exports.isEmpty=isEmpty,exports.escapeRE=escapeRE,exports.htsc=htsc,exports.escapeAttr=escapeAttr,exports.unescapeAttr=unescapeAttr,exports.replaceEntities=replaceEntities,exports.escapeStr=escapeStr,exports.stripTags=stripTags,exports.rand=rand,exports.srand=srand,exports.utf2win=utf2win,exports.isHttpHref=isHttpHref,exports.vkNow=vkNow,exports.bind=bind,exports.intval=intval,exports.floatval=floatval,exports.qs2obj=qs2obj,exports.obj2qs=obj2qs,exports.parseJSON=parseJSON,exports.lsCheck=lsCheck,exports.lsSet=lsSet,exports.lsGet=lsGet,exports.ssCheck=ssCheck,exports.ssSet=ssSet,exports.ssGet=ssGet,exports.getValues=getValues,exports.len=len,exports.realSubstr=realSubstr,exports.hashCode=hashCode,exports.formatNum=formatNum,exports.each=each,exports.copy=copy,exports.addEvent=addEvent,exports.removeEvent=removeEvent,exports.preventEvent=preventEvent,exports.stopEvent=stopEvent,exports.cancelEvent=cancelEvent,exports.checkEvent=checkEvent,exports.onCtrlEnter=onCtrlEnter,exports.submitBtn=submitBtn,exports.createIframe=createIframe,exports.winToUtf=winToUtf,exports.shortCurrency=shortCurrency,exports.checkNav=checkNav,exports.checkElementNav=checkElementNav,exports.checkTouchHover=checkTouchHover,exports.parseCyr=parseCyr,exports.parseLat=parseLat,exports.parseRusKeys=parseRusKeys,exports.parseLatKeys=parseLatKeys,exports.scrollLeft=scrollLeft,exports.scrollTop=scrollTop,exports.se=se,exports.onBodyScrollForce=onBodyScrollForce,exports.sgFix=sgFix,exports.hideUnvisibleItems=hideUnvisibleItems,exports.initObjectsHideByScroll=initObjectsHideByScroll,exports.checkPostsSeen=checkPostsSeen,exports.initPostsStats=initPostsStats,exports.initAutoScroll=initAutoScroll,exports.autoScroll=autoScroll,exports.scrollToEl=scrollToEl,exports.scrollToHash=scrollToHash,exports.lockButton=lockButton,exports.unlockButton=unlockButton,exports.extend=extend,exports.ge=ge,exports.geByClass=geByClass,exports.geByClass1=geByClass1,exports.gpeByClass=gpeByClass,exports.geByTag=geByTag,exports.geByTag1=geByTag1,exports.gpeByTag=gpeByTag,exports.geBySel=geBySel,exports.geBySel1=geBySel1,exports.domNS=domNS,exports.domPS=domPS,exports.append=append,exports.before=before,exports.after=after,exports.replace=replace,exports.remove=remove,exports.clone=clone,exports.reflow=reflow,exports.tag=tag,exports.outer=outer,exports.show=show,exports.hide=hide,exports.isVisible=isVisible,exports.toggle=toggle,exports.ce=ce,exports.elfocus=elfocus,exports.elblur=elblur,exports.val=val,exports.attr=attr,exports.cssToJs=cssToJs,exports.getCssPropertyName=getCssPropertyName,exports.cssValue=cssValue,exports.getStyle=getStyle,exports.setStyle=setStyle,exports.hasClass=hasClass,exports.addClass=addClass,exports.removeClass=removeClass,exports.toggleClass=toggleClass,exports.replaceClass=replaceClass,exports.switchClass=switchClass,exports.getXY=getXY,exports.getX=getX,exports.getY=getY,exports.getW=getW,exports.getH=getH,exports.getSize=getSize,exports.getCw=getCw,exports.getCh=getCh,exports.evalJs=evalJs,exports.alLoadingFix=alLoadingFix,exports.getHref=getHref,exports.ajx2q=ajx2q,exports.indexOf=indexOf,exports.langSex=langSex,exports.langNumeric=langNumeric,exports.langWordNumeric=langWordNumeric,exports.langDate=langDate,exports.setNotify=setNotify,exports.getNotify=getNotify,exports.canUploadFile=canUploadFile,exports.uploadFile=uploadFile,exports.readFile=readFile,exports.registeredEvents=registeredEvents,exports.trim=trim,exports.domClosestOverflowHidden=domClosestOverflowHidden,exports.copyToClipboard=copyToClipboard,exports.blinkItem=blinkItem,exports.domPN=domPN,exports.domCA=domCA,exports.getLang=getLang,exports.domData=domData,exports.throttle=throttle,exports.debounce=debounce,exports.scrollGetX=scrollGetX,exports.scrollGetY=scrollGetY,exports.domChildIndex=domChildIndex,exports.domChildren=domChildren,exports.safeGet=safeGet,exports.disableFlex=disableFlex,exports.domQuery=domQuery,exports.domQuery1=domQuery1,exports.domFC=domFC,exports.domInsertAfter=domInsertAfter,exports.domInsertBefore=domInsertBefore,exports.alwaysArray=alwaysArray,exports.need=need,exports.isString=isString,exports.ceFromString=ceFromString,exports.isIosWebView=isIosWebView,exports.isAndroidWebView=isAndroidWebView,exports.isVkWebView=isVkWebView,exports.statlogsValueEvent=statlogsValueEvent,exports.ajaxRequest=ajaxRequest,exports.arrayRemove=arrayRemove,exports.arrayIntersects=arrayIntersects,exports.asc=asc,exports.desc=desc,exports.unique=unique,exports.first=first,exports.last=last,exports.toInt=toInt,exports.toArray=toArray,exports.groupBy=groupBy,exports.domInsert=domInsert,exports.irand=irand,exports.openApp=openApp,exports.domCreate=domCreate,exports.rs=rs,exports.resizePosters=resizePosters,Object.assign(window,{onBodyScroll:onBodyScroll,onBodyResize:onBodyResize,re:re,ariaMode:ariaMode,flatten:flatten,flatArray:flatArray,formatTime:formatTime,setDocumentDomain:setDocumentDomain,isUndefined:isUndefined,isFunction:isFunction,isArray:isArray,isObject:isObject,isEmpty:isEmpty,escapeRE:escapeRE,htsc:htsc,escapeAttr:escapeAttr,unescapeAttr:unescapeAttr,replaceEntities:replaceEntities,escapeStr:escapeStr,stripTags:stripTags,rand:rand,srand:srand,utf2win:utf2win,isHttpHref:isHttpHref,vkNow:vkNow,bind:bind,intval:intval,floatval:floatval,qs2obj:qs2obj,obj2qs:obj2qs,parseJSON:parseJSON,lsCheck:lsCheck,lsSet:lsSet,lsGet:lsGet,ssCheck:ssCheck,ssSet:ssSet,ssGet:ssGet,getValues:getValues,len:len,realSubstr:realSubstr,hashCode:hashCode,formatNum:formatNum,each:each,copy:copy,addEvent:addEvent,removeEvent:removeEvent,preventEvent:preventEvent,stopEvent:stopEvent,cancelEvent:cancelEvent,checkEvent:checkEvent,onCtrlEnter:onCtrlEnter,submitBtn:submitBtn,createIframe:createIframe,winToUtf:winToUtf,shortCurrency:shortCurrency,checkNav:checkNav,checkElementNav:checkElementNav,checkTouchHover:checkTouchHover,parseCyr:parseCyr,parseLat:parseLat,parseRusKeys:parseRusKeys,parseLatKeys:parseLatKeys,scrollLeft:scrollLeft,scrollTop:scrollTop,se:se,onBodyScrollForce:onBodyScrollForce,sgFix:sgFix,hideUnvisibleItems:hideUnvisibleItems,initObjectsHideByScroll:initObjectsHideByScroll,checkPostsSeen:checkPostsSeen,initPostsStats:initPostsStats,initAutoScroll:initAutoScroll,autoScroll:autoScroll,scrollToEl:scrollToEl,scrollToHash:scrollToHash,lockButton:lockButton,unlockButton:unlockButton,extend:extend,ge:ge,geByClass:geByClass,geByClass1:geByClass1,gpeByClass:gpeByClass,geByTag:geByTag,geByTag1:geByTag1,gpeByTag:gpeByTag,geBySel:geBySel,geBySel1:geBySel1,domNS:domNS,domPS:domPS,append:append,before:before,after:after,replace:replace,remove:remove,clone:clone,reflow:reflow,tag:tag,outer:outer,show:show,hide:hide,isVisible:isVisible,toggle:toggle,ce:ce,elfocus:elfocus,elblur:elblur,val:val,attr:attr,cssToJs:cssToJs,getCssPropertyName:getCssPropertyName,cssValue:cssValue,getStyle:getStyle,setStyle:setStyle,hasClass:hasClass,addClass:addClass,removeClass:removeClass,toggleClass:toggleClass,replaceClass:replaceClass,switchClass:switchClass,getXY:getXY,getX:getX,getY:getY,getW:getW,getH:getH,getSize:getSize,getCw:getCw,getCh:getCh,evalJs:evalJs,alLoadingFix:alLoadingFix,getHref:getHref,ajx2q:ajx2q,indexOf:indexOf,langSex:langSex,langNumeric:langNumeric,langWordNumeric:langWordNumeric,langDate:langDate,setNotify:setNotify,getNotify:getNotify,canUploadFile:canUploadFile,uploadFile:uploadFile,readFile:readFile,registeredEvents:registeredEvents,trim:trim,domClosestOverflowHidden:domClosestOverflowHidden,copyToClipboard:copyToClipboard,blinkItem:blinkItem,domPN:domPN,domCA:domCA,getLang:getLang,domData:domData,throttle:throttle,debounce:debounce,scrollGetX:scrollGetX,scrollGetY:scrollGetY,domChildIndex:domChildIndex,domChildren:domChildren,safeGet:safeGet,disableFlex:disableFlex,domQuery:domQuery,domQuery1:domQuery1,domFC:domFC,domInsertAfter:domInsertAfter,domInsertBefore:domInsertBefore,alwaysArray:alwaysArray,need:need,isString:isString,ceFromString:ceFromString,isIosWebView:isIosWebView,isAndroidWebView:isAndroidWebView,isVkWebView:isVkWebView,statlogsValueEvent:statlogsValueEvent,ajaxRequest:ajaxRequest,arrayRemove:arrayRemove,arrayIntersects:arrayIntersects,asc:asc,desc:desc,unique:unique,first:first,last:last,toInt:toInt,toArray:toArray,groupBy:groupBy,domInsert:domInsert,openApp:openApp,rs:rs,domCreate:domCreate,resizePosters:resizePosters}),_logTimer=vkNow(),window.clog=function(e){var t=window.vk;if(t&&t.__debug)try{if(window.console&&console.log){var n=Array.prototype.slice.call(arguments);n.unshift("["+(vkNow()-_logTimer)/1e3+"] ");var i=window.browser;i.msie||i.mobile&&!i.safari_mobile?console.log(n.join(" ")):console.log.apply(console,n)}}catch(e){}};var rf=function(){return!1},eventPassiveSupported=!1,doc,frag,elem,range;try{var options=Object.defineProperty({},"passive",{get:function(){eventPassiveSupported=!0}});window.addEventListener("test",null,options),window.removeEventListener("test",null,options)}catch(e){}function addEvent(e,t,n,i){var o=!!i&&!0===i.capture,r=!!i&&!0===i.passive;if(e=ge(e),n=n||rf,e&&3!=e.nodeType&&8!=e.nodeType){e.setInterval&&e!=window&&(e=window);for(var a=0,s=(t=t.split(" ")).length;a<s;a++){var l=t[a];e.addEventListener?e.addEventListener(l,n,eventPassiveSupported?{passive:r,capture:o}:o):e.attachEvent&&e.attachEvent("on"+l,n),registeredEvents.push([e,l,n])}}}function removeEvent(e,t,n,i){var o=!!i&&!0===i.capture,r=!!i&&!0===i.passive;if(e=ge(e),n=n||rf,e&&3!=e.nodeType&&8!=e.nodeType)for(var a=0,s=(t=t.split(" ")).length;a<s;a++){var l=t[a];e.removeEventListener?e.removeEventListener(l,n,eventPassiveSupported?{passive:r,capture:o}:o):e.detachEvent&&e.detachEvent("on"+l,n)}}function preventEvent(e){return!!(e=e||window.event)&&((e=e.originalEvent||e).preventDefault&&e.preventDefault(),e.returnValue=!1,!1)}function stopEvent(e){return!!(e=e||window.event)&&((e=e.originalEvent||e).stopPropagation&&e.stopPropagation(),e.cancelBubble=!0,!1)}function cancelEvent(e){return!!(e=e||window.event)&&((e=e.originalEvent||e).preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0,e.returnValue=!1,!1)}function checkEvent(e){var t=window.PointerEvent;return(e=e||window.event)&&(!t||!(e instanceof t))&&("click"==e.type||"mousedown"==e.type||"mouseup"==e.type)&&(e.which>1||e.button>1||e.ctrlKey||e.shiftKey||e.metaKey)}function onCtrlEnter(e,t,n){var i=window.browser;if(10==(t=t||window.event).keyCode||13==t.keyCode&&(t.ctrlKey||t.metaKey&&i.mac)){if(isUndefined(n)){var o=submitBtn(e);o&&o.click()}else n.call(e);cancelEvent(t)}}function submitBtn(e){if(!e)return!1;var t="form"==tag(e)?e:e.form||gpeByTag("form",e);if(!t)return!1;for(var n in t){var i=t[n];if("input"==tag(i)&&"submit"==i.type&&/(^|\\s)(small_)?button(\\s|$)/i.test(i.className)&&!i.name)return i}return!1}function createIframe(e,t){var n=ce("iframe",e=extend(e||{},{border:"0"}),t=extend(t||{},{position:"absolute",width:1,height:1,left:10}));return append(n,"vk_utils"),n}function winToUtf(e){return e.replace(/&#(\d\d+);/g,function(e,t){return(t=intval(t))>=32?String.fromCharCode(t):e}).replace(/&quot;/gi,'"').replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/&amp;/gi,"&")}function shortCurrency(){var e={};each(geByClass("_short_currency"),function(){var t=this.getAttribute("data-short")||"",n=winToUtf(t).length,i=getStyle(this,"fontFamily")||"tahoma,arial,sans-serif";if(!t)return!0;if(isUndefined(e[i])){for(var o="",r=n-1;r>=0;r--)o+="&#8399;";var a=ce("div",{innerHTML:"<b>"+t+"</b><b>"+o+"</b>"},{fontFamily:i,fontSize:"24px"});ge("vk_utils").appendChild(a),e[i]=Math.abs(a.firstChild.offsetWidth-a.lastChild.offsetWidth)>=2*n,remove(a)}e[i]&&val(this,t)})}function checkNav(e,t){if(!(e=ge(e)))return!1;do{if(checkElementNav(e,t))return e}while(e=e.parentNode);return!1}function checkElementNav(e,t){var n=window.al;if(!n||!n.ver)return!1;if(!e)return!1;if(t=t||{},"a"==tag(e)){if((t.skip_onclick||e.getAttribute("data-skiponclick")||!e.getAttribute("onclick"))&&(e.getAttribute("href")||e.getAttribute("data-href"))||hasClass("al_nav",e)){if(e.hostname)var i=e.hostname;else{var o=e.href||attr(e,"data-href");i=(/^(https?:)\/\/([^:\/]+)?(?::(\d+))?\/?(.*)$/i.exec(o)||[])[2]}if("_blank"===e.target&&t.skip_blank||t.skip_clicable)return!0;if("_blank"!==e.target&&isHttpHref(o)){if(!i||i==location.hostname)return!0;if(t.allow_post_away&&i&&e.getAttribute("data-post-id")&&e.getAttribute("data-post-click-type"))return e.setAttribute("data-change-location-with-post-away",1),!0}}}else if("input"==tag(e)||"button"===tag(e)&&e.form&&!e.form.getAttribute("onsubmit")){if(e.form&&("submit"==e.type||"image"==e.type)&&(t.skip_onclick||e.getAttribute("data-skiponclick")||!e.getAttribute("onclick"))||hasClass("al_nav",e))return!0}else if("label"==tag(e)&&t.skip_clicable&&(e.htmlFor||geByTag1("input",e)&&(t.skip_onclick||e.getAttribute("data-skiponclick")||!e.getAttribute("onclick"))||hasClass("al_nav",e)))return!0;return!1}function checkTouchHover(e){if(!(e=ge(e)))return!1;do{if("a"==tag(e)||hasClass("al_photo",e))return e;if(hasClass(Btn.className,e))return e;if("label"==tag(e)&&hasClass("option_row",e))return e;if(hasClass("_touched",e))return e}while(e=e.parentNode);return!1}function trim(e){return(e||"").trim()}function parseCyr(e,t){for(var n=e,i=["yo","zh","kh","ts","ch","sch","shch","sh","eh","yu","ya","YO","ZH","KH","TS","CH","SCH","SHCH","SH","EH","YU","YA","'"],o=["ё","ж","х","ц","ч","щ","щ","ш","э","ю","я","Ё","Ж","Х","Ц","Ч","Щ","Щ","Ш","Э","Ю","Я","ь"],r=0,a=i.length;r<a;r++)n=t?n.split(i[r]).join(o[r]):n.split(o[r]).join(i[r]);var s="abvgdezijklmnoprstufhcyABVGDEZIJKLMNOPRSTUFHCYёЁ",l="абвгдезийклмнопрстуфхцыАБВГДЕЗИЙКЛМНОПРСТУФХЦЫеЕ";for(r=0,a=s.length;r<a;r++)n=t?n.split(s.charAt(r)).join(l.charAt(r)):n.split(l.charAt(r)).join(s.charAt(r));return n==e?null:n}function parseLat(e){return parseCyr(e,!0)}function parseRusKeys(e,t,n){if(!t)return null;for(var i=e,o="qwertyuiop[]asdfghjkl;'zxcvbnm,./`QWERTYUIOP{}ASDFGHJKL:\"ZXCVBNM<>?~",r="йцукенгшщзхъфывапролджэячсмитьбю.ёЙЦУКЕНГШЩЗХЪФЫВАПРОЛДЖЭЯЧСМИТЬБЮ,Ё",a=0,s=o.length;a<s;a++)i=n?i.split(o.charAt(a)).join(r.charAt(a)):i.split(r.charAt(a)).join(o.charAt(a));return i==e?null:i}function parseLatKeys(e,t){return parseRusKeys(e,t,!0)}function scrollLeft(){var e=window,t=e.htmlNode,n=e.bodyNode;return t.scrollLeft||n.scrollLeft||window.scrollX||0}function scrollTop(e,t){var n=window,i=n.htmlNode,o=n.bodyNode;if(void 0===e)return i.scrollTop||o.scrollTop||window.scrollY||0;t?setTimeout(function(){window.scrollTo(0,Math.max(0,e))},t):window.scrollTo(0,Math.max(0,e))}function se(){var e=[],t=Array.prototype.slice.call(arguments);return function(n,i){if(n)if(n.apply)e.push(n);else if("__clear"===n)if(i){for(var o=0,r=e.length;o<r;o++)if(e[o]===i){e.splice(o,1);break}}else e=[];else{var a=Array.prototype.slice.call(arguments);a.shift();var s=0;for(r=e.length;s<r;s++)e[s].apply(window,getValues(t).concat(a))}}}function onBodyScrollForce(e){var t=window,n=t.onBodyScroll,i=t.onDOMReady;e?setTimeout(function(){n(!0)},e):i(function(){n(!0)})}function sgFix(){var e=window,t=e._ua,n=e.ajax,i=e.page,o=e.clog;/galaxy|gt\-/i.test(t)&&(window.vkSGi=0,window.vkAjax=n,window.vkPage=i,function e(){if(!(++window.vkSGi>25))return n!==window.vkAjax||i!==window.vkPage?(n=window.vkAjax,i=window.vkPage,o("SG fixed"),void delete window.vkSGi):void setTimeout(e,200);delete window.vkSGi}())}function hideUnvisibleItems(e){var t=window.cur;if(t.alHiddenObjects){var n=getValues(t.alHiddenObjects);if(n){var i=(e=e||{}).delta||3*getCh(),o=scrollTop(),r=o-i,a=o+getCh()+i,s=[],l=[],u=null,c=null;if(each(n,function(e,t){var n=gpeByClass("ali_wrap",t);if(!n)return!0;var i=n.offsetHeight,o=getY(n),d=o+i,f=isVisible(t);d<r||o>a?f&&s.push([n,t,i]):f?u||(u=n,c=o):l.push([n,t])}),each(l,function(e,t){var n=t[0],i=t[1];setStyle(n,"height","auto"),show(i)}),each(s,function(e,t){var n=t[0],i=t[1];setStyle(n,"height",t[2]),hide(i)}),u&&c){var d=getY(u);d!=c&&scrollTop(o+(d-c))}}}}function initObjectsHideByScroll(e,t){var n=window,i=n.cur,o=n.onBodyScroll,r=n.onDOMReady;i&&e&&(i.alHiddenObjects=e,o(function(){hideUnvisibleItems(t)}),r(function(){hideUnvisibleItems(t)}))}function checkPostsSeen(){var e=window,t=e.cur,n=e.pStats;if(t&&t.alPostsStatsObjects){var i=getValues(t.alPostsStatsObjects);if(i){var o=scrollTop(),r=o+getCh(),a=[];each(i,function(e,t){if(attr(t,"data-ignore"))return!0;var i=getY(t),s=i+t.offsetHeight,l=(isVisible(t),attr(t,"data-clicked")),u=t.bits||0;return u>=3||(s<o||i>r||(u|=i>=o&&i<r||l?1:0,void((u|=s>=o&&s<r||l?2:0)&&(t.bits=u,3==u&&(a.push(n.postsGetRaws(t)),n.viewed(t))))))}),n.seen(a)}}}function initPostsStats(e){var t=window,n=t.cur,i=t.onBodyScroll,o=t.onDOMReady;n&&e&&(n.alPostsStatsObjects=e,i(function(){checkPostsSeen()}),o(function(){checkPostsSeen()}))}function initAutoScroll(e,t,n){var i=window.onBodyScroll;if(e&&t){var o=(n=n||{}).delta||!1;i(function(n){var i=getValues(e);if(i){var r=getY(i),a=getCh();r>0&&r-n-a<(o||2*a)&&t.call(i)}})}}function autoScroll(e,t,n){var i=window.ajax;n=n||{};var o=getValues(e),r=ge("show_more_loading"),a=n.no_cache||!1,s=function(){i.click(this,t,{use_cache:!a})};!o&&r&&s.call(r),initAutoScroll(e,s,n),n.hide_objects&&initObjectsHideByScroll(n.hide_objects)}function scrollToEl(e,t,n){e=ge(e)||window,t=t||0,scrollTop((e===window?1:getY(e))-t,n)}function scrollToHash(e){var t=window.nav;if("#"===(e=e||t.hash||location.hash)[0]&&(e=e.substr(1)),e){var n=geBySel("a[name]");!1===n&&(n=geByTag("a")),each(n,function(t,n){if(n.name==e)return scrollToEl(n),!1})}}function lockButton(e){var t=ge(e);if(/(^|\s)(small_)?button(\s|$)/i.test(t.className)){var n=ce("button",{id:t.id,className:t.className,innerHTML:'<span class="button_locked"><b class="button_locked_label">'+htsc(val(t))+"</b></span>",onclick:function(e){return cancelEvent(e)},real_btn:t});t.fake_btn=n,before(n,t),remove(t)}}function unlockButton(e){var t=ge(e);t.real_btn?(before(t.real_btn,t),remove(t),t.real_btn.fake_btn=null,t.real_btn=null):t.fake_btn&&(before(t,t.fake_btn),remove(t.fake_btn),t.fake_btn.real_btn=null,t.fake_btn=null)}function extend(){var e=Array.prototype.slice.call(arguments),t=e.shift();if(!e.length)return t;for(var n=0,i=e.length;n<i;n++)for(var o in e[n])"layerX"!=o&&"layerY"!=o&&(t[o]=e[n][o]);return t}function ge(e){return"string"==typeof e?document.getElementById(e):e}function geByClass(e,t,n){if(t=ge(t)||document,n=n||"*",t.getElementsByClassName){var i=t.getElementsByClassName(e);if("*"==n)return Array.prototype.slice.call(i);var o=[];n=n.toUpperCase();for(var r=0,a=i.length;r<a;r++)i[r].tagName.toUpperCase()==n&&o.push(i[r]);return o}i=geByTag(n,t),o=[];var s=new RegExp("(^|\\s)"+escapeRE(e)+"(\\s|$)");for(r=0,a=i.length;r<a;r++)s.test(i[r].className)&&o.push(i[r]);return o}function geByClass1(e,t,n){return geByClass(e,t,n)[0]}function gpeByClass(e,t){if(!(t=ge(t)))return null;for(;t=t.parentNode;)if(hasClass(e,t))return t;return null}function geByTag(e,t){return(ge(t)||document).getElementsByTagName(e)}function geByTag1(e,t){return geByTag(e,t)[0]}function gpeByTag(e,t){if(!(t=ge(t)))return null;for(e=e.toUpperCase();t=t.parentNode;)if(t.tagName&&t.tagName.toUpperCase()==e)return t;return null}function geBySel(e,t){return!!(t=ge(t)||document).querySelectorAll&&t.querySelectorAll(e)}function geBySel1(e,t){return!!(t=ge(t)||document).querySelector&&t.querySelector(e)}function append(e,t){return e=ge(e),t=ge(t),e&&t&&t.appendChild(e)||!1}function before(e,t){return(t=ge(t))&&t.parentNode&&t.parentNode.insertBefore(ge(e),t)||!1}function after(e,t){return(t=ge(t))&&t.parentNode&&t.parentNode.insertBefore(ge(e),t.nextSibling)||!1}function replace(e,t){before(e,t)&&remove(t)}function remove(e){return!(!(e=ge(e))||!e.parentNode)&&e.parentNode.removeChild(e)}function clone(e){return!!(e=ge(e))&&e.cloneNode(!0)}function reflow(e){e=ge(e);try{e.offsetWidth,e.offsetHeight}catch(e){}}function tag(e){return((e=ge(e))&&e.tagName||"").toLowerCase()}function outer(e){return(e=ge(e))?val(ce("div").appendChild(clone(e)).parentNode):""}function show(e){var t=ge(e);t&&(t.style.display=t.oldstyle||(hasClass("_ib",t)?"inline-block":hasClass("_i",t)||"span"==tag(t)?"inline":"block"))}function hide(e){var t=ge(e);t&&("none"!=t.style.display&&(t.oldstyle=t.style.display),t.style.display="none")}function isVisible(e){var t=ge(e);return!(!t||!t.style)&&"none"!=t.style.display}function toggle(e,t){void 0===t&&(t=!isVisible(e)),t&&isVisible(e)||(t||isVisible(e))&&(t?show:hide)(e)}function ce(e,t,n){var i=document.createElement(e);return t&&extend(i,t),n&&setStyle(i,n),i}function elfocus(e,t,n){e=ge(e);try{if(e.focus(),void 0!==t&&!1!==t||(t=e.value.length),void 0!==n&&!1!==n||(n=t),e.createTextRange){var i=e.createTextRange();i.collapse(!0),i.moveEnd("character",t),i.moveStart("character",n),i.select()}else e.setSelectionRange&&e.setSelectionRange(t,n)}catch(e){}}function elblur(e){(e=ge(e))&&e.blur&&e.blur()}function val(e,t){if(!(e=ge(e)))return"";var n=e.tagName.toLowerCase(),i="input"==n||"textarea"==n||"select"==n,o=i&&("radio"==e.type||"checkbox"==e.type);if(void 0===t)return i?o?e.checked:e.value:e.innerHTML;if(i)o?e.checked=t:e.value=t;else{e.innerHTML=t;var r=window.ajax;"a"!=n&&(r.prepare_nav(e),r.prepare_click(e),r.onPrepared(!0,e))}}function attr(e,t,n){if(e=ge(e))return void 0===n?"data-"==t.substr(0,5)&&e.dataset?e.dataset[t.substr(5).replace(/-([a-z0-9])/,function(e,t){return t.toUpperCase()})]||!1:e.getAttribute&&e.getAttribute(t)||!1:!1===n?e.removeAttribute&&e.removeAttribute(t)||!1:void(e.setAttribute&&e.setAttribute(t,n))}function cssToJs(e,t){return t?t+(e||"").replace(/(?:^|-)([a-z])/g,function(e,t){return(t||"").toUpperCase()}):(e||"").replace(/-([a-z])/g,function(e,t){return(t||"").toUpperCase()})}function getCssPropertyName(e,t,n){e=ge(e)||ce("div");for(var i=["webkit","Moz","ms","O",""],o=["-webkit-","-moz-","-ms-","-o-",""],r=0,a=i.length;r<a;r++){var s=cssToJs(t,i[r]);if(void 0!==e.style[s])return n?o[r]+t:s}return!1}function cssValue(e,t){if("number"==typeof e){e=Math.round(1e7*e)/1e7+(t||"")}return e}function getStyle(e,t,n){if(!(e=ge(e)))return!1;if(isArray(t)){var i={};return each(t,function(t,n){i[n]=getStyle(e,n)}),i}if(isUndefined(n)&&(n=!0),/transform(-origin)?|transition(-duration)?/i.test(t)&&!(t=getCssPropertyName(e,t)))return!1;var o=window.browser;if(!n&&"opacity"==t&&o.msie)return(l=e.style.filter)?l.indexOf("opacity=")>=0?parseFloat(l.match(/opacity=([^)]*)/)[1])/100+"":"1":"";if(!n&&e.style&&(e.style[t]||"height"==t))return e.style[t];var r,a=document.defaultView||window;if(a.getComputedStyle){t=t.replace(/([A-Z])/g,"-$1").toLowerCase();var s=a.getComputedStyle(e,null);s&&(r=s.getPropertyValue(t))}else if(e.currentStyle){var l;if("opacity"==t&&o.msie)return(l=e.currentStyle.filter)&&l.indexOf("opacity=")>=0?parseFloat(l.match(/opacity=([^)]*)/)[1])/100+"":"1";var u=t.replace(/\-(\w)/g,function(e,t){return t.toUpperCase()});"auto"==(r=e.currentStyle[t]||e.currentStyle[u])&&(r=0),each(r=(r+"").split(" "),function(t,n){if(!/^\d+(px)?$/i.test(n)&&/^\d/.test(n)){var i=e.style,o=i.left,a=e.runtimeStyle.left;e.runtimeStyle.left=e.currentStyle.left,i.left=n||0,r[t]=i.pixelLeft+"px",i.left=o,e.runtimeStyle.left=a}}),r=r.join(" ")}if(n&&("width"==t||"height"==t)){var c="width"==t?getW(e):getH(e);r=(intval(r)?Math.max(floatval(r),c):c)+"px"}return r}function setStyle(e,t,n){if((e=ge(e))&&e.style){if(isObject(t))return each(t,function(t,n){setStyle(e,t,n)});var i="number"==typeof n;i&&/height|width/i.test(t)&&(n=Math.abs(n)),/transform(-origin)?|transition(-duration)?/i.test(t)&&!(t=getCssPropertyName(e,t))||(e.style[t]=i&&!/z-?index|font-?weight|opacity|zoom|line-?height/i.test(t)?n+"px":n)}}function hasClass(e,t,n){if("string"==typeof t&&"string"!=typeof e){var i=[t,e];e=i[0],t=i[1]}if(t=ge(t))return new RegExp("(^|\\s)"+(n?e:escapeRE(e))+"(\\s|$)").test(t.className)}function addClass(e,t){if("string"==typeof t&&"string"!=typeof e){var n=[t,e];e=n[0],t=n[1]}(t=ge(t))&&!hasClass(e,t)&&(t.className=(t.className?t.className+" ":"")+e)}function removeClass(e,t,n){if("string"==typeof t&&"string"!=typeof e){var i=[t,e];e=i[0],t=i[1]}(t=ge(t))&&hasClass(e,t,n)&&(t.className=(t.className||"").replace(new RegExp("(^|\\s)"+(n?e:escapeRE(e))+"(\\s|$)"),function(e,t,n){return t&&n?" ":""}))}function toggleClass(e,t,n){(void 0===n?hasClass(e,t):!n)?removeClass(e,t):addClass(e,t)}function replaceClass(e,t,n,i){removeClass(e,n,i),addClass(t,n)}function switchClass(e,t,n){hasClass(e,n)?replaceClass(e,t,n):replaceClass(t,e,n)}function getXY(e){if(!(e=ge(e)))return[0,0];var t=0,n=0;if(e.offsetParent)do{t+=e.offsetLeft,n+=e.offsetTop}while(e=e.offsetParent);return[t,n]}function getX(e){return getXY(e)[0]}function getY(e){return getXY(e)[1]}function getW(e){return(e=ge(e))&&e.offsetWidth||0}function getH(e){return(e=ge(e))&&e.offsetHeight||0}function getSize(e){return[getW(e=ge(e)),getH(e)]}function getCw(){return Math.max(window.innerWidth||0,(window.htmlNode||{}).clientWidth||0)}function getCh(){return Math.max(window.innerHeight||0,(window.htmlNode||{}).clientHeight||0)}function evalJs(e){window.execScript?window.execScript(e):eval.call(window,e)}function domData(e,t,n){return e?void 0!==n?(null===n?e.removeAttribute("data-"+t):e.setAttribute("data-"+t,n),n):e.getAttribute("data-"+t):null}function alLoadingFix(e,t){var n=ge(t=t||"al_loading");if(n){if(!e){var i=ge("m").offsetHeight||0,o=ge("mfoot")&&ge("mfoot").offsetHeight||0;e=getCh()-i+o}n.style.height=e+"px",addClass(t,n)}}function getHref(e){if(!e)return!1;var t=!1;return e.getAttribute&&(t=e.getAttribute("data-href")||e.getAttribute("href")),t||(e.pathname?t=e.pathname+e.search+e.hash:tag(e)||(t=e)),t||!1}function ajx2q(e){var t=[],n=function(e){try{return encodeURIComponent(e)}catch(e){return""}};for(var i in e)if(null!=e[i]&&!isFunction(e[i]))if(isArray(e[i]))for(var o=0,r=0,a=e[i].length;o<a;++o)null==e[i][o]||isFunction(e[i][o])||(t.push(n(i)+"["+r+"]="+n(e[i][o])),++r);else t.push(n(i)+"="+n(e[i]));return t.join("&")}function indexOf(e,t,n){for(var i=n||0,o=(e||[]).length;i<o;i++)if(e[i]==t)return i;return-1}function isToday(e){var t=new Date;return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}function isYesterday(e){return isToday(new Date(e.getTime()+864e5))}function isTomorrow(e){return isToday(new Date(e.getTime()-864e5))}function isSameDate(e,t){var n=new Date(e),i=new Date(t);return n.getFullYear()===i.getFullYear()&&n.getMonth()===i.getMonth()&&n.getDate()===i.getDate()}function leadingZero(e){return e>=10?e:"0"+e}function langSex(e,t){if(!isArray(t))return t;var n=t[1];return window.langConfig?(each(langConfig.sexRules,function(i,o){return"*"==o[0]?(n=t[o[1]],!1):e==o[0]&&t[o[1]]?(n=t[o[1]],!1):void 0}),n):n}function langNumeric(e,t,n){var i,o=window.langConfig;if(!t||!o)return e;if(isArray(t)?(i=t[1],e!=Math.floor(e)?i=t[o.numRules.float]:each(o.numRules.int,function(n,o){if("*"==o[0])return i=t[o[2]],!1;var r=o[0]?e%o[0]:e;return-1!=indexOf(o[1],r)?(i=t[o[2]],!1):void 0})):i=t,n){for(var r=e.toString().split("."),a=[],s=r[0].length-3;s>-3;s-=3)a.unshift(r[0].slice(s>0?s:0,s+3));r[0]=a.join(o.numDel),e=r.join(o.numDec)}return i=(i||"%s").replace("%s",e)}function langWordNumeric(e,t,n){return isArray(t)&&e<t.length?t[e]:langNumeric(e,n)}function langDate(e,t,n,i,o,r){var a=window.langConfig,s=void 0;if(r||(r=""),isArray(t)||(t=["",t,t,t,t]),"number"==typeof e||"string"==typeof e?(e>2147483646e3&&(e=0),e+=n,s=new Date(e)):s=e,o)t=t[1];else{var l="";!(l=isToday(s)?t[3]:isYesterday(s)?t[2]:isTomorrow(s)?t[4]:t[1])&&t[1]&&(l=t[1]),t=l}var u="",c={hours:s.getHours(),minutes:s.getMinutes(),seconds:s.getSeconds(),day:s.getDate(),month:s.getMonth()+1,year:s.getFullYear()};switch(3===a.id&&(u=s.getHours()>11?"pm":"am",c.hours=s.getHours()%12==0?12:s.getHours()%12),a.id){case 1:switch(s.getHours()){case 11:t=t.replace(" о "," об ");break;case 0:t=t.replace(" о "," в ")}break;case 3:!isToday(s)||isYesterday(s)||isTomorrow(s)||(t=r+t);break;case 12:case 73:1==s.getHours()&&(t=t.replace(" &#224;s "," &#224; "))}return 68===a.id&&(c.year=c.year+543),t.replace("{hour}",c.hours).replace("{num_hour}",leadingZero(c.hours)).replace("{minute}",leadingZero(c.minutes)).replace("{day}",c.day).replace("{num_day}",leadingZero(c.day)).replace("{month}",i[c.month]).replace("{year}",c.year).replace("{short_year}",c.year%100).replace("{second}",leadingZero(c.seconds)).replace("{am_pm}",u)}function setNotify(e){var t=intval(e),n=ge("header_msgs"),i=geByClass1("pcont","l");if(n&&(window.isNewMail?val(n,'<div class="hb_btn mhi_notify">'+(t>0?'<em class="mh_notify_counter">'+t+"</em>":"")+"</div>"):val(n,'<div class="hb_btn mhi_notify">'+(t>0?'<em class="mh_notify_counter">'+t+"</em>":"&nbsp;")+"</div>"),t>0?removeClass("mhb_no_notify",n):addClass("mhb_no_notify",n),i)){var o=geByClass1("mmi_mail",i),r=geByClass1("mmi_wrap",o),a=geByClass1("mm_counter",r);if(!o)return;t>0?a?val(a,t):append(ce("em",{className:"mm_counter",innerHTML:t}),r):remove(a)}}function getNotify(){var e=ge("header_msgs");return e?intval(val(geByTag1("em",e))):0}function canUploadFile(){return(window.XMLHttpRequest||window.XDomainRequest)&&(window.FormData||window.FileReader&&(window.XMLHttpRequest&&XMLHttpRequest.sendAsBinary||window.ArrayBuffer&&window.Uint8Array&&(window.MozBlobBuilder||window.WebKitBlobBuilder||window.BlobBuilder)))}function uploadFile(e,t,n){var i=window.XDomainRequest||window.XMLHttpRequest,o=new i;o.open("POST",e,!0),o.upload.addEventListener("progress",n.onProgress||rf,!1),o.onload=n.onComplete||rf,o.onerror=n.onError||rf;var r=n.onStart||rf;if(window.FormData){var a=new FormData;for(var s in t)a.append(s,t[s]);return o.send(a),r(o),o}try{if(i&&!i.prototype.sendAsBinary&&window.ArrayBuffer&&window.Uint8Array){var l=window.MozBlobBuilder||window.WebKitBlobBuilder||window.BlobBuilder;l&&(i.prototype.sendAsBinary=function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t,0),i=0;i<e.length;i++)n[i]=255&e.charCodeAt(i);var o=new l;o.append(t);var r=o.getBlob();this.send(r)})}var u="----VkComFormBoundary-"+srand(),c="",d=0,f=function(e,t,n){n+="--"+t+"--",e.setRequestHeader("Content-type",'multipart/form-data; boundary="'+t+'"'),e.sendAsBinary(n),r(e)};for(var s in t)if("function"==typeof t[s].getAsBinary){d++;var p=new FileReader,_=t[s],A=_.fileName||_.name||"";p.onload=function(){c+="--"+u+'\r\nContent-Disposition: form-data; name="'+utf2win(s)+'"; filename="'+utf2win(A)+'"\r\nContent-Type: application/octet-stream\r\n',p.result,--d||f(o,u,c)},p.readAsBinaryString(_)}else c+="--"+u+'\r\nContent-Disposition: form-data; name="'+utf2win(s)+'"\r\n\r\n'+utf2win(t[s])+"\r\n";return d||f(o,u,c),o}catch(e){return!1}return!1}function readFile(e,t){if(window.FileReader&&window.vk.iu_ex){var n=new FileReader;n.onload=function(){t&&t(n.result),n=null},n.readAsDataURL(e)}}function formatTime(e){var t,n,i,o=e<0;return t=(n=(e=Math.round(o?-e:e))%60)<10?"0"+n:n,t=(i=(e=Math.floor(e/60))%60)+":"+t,(e=Math.floor(e/60))>0&&(i<10&&(t="0"+t),t=e+":"+t),o&&(t="-"+t),t}function domClosestOverflowHidden(e){for(var t,n,i,o,r=e=ge(e);r&&r.tagName&&r!==bodyNode&&(t=getStyle(r,"position"),n=getStyle(r,"overflow"),i=getStyle(r,"transform"),r===e||"visible"===n||("static"===t?o&&"relative"!==o:"fixed"===o));)"none"!==i?o=void 0:"static"!==t&&"fixed"!==o&&(o=t),r=(r||{}).parentNode;return r}function copyToClipboard(e){(0,_select2.default)(e);var t=void 0;try{t=document.execCommand("copy")}catch(e){t=!1}return t}function blinkItem(e,t){setStyle(e,{opacity:1}),setTimeout(function(){return setStyle(e,{opacity:0})},t)}function domPN(e){return(e||{}).parentNode}function matchesSelector(e,t){return!(!(e=ge(e))||e==document)&&(e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector||function(e){for(var t=(this.parentNode||this.document||this.ownerDocument).querySelectorAll(e),n=t.length;--n>=0&&t[n]!==this;);return n>-1}).call(e,t)}function domCA(e,t){do{e=domPN(e)}while(e&&!matchesSelector(e,t));return e}function getLang(){try{var e=Array.prototype.slice.call(arguments),t=e.shift();if(!t)return"...";var n=window.cur&&window.cur.lang&&window.cur.lang[t]||window.lang&&window.lang[t]||window.langpack&&window.langpack[t]||window[t];if(!n){var i=t.split("_");return i.shift(),i.join(" ")}return isFunction(n)?n.apply(null,e):void 0===e[0]&&!isArray(n)||"raw"===e[0]?n:langNumeric(e[0],n,e[1])}catch(e){console.log("lang error:"+e.message+"("+Array.prototype.slice.call(arguments).join(", ")+")")}}function domData(e,t,n){return e?void 0!==n?(null===n?e.removeAttribute("data-"+t):e.setAttribute("data-"+t,n),n):e.getAttribute("data-"+t):null}function throttle(e,t){var n;return function(){n||(e.apply(this,arguments),n=setTimeout(function(){n=!1},t))}}function debounce(e,t){return function t(){t._timer&&clearTimeout(t._timer);var n=this,i=arguments;t._timer=setTimeout(function(){t._timer=null,e.apply(n,i)})}}function scrollGetX(){return window.pageXOffset||scrollNode.scrollLeft||document.documentElement.scrollLeft}function scrollGetY(){return window.pageYOffset?window.pageYOffset:window.scrollNode?window.scrollNode.scrollTop:document.documentElement?document.documentElement.scrollTop:0}function domEL(e,t){for(t=t?"previousSibling":"nextSibling";e&&!e.tagName;)e=e[t];return e}function domPS(e){return domEL((e||{}).previousSibling,1)}function domNS(e){return domEL((e||{}).nextSibling)}function domFC(e){return domEL((e||{}).firstChild)}function domInsertAfter(e,t){var n=domPN(t);return n&&n.insertBefore(e,domNS(t))}function domInsertBefore(e,t){var n=domPN(t);return n&&n.insertBefore(e,t)}function domChildIndex(e){for(var t=0;null!=(e=domPS(e));)t++;return t}function domChildren(e){for(var t=[],n=e.childNodes,i=0;i<n.length;i++)n[i].tagName&&t.push(n[i]);return t}function safeGet(e,t){for(var n=t.split("."),i=n.length,o=e,r=0;r<i;r++)if(!(o=o[n[r]]))return;return o}function alwaysArray(e){return Array.isArray(e)?e:[e]}function disableFlex(){var e=(0,_Dollars.$)(".vk"),t=Array.from((0,_Dollars.$$)("*")),n=["A","IMG","SPAN"];e.classList.remove("vk_flex_yes"),e.classList.add("vk_flex_no"),t.filter(function(e){return e instanceof Element&&"flex"===getComputedStyle(e).display}).forEach(function(e){n.includes(e.tagName)?e.style.display="inline":e.style.display="block"})}function flatArray(e){return Array.isArray(e)?flatten(e):[e]}function domQuery(e,t){return(t||document).querySelectorAll(e)}function domQuery1(e,t){return(t||document).querySelector(e)}function domQuery(e,t){return(t||document).querySelectorAll(e)}function flatten(e){var t=[];return e.forEach(function(e){isArray(e)?t=t.concat(flatten(e)):t.push(e)}),t}function ariaMode(){(0,_Dollars.$)("html").classList.add("vk_ariaMode"),(0,_Dollars.$$)("*").forEach(function(e){if(e.style.opacity=1,e.style.fontSize="9px",e.style.backgroundImage="none","true"===e.getAttribute("aria-hidden")&&(e.style.display="none"),"IMG"===e.tagName){var t=e.getAttribute("alt")||"[?]";e.insertAdjacentHTML("afterend","<div>"+t+"</div>"),e.style.display="none"}else e.innerHTML.trim()&&!e.getAttribute("aria-label")||(e.innerHTML=e.getAttribute("aria-label")||e.getAttribute("alt")||e.getAttribute("href")||"[?]")})}function ceFromString(e){var t=document.createElement("div");return t.innerHTML=e.trim(),t.firstChild}function isIosWebView(){return window.webkit&&window.webkit.messageHandlers}function isAndroidWebView(){return window.AndroidBridge}function isVkWebView(){return isIosWebView()?"function"==typeof window.webkit.messageHandlers.VKWebAppInit:!!isAndroidWebView()&&"function"==typeof window.AndroidBridge.VKWebAppInit}function acquireLock(e,t,n){var i="lock_"+e;if(lsCheck()){if(!0!==lsGet(i)){lsSet(i,!0);try{t()}catch(e){}return void lsSet(i,!1)}n||setTimeout(acquireLock.bind(window,e,t,!0),100)}else t()}function statlogsValueEvent(e,t){if(void 0!==e&&void 0!==t){var n=[].slice.call(arguments,2),i=void 0;acquireLock("m_stats_cookie_lock",function(){try{i=(i=JSON.parse(getCookie("remixmsts"))).data}catch(e){i=[]}i.push([Math.round(Date.now()/1e3),e,t].concat(n)),i=i.slice(i.length-100);var o=Math.round(rand(0,1e9));setCookie("remixmsts",JSON.stringify({data:i,uniqueId:o}),.01)})}}function ajaxRequest(e,t,n,i){n||(n=function(){}),t._ajax=1;var o=nav.getQuery("community");return o&&!t.community&&(t.community=o),ajax.post(e,t,{onDone:n,onFail:i})}function arrayRemove(e,t){for(;;){var n=e.indexOf(t);if(!(n>=0))break;e.splice(n,1)}}function arrayIntersects(e,t){return e.some(function(e){return-1!==t.indexOf(e)})}function asc(e,t){return e-t}function desc(e,t){return t-e}function unique(e,t,n){return n.indexOf(e)===t}function first(e,t){return 1===arguments.length?e[0]:t.slice(0,e)}function last(e,t){return 1===arguments.length?e[e.length-1]:t.slice(-e)}function toInt(e){return parseInt(e,10)}function toArray(e){return"[object Object]"===Object.prototype.toString.call(e)?Object.keys(e).map(function(t){return e[t]}):Array.isArray(e)?e:[e]}function groupBy(e,t){var n={};return e.forEach(function(e){var i=t(e);(n[i]||(n[i]=[])).push(e)}),n}function domInsert(e,t,n){var i="string"==typeof t?domCreate(t):t;n>=0&&e.children[n]?e.insertBefore(i,e.children[n]):e.appendChild(i)}function openApp(e){e.startsWith("/")?window.location="vk://vk.com"+e:window.location="vk://"+e,setTimeout(function(){window.location="/?act=go2app"},25)}function domCreate(e){var t=document.createElement("div");return t.innerHTML=e,t.children[0]}function rs(e,t){return e.replace(/%([^%]+?)%/g,function(e){return e=e.slice(1,-1),t.hasOwnProperty(e)?t[e]:""})}extend(getStyle,{transform:function(e){var t,n=getStyle(e,"transform");return n?{scale:(t=n.match(/(^|\s+)scale\(([0-9.]+)\)(\s+|$)/))&&t[2]||1,scale3d:(t=n.match(/(^|\s+)scale3d\(([0-9.]+,\s+([0-9.]+),\s+([0-9.]+))\)(\s+|$)/))&&t[2]||1,rotate:(t=n.match(/(^|\s+)rotate\(([0-9.-]+)(deg)?\)(\s+|$)/))&&+t[2]||0,translate:(t=n.match(/(^|\s+)translate\(([0-9.-]+)(px)?(?:,\s+([0-9.-]+)(px)?)\)(\s+|$)/))&&[+t[2],+t[4]]||[0,0],translate3d:(t=n.match(/(^|\s+)translate3d\(([0-9.-]+)(px)?(?:,\s+([0-9.-]+)(px)?)(?:,\s+([0-9.-]+)(px)?)\)(\s+|$)/))&&[+t[2],+t[4],+t[6]]||[0,0,0]}:{scale:1,rotate:0,translate:[0,0]}}}),extend(setStyle,{animate:function(e,t,n,i){if(getCssPropertyName(e,"transition")){if(!t)return e.onAnimationEnd?e.onAnimationEnd():setStyle.transition(e),setStyle;var o=(isObject(n)?n.duration:n)||200,r=n.func||"ease";setStyle.transition(e,t,o,r);var a=window.browser;e.onAnimationEnd&&(a.opera?e.removeEventListener("oTransitionEnd",e.onAnimationEnd):removeEvent(e,"transitionend webkitTransitionEnd oTransitionEnd otransitionend msTransitionEnd",e.onAnimationEnd)),e.onAnimationEnd=function(){return a.opera?e.removeEventListener("oTransitionEnd",e.onAnimationEnd):removeEvent(e,"transitionend webkitTransitionEnd oTransitionEnd otransitionend msTransitionEnd",e.onAnimationEnd),e.onAnimationEnd=null,setStyle.transition(e),i&&i(e),!1},a.opera?e.addEventListener("oTransitionEnd",e.onAnimationEnd):addEvent(e,"transitionend webkitTransitionEnd oTransitionEnd otransitionend msTransitionEnd",e.onAnimationEnd)}return setStyle},transform:function(e,t,n,i){var o=window.has3d,r=[];if(isObject(t)){o&&(t.scale3d=t.scale,t.translate3d=t.translate);var a=extend(getStyle.transform(e),t);t=o?a.scale3d:a.scale,i=a.rotate,n=o?a.translate3d:a.translate}if(isArray(t)?o?r.push("scale3d("+cssValue(t[0])+", "+cssValue(t[1])+", 1)"):r.push("scale("+cssValue(t[0])+", "+cssValue(t[1])+")"):void 0!==t&&(o?r.push("scale3d("+cssValue(t)+", "+cssValue(t)+", 1)"):r.push("scale("+cssValue(t)+")")),void 0!==i&&r.push("rotate("+cssValue(i,"deg")+")"),void 0!==n&&(o?r.push("translate3d("+cssValue(n[0],"px")+", "+cssValue(n[1],"px")+", 0)"):r.push("translate("+cssValue(n[0],"px")+", "+cssValue(n[1],"px")+")")),!r.length)return setStyle(e,"transform","none");setStyle(e,"transform",r.join(" "))},transformOrigin:function(e,t,n){isArray(t)&&(n=t[1],t=t[0]),setStyle(e,"transform-origin",cssValue(t,"px")+" "+cssValue(n,"px"))},transition:function(e,t,n,i){var o=[];if(!t)return setStyle(e,"transition","none");isArray(t)||(t=t.split(/\s*,\s*/)),n=cssValue(n,"ms"),each(t,function(){var t=getCssPropertyName(e,this,!0),r=[];t&&(r.push(t),r.push(n),i&&r.push(i),o.push(r.join(" ")))}),setStyle(e,"transition",o.join(","))}}),function(){var e=!1,t=[],n=function(){if(!e&&(e=!0,window.htmlNode=geByTag1("html"),window.bodyNode=geByTag1("body"),t)){for(var n=null;n=t.shift();)n.call(document);t=null}};document.addEventListener?document.addEventListener("DOMContentLoaded",function e(){document.removeEventListener("DOMContentLoaded",e,!1),n()},!1):document.attachEvent&&document.attachEvent("onreadystatechange",function e(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",e),n())}),window.addEventListener?window.addEventListener("load",n,!1):window.attachEvent?window.attachEvent("onload",n):window.onload=n,window.onDOMReady=function(n){e?n.call(document):t.push(n)}}(),window.cdf=(doc=document,frag=doc.createDocumentFragment(),elem=doc.createElement("div"),range=doc.createRange&&doc.createRange(),frag&&frag.appendChild(elem),range&&range.selectNodeContents&&range.selectNodeContents(elem),frag?range&&range.createContextualFragment?function(e){return e?range.createContextualFragment(e):doc.createDocumentFragment()}:function(e){if(!e)return doc.createDocumentFragment();elem.innerHTML=e;for(var t=doc.createDocumentFragment();elem.firstChild;)t.appendChild(elem.firstChild);return t}:function(e){return ce("div",{innerHTML:e})}),onDOMReady(function(){browser.chrome||browser.msie_edge?window.scrollNode=document.scrollingElement||bodyNode:window.scrollNode=browser.safari?bodyNode:htmlNode});var POSTER_SIZE_ASPECT_RATIO=.75,POSTER_HORIZONTAL_PADDING_RATIO=1/18;function resizePosters(e,t,n){var i=ge(t)||document,o="[data-poster-resized='false']";(e||n)&&(o="");var r=domQuery(".poster__text"+o,i),a=cur.posterConfig&&cur.posterConfig.constants;if(!a){if(!r.length)return;a=JSON.parse(domData(r[0].parentElement,"poster-constants"))}for(var s=0;s<r.length;s++){var l=r[s],u=domPN(l),c=domPN(u).clientWidth,d=a.font_size_ratio_range_1*c+"px",f=Math.round(a.line_height_ratio_range_1*c)+"px",p="0 "+Math.round(c*POSTER_HORIZONTAL_PADDING_RATIO)+"px";l.textContent.length>a.range_threshold&&(d=Math.round(a.font_size_ratio_range_2*c)+"px",f=Math.round(a.line_height_ratio_range_2*c)+"px"),setStyle(u,{height:c*POSTER_SIZE_ASPECT_RATIO+"px",width:c}),setStyle(l,{fontSize:d,lineHeight:f,padding:p}),domData(l,"poster-resized",!0)}}},function(e,t){!function(t){var n=[];void 0!==t&&(t.CustomEvent||function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}e.prototype=t.Event.prototype,t.CustomEvent=e}(),t.addEventListener("VKWebAppEvent",function(){var e=Array.prototype.slice.call(arguments);n.forEach(function(t){t.apply(null,e)})})),e.exports={send:function(e,n){n||(n={});var i=void 0!==t,o=i&&t.AndroidBridge,r=i&&t.webkit&&t.webkit.messageHandlers;o&&"function"==typeof o[e]&&o[e](JSON.stringify(n)),r&&r[e]&&"function"==typeof r[e].postMessage&&r[e].postMessage(n)},subscribe:function(e){n.push(e)},unsubscribe:function(e){var t=n.indexOf(e);t>-1&&n.splice(t,1)},supports:function(e){var n=void 0!==t,i=n&&t.AndroidBridge,o=n&&t.webkit&&t.webkit.messageHandlers;return!(!i||"function"!=typeof i[e])||!(!o||!o[e]||"function"!=typeof o[e].postMessage)}}}(window)},function(e,t,n){"use strict";window.SettingsNotifyGroup={},SettingsNotifyGroup._onChange=o;var i={notifyGroup:".settingsNotifyGroup",description:".settingsNotifyGroup__description"};function o(e,t){t.$control.closest(i.notifyGroup).$(i.description).innerHTML=e}},function(e,t,n){"use strict";window.LoginHistory={_onSubmit:function(e,t,n){var i=geByClass1("loginHistory__iframe");preventEvent(e),t.submit(),addEvent(i,"load",function(){return nav.go(n)})}}},function(e,t,n){"use strict";var i,o=n(326),r=(i=o)&&i.__esModule?i:{default:i};window.Select={},Select._onChange=s;var a={optionByValue:function(e){return'.Select__option[value="'+e+'"]'}};function s(e,t){var n=e.value,i=e.$(a.optionByValue(n));r.default.handle(t,{$select:e,$option:i,value:n,name:e.name,label:i.textContent})}},function(e,t){var n,i,o=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===r||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:r}catch(e){n=r}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(e){i=a}}();var l,u=[],c=!1,d=-1;function f(){c&&l&&(c=!1,l.length?u=l.concat(u):d=-1,u.length&&p())}function p(){if(!c){var e=s(f);c=!0;for(var t=u.length;t;){for(l=u,u=[];++d<t;)l&&l[d].run();d=-1,t=u.length}l=null,c=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function _(e,t){this.fun=e,this.array=t}function A(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new _(e,t)),1!==u.length||c||s(p)},_.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=A,o.addListener=A,o.once=A,o.off=A,o.removeListener=A,o.removeAllListeners=A,o.emit=A,o.prependListener=A,o.prependOnceListener=A,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.audioUnmaskSource=function(e){if((!window.wbopen||!~(window.open+"").indexOf("wbopen"))&&~e.indexOf("audio_api_unavailable")){var t=e.split("?extra=")[1].split("#"),n=""===t[1]?"":r(t[1]);if(t=r(t[0]),"string"!=typeof n||!t)return e;for(var i,a,s=(n=n?n.split(String.fromCharCode(9)):[]).length;s--;){if(a=n[s].split(String.fromCharCode(11)),i=a.splice(0,1,t)[0],!o[i])return e;t=o[i].apply(null,a)}if(t&&"http"===t.substr(0,4))return t}return e};var i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMN0PQRSTUVWXYZO123456789+/=",o={v:function(e){return e.split("").reverse().join("")},r:function(e,t){e=e.split("");for(var n,o=i+i,r=e.length;r--;)~(n=o.indexOf(e[r]))&&(e[r]=o.substr(n-t,1));return e.join("")},s:function(e,t){var n=e.length;if(n){var i=function(e,t){var n=e.length,i=[];if(n){var o=n;for(t=Math.abs(t);o--;)t=(n*(o+1)^t+o)%n,i[o]=t}return i}(e,t),o=0;for(e=e.split("");++o<n;)e[o]=e.splice(i[n-1-o],1,e[o])[0];e=e.join("")}return e},i:function(e,t){return o.s(e,t^vk.id)},x:function(e,t){var n=[];return t=t.charCodeAt(0),each(e.split(""),function(e,i){n.push(String.fromCharCode(i.charCodeAt(0)^t))}),n.join("")}};function r(e){if(!e||e.length%4==1)return!1;for(var t,n,o=0,r=0,a="";n=e.charAt(r++);)~(n=i.indexOf(n))&&(t=o%4?64*t+n:n,o++%4)&&(a+=String.fromCharCode(255&t>>(-2*o&6)));return a}},function(e,t,n){"use strict";function i(e){return function(t){t.$control.closest(r.sms).classList.toggle(a[e])}}function o(e,t){var n=t.$select,i=t.value;n.closest(r.sms).classList.toggle(a.pmUsersVisible,e.includes(i)||e.includes(Number(i)))}window.SettingsSms={},SettingsSms._onEnabledChange=i("enabled"),SettingsSms._onTimeLimitedChange=i("timeLimited"),SettingsSms._onFrequencyChange=o;var r={sms:".settingsSms"},a={enabled:"settingsSms_enabled",timeLimited:"settingsSms_timeLimited",pmUsersVisible:"settingsSms_pmUsersVisible"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(139),r=(i=o)&&i.__esModule?i:{default:i};n(287),t.default=r.default,window.MailScrap=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{!i&&s.return&&s.return()}finally{if(o)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}t.createLongpollEventsQueue=function(e,t,n){var r=0,a=e,s=[],l=!1;function u(){!s.length||r>0||l||(t(s),s=[])}return{pause:function(){r++},resume:function(){r>0&&(r--,u())},onLp:function(e,t,r){var c;l||(a>=e?(a=t,(c=s).push.apply(c,o(r)),u()):function(){if(!n)return;l=!0,n(a).then(function(e){var t,n=i(e,3),r=(n[0],n[1]),c=n[2];a=r,l=!1,(t=s).push.apply(t,o(c)),u()})}())}}}},function(e,t,n){e.exports=n(343)},function(e,t,n){"use strict";var i,o=n(342),r=(i=o)&&i.__esModule?i:{default:i};function a(e,t){return e+'="'+t+'"'}function s(e){return function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];return a(e,function(e){var t=e[0],n=e.slice(1).map(l).join(", ");return t+"("+n+")"}(n))}}function l(e){return"number"==typeof e||"event"===e||"this"===e?e:JSON.stringify(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39").replace(/</g,"&lt;").replace(/>/g,"&gt;")}Object.assign(r.default,{attr:a,onBlur:s("onblur"),onClick:s("onclick"),onFocus:s("onfocus"),onInput:s("oninput"),onKeyDown:s("onkeydown"),onKeyPress:s("onkeypress"),onKeyUp:s("onkeyup"),onMouseDown:s("onmousedown"),onMouseUp:s("onmouseup"),onScroll:s("onscroll"),onSubmit:s("onsubmit"),onTouchEnd:s("ontouchend"),onTouchMove:s("ontouchmove"),onTouchStart:s("ontouchstart"),onWheel:s("onwheel"),onChange:s("onchange")})},function(e,t,n){"use strict";var i=window,o=i.hide,r=i.ge,a=i.ce,s=i.geByClass1,l=i.val,u=i.show,c=i.remove,d=i.addClass,f=i.removeClass,p=window.geo,_=window.ajax,A=function(){var e=null,t=!1;function n(e,t){var n=r("medias_map"),i=r("attached_wrap");n||(n=a("div",{id:"medias_map",className:"pi_medias"}),i.appendChild(n));var o=e.latitude,c=e.longitude,d=(window.devicePixelRatio,s("medias_map",n)),f=t?'<div class="medias_map_close"><i class="i_close">&nbsp;</i></div><div class="medias_map_label">'+t+"</div>":"",p='<input type="hidden" name="map" value="'+(o+"_"+c+"_0")+'">';d?l(d,f+""+p):l(n,'<div class="meias_row medias_map" onclick="geoloc.remove();">'+f+p+"</div>");u(n)}function i(){e=null,c("medias_map")}function m(t){var i;t&&t.coords&&(e={latitude:+t.coords.latitude||0,longitude:+t.coords.longitude||0},i=e,_.post("/places.php",{_ajax:1,act:"map_label",lat:i.latitude,lng:i.longitude},{onDone:function(e){o("geo_waiting"),n(i,e)},onFail:h}))}function h(e){A.remove(),o("geo_waiting")}return{toggle:function(){t?A.remove():A.add()},add:function(i){!i&&t||(t=!0,d("cp_geo_btn_sel","geo_btn"),i&&(i.latitude||i.longitude)?n(e={latitude:+i.latitude||0,longitude:+i.longitude||0},i.label):(p.getCurrentPosition(m,h),u("geo_waiting")))},remove:function(){t&&(t=!1,f("cp_geo_btn_sel","geo_btn"),i())},init:function(e){return e&&A.add(e),p.init()}}}();window.geoloc=A},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNetworkType=function(){if(!1===navigator.onLine)return"none";var e=navigator.connection||navigator.webkitConnection||navigator.mozConnection;if(!e)return"unknown";if(e.effectiveType)return e.effectiveType;var t=+(e.downlinkMax||e.downlink);if(t)return t<50?"slow-2g":t<70?"2g":t<700?"3g":"4g";return i[e.type]||"unknown"};var i={bluetooth:"2g",cellular:"2g",ethernet:"4g",mixed:"unknown",none:"none",other:"unknown",unknown:"unknown",wifi:"3g",wimax:"4g"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=c(['\n    <div class="','" ',">\n      ",'\n      <div class="Unfold__popup ','">\n        ',"\n      </div>\n    </div>\n  "],['\n    <div class="','" ',">\n      ",'\n      <div class="Unfold__popup ','">\n        ',"\n      </div>\n    </div>\n  "]),o=c(['\n    <a href="','" class="Unfold__trigger" '," ",">\n      ","\n    </a>\n  "],['\n    <a href="','" class="Unfold__trigger" '," ",">\n      ","\n    </a>\n  "]),r=u(n(77)),a=u(n(131)),s=u(n(355)),l=u(n(293));function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function d(e){return e?(0,a.default)({mix:r.default.class(e.mix,"_touched","Unfold__item",{active:e.active,name:e.name,disabled:e.disabled}),url:e.url,tag:e.tag,attrs:e.attrs,inner:[e.icon?(0,s.default)({mix:"Unfold__itemIcon",icon:e.icon}):"",(0,a.default)({mix:"Unfold__itemText",inner:[e.text,e.count?(0,a.default)({mix:"Unfold__itemCountHidden",inner:e.count}):""]}),e.count?(0,l.default)({mix:"Unfold__itemCount",gray:!0,value:e.count}):""]}):""}t.default=function(e){var t=r.default.class(e.mix,"Unfold",{position:e.position,asIcon:!!e.icon||!!e.icon_html,open:e.opened}),n=function(e){var t=r.default.onMouseDown("Unfold._onTriggerMouseDown","this"),n=r.default.onClick("Unfold._onTriggerClick","event"),i=void 0;if(e.icon)i=(0,s.default)({icon:e.icon});else if(e.icon_html)i=e.icon_html;else{for(var l=e.items,u=l.length,c="",d="",f=0;f<u;f++){var p=l[f];if(p&&p.active){c=p.text,d=p.activeCount;break}}i=[(0,a.default)({mix:"Unfold__triggerText",tag:"h1",inner:[c,d?(0,a.default)({mix:"Unfold__triggerTextCount",inner:d}):""]}),(0,s.default)({mix:"Unfold__triggerIcon",icon:"reveal"})],i=r.default.list(i)}var _=e.opened?e.close_url:e.open_url;return r.default.html(o,_,n,t,i)}(e),l=r.default.list(e.items,d),u=e.name&&r.default.attr("data-name",e.name);return r.default.html(i,t,u,n,e.popup_class,l)}},function(e,t,n){"use strict";var i,o=n(72),r=(i=o)&&i.__esModule?i:{default:i};window.uVK={onReady:(0,r.default)(),onResize:(0,r.default)(),onOrientationChange:(0,r.default)()},onDOMReady(function(){if(window.isNewMail&&document.body){uVK.onReady();var e=document.body.getAttribute("onresize"),t=document.body.getAttribute("onorientationchange");document.body.setAttribute("onresize","uVK.onResize(); "+e),document.body.setAttribute("onorientationchange","uVK.onOrientationChange(); "+t)}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VoiceMessagePlayer=void 0;var i,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(159),a=n(144),s=n(172);var l=!1;t.VoiceMessagePlayer=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._reattach=!1,this._audioEl=null,this._playing=!1,this._timer=null,this._duration=0,this._detaching=!1;var n={onEnd:function(){t.detach()},onFail:function(){n.onEnd()},onCanPlay:function(){},onProgressUpdate:function(e){t._updateProgress(e)}};i=!1,r.PlayerHTML5.isSupported()?(r.PlayerHTML5.isSupported('audio/ogg;codecs="opus"')&&!r.PlayerHTML5.isSupported('audio/ogg;codecs="codec_check"')&&(i=!0),this._impl=new r.PlayerHTML5(n)):browser.flash&&window.renderFlash&&(this._impl=new a.PlayerFlash(n)),this.onPlayPause=function(e){return cancelEvent(e),t.toggle()},this.onDurationClick=function(e){t.durationType=!t.durationType,cancelEvent(e)},this._initEvents()}return e.prototype._updateProgress=function(e){this._durationEl&&(this.durationType?this._durationEl.innerHTML="-"+formatTime(Math.round(this._duration*(1-e))):this._durationEl.innerHTML=formatTime(Math.round(this._duration*e))),this._progressSlider&&this._progressSlider.setValue(e)},e.prototype._initInterface=function(){var e=this;this._el=ce("div",{innerHTML:'<div class="audio-msg-player audio-msg-track"><button class="audio-msg-track--btn"></button><div class="audio-msg-track--duration"></div><div class="audio-msg-track--wave-wrapper"><div class="audio-msg-track--slider"></div></div></div>'}).firstChild,window.getLang&&attr(this._el,"aria-label",getLang("mail_audio_message")),this._playBtn=geByClass1("audio-msg-track--btn",this._el),window.getLang&&attr(this._playBtn,"aria-label",getLang("global_audio_play")),this._durationEl=geByClass1("audio-msg-track--duration",this._el),this._durationEl.innerHTML=formatTime(this._duration),this._progressSlider=new s.Slider(geByClass1("audio-msg-track--slider",this._el),{value:0,size:0,hintClass:"audio_player_hint",formatHint:function(t){return formatTime(Math.round(t*e._duration))},onEndDragging:function(t){e._impl.seek(t)}});var t=geByClass1("audio-msg-track--wave-wrapper",this._audioEl).children[0];geByClass1("slider_slide",this._el).appendChild(t.cloneNode(!0)),geByClass1("slider_amount",this._el).appendChild(t.cloneNode(!0)),addEvent(this._playBtn,"click",this.onPlayPause),addEvent(this._durationEl,"click",this.onDurationClick),this._audioEl.parentNode.appendChild(this._el)},e.prototype._destroyInterface=function(){hide(this._el),this._audioEl.parentNode.removeChild(this._el),removeEvent(this._playBtn,"click",this.onPlayPause),this._progressSlider&&(this._progressSlider.destroy(),this._progressSlider=null),this._playBtn=null,this._durationEl=null,this._el=null},e.prototype.attachTo=function(e){var t=this;if(this._audioEl!=e){null!=this._audioEl&&(this._reattach=!0),this.detach(),this._audioEl=e,addClass(this._audioEl,"audio-msg-track_player-attached"),this._duration=attr(e,"data-duration"),this._initInterface();var n=this._audioEl.id.split("_");if(n&&n.length>1&&(this._owner_id=n[1]),this._reattach=!1,!this._impl.loaded)return new Promise(function(n,o){t._impl.onReady(function(){t._impl.setUrl(attr(e,i?"data-ogg":"data-mp3"),{duration:t._duration,callback:n})})});this._impl.setUrl(attr(e,i?"data-ogg":"data-mp3"),{duration:this._duration})}return!0},e.prototype.detach=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._audioEl&&this._el&&!this._detaching){if(e&&this.isAttached())return;this._detaching=!0,this.stop(),this._destroyInterface(),removeClass(this._audioEl,"audio-msg-track_player-attached"),this._audioEl=null}this._detaching=!1},e.prototype.play=function(){this._audioEl&&(this._reattach||e.pauseGlobalMedia(),addClass(this._el,"audio-msg-track_playing"),window.getLang&&attr(this._playBtn,"aria-label",getLang("global_audio_pause")),this._playing=!0,this._createTimer(),this._owner_id&&statlogsValueEvent("audio_message_play",this._owner_id),this._impl.play())},e.prototype.pause=function(){this._audioEl&&(!this._reattach&&this._playing&&e.resumeGlobalMedia(),window.getLang&&attr(this._playBtn,"aria-label",getLang("global_audio_play")),removeClass(this._el,"audio-msg-track_playing"),this._playing=!1,this._impl.pause(),this._killTimer())},e.prototype.stop=function(){this.pause(),this._impl.stop()},e.prototype.toggle=function(){this._playing?this.pause():this.play()},e.prototype._createTimer=function(){var e=this;this._duration>0&&(this._killTimer(),this._timer=setInterval(function(){var t=e._impl.getCurrentProgress();e._updateProgress(t)},100))},e.prototype._killTimer=function(){this._timer&&(clearInterval(this._timer),this._timer=null)},e.prototype._initEvents=function(){var e=this;window.ap?ap.on(this,AudioPlayer.EVENT_PLAY,function(){delete ap.pausedByMsg,e.pause()}):window.audio&&audio.onPlay(function(){delete audio.pausedByMsg,e.pause()}),window.Notifier&&(Notifier.addRecvClbk("audio_start","audio_msg",function(){e.pause()}),Notifier.addRecvClbk("video_start","audio_msg",function(){e.pause()}))},e.prototype.isAttached=function(){if(this._audioEl){for(var e=this._audioEl;e.parentNode;)e=e.parentNode;return!!e.body}return!1},e.pauseGlobalMedia=function(){window.Notifier&&(l=!0,Notifier.lcSend("video_start")),window.ap&&ap.isPlaying()?(ap.pause(),ap.pausedByMsg=!0):window.audio&&audio.playing&&audio.playing()&&(audio.pause(),audio.pausedByMsg=!0)},e.resumeGlobalMedia=function(){window.Notifier&&l&&(l=!1,Notifier.lcSend("video_hide")),window.ap&&ap.pausedByMsg?(ap.play(),delete ap.pausedByMsg):window.audio&&audio.playing&&audio.pausedByMsg&&(audio.play(),delete audio.pausedByMsg)},o(e,[{key:"type",get:function(){return this._impl.type}},{key:"durationType",get:function(){return window.AudioPlayer?!!ls.get(AudioPlayer.LS_PREFIX+AudioPlayer.LS_DURATION_TYPE):"1"==lsGet("audio_time_left")},set:function(e){window.AudioPlayer?ls.set(AudioPlayer.LS_PREFIX+AudioPlayer.LS_DURATION_TYPE,!!e):lsSet("audio_time_left",e?"1":"0")}}]),e}()},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(260),r=(i=o)&&i.__esModule?i:{default:i};n(29),t.default=r.default,window.TextInput=r.default},function(e,t,n){"use strict";Array.prototype.findIndex||(Array.prototype.findIndex=function(e){if(null==this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,n=Object(this),i=n.length>>>0,o=arguments[1],r=0;r<i;r++)if(t=n[r],e.call(o,t,r,n))return r;return-1})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={html:a,wrap:function(e){return e?{__raw__:e}:null},handle:function(){var e=h(arguments[0]),t=Array.prototype.slice.call(arguments,1),n=e[0];if(!n)return;p(n)||console.warn('Invalid handler "'+n+'"');var i=function(e,t){for(var n=t.split("."),i=n.length,o=e,r=0;r<i;r++)try{o=o[n[r]]}catch(e){return}return o}(window,n);if(o=i,"[object Function]"!==Object.prototype.toString.call(o))return void console.warn("`"+n+"` is not a function");var o;i.apply(null,e.slice(1).concat(t))},elem:function(e){return e?ceFromString(a(e)):""},class:l};var i=["tag","inner","attrs","innerHTML","outerHTML"],o=["area","base","br","col","command","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"],r=["abort","auxclick","beforecopy","beforecut","beforepaste","blur","cancel","canplay","canplaythrough","change","click","close","contextmenu","copy","cuechange","cut","dblclick","drag","dragend","dragenter","dragleave","dragover","dragstart","drop","durationchange","emptied","ended","error","focus","gotpointercapture","input","invalid","keydown","keypress","keyup","load","loadeddata","loadedmetadata","loadstart","lostpointercapture","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup","mousewheel","paste","pause","play","playing","pointercancel","pointerdown","pointerenter","pointerleave","pointermove","pointerout","pointerover","pointerup","progress","ratechange","reset","resize","scroll","search","seeked","seeking","select","selectstart","stalled","submit","suspend","timeupdate","toggle","touchcancel","touchend","touchmove","touchstart","volumechange","waiting","wheel"].map(function(e){return"on"+e});function a(e){if(p(e))return e?{__raw__:e}:null;if(_(e))return e.map(a).join("");if(!A(e))throw"Invalid input, object is expected";if("outerHTML"in e){var t=e.outerHTML;if(p(t))return t;if(f(t))return t.toString();if(t)throw"Invalid outerHTML";return""}var n=function(e){if("tag"in e){var t=e.tag;if(p(t)&&/^[\w-]+$/.test(t))return t;throw"Invalid tag name"}if(m(e.href))return"a";return"div"}(e),i=function(e){if("innerHTML"in e){var t=e.innerHTML;if(p(t))return t;if(f(t))return t.toString();if(t)throw"Invalid innerHTML";return""}if("inner"in e)return g(e.inner).map(s).join("");return""}(e),c=function(e){var t="";A(e.attrs)&&Object.assign(e,e.attrs);for(var n in e)if(!d(n)){var i=e[n];"class"===n?i=l(i):(s=n,r.includes(s.toLowerCase())&&(_(i)||p(a=i)&&/^[\w.]+$/.test(a))&&(i=u(i)));var o=v(n);!0===i?t+=" "+o:f(i)?t+=" "+o+'="'+i+'"':p(i)?t+=" "+o+'="'+v(i)+'"':i&&(i=i.__raw__?i.__raw__:v(JSON.stringify(i),!0),t+=" "+o+'="'+i+'"')}var a;var s;p(e.attrs)&&(t+=" "+e.attrs);return t}(e);return function(e){return o.includes(e.toLowerCase())}(n)?"<"+n+c+" />":"<"+n+c+">"+i+"</"+n+">"}function s(e){return f(e)?e.toString():p(e)?v(e):A(e)?e.__raw__?e.__raw__:a(e):""}function l(e){return g(e).filter(m).join(" ").trim().replace(/\s+/g," ")}function u(e){if(!(e=h(e)).length)return null;var t=e[0];if(!p(t))throw"Invalid handler";return t+"("+e.slice(1).map(c).join(", ")+")"}function c(e){return f(e)||"this"===e||"event"===e?e:JSON.stringify(e)}function d(e){return i.includes(e)}function f(e){return"number"==typeof e&&!isNaN(e)}function p(e){return"string"==typeof e}function _(e){return Array.isArray(e)}function A(e){return"[object Object]"===Object.prototype.toString.call(e)}function m(e){return p(e)&&e}function h(e){return _(e)?e:[e]}function v(e,t){return t?e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39").replace(/</g,"&lt;").replace(/>/g,"&gt;"):(e=e.replace(/&(?!(#\d{0,4};|quot;|lt;|gt;|amp;))/g,"&amp;",e)).replace(/"/g,"&quot;").replace(/'/g,"&#39").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function g(e){return _(e)?function e(t){var n=[];t.forEach(function(t){_(t)?n=n.concat(e(t)):n.push(t)});return n}(e):[e]}},,function(e,t,n){"use strict";var i,o=n(347),r=(i=o)&&i.__esModule?i:{default:i};window.Podcast={toggleFave:function(e,t,n){var i="snippet__favorite_active",o=hasClass(e,i);ajax.post("fave.php",{act:"fave_podcast",add:!o,hash:n,audio_id:t}),o?removeClass(e,i):addClass(e,i)},onOpenClick:function(e,t){var n=$(".snippet__popup",e.closest(".snippet")),i="";cur&&cur.module?i=cur.module:nav&&"/feed"===nav.cur?i="feed":!nav||"/feed?section=podcasts"!==nav.cur&&"/feed/podcasts"!==nav.cur||(i="feed_podcasts"),statlogsValueEvent("mvk_podcasts_actions","mvk_open_popup",t,i),r.default.open(n,!0)}}},function(e,t,n){"use strict";var i=window,o=i.hide,r=i.lockButton,a=i.gpeByClass,s=window.ajax;window.FeedNotifications={webActionsAcceptHandlers:{reveal_bdya:function(e,t,n,i,o){var r=a("_block",e);return s.post("profileEdit.php",{act:"reveal_birthday",from:"feed_assistance",hash:o},{onDone:function(e){var t=window.Snackbar;t&&t.init&&t.init({text:e.msg}),remove(r)}}),!0}},webActionsDeclineHandlers:{},withoutNavActions:["enable_browser_notifications","reveal_bdya"],hide:function(e,t,n,i,l,u,c,d){var f={_ajax:1,act:"hide_internal_notification",reason:i,id:t,hash:n},p={},_=a("_block",e),A=!0;if("decline"==i){var m=this.webActionsDeclineHandlers[u];A=this.runActionHandler(m,e,f,p,c,n),o(_)}else{var h=this.webActionsAcceptHandlers[u];A=this.runActionHandler(h,e,f,p,c,n),r(e),"add_custom_newsfeed"==u&&(setCookie("remixcustom_feed_added",c),f.action=u,f.action_section=c.section,f.action_hash=c.hash)}return p.onDone=function(){"compact"===d&&"accept"===i||cur.destroy.push(function(){return remove(_)}),~this.withoutNavActions.indexOf(u)||nav.go(e,l)}.bind(this),p.onFail=function(){unlockButton(e)},Promise.resolve(A).then(function(e){(e||isUndefined(e))&&s.post("/index.php",f,p)}),!1},runActionHandler:function(e,t,n,i,o,r){return!isFunction(e)||e(t,n,i,o,r)},addWebActionAcceptHandler:function(e,t){this.webActionsAcceptHandlers[e]=t},addWebActionDeclineHandler:function(e,t){this.webActionsDeclineHandlers[e]=t}}},function(e,t,n){"use strict";var i,o=n(7),r=n(72),a=(i=r)&&i.__esModule?i:{default:i},s=n(215);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=window,c=u.cancelEvent,d=u.removeEvent,f=u.srand,p=u.ce,_=u.addEvent,A=u.ssSet,m=u.lsGet,h=u.vkNow,v=u.onDOMReady,g=u.ssGet,y=u.se,w=u.lsSet,b=u.each,D=u.HTMLAudioElement,C=function(){var e;if(!D)return{init:function(){},playing:function(){},onInit:function(){},onSelect:function(){},pause:function(){}};var t=!1,n=!1,i=!1,r=!1,u=function e(n){(t||!1!==r)&&(t=!1,B&&!1===r||(i=!0,j.pause.call(k))),c(n),d(k,"play",e),d(document,s.isTouch?"touchstart":"click",S)},E=function(){!1!==r&&r()},S=function e(){n&&(n=!1,t=!0,j.play.call(k),d(document,s.isTouch?"touchstart":"click",e))},k=function(e){var n=window.Audio?new Audio:p("audio");n.autobuffer=!0,n.muted=!1,e&&(n.volume=e.volume,d(e,"play",H),d(e,"pause",V),d(e,"progress",$),d(e,"timeupdate",U),d(e,"ended",z),d(e,"play",u),d(e,"progress canplaythrough",E),d(document,s.isTouch?"touchstart":"click",S),e.muted=!0,e.pause(),e.src=null);return L=!1,F=!1,!1,t=!1,i=!1,r=!1,_(n,"play",H),_(n,"pause",V),_(n,"progress",$),_(n,"timeupdate",U),_(n,"ended",z),_(n,"play",u),_(n,"progress canplaythrough",E),_(document,s.isTouch?"touchstart":"click",S),n}(),M=f(),T=[],x=null,I={},P="",B=!1,F=!1,L=!1,O=null,N=!1,R=!1;delete D.prototype.play,delete D.prototype.pause,delete D.prototype.load,delete D.prototype.canPlayType;var j={play:D.prototype.play,pause:D.prototype.pause,load:D.prototype.load,canPlayType:D.prototype.canPlayType};function H(){B||(B=!0,C.onPlay(!0),A("audio_play","1"),clearTimeout(O),O=setTimeout(G,100))}function V(){i?i=!1:B&&(B=!1,C.onPause(!0),A("audio_play","0"),clearTimeout(O))}function $(){C.onProgress(!0)}function U(){i||(C.onProgress(!0),C.onPositionChanged(!0,C.position(),C.duration()),A("audio_pos",C.position()),!L&&k.duration-k.currentTime<.5&&(L=!0),F&&(F=!1,C.next()))}function z(){C.onEnded(!0),L?(L=!1,C.next()):F=!0}function q(){return T[x]||!1}function W(){return q().id||!1}function Y(e){e&&(k.src=(0,o.audioUnmaskSource)(e.src),j.load.call(k),C.onSelect(!0,e))}function G(){if(B){var e=m("audio_current_player");M!=e?C.pause():O=setTimeout(G,100)}}function X(){var e=W();A("audio_id",e),A("audio_pos",0),N&&(document.cookie=N+"="+e+"; expires="+new Date(h()+864e5).toUTCString()+"; path="+R)}return l(e={onInit:(0,a.default)(),init:function(e){if(!C.support)return!1;e.cookie&&(N=e.cookie,R=e.cookie_path||"/"),v(function(){e.playlist&&C.playlist(e.playlist,{q:e.playlist_q||""});var t=g("audio_id");if(t){var i=g("audio_pos"),o=g("audio_vol"),r=g("audio_play");C.select(t),"1"==r&&(null!==i&&C.position(i),null!==o&&C.volume(o),n=!0,C.play())}C.onInit()})},support:k.canPlayType&&j.canPlayType.call(k,"audio/mpeg")&&"no"!=j.canPlayType.call(k,"audio/mpeg")||!1,onPlay:y(W),onPause:y(W),onDeselect:y(W,function(){return C.duration()}),onSelect:y(),onProgress:y(W,function(){return C.loaded()},function(){return C.duration()}),onPositionChanged:y(W),onVolumeChanged:y(W,function(){return k.volume}),onEnded:y(W),onNotFoundError:y(),onEmptyPlaylistError:y(),playing:B,getCurrent:q,getCurrentId:W,operate:function(e){if(!C.support)return!1;!e||T[x]&&e==T[x].id?B?C.pause():C.play():C.play(e)}},"playing",function(){var e=window.AudioSubscribe;return e.badBrowser?e.touchTrack():B&&!e.audioSubscribe&&(e.isSleep||e.isVisibilityChange&&e.isHidden()?e.backgroundPlayCountdown.start():e.sleepModeStart()),B}),l(e,"select",function(e){if(!C.support)return!1;if(e)if(T.length){if(T[I[e]])return W()&&C.onDeselect(!0),x=I[e],Y(T[x]),X(),!0;C.onNotFoundError(!0,e)}else C.onEmptyPlaylistError(!0,e)}),l(e,"autoplay",function(e){C.play(e),k.paused&&C.pause()}),l(e,"play",function(e){if(!C.support)return!1;if(e){if(B&&C.pause(),!C.select(e))return;try{k.currentTime=.01}catch(e){}}if(!B){k.muted=!1;var t=j.play.call(k);void 0!==t&&t.catch(function(e){C.pause()}),B=!0,C.onPlay(!0),A("audio_play","1"),w("audio_current_player",M)}}),l(e,"pause",function(){if(!C.support)return!1;B&&(j.pause.call(k),B=!1,C.onPause(!0),A("audio_play","0"),AudioSubscribe.sleepModePause())}),l(e,"position",function(e,t){if(!C.support)return!1;if(void 0===e)return k.currentTime;t&&(e=C.duration()*e),e=Math.max(0,Math.min(e,C.duration()));var n=B;n&&(B=!1,j.pause.call(k));try{k.currentTime=e,C.onPositionChanged(!0,C.position(),C.duration()),A("audio_pos",e),n&&(B=!0,k.muted=!1,j.play.call(k))}catch(t){C.onPositionChanged(!0,e,C.duration()),r=function(){r=!1,C.position(e)},n&&(B=!0)}}),l(e,"volume",function(e){if(!C.support)return!1;if(void 0===e)return k.volume;try{k.volume=e||0}catch(e){}C.onVolumeChanged(!0),A("audio_vol",e||0)}),l(e,"loaded",function(){return k.buffered&&k.buffered.length&&k.buffered.end(k.buffered.length-1)||0}),l(e,"duration",function(){return k.duration||T[x]&&T[x].dur||0}),l(e,"next",function(){if(!C.support)return!1;B&&C.pause(),C.onDeselect(!0),++x>=T.length&&(x=0),Y(T[x]),X(),n=!0,(AudioSubscribe.hasTouch&&AudioSubscribe.badBrowser||AudioSubscribe.audioSubscribe||!AudioSubscribe.badBrowser)&&C.play(),AudioSubscribe.hasTouch||!AudioSubscribe.badBrowser||AudioSubscribe.audioSubscribe||AudioSubscribe.showPaymentAlert(),AudioSubscribe.badBrowser&&(AudioSubscribe.hasTouch=!1)}),l(e,"prev",function(){if(!C.support)return!1;B&&C.pause(),C.onDeselect(!0),--x<=0&&(x=T.length-1),Y(T[x]),X(),n=!0,C.play()}),l(e,"playlist",function(e,t){return!!C.support&&(void 0===e?T:(B&&C.pause(),q()&&C.onDeselect(!0),T=e,P=t&&t.q||"",x=null,I={},b(e,function(e,t){I[t.id]=e}),A("audio_query",n=P),void(N&&(document.cookie=N+"q="+encodeURIComponent(n)+"; expires="+new Date(h()+864e5).toUTCString()+"; path="+R))));var n}),l(e,"playlist_q",function(){return P}),l(e,"closeAttention",function(e,t){c(t),hide(gpeByClass("audioAttention",e))}),e}();window.audio=C},function(e,t,n){"use strict";var i,o=n(78),r=(i=o)&&i.__esModule?i:{default:i};var a=window,s=a.preventEvent,l=a.cancelEvent,u=a.lockButton,c=a.attr,d=a.ajax,f=1500,p=void 0,_=void 0,A=!1,m=null;function h(){m&&Btn.setLoading(m,!1),p&&(clearInterval(p),p=null),_&&(_.abort(),_=null)}r.default._onCancelClick(function(e,t){var n,i;t?(A=!1,s(e),l(e),u(t)):(A=!0,t=e.$btn,e=null,m=t,Btn.setLoading(t,!0)),n={cancelUrl:c(t,"href")},i=n.cancelUrl,p=setInterval(function(){_=d.post(i,{_ajax:1},{onDone:function(e){if(1===e){if(A){var t=arguments[1];return m.closest(".BtnStack").outerHTML='\n            <div class="notification__tempText">'+t+"</div>\n          ",void h()}var n=window.scrollTop();nav.go(location.pathname+location.search,null,{replace:!0}),cur.destroy.push(function(){window.scrollTop(n)}),h()}}})},f),window.cur.destroy.push(h)})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(326)),o=r(n(355));function r(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.tag,n=t.id===e.current_id?"control_radio_checked":"control_radio";return{href:t.href,class:"Bookmarks__tagsSelectItem",inner:[{class:"Bookmarks__tagsSelectItemTitle",inner:i.default.wrap(t.name)},i.default.wrap((0,o.default)({icon:n}))]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Oval_isHidden=void 0;i(n(77)),i(n(131));function i(e){return e&&e.__esModule?e:{default:e}}function o(e){return!e||e<=0}t.default=function(e){return Wd.html({class:[Bem.class("Oval",{type:e.gray?"minor":e.type,hidden:o(e.value)}),e.mix],inner:e.value})},t.Oval_isHidden=o},function(e,t,n){"use strict";var i,o=n(260),r=(i=o)&&i.__esModule?i:{default:i};Object.assign(r.default,{setPrefix:function(e,t){e.$(a.prefix).innerText=t},getValue:function(e){return e.$(a.native).value}});var a={native:".TextInput__native",prefix:".TextInput__prefix"}},function(e,t,n){"use strict";var i,o=n(215),r=(i=o)&&i.__esModule?i:{default:i},a=n(322),s=n(251);var l=window,u=l.removeClass,c=l.replaceClass,d=l.hasClass,f=l.checkEvent,p=l.ce,_=l.scrollTop,A=l.ge,m=l.geByClass1,h=l.append,v=l.addClass,g=l.addEvent,y=l.getCh,w=l.remove,b=l.removeEvent,D=l.getW,C=l.preventEvent,E=l.getCw,S=l.each,k=l.attr,M=l.val,T=l.onBodyResize,x=l.cancelEvent,I=l.scrollLeft,P=window.ajax,B=window.thover,F=window.nav,L={enabled:function(e){return window.al&&window.al.menu?(void 0!==e&&(e?c("_lms","_lm",window.bodyNode):(c("_lm","_lms",window.bodyNode),L.qsClose())),d("_lm",window.bodyNode)):(u("_lm",window.bodyNode),u("_lms",window.bodyNode),!1)},opened:function(){return d("lm_opened",window.bodyNode)},toggle:function(e,t){return!!f(e)||(!window.al||!window.al.menu||(L.opened()?L.close(e,t):L.open(e,t),!1))},open:function(e){var t=window.zlayer;if(f(e))return!0;if(!window.al||!window.al.menu)return!0;if(L.opened())return!1;if(t&&t.opened())return!1;if(!L.enabled())return F.go("/"),!1;L.clear_hover();var n=p("div",{id:"m_helper",onclick:L.close}),i=L._st||0,o=_(),r=A("l"),a=A("m"),s=A("vk_wrap"),l=(m("head_search",r),s.offsetWidth),d=a.offsetWidth,w=a.offsetHeight;if(!(l>=882)){h(n,"m"),L.fixed?(v("lm_opened",window.bodyNode),v("lm_anim_start",s),setTimeout(function(){c("lm_anim_start","lm_anim lm_anim_end",s)},5),setTimeout(function(){u("lm_anim_end",s),u("lm_anim",s)},200),g(a,"touchmove",L.blockScroll)):v("lm_opened",window.bodyNode);var b=r.offsetHeight;return l>=480?i=o<=b-y()?Math.min(o,b-y()):0:o<i?i=o:o-i>w-b&&w>b&&(i=o-w+b),L._st=Math.max(0,o-i),L._mw=d,L.fix_size(!1),L.fixed||_(i),P.post("/",{_ajax:1,act:"ping"}),window.lm_qsearch_counter?window.lm_qsearch_counter--:window.lm_qsearch_counter=-1,window.lm_qsearch_counter>0&&L.cancelSearch(),!1}},close:function(e){if(f(e))return!0;if(!window.al||!window.al.menu)return!0;if(!L.opened())return!1;w("m_helper"),L.clear_hover();var t=_(),n=L._st+t,i=A("l"),o=A("m"),r=A("vk_wrap"),a=(m("head_search",i),A("vk_wrap").offsetWidth>=480);return L.fixed?(v("lm_anim_end",r),setTimeout(function(){c("lm_anim_end","lm_anim lm_anim_start",r)},5),setTimeout(function(){u("lm_anim_start",r),u("lm_anim",r),u("lm_opened",window.bodyNode)},200),b(o,"touchmove",L.blockScroll)):u("lm_opened",window.bodyNode),L._st=a?0:t,L.fix_size(!0),L.fixed||_(n),window.lm_qsearch_focused&&L.cancelSearch(),!1},fix_size:function(e){var t=A("l"),n=A("m"),i=A("mhead"),o=i&&i.offsetHeight||0,r=L._st||0;t&&(e?n.style.minHeight="0":(r=r>o?r:0,n.style.minHeight=t.offsetHeight+r+"px"),!L.fixed||E()<320?e?n.style.marginTop="0":(t.style.minHeight=y()+"px",n.style.marginTop=-r+"px"):t.style.minHeight="0")},clear_hover:function(){B.clear()},refreshCounters:function(e){if(!e||!e.length)return!0;if(!window.al||!window.al.menu)return!0;if(e.length!=window.al.menu.length)return!1;var t=window.al,n=m("main_menu","l"),i=e[1];return Bell.setCount(i),window.store&&(store.notificationsCount=i),S(e,function(e,i){if(void 0===i)return!0;var o=t.menu[e],r=m("mmi_"+o[0],n),a=m("mm_item",r),s=m("mmi_wrap",r),l=m("mm_counter",s);k(a,"data-href",!1),i?(o[2]&&k(a,"href",o[2]),l?M(l,i):h(p("em",{className:"mm_counter",innerHTML:i}),s)):(o[1]&&k(a,"href",o[1]),w(l)),P.prepare_click(a)}),!0},refresh:function(e){e=e||{},P.refreshLinks(e.fv_link,e.app_link),void 0!==e.pp&&!1!==e.pp&&M("lm_prof_panel",e.pp),void 0!==e.tn&&!1!==e.tn&&M("lm_top_notify",e.tn),void 0!==e.bn&&!1!==e.bn&&M("lm_bottom_notify",e.bn),e.lm&&M("l",e.lm),e.topbar||w("vk_topbar")},initEvents:function(){T(function(){var e=A("vk_wrap").offsetWidth,t=d("_hfixed",window.bodyNode),n=L._st||0;e>=882&&n>44&&L.close(),L.fix_size(!L.opened(),t)})},init:function(){L.fixed=d("_hfixed",window.bodyNode),L.initEvents(),g(window,"orientationchange",function(){var e=A("vk_wrap").offsetWidth,t=L._st||0;e>=882&&t>44&&L.close()}),L.initTouch();var e=(0,a.$)(".leftMenu__content");e&&(0,s.setScrollView)(e,{topBanner:!!r.default.ipad&&void 0,overscrollY:!1,standalone:!0})},blockScroll:function(e){var t=A("vk_wrap");L.opened()&&D(t)<882&&C(e)},initTouch:function(){if(g(document,"keydown",function(e){var t=window.vk;e&&e.shiftKey&&(e.ctrlKey||e.metaKey)&&t.__debug&&77==e.keyCode&&(x(e),L.toggle())}),o.isTouch){var e=!1,t=!1,n=Math.min(604,E())/3;g(document,"touchstart",function(n){gpeByClass("_preventMenuOpen",n.target)||(m("mhb_home","mhead")||m("mailHat"))&&(I()>0||(e=t=i(n)))}),g(document,"touchmove touchend touchcancel",function(o){if(e){"touchmove"==o.type&&(t=i(o));var r,a,s,l,u=(r=e,s=(a=t).x-r.x,l=a.y-r.y,Math.sqrt(s*s+l*l)),c=function(e,t){var n=t.x-e.x,i=e.y-t.y;return Math.abs(180*Math.atan2(i,n)/Math.PI)}(e,t);("touchend"!=o.type&&"touchcancel"!=o.type||(e=!1,"touchcancel"!=o.type))&&(u<10||(L.opened()&&(c=180-c),c>30?e=!1:(C(o),u>n&&(e=!1,L.toggle()))))}})}function i(e){var t=e.touches,n=_();return{x:(t&&t[0]?t[0].pageX:e.pageX)||0,y:((t&&t[0]?t[0].pageY:e.pageY)||0)-n}}},qsOpened:!1,qsOpen:function(){L.qsOpened||(L.qs_st=_(),v("qs_opened","vk_wrap"),v("qs_opened",window.bodyNode),D("vk_wrap")<882&&_(0),L.qsOpened=!0)},qsClose:function(){L.qsOpened&&(u("qs_opened","vk_wrap"),u("qs_opened",window.bodyNode),D("vk_wrap")<882&&_(L.qs_st||0),L.qsOpened=!1)},closeSearch:function(){return!window.al||!window.al.menu||(window.lm_qsearch&&window.lm_qsearch.blur(),L.qsClose(),!1)},cancelSearch:function(){return!window.al||!window.al.menu||(window.lm_qsearch&&window.lm_qsearch.clear(),L.qsClose(),!1)},headerAction:function(e,t){return D("vk_wrap")>=882?F.go(e,t):L.toggle()}};window.menu=L},function(e,t,n){"use strict";window.requestAnimationFrame||(window.requestAnimationFrame=function(e){setTimeout(e)})},function(e,t,n){"use strict";function i(e,t){var n=t.$select,i=t.value;n.closest(o.email).classList.toggle(r.groupsVisible,e.includes(i)||e.includes(Number(i)))}window.SettingsEmail={},SettingsEmail._onFrequencyChange=i;var o={email:".settingsEmail"},r={groupsVisible:"settingsEmail_groupsVisible"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(91),r=(i=o)&&i.__esModule?i:{default:i};n(162),t.default=r.default,window.uMailWrite=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(69),r=(i=o)&&i.__esModule?i:{default:i};t.default=r.default,window.Avatar=r.default},function(e,t,n){"use strict";var i=window,o=i.Friends,r=i.domData,a=i.FeedAssistanceStats,s=i.getLang;window.FeedAssistanceImportContacts={importContacts:function(e,t,n){if(!window.XMLHttpRequest||n)return;var i=r(e,"service-id");return window.open(t),l[i]=e,!1}};var l={},u="feedAssistanceImportContacts__desc",c=!1;a.registerTrackingCls("feedAssistance_importContacts"),a.onStartViewElement(function(e){a.getElementType(e)===a.BLOCKS.BLOCK_TYPE_IMPORT_CONTACTS&&(c=!0)}),o.onImportSuccess(function(){var e=arguments[0],t=arguments[2],n=l[e];n&&(geByClass1(u,n).textContent=s("mobile_join_friends_found_count",t));c&&a.dispatchEvent({type:a.EVENTS.EVENT_FEED_ASSISTANCE,data:a.serializeEventData(a.EVENTS.EVENT_FEED_ASSISTANCE,n,"m_mp",a.EVENTS.SUB_EVENT_FILLED)})}),o.onImportFailed(function(e){var t=l[e];t&&(geByClass1(u,t).textContent=s("mobile_friends_import_error"))})},function(e,t,n){"use strict";var i=n(322),o=u(n(72)),r=(n(215),u(n(293))),a=u(n(112)),s=n(289),l=u(s);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){e.target.closest("a.convo__avatar")||(e.stopPropagation(),e.preventDefault(),l.default.onTap(t))}Object.assign(l.default,{onTap:(0,o.default)("url"),setOnline:function(e,t){(0,i.$$)(".convo_id_"+e+" .convo__online").forEach(function(e){e.outerHTML=(0,s.Convo__online)(t)})},setLastMsg:function(e,t,n){(0,i.$$)(".convo_last.convo_id_"+e).forEach(function(e){e.$(".convo__text").innerHTML=t,e.$(".convo__date").innerText=n})},setTyping:function(e,t){(0,i.$$)(".convo_last.convo_id_"+e).forEach(function(e){var n=e.$(".convo__typing"),i=t.typing;if(!0===i||Array.isArray(i)&&i.length){var o=n.$(".typing"),r=o&&q.parseClass("typing",o.className);o&&r.animation===t.animation?a.default.setTyping(o,t):(e.classList.add("convo_typing"),n.innerHTML=(0,a.default)(t))}else n.innerHTML="",e.classList.remove("convo_typing")})},setUnreadCount:function(e,t){(0,i.$$)(".convo_last.convo_id_"+e).forEach(function(e){var n=e.$(".Oval");e.classList.toggle("convo_unread",t>0),e.classList.toggle("convo_unreadOut",t<0),r.default.setValue(n,t)})},setImportant:function(e,t){(0,i.$$)(".convo_id_"+e).forEach(function(e){e.classList.toggle("convo_important",t)})}}),l.default._onClick=c},function(e,t,n){"use strict";var i=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{!i&&s.return&&s.return()}finally{if(o)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=d(n(326)),r=d(n(72)),a=d(n(303)),s=d(n(215)),l=n(285),u=d(n(344)),c=n(104);function d(e){return e&&e.__esModule?e:{default:e}}var f=window,p=f.append,_=f.ce,A=f.remove,m=f.intval,h=f.val,v=f.geByClass1,g=f.each,y=f.removeClass,w=f.addClass,b=f.page,D=f.audio,C=f.parseJSON,E=f.zlayer,S={init:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.params=extend({replace:!1,reply:!1,replyTo:!1,restore:!1,forceAuthorIndex:!0,isOpenNarrativeFromFeed:!1},n);var o=this._parseList(e).split("/"),r=i(o,3),a=r[0],s=r[1],l=r[2],u=a.split("_"),c=i(u,1)[0];n&&n.narrativeId&&(c=n.narrativeId.toString()),this.initRaw=e,this.storyOwner=m(c),this.storyRaw=a,this.storyExtra=l,this.storyList=s,this.needAudioRestore=D.playing(),this.Views={},this.popoutOpen=!1,this.slideTimer=null,this.createLayer(),this._initStore(),this.detectAutoplay().then(function(){t.isRestored?t._init():t._checkPreloadedList()?(t._initPreloadedList(),t._init()):t._requestList().then(function(e){var n=e.items,i=e.list;n&&(t.store.authors=n,t.store.listLoaded=!0,t.store.list=i,t.store.inited=!0,t._init())},function(){})})},_checkPreloadedList:function(){return!!(window.store&&window.store.storiesLists&&window.store.storiesLists[this.storyList])},_initPreloadedList:function(){var e=window.store.storiesLists[this.storyList];e&&(this.store.authors=e,this.store.listLoaded=!0,this.store.list=this.storyList,this.store.inited=!0)},pushPreloadedList:function(e){var t=C(e);window.store||(window.store={}),window.store.storiesLists||(window.store.storiesLists={}),extend(window.store.storiesLists,t),window.store.stories||(window.store.stories={}),Object.keys(t).forEach(function(e){window.store&&window.store.storiesLayers&&window.store.storiesLayers.includes(e)||delete window.store.stories[e]})},_createMetaStory:function(){var e=this;g(this.store.authors,function(t,n){var i=n.items[n.items.length-1];i.isNarrativeMetaStory||n.items.push({type:"photo",raw_id:i.raw_id,preview:i.preview,preview_url:i.preview_url,narrative:i.narrative,photo_url:i.photo_url,isNarrativeMetaStory:!0,isOpenNarrativeFromFeed:e.params.isOpenNarrativeFromFeed})})},_init:function(){var e=this;this.createAuthors(),this.storyList.match(/narrative-?\d+_\d+/)&&this._createMetaStory();var t=this.getFirstStoryIndex();this.setCurrentStory(t);var n=this.getCurrentStory();this.params.restore||this.setHistory(n.raw_id,{nav_init:!0,replace:this.params.replace}),this.onRender(),this.sliderEl=ge("StoriesSlider"),this.slider=(0,a.default)(this.sliderEl,{speed:300,startSlide:this.getCurrentAuthorIndex(),onSlideChange:function(t){t=e.slider&&m(e.slider.getCurrentPos());var n=e.getCurrentAuthorIndex();e.setAllAuthorStoriesReaded(n),clearTimeout(e.slideTimer),t!==n&&(e.setCurrentAuthor(t),e.slideTimer=setTimeout(function(){e.renderStory()},300))},onSetup:function(){w(e.layer,"Stories_inited"),e.renderStory()}}),1===this.store.authors.length&&(w(this.layer,"Stories_inited"),this.renderStory()),this.store.showViews&&this.showViews(n.raw_id),this._initViewerSource(),this._sendOpeningEvents()},_initStore:function(){window.store||(window.store={stories:{},storiesLayers:[]}),window.store.stories||(window.store.stories={}),window.store.storiesLayers||(window.store.storiesLayers=[]),window.store.stories[this.storyList]&&window.store.stories[this.storyList].inited?(this.store=window.store.stories[this.storyList],this.isRestored=!0):(this.store={authors:[],listLoaded:!1,readedStories:{},_requests:[],viewers:{},viewersState:{},replies:{},showMenu:!1,storyList:this.storyList,initRaw:this.initRaw,storyIndex:0,authorIndex:0,isReply:this.params.reply,replyTo:this.params.replyTo,inited:!1},window.store.stories[this.storyList]=this.store,this.isRestored=!1),this.params.restore||window.store.storiesLayers.push(this.store.storyList)},_initViewerSource:function(){var e=this._getSource();switch(e){case"reply":this.viewerSource="replies_list";break;case"feed":this.viewerSource=cur.module;break;default:this.viewerSource=e}},_sendOpeningEvents:function(){var e=this._getSource();if(e){var t=void 0;switch(e){case"narrative_story":t="narrative_open_stories";break;case"narrative_snippet":case"narrative_link":t="narrative_open";break;case"narrative_recommendations":t="narrative_other"}t&&this._sendNavigationStatEvents(t)}},_abortRequests:function(){isArray(this.store._requests)&&g(this.store._requests,function(e,t){t&&t.readyState<4&&t.abort()}),this.store._requests=[]},_saveRequest:function(e){this.store._requests.push(e)},getStore:function(){return this.store},setAllAuthorStoriesReaded:function(e){var t=this;this.store.authors[e].items.forEach(function(e){e.unread&&(t.store.readedStories[e.raw_id]=!0)})},createAuthors:function(){var e=this,t="";this.Authors=[],g(this.store.authors,function(n,i){var o=new l.StoryAuthor(n,i);e.Authors.push(o),t+=o.renderEmpty()}),h(v("Stories__authors",this.layer),t),this.authors=Array.from(geByClass("StoryAuthor",this.layer)),g(this.Authors,function(e,t){t.updateHeader()});var n=this.getCurrentAuthorIndex();this.isRestored&&!this.params.forceAuthorIndex||(n=this.getFirstAuthorIndex()),this.setCurrentAuthor(n)},getFirstStoryIndex:function(){var e=this,t=this.store.authors[this.getCurrentAuthorIndex()].items.findIndex(function(t){return t.raw_id===e.storyRaw});return-1!==t?t:this.getCurrentStoryIndex()},getFirstAuthorIndex:function(){var e=this,t=this.store.authors.findIndex(function(t){return t.author.index===e.storyOwner});return-1!==t?t:0},getCurrentAuthorIndex:function(){return this.store.authorIndex},getCurrentStoryIndex:function(){return this.store.authors[this.getCurrentAuthorIndex()].index},getCurrentStory:function(){return this.store.authors[this.getCurrentAuthorIndex()].items[this.getCurrentStoryIndex()]},setCurrentAuthor:function(e){this.store.authorPrevIndex=this.store.authorIndex,this.store.authorIndex=e,this.updateCurrentAuthor()},setCurrentStory:function(e){this.store.authors[this.getCurrentAuthorIndex()].index=e},drawSiblingPreview:function(){for(var e=this.getCurrentAuthorIndex(),t=-2;t<=2;t++){var n=e+t;this.authors[n]&&n!==e&&this.drawPreview(this.authors[n])}},drawPreview:function(e){setStyle(e,"background-image","url("+attr(e,"data-src")+")")},updateCurrentAuthor:function(){var e=this.authors[this.store.authorIndex];g(this.authors,function(e,t){y(t,"StoryAuthor_current")}),w(e,"StoryAuthor_current")},getSizes:function(){var e=window.innerHeight,t=window.innerWidth,n=void 0,i=void 0;return t<540?(n=t,i=e,E.open(),E.onResize=this.onResize.bind(this)):(n=Math.floor(Math.min(540,Math.max(320,.563*e))),i=Math.floor(1.78*n),w(document.body,"vk__story_open")),[n,i]},createLayer:function(){window.innerWidth<540?(E.open(),E.onResize=this.onResize.bind(this)):w(document.body,"vk__story_open");var e=this.getSizes(),t=i(e,2),n=t[0],r=t[1];this.storyW=n;var a=o.default.html({id:"StoriesView",class:"Stories__layer _preventMenuOpen",style:"max-width: "+n+"px; max-height: "+r+"px",inner:[{class:"Stories__loading",inner:{class:"Stories__loadingInner"}},{id:"StoriesSlider",class:"Stories__authors peppermint peppermint-inactive",ontouchmove:"Stories.onTouchMove(event);",inner:""},{class:"Stories__layerClose",inner:{class:"Story__icon Story__icon_close"},onclick:"return Stories.clickClose();"},{class:"Stories__popout"},{class:"Stories__flash",onclick:"Stories.hideFlashPopup()",inner:{class:"Stories__flashText"}},{class:"Stories__swipeText Stories__swipeText_top"}]});this.layer=p(_("div",{className:"Stories",innerHTML:a}),document.body),this.loader=v("Stories__loading",this.layer),this.popout=v("Stories__popout",this.layer),this.swipeTextTop=v("Stories__swipeText_top",this.layer)},onResize:function(){var e=ge("StoriesView"),t=this.getSizes(),n=i(t,2),o=n[0],r=n[1];attr(e,"style","max-width: "+o+"px; max-height: "+r+"px"),this.storyW=o,this.authors.forEach(function(e){setStyle(e,"width",o+"px")}),this.store&&this.store.authors.length>1&&this.slider&&this.slider.recalcWidth()},getWidth:function(){return this.storyW},renderStory:function(){var e=this.store.authorPrevIndex,t=this.getCurrentAuthorIndex(),n=this.authors[t],i=this.Authors[t];if(i.update(),!isNaN(e)&&e!==t){var o=this.Authors[e],r=this.authors[e];o.update();var a=o.renderEmpty(),s=ceFromString(a);replace(s,r)}var l=ceFromString(i.render());replace(l,n),this.authors=Array.from(geByClass("StoryAuthor",this.layer)),this.updateCurrentAuthor(),i.updateHeader(),this.onRender(),this.drawSiblingPreview()},getCurrentAuthor:function(){var e=this.getCurrentAuthorIndex();return this.Authors[e]},getAuthorElems:function(){return this.authors},prevStory:function(){var e=this;this.stopStory(),this.store.isStopped=!1,requestAnimationFrame(function(){var t=e.getCurrentStoryIndex(),n=e.getCurrentAuthorIndex();if(t-1<0)if(n-1<0)e.setCurrentStory(0),e.renderStory();else{e.slider.slideTo(n-1);var i=e.store.authors[n-1].items.length-1;e.setCurrentStory(i)}else e.setCurrentStory(t-1),e.renderStory()})},nextStory:function(){var e=this;this.stopStory(),this.store.isStopped=!1,requestAnimationFrame(function(){var t=e.store.authors,n=t[e.getCurrentAuthorIndex()],i=e.getCurrentStoryIndex(),o=e.getCurrentAuthorIndex(),r=n.items.length,a=t.length;r-1<=i?a-1<=o?requestAnimationFrame(function(){e.close()}):(e.slider.slideTo(o+1),e.setCurrentStory(0)):(e.setCurrentStory(i+1),e.renderStory())})},stopStory:function(){this.store.isStopped=!0,this.pauseStory()},pauseStory:function(e){var t=this.getCurrentAuthor();if(t){t.getCurrentStory();var n=t.getCountDown();e&&w(this.layer,"Stories_paused"),n&&n.pause()}},playStory:function(e){this.store.isStopped=!1;var t=this.getCurrentAuthor();if(t){t.getCurrentStory();var n=t.getCountDown();y(this.layer,"Stories_paused"),n&&n.start()}},pauseAudio:function(){var e=window.audio;e&&e.pause()},restoreAudio:function(){var e=window.audio;this.needAudioRestore&&e&&e.play()},showMenu:function(){this.store.showMenu=!0,this.stopStory(),w(this.layer,"Stories_menuOpened")},hideMenu:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.store.showMenu=!1,y(this.layer,"Stories_menuOpened"),e&&this.playStory()},showLoading:function(){var e=this;this.loader&&(clearTimeout(this.loaderTimer),this.loaderTimer=setTimeout(function(){show(e.loader)},100))},hideLoading:function(){this.loader&&(clearTimeout(this.loaderTimer),hide(this.loader))},onRepliesScroll:function(e,t){this.Views[t]&&(this.store.viewersState[t].repliesScrollLeft=e.target.scrollLeft)},showViews:function(e){var t=this;if(this.hideMenu(),this.store.showViews=!0,this.stopStory(),this.Views[e]){this.store.viewersState[e];var n=this.Views[e].render();this.popoutOpen=!0,h(this.popout,n);var i=v("Views__repliesBody",this.popout);i&&(i.scrollLeft=0)}else{var o=this.store.viewersState[e],r=this.store.viewers[e];if(o&&r)return void this.createViews(e);this.showLoading(),this._requestFeedback(e).then(function(){t.createViews(e),t.hideLoading()})}},createViews:function(e){var t=this.store.viewersState[e],n=new u.default(e),i=n.render();this.popoutOpen=!0,h(this.popout,i),this.Views[e]=n;var o=v("Views__repliesBody",this.popout);o&&(o.scrollLeft=t.repliesScrollLeft)},hideViews:function(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&this.playStory(),this.store.showViews=!1,this.popoutOpen=!1,h(this.popout,"")},loadViews:function(e){var t=this,n=this.store.viewersState[e],i=n.loading,o=n.nextFrom;!i&&o&&(n.loading=!0,this.showLoading(),this._requestFeedback(e,o).then(function(){var i=new u.default(e),o=i.render();t.popoutOpen=!0;var r=v("Views__body",t.layer).scrollTop;h(t.popout,o),v("Views__body",t.layer).scrollTop=r,t.Views[e]=i,t.hideLoading(),n.loading=!1}))},showComment:function(){var e=this.authors[this.store.authorIndex],t=v("Story__commentTextarea",e);this.store.showComment=!0,this.stopStory(),w(this.layer,"Stories_commentOpened"),requestAnimationFrame(function(){t&&t.focus()})},hideComment:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.store.showMenu=!1,y(this.layer,"Stories_commentOpened"),e&&this.playStory()},onInputComment:function(e){var t=this.authors[this.store.authorIndex],n=v("Story__commentSend",t),i=h(e);toggleClass("Story__commentSend_active",n,!!i)},sendComment:function(){var e=this.authors[this.store.authorIndex],t=v("Story__commentTextarea",e),n=v("Story__commentSend",e),i=h(t);if(hasClass("Story__commentSend_active",n)){h(t,"");var o=this.getCurrentAuthorIndex(),r=this.getCurrentStory(),a=r.raw_id,s=r.narrative,l=this.store.authors[o],u=l.send_hash,c=l.author.id,d=void 0;d=s?"narrative"+s.raw_id:"story"+a,this._sendMessage(u,d,i,c),this.hideComment()}},showFlashPopup:function(e){var t=this;this.stopStory();var n=v("Stories__flash",this.layer);h(v("Stories__flashText",n),e),show(n),setTimeout(function(){w(n,"Stories__flash_show")}),clearTimeout(this.flashTimer),clearTimeout(this.flashHideTimer),this.flashTimer=setTimeout(function(){y(n,"Stories__flash_show"),t.flashHideTimer=setTimeout(function(){t.hideFlashPopup()},1500)},1500)},hideFlashPopup:function(){this.playStory(),clearTimeout(this.flashTimer),clearTimeout(this.flashHideTimer);var e=v("Stories__flash",this.layer);hide(e)},removeCurrentStory:function(){var e=this,t=window.lang,n=this.getCurrentAuthor();if(n){var i=n.getCurrentStory(),o=i.narrative?t.mobile_stories_delete_narrative:t.mobile_stories_delete_story;if(confirm(o.replace(/(<([^>]+)>)/gi,"\n"))){var r=n.data.remove_hash,a=i.can_remove,s=i.raw_id;if(a){this.pauseStory();var l=function(){e._requestFeedBlock(),i.isNarrativeSlide&&e.close(),0===e.getCurrentStoryIndex()?(e.close({closeAll:!1}),location.reload()):(e.store.authors[e.getCurrentAuthorIndex()].items.splice(e.getCurrentStoryIndex(),1),e.hideMenu(),e.prevStory())};if(i.narrative){var u=i.narrative,c=u.owner_id+"_"+u.id;this._requestRemoveNarrative(c,r).then(function(){l()},function(){})}else this._requestRemoveStory(s,r).then(function(){l()},function(){})}}}},onScrollViews:function(e,t){var n=this.store.viewersState[t],i=n.loading,o=n.nextFrom;if(!i&&o){e.scrollHeight-e.offsetHeight-400<=e.scrollTop&&this.loadViews(t)}},unMute:function(e,t){var n=this.getCurrentAuthor().story.getVideo();cancelEvent(t),n&&n.muted&&(n.muted=!1,y(gpeByClass(l.VIDEO_MUTED_CLASS,e),l.VIDEO_MUTED_CLASS))},onTouchStart:function(e){var t=this,n=this.getCurrentAuthor().story;if(n&&"video"===n.getType()){var i=n.getVideo();if(i&&i.paused)return void(this.preventedTap=!0)}this.pauseStory(!0),this.isTap=!0,"touchstart"===e.type?(this.tapStartX=e.changedTouches[0].clientX,this.tapStartY=e.changedTouches[0].clientY):(this.tapStartX=e.clientX,this.tapStartY=e.clientY),clearTimeout(this.isTapTimer),this.isYmove=null,y(this.layer,"Stories_touchMove"),this.isTapTimer=setTimeout(function(){t.isTap=!1},200)},onTouchMove:function(e){var t=0,n=0;"touchmove"===e.type&&(t=this.tapStartX-e.changedTouches[0].clientX,n=this.tapStartY-e.changedTouches[0].clientY),null===this.isYmove&&(this.isYmove=Math.abs(t)<Math.abs(n),this.isYmove&&w(this.layer,"Stories_touchMove")),this.isYmove?this.onVerticalSwipe(-n/1.5):this.onVerticalSwipe(0)},onTouchEnd:function(e){clearTimeout(this.isTapTimer);var t=void 0,n=void 0;if("touchend"===e.type?(t=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY):(t=e.clientX,n=e.clientY),(Math.abs(this.tapStartX-t)>20||Math.abs(this.tapStartY-n)>20)&&(this.isTap=!1),y(this.layer,"Stories_touchMove"),setStyle(this.sliderEl,"opacity",1),setStyle.transform(this.sliderEl,1,[0,0]),setStyle.transform(v("Story__moreLink"),1,[0,0]),this.needGoToLink){var i=this.getCurrentAuthor().story;if(this.needGoToLink=!1,i&&i.hasLink())return void this.openCustomButton(e)}this.needClose?this.close():(this.isTap&&this.nextStory(),this.playStory(!0))},openCustomButton:function(e){e.preventDefault(),e.stopPropagation();var t=this.getCurrentAuthor().story,n=t.getLinkUrl(),i=n.match(/\/narrative(-?\d+)_(\d+)/);if(i){var o={ownerId:i[1],narrativeId:i[2]},r=o.ownerId,a=o.narrativeId;if(!r||!a)return!1;this.openNarrative(r+"/narrative"+r+"_"+a,{source:"narrative_story",isOpenNarrativeFromFeed:!0})}else if(this.stopStory(),this.showLoading(),t.stats&&t.stats.url_view){var s=t.stats.url_view,l=s.event_type,u=s.rhash,c=t.raw_id;this._requestClickStat(c,l,u,function(){nav.go(n)})}else nav.go(n);return!1},onVerticalSwipe:function(e){var t=window.lang;if(this.needClose=!1,this.needGoToLink=!1,e){var n=e>0,i=this.sliderEl.offsetHeight,o=i/3.5,r=Math.abs(e)>o;if(n){var a=r?t.mobile_zphoto_release_to_close:t.mobile_zphoto_move_to_close,s=r?"":n?"zpv_close_move_down":"zpv_close_move_up",l=Math.max(1-.75*e/i,.6);h(this.swipeTextTop,'<div class="zpv_close_msg '+s+'">'+a+"</div>"),setStyle(this.sliderEl,"opacity",l),setStyle.transform(this.sliderEl,1,[0,e/1.5]),setStyle(this.swipeTextTop,"opacity",Math.abs(l-1-.6)),setStyle.transform(this.swipeTextTop,1,[0,e/1.5*.85]),this.needClose=r}else{var u=Math.min(1-.5*e/i,1.1);setStyle(this.sliderEl,"opacity",1),setStyle.transform(this.sliderEl,1,[0,0]),setStyle.transform(v("Story__moreLink"),u,[0,Math.max(e/(1.5*1.6),-90)]),this.needGoToLink=r}}else setStyle(this.sliderEl,"opacity",1),setStyle.transform(this.sliderEl,1,[0,0]),setStyle.transform(v("Story__moreLink"),1,[0,0]),this.needClose=!1,this.needGoToLink=!1},preventScroll:function(){return this.popoutOpen},_requestRemoveStory:function(e,t){return new Promise(function(n,i){ajax.post("stories.php",{_ajax:1,act:"remove_story",hash:t,story_raw:e},{onDone:function(){n()},onFail:function(){i()}})})},_requestRemoveNarrative:function(e,t){return new Promise(function(n,i){ajax.post("stories.php",{_ajax:1,act:"remove_narrative",hash:t,narrative_raw:e},{onDone:function(){n()},onFail:function(){i()}})})},_requestList:function(){var e=this;return new Promise(function(t,n){var i={storyOwner:e.storyOwner,list:e.storyList,storyRaw:e.storyRaw,extra:e.storyExtra};if(!e.storyRaw)return n();var o=ajax.post("stories.php",{_ajax:1,act:"get_list",list:i.list,story_raw:i.storyRaw,extra:i.extra},{onDone:function(e){if(i.items=e.list,e.recommendations){var n=i.list+"_recommendations";window.store.stories[n]=S._forceSetStore(i.storyRaw,n,e.recommendations)}t(i)},onFail:function(){n()}});e._saveRequest(o)})},_forceSetStore:function(e,t,n){return{authors:n,listLoaded:!0,list:t,readedStories:{},viewers:{},viewersState:{},replies:{},showMenu:!1,storyList:t,initRaw:e,storyIndex:0,authorIndex:0,isReply:!1,replyTo:!1,inited:!0}},_requestFeedback:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.store;return new Promise(function(o,r){var a=ajax.post("stories.php",{_ajax:1,act:"feedback",offset:n,story_raw:e},{onDone:function(t,n,r,a,s,l){var u;(a&&a.length&&(i.replies[e]=a),i.viewers[e])?(u=i.viewers[e]).push.apply(u,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t)):i.viewers[e]=t;i.viewersState[e]?extend(i.viewersState[e],{count:n,nextFrom:r}):i.viewersState[e]={count:n,nextFrom:r,repliesCountText:s,authorCountText:l,repliesScrollLeft:0},s&&(i.viewersState[e].repliesCountText=s),l&&(i.viewersState[e].authorCountText=l),o({viewers:t,count:n,nextFrom:r,repliesCountText:s,authorCountText:l})},onFail:function(){r()}});t._saveRequest(a)})},_requestReadStories:function(){var e=this.store,t=Object.keys(e.readedStories),n=this._getSource();if(t.length){var i=ajax.post("stories.php",{_ajax:1,act:"read_stories",hash:this.store.authors[0].read_hash,stories:t.join(","),source:n,navigation_stats:(0,c.serializeNavigationStats)(),loading_stats:(0,c.serializeLoadingStats)(),connection_type:(0,c.getConnectionType)()},{onDone:function(){e.readedStories={},"feed"===n&&S._requestFeedBlock()}});this._saveRequest(i)}},_getSource:function(){if(this.params&&this.params.source)return this.params.source;var e="";return this.store.list.includes("feed")?e="feed":this.store.list.includes("replies")&&(e="reply"),e},_sendNavigationStatEvents:function(e){var t=this.getCurrentStory(),n=t&&t.raw_id;if(n){var i=this._getSource();(0,c.saveNavigationStatEvent)({storyRawId:n,source:i,action:e})}},_sendViewerStartTime:function(e,t){var n=this.viewerSource;(0,c.saveViewerStartTime)({storyRawId:e,source:n,time:t})},_requestFeedBlock:function(){if(!window.store.storiesLayers.length)ajax.post("stories.php",{_ajax:1,act:"feed_block"},{onDone:function(e,t){var n=ge("StoriesFeedBlock");n&&replace(ceFromString(e),n),S.pushPreloadedList(t)}})},_requestClickStat:function(e,t,n,i){ajax.post("stories.php",{_ajax:1,act:"stat",source_story:e,event_type:t,rhash:n},{onDone:function(){i&&i()}})},_sendMessage:function(e,t,n,i){var o=ajax.post("mail.php",{_ajax:1,act:"send",entrypoint:"stories_comment",hash:e,media:t,message:n,to:i},{onDone:function(){var e=window.lang;S.showFlashPopup(e.mobile_stories_comment_success)}});this._saveRequest(o)},_requestFave:function(e,t,n,i){ajax.post("bookmarks.php",{_ajax:1,act:e,item_type:31,item_oid:t,item_id:n,hash:i})},_parseList:function(e){var t=(e=decodeURIComponent(e)).match(/^story(-?\d+)_(\d+)(\/([a-z0-9\_\-]+))?(\/([a-z0-9\_\=\;\-]+))?$/i);if(t){var n=i(t,7),o=n[1],r=n[2],a=n[4],s=n[6],l=o+"_"+r;return e.match(/from_feed\=1/)?a="feed":e.match(/profile\=1/)?a="profile":a||(a=l),l+"/"+a+"/"+s}return e},setHistory:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{nav_init:!1,replace:!0},n=window.nav,i=this.getHistoryURL(e),o=n.getQuery();i.match(/narrative-\d+_\d+/)&&(i="narrative"+this.getCurrentStory().narrative.raw_id),o.z=i;var r=n.path+obj2qs(o)+n.hash,a={push_only:!0,replace:t.replace,nav_init:!t.no_open,nav_incr:!0};n.go(r,null,a)},getFrom:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=window.nav,n=t.getQuery(),i="z="+n.z,o="";return"/write"===t.path.substr(0,6)?o="write"+t.path.substr(0,6)+"?"+i:"/mail"===t.path?o="write"+n.peer+"?"+i:"/feed"===t.path?o=n.section&&"notifications"===n.section?"feed?section=notifications&"+i:"feed?"+i:n.from&&(o=n.from),e?encodeURIComponent(o):o},getHistoryURL:function(e){var t=this.store.list;return"story"+e+(t?"/"+t:"")},getParams:function(){return this.params||{}},reportCurrentStory:function(e){var t=window.nav,n=this.getHistoryURL(e),i=(t.getQuery(),"/reports?act=add&object="+n+"&refrom="+this.getFrom());t.go(i)},toggleBookmark:function(e){var t=this.getCurrentAuthor();if(t){var n=t.getCurrentStory(),i=n.bookmark_add_hash,o=window.store,r=(n.narrative?n.narrative:n).is_bookmarked;Object.keys(o.stories).forEach(function(e){var t=o.stories[e];if(t.authors){var a=!1;t.authors.forEach(function(e){a||(a=e.items.find(function(e){return!!e.narrative&&(e.narrative.bookmark_hash===i&&e.raw_id===n.raw_id)}))}),a&&(a.narrative?a.narrative.is_bookmarked=!r:a.is_bookmarked=!r)}}),h(e,r?lang.mobile_stories_menu_bookmark_title:lang.mobile_stories_menu_bookmarked_title);var a=r?"bookmark_remove":"bookmark_add",s=n.narrative,l=s.owner_id,u=s.id;this._requestFave(a,l,u,i)}},share:function(e,t){this.stopStory(),this.showLoading();var n=this.getFrom(),i="/like?act=publish&object="+(t?"narrative":"story")+e+"&from="+n;nav.go(i)},openReplies:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.playStory(),this.destroy();var n=e.split("/"),o=i(n,2)[1];if(o)if(~window.store.storiesLayers.indexOf(o)){var r=this.store.list,a=o;this.restore(r,a)}else this.init(e,{reply:!0,replyTo:t});else this.close()},openNarrative:function(e,t){this.playStory(),this.destroy();var n=e.split("/"),o=i(n,2)[1];if(o)if(~window.store.storiesLayers.indexOf(o)){var r=this.store.list,a=o;this.restore(r,a)}else this.init(e,t);else this.close()},clickClose:function(){var e=this;requestAnimationFrame(function(){e.close()})},close:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(extend({isPopState:!1,storyRaw:!1,closeAll:!1},e),this.store&&this._getSource().indexOf("narrative")>-1&&this._sendNavigationStatEvents("narrative_close"),!e.isPopState){var t=window.nav,n=t.getQuery();if(window.store.storiesLayers[window.store.storiesLayers.length-1-1]){var o=window.store.storiesLayers[window.store.storiesLayers.length-1-1],r=window.store.stories[o],a=r.authorIndex,s=r.authors[a].index,l=r.authors[a].items[s];n.z=this.getHistoryURL(l.raw_id)}else delete n.z;var u=t.path+obj2qs(n)+t.hash;t.go(u,null,{push_only:!0})}if(this.destroy(),e.isPopState&&e.storyRaw){var c=this._parseList(e.storyRaw).split("/"),d=i(c,2)[1];this.store?this.restore(this.store.storyList,d,e.storyRaw,e):this.init(e.storyRaw,{replace:!0})}else this.store&&this.store.storyList&&this.restore(this.store.storyList,!1,!1,e)},hideAllViews:function(){var e=window.store;e&&(e.storiesLayers=[],e.stories&&Object.keys(e.stories).forEach(function(t){e.stories[t].showViews=!1,e.stories[t].isStopped=!1}))},restore:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(window.store.storiesLayers){var r=window.store.storiesLayers.indexOf(e);window.store.storiesLayers.splice(r,1)}if(window.store.storiesLayers.length||t||n){t=t||window.store.storiesLayers[window.store.storiesLayers.length-1];var a=window.store.stories[e],s=window.store.stories[t];if(a&&s){var l=Object.keys(a.readedStories);g(l,function(e,t){var n=t.split("_"),o=i(n,2),r=o[0],l=(o[1],s.replies[a.replyTo]);if(l){var u=l.filter(function(e){return e.owner_id==r}),c=i(u,1)[0];c&&(c.has_new=!1)}}),this.init(s.initRaw,{restore:!0,forceAuthorIndex:!1,reply:!0})}else n&&this.init(n,{restore:!0,forceAuthorIndex:!1,reply:!0})}else this.hideAllViews();o.closeAll&&window.store.storiesLayers.length&&this.close(o)},clearStore:function(){this.store=this._initStore()},destroy:function(){var e=this;if(this.restoreAudio(),this.store){this.slider=null,this.hideMenu(!1),this._abortRequests(),this._requestReadStories(),y(this.layer,"Stories_inited");var t=this.getCurrentAuthorIndex();if(void 0!==t&&this.Authors)this.Authors[t].destroy();this.onRender.off(),A(this.layer),Object.keys(this).forEach(function(t){"store"!==t&&"supportAutoplay"!==t&&"function"!=typeof e[t]&&(e[t]=null,delete e[t])}),E.close(),y(document.body,"vk__story_open")}},isAutoplaySupport:function(){return this.supportAutoplay},isGoodBrowser:function(){return s.default.ios&&s.default.safari_mobile&&parseInt(s.default.version,10)>=10},detectAutoplay:function(){var e=this;return new Promise(function(t){if(e.supportAutoplay)t();else{if(e.isGoodBrowser())return e.supportAutoplay=!0,void t();e.supportAutoplay=!1;var n=_("video"),i=_("source");i.src="data:video/mp4;base64,AAAAFGZ0eXBNU05WAAACAE1TTlYAAAOUbW9vdgAAAGxtdmhkAAAAAM9ghv7PYIb+AAACWAAACu8AAQAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAnh0cmFrAAAAXHRraGQAAAAHz2CG/s9ghv4AAAABAAAAAAAACu8AAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAFAAAAA4AAAAAAHgbWRpYQAAACBtZGhkAAAAAM9ghv7PYIb+AAALuAAANq8AAAAAAAAAIWhkbHIAAAAAbWhscnZpZGVBVlMgAAAAAAABAB4AAAABl21pbmYAAAAUdm1oZAAAAAAAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAVdzdGJsAAAAp3N0c2QAAAAAAAAAAQAAAJdhdmMxAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAFAAOABIAAAASAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGP//AAAAEmNvbHJuY2xjAAEAAQABAAAAL2F2Y0MBTUAz/+EAGGdNQDOadCk/LgIgAAADACAAAAMA0eMGVAEABGjuPIAAAAAYc3R0cwAAAAAAAAABAAAADgAAA+gAAAAUc3RzcwAAAAAAAAABAAAAAQAAABxzdHNjAAAAAAAAAAEAAAABAAAADgAAAAEAAABMc3RzegAAAAAAAAAAAAAADgAAAE8AAAAOAAAADQAAAA0AAAANAAAADQAAAA0AAAANAAAADQAAAA0AAAANAAAADQAAAA4AAAAOAAAAFHN0Y28AAAAAAAAAAQAAA7AAAAA0dXVpZFVTTVQh0k/Ou4hpXPrJx0AAAAAcTVREVAABABIAAAAKVcQAAAAAAAEAAAAAAAAAqHV1aWRVU01UIdJPzruIaVz6ycdAAAAAkE1URFQABAAMAAAAC1XEAAACHAAeAAAABBXHAAEAQQBWAFMAIABNAGUAZABpAGEAAAAqAAAAASoOAAEAZABlAHQAZQBjAHQAXwBhAHUAdABvAHAAbABhAHkAAAAyAAAAA1XEAAEAMgAwADAANQBtAGUALwAwADcALwAwADYAMAA2ACAAMwA6ADUAOgAwAAABA21kYXQAAAAYZ01AM5p0KT8uAiAAAAMAIAAAAwDR4wZUAAAABGjuPIAAAAAnZYiAIAAR//eBLT+oL1eA2Nlb/edvwWZflzEVLlhlXtJvSAEGRA3ZAAAACkGaAQCyJ/8AFBAAAAAJQZoCATP/AOmBAAAACUGaAwGz/wDpgAAAAAlBmgQCM/8A6YEAAAAJQZoFArP/AOmBAAAACUGaBgMz/wDpgQAAAAlBmgcDs/8A6YEAAAAJQZoIBDP/AOmAAAAACUGaCQSz/wDpgAAAAAlBmgoFM/8A6YEAAAAJQZoLBbP/AOmAAAAACkGaDAYyJ/8AFBAAAAAKQZoNBrIv/4cMeQ==";var o=_("source");o.src="data:video/webm;base64,GkXfo49CgoR3ZWJtQoeBAUKFgQEYU4BnAQAAAAAAF60RTZt0vE27jFOrhBVJqWZTrIIQA027jFOrhBZUrmtTrIIQbE27jFOrhBFNm3RTrIIXmU27jFOrhBxTu2tTrIIWs+xPvwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFUmpZuQq17GDD0JATYCjbGliZWJtbCB2MC43LjcgKyBsaWJtYXRyb3NrYSB2MC44LjFXQY9BVlNNYXRyb3NrYUZpbGVEiYRFnEAARGGIBc2Lz1QNtgBzpJCy3XZ0KNuKNZS4+fDpFxzUFlSua9iu1teBAXPFhL4G+bmDgQG5gQGIgQFVqoEAnIEAbeeBASMxT4Q/gAAAVe6BAIaFVl9WUDiqgQEj44OEE95DVSK1nIN1bmTgkbCBULqBPJqBAFSwgVBUuoE87EQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB9DtnVB4eeBAKC4obaBAAAAkAMAnQEqUAA8AABHCIWFiIWEiAICAAamYnoOC6cfJa8f5Zvda4D+/7YOf//nNefQYACgnKGWgQFNANEBAAEQEAAYABhYL/QACIhgAPuC/rOgnKGWgQKbANEBAAEQEAAYABhYL/QACIhgAPuC/rKgnKGWgQPoANEBAAEQEAAYABhYL/QACIhgAPuC/rOgnKGWgQU1ANEBAAEQEAAYABhYL/QACIhgAPuC/rOgnKGWgQaDANEBAAEQEAAYABhYL/QACIhgAPuC/rKgnKGWgQfQANEBAAEQEAAYABhYL/QACIhgAPuC/rOgnKGWgQkdANEBAAEQEBRgAGFgv9AAIiGAAPuC/rOgnKGWgQprANEBAAEQEAAYABhYL/QACIhgAPuC/rKgnKGWgQu4ANEBAAEQEAAYABhYL/QACIhgAPuC/rOgnKGWgQ0FANEBAAEQEAAYABhYL/QACIhgAPuC/rOgnKGWgQ5TANEBAAEQEAAYABhYL/QACIhgAPuC/rKgnKGWgQ+gANEBAAEQEAAYABhYL/QACIhgAPuC/rOgnKGWgRDtANEBAAEQEAAYABhYL/QACIhgAPuC/rOgnKGWgRI7ANEBAAEQEAAYABhYL/QACIhgAPuC/rIcU7trQOC7jLOBALeH94EB8YIUzLuNs4IBTbeH94EB8YIUzLuNs4ICm7eH94EB8YIUzLuNs4ID6LeH94EB8YIUzLuNs4IFNbeH94EB8YIUzLuNs4IGg7eH94EB8YIUzLuNs4IH0LeH94EB8YIUzLuNs4IJHbeH94EB8YIUzLuNs4IKa7eH94EB8YIUzLuNs4ILuLeH94EB8YIUzLuNs4INBbeH94EB8YIUzLuNs4IOU7eH94EB8YIUzLuNs4IPoLeH94EB8YIUzLuNs4IQ7beH94EB8YIUzLuNs4ISO7eH94EB8YIUzBFNm3SPTbuMU6uEH0O2dVOsghTM",p(o,n),p(i,n),n.style.position="fixed",n.style.left="5000px",attr(n,"id","base64testvideo"),attr(n,"playsinline","playsinline"),attr(n,"webkit-playsinline","webkit-playsinline"),attr(n,"muted","muted"),attr(n,"autoplay","autoplay"),attr(n,"loop","loop"),p(n,document.body);var r=ge("base64testvideo");if(s.default.android&&s.default.chrome)return e.supportAutoplay=!0,A(n),t(),void clearTimeout(e.autoDetectTimeout);if(s.default.mobile&&s.default.ios&&s.default.ios<10)return e.supportAutoplay=!1,A(n),t(),void clearTimeout(e.autoDetectTimeout);if(!s.default.safari_mobile||s.default.safari_mobile&&parseInt(s.default.version,10)>=10){var a=n.play();void 0!==a&&a.then(function(){e.supportAutoplay=!0,A(n),t(),clearTimeout(e.autoDetectTimeout)}).catch(function(e){})}r.onplay=function(){e.supportAutoplay=!0,A(n),t(),clearTimeout(e.autoDetectTimeout)},e.autoDetectTimeout=setTimeout(function(){r.paused||(e.supportAutoplay=!0),A(n),t()},250)}})},narrativeReply:function(){this.setCurrentStory(0),this.renderStory(),this._sendNavigationStatEvents("narrative_replay")},narrativeGoToStories:function(){this.nextStory(),this._sendNavigationStatEvents("narrative_go_to_stories")},onRender:(0,r.default)()};b.onChange(function(){window.store.storiesLayers=[],window.store.stories={}}),window.Stories=S},function(e,t,n){"use strict";var i,o=n(322),r=n(19),a=(i=r)&&i.__esModule?i:{default:i};var s=need("Btn"),l=need("Control"),u=window.Join||(window.Join={});u._onCountryChange=f,u._onPhoneChange=p,u._onTermsAcceptChange=p;var c={eu:"Join_eu"},d={join:".Join",phone:".Join__phone",accept:".Join__accept",submit:".Join__submit"};function f(e){var t=e.$option,n=(0,o.$)(d.join),i="1"===t.getAttribute("data-eu");n.classList.toggle(c.eu,i);var r=(0,o.$)(d.phone),s=t.value;a.default.setPrefix(r,s),cur.calledPhoneExcludeCountries&&val((0,o.$)(".join_desc"),getLang(-1==indexOf(cur.calledPhoneExcludeCountries,t.getAttribute("data-id"))?"mobile_join_about_phone_with_call":"mobile_join_about_phone")),(0,o.$$)(d.accept).forEach(function(e){return l.setChecked(e,!1)}),p()}function p(){var e=Array.prototype.slice.call((0,o.$$)(d.accept)),t=(0,o.$)(d.phone),n=(0,o.$)(d.submit);if(n){var i=e.some(l.isChecked)&&a.default.getValue(t).trim().length>0;s.setDisabled(n,!i)}else(n=(0,o.$)('.button[type="submit"]')).disabled=!l.isChecked(e[0])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(77)),o=r(n(355));function r(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=window.lang,n=e.query;return Wd.html({class:[Bem.class("mailFilter",{hasQuery:!!n}),e.mix],inner:[Wd.wrap((0,o.default)({icon:"search"})),{class:"mailFilter__input",tag:"input",placeholder:t.mobile_search,value:n,oninput:["MailFilter._onInput","this"],attrs:i.default.onFocus("MailFilter._onFocus")},{class:"mailFilter__right",inner:[Wd.wrap((0,o.default)({mix:"mailFilter__create",icon:"plus",url:e.createUrl})),Wd.wrap((0,o.default)({mix:"mailFilter__clear",icon:"close12",attrs:i.default.onMouseDown("MailFilter._onClearMouseDown","this")}))]}]})}},function(e,t,n){"use strict";var i,o=n(68),r=(i=o)&&i.__esModule?i:{default:i},a=n(1);var s=window,l=s.nav,u=s.ajax,c=s.geByClass1,d=s.addClass,f=s.val,p="pageMoneyTransfer",_="pageMoneyTransfer_error",A="pageMoneyTransfer__errorText",m="pageMoneyTransfer__iframe",h=2e3,v=void 0,g=void 0,y=void 0;r.default.onIframeReady(function(e){b(),g={checkUrl:e.check_transfer_url,onSuccessUrl:e.on_success_url},D(),window.cur.destroy.push(C)}),r.default.onPostMessage(function(e,t){if("paySuccess"===e)d("pageMoneyTransfer_success",c(p));else if("payError"===e)C(),d(_,c(p)),f(c(A),t.descr);else if("session_fail"===e)C(),d(_,c(p)),d("pageMoneyTransfer_errorCookie",c(p));else if("putPixel"===e&&"page_load"===t.alias){var n=null;(0,a.isVkWebView)()&&((0,a.isIosWebView)()?n="iphone":isAndroidWebView()&&(n="android")),n||(n=""),(0,a.statlogsValueEvent)("money_transfers",0,"iframe_loaded",n)}});var w=0;function b(){var e=c(m);if(e){var t=e.contentWindow.document;t.open("text/html","replace"),t.write(attr(e,"data-html")),t.close()}else setTimeout(b,2e3)}function D(){var e=g,t=e.checkUrl,n=e.onSuccessUrl;v=setInterval(function(){y=u.post(t,{},{onDone:function(e,t,i){if(1===e||3===e){if(C(),i)return void l.go(i,null,{replace:!0});"/"===n[0]?l.go(n,null,{replace:!0}):location.href=n}else 2===e&&(C(),d(_,c(p)),f(c(A),t))}})},h)}function C(){v&&(clearInterval(v),v=null),y&&(y.abort(),y=null)}r.default.onAcceptCookieClick(function(){var e=window.open("https://top-fwz1.mail.ru/counter2?id=1;","","width=300; height=300");setTimeout(function(){e.close();var t=c(m),n=clone(t);removeClass(_,c(p)),replace(n,t);var i=n.contentWindow.document;i.open("text/html","replace"),i.write(attr(t,"data-html")),i.close(),D()},400+w),w<750&&(w+=150)})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.registration=null,this._handlers=[]}return e.isSupported=function(){try{return!(!window.fetch||!navigator.serviceWorker)}catch(e){return!1}},e.prototype.register=function(){return e.isSupported()?navigator.serviceWorker.register("/js/cmodules/sw/sw_mobile.js",{scope:"/",updateViaCache:"none"}).then(this._onactive.bind(this)).then(function(e){return this.registration||(this.registration=e,this._addEventListener(navigator.serviceWorker,"message",this._onmessage.bind(this),!1)),e}.bind(this)):Promise.reject("SW: serviceWorker is unavailable")},e.prototype.getRegistration=function(){return e.isSupported()?navigator.serviceWorker.ready.then(this._onactive.bind(this)).then(function(e){return this.registration||(this.registration=e,this._addEventListener(navigator.serviceWorker,"message",this._onmessage.bind(this),!1)),e}.bind(this)):Promise.reject("SW: serviceWorker is unavailable")},e.prototype.unregister=function(){this.registration&&this.registration.unregister(),this._handlers.forEach(function(e){return e[0].removeEventListener(e[1],e[2])}),this._handlers=[]},e.prototype.update=function(){this.registration&&this.registration.update()},e.prototype._addEventListener=function(e,t,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=!1;this._handlers.forEach(function(i){i[0]===e&&i[1]===t&&i[2]===n&&(o=!0)}),o&&!i||(this._handlers.push([e,t,n]),e.addEventListener(t,n))},e.prototype._onactive=function(e){return e.active?Promise.resolve(e):new Promise(function(t){this._addEventListener(e.installing,"statechange",function(n){"activated"===n.currentTarget.state&&t(e)})}.bind(this))},e.prototype.action_isIMLongPollingEnabled=function(){return window.im&&im.isLongPollingEnabled()},e.prototype.action_devicePixelRatio=function(){return window.devicePixelRatio},e.prototype.action=function(e,t){var n=null;return n=Array.isArray(e)?e:[[e,t]],this._message({actions:n}).then(function(e){return e.answers?Promise.resolve(1===n.length?e.answers[0]:e.answers):Promise.reject(new Error("ServiceWorker answer is incorrect"))})},e.prototype._message=function(e){var t=this;return this.getRegistration().then(function(){return new Promise(function(t,n){var i=new MessageChannel;i.port1.onmessage=function(e){this._messageCheck(e)?t(e.data.data):n(new Error("ServiceWorker message is incorrect"))}.bind(this),this.registration.active.postMessage(this._messageWrap(e),[i.port2])}.bind(t))})},e.prototype._onmessage=function(e){if(this._messageCheck(e)){var t=e.data.data;if(t.actions&&Array.isArray(t.actions)){var n=[];t.actions.forEach(function(t){var i="action_"+t[0],o=t[1],r=this[i]?this[i](o,e):void 0;r instanceof Promise||(r=Promise.resolve(r)),n.push(r)}.bind(this)),Promise.all(n).then(function(t){var n={};t.forEach(function(e,t){void 0!==e&&(n[t]=e)}),Object.keys(n).length&&e.ports[0].postMessage(this._messageWrap({answers:n}))}.bind(this))}}},e.prototype._messageCheck=function(e){return(""===e.origin||e.origin.match(/^https:\/\/([a-zA-Z0-9\-\.]+\.)?vk\.com$/))&&e.data&&e.data.data&&"sw"===e.data.type},e.prototype._messageWrap=function(e){return{type:"sw",data:e}},e}();t.default=i,i.SW_NOT_AVAILABLE_ERROR="SW: serviceWorker is unavailable"},function(e,t,n){"use strict";var i,o=n(327),r=(i=o)&&i.__esModule?i:{default:i};Object.assign(r.default,{setCount:function(e){$$(s.bell).forEach(function(t){var n=t.$(s.counter);t.classList.toggle(a.empty,!e),n.innerText=e})}});var a={empty:"Bell_empty"},s={bell:".Bell",counter:".Bell__counter"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAppropriateImage=function(e,t,n){var i=[];if(o(e,function(e,t){n&&-1==["w","z","y","x","m","s"].indexOf(e)||i.push(t)}),!i.length)return[!1];i.sort(function(e,t){return e[1]-t[1]}),t*=window.devicePixelRatio>=2?2:1;var r=i[i.length-1];return o(i,function(e,n){if(n[1]>=t)return r=n,!1}),r},t.preloadImage=function(e,t){if(!0===r[e])return t&&t(),!0;if(isArray(r[e]))return r[e].push(t),!1;r[e]=[t];var n=new Image;return n.onload=function(){var t=r[e];r[e]=!0,o(t,function(e,t){t&&t()})},n.src=e,!1},t.mailruStatsPixel=function(e,t){if(isObject(t)&&!isEmpty(t)){var n="https://vk-callback.go.mail.ru/longread_pxl?action="+e;o(t,function(e,t){n+="&"+e+"="+t});var i=new Image;i.src=n}},t.getUrlParam=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))};var i=t.ParagraphType={Text:1,Header1:2,Header2:3,Header3:4,Code:5,NumericList:6,BulletList:7,Quote:8,Quote2:9,ObjectAudioPlaylist:100,ObjectPhoto:101,ObjectVideo:102,ObjectGIF:103,ObjectAudio:105};t.ResizableObjectTypes=[i.ObjectPhoto,i.ObjectGIF,i.ObjectVideo],t.ObjectResizeType={Normal:0,Float:1,Medium:2,Large:3};function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&!1===t.call(e[n],n,e[n]))break;return e}var r={}},function(e,t,n){"use strict";var i=n(322),o=need("scrollToEl");need("page").onChange(a);var r={anchorByHash:function(e){return".Anchor#"+e}};function a(e){if(e){var t=e.split("#")[1],n=t&&(0,i.$)(r.anchorByHash(t));n&&o(n)}}},function(e,t,n){"use strict";var i=window.Popup,o=window.Btn;window.AuthCheck={},AuthCheck._onDropConfirmationClick=s,AuthCheck._onResetSessionSubmit=l,AuthCheck._onCurBrowserDropClick=u;var r={popupByIndex:function(e){return".AuthCheck__popup_index_"+e},dropConfirmation:function(e){return'.AuthCheck__dropConfirmation[data-index="'+e+'"]'},dropConfirmationSubmit:".AuthCheck__dropConfirmationSubmit"},a={dropConfirmationSuccess:"AuthCheck__dropConfirmation_success"};function s(e){var t=$(r.popupByIndex(e));i.open(t)}function l(e,t){e.preventDefault();var n=e.target,s=$('iframe[name="'+e.target.target+'"]'),l=n.$(r.dropConfirmationSubmit);n.submit(),o.setLoading(l,!0),addEvent(s,"load",function(){$(r.dropConfirmation(t)).classList.toggle(a.dropConfirmationSuccess),i.close(),o.setLoading(l,!1)})}function u(e){var t=e.$btn;o.setLoading(t,!0),ajax.click(t,{onDone:function(){$(r.dropConfirmation("0")).classList.toggle(a.dropConfirmationSuccess),i.close(),o.setLoading(t,!1)}})}},function(e,t,n){"use strict";var i=n(322),o=window.page,r=window.photoview;o.onChange(c),r.onHide(c),r.onShow(d);var a="#5181b8",s="#000",l=(0,i.$)('meta[name="theme-color"]'),u=void 0;function c(){f(a)}function d(){f(s)}function f(e){u||(u=(0,i.$)("#theme_color_shim")),l.setAttribute("content",e),u.style.backgroundColor=e}},function(e,t,n){"use strict";var i,o=n(219),r=(i=o)&&i.__esModule?i:{default:i};Object.assign(r.default,{setTyping:function(e,t){var n="string"==typeof e?$(".typing_id_"+e):e,i=n.$(".typing__names");n.classList.toggle("typing_empty",(0,o.Typing_isEmpty)(t.typing)),i.innerText=(0,o.Typing_renderNames)(t)},getElem:function(e){return $(".typing_id_"+e)}})},function(e,t,n){"use strict";var i=n(322);window.Settings={_privacy:{}},Settings._privacy.onRadioChange=a;var o={pad:function(e){return'.Settings__privacyPad[data-privacy="'+e+'"]'},submit:".Settings__privacySubmitRow",form:".Settings__privacyForm",forbid:".Settings__privacySelectForbiddenLink"},r={padVisible:"Settings__privacyPad_visible",submitVisible:"Settings__privacySubmitRow_visible"};function a(e,t){if("none"===e)s("allowed",!1),s("forbidden",!1),l(!0);else if("allowed"===e)s("allowed",!0),s("forbidden",!1),l(!1);else if("forbidden"===e){s("allowed",!1),s("forbidden",!0),l(!0);var n=(0,i.$)(o.form),r=(0,i.$)(o.forbid),a=t.name,u=t.value,c=n.getAttribute("action")+"&"+a+"="+u+"&forbid";r.setAttribute("href",c)}}function s(e,t){(0,i.$)(o.pad(e)).classList.toggle(r.padVisible,t)}function l(e){(0,i.$)(o.submit).classList.toggle(r.submitVisible,e)}},,function(e,t,n){"use strict";var i;function o(e){return function(){i={};for(var e=document.cookie.split(";"),t=/^[\s]*([^\s]+?)$/i,n=0,o=e.length;n<o;n++){var r=e[n].split("=");2==r.length&&(i[r[0].match(t)[1]]=unescape(r[1].match(t)?r[1].match(t)[1]:""))}}(),i[e]}function r(e,t,n,i){var o=window.locDomain,r="";if(n){var a=new Date;a.setTime(a.getTime()+24*n*60*60*1e3),r="; expires="+a.toGMTString()}document.cookie=[e,"=",escape(t),r,"; path=/",o?"; domain=."+o:"",i&&"https:"==window.locProtocol?"; secure":""].join("")}function a(e){r(e,null,-1)}Object.defineProperty(t,"__esModule",{value:!0}),t.getCookie=o,t.setCookie=r,t.clearCookie=a,window.getCookie=o,window.setCookie=r,window.clearCookie=a},,function(e,t,n){"use strict";var i=n(1),o=window,r=o.page,a=o.onDOMReady,s=o.nav;window.SliderTabs={},SliderTabs._onClick=m,a(A),r.onChange(f),r.onRestore(p);var l={container:"SliderTabs",scroll:"Slider__scroll",active:"SliderTabs__tab_selected"},u={active:".SliderTabs__tab_selected",tab:".SliderTabs__tab",scroll:"."+l.scroll,container:"."+l.container},c="",d=0;function f(){var e=ge(c),t=$(u.container);if(e){var n=$(u.scroll,e),o=$(u.active,e);n.scrollLeft=d;var r=(0,i.getX)(o);if(d>r){n.scrollLeft=r-16}}else t?_():(c="",d=0)}function p(){setTimeout(function(){var e=ge(c);if(e){var t=Array.from($$(u.tab,e));if(t)t.some(function(e){return e.getAttribute("href")===s.cur})&&t.forEach(function(e){e.getAttribute("href")===s.cur?e.classList.add(l.active):e.classList.remove(l.active)})}})}function _(){var e=$$(u.container),t=Math.min((0,i.getCw)(),882);e.forEach(function(e){var n=$(u.scroll,e),o=$(u.active,e),r=o.offsetWidth,a=(0,i.getX)(o);a+r>t&&(n.scrollLeft=a-t+r)})}function A(){_()}function m(e,t){var n=(0,i.gpeByClass)(l.container,t),o=(0,i.gpeByClass)(l.scroll,t),r=$(u.active,n);return r&&r.classList.remove(l.active),t.classList.add(l.active),d=o.scrollLeft,c=attr(n,"id"),!0}},function(e,t,n){"use strict";Array.prototype.map||(Array.prototype.map=function(e){var t,n,i;if(null==this)throw new TypeError("this is null or not defined");var o=Object(this),r=o.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(arguments.length>1&&(t=arguments[1]),n=new Array(r),i=0;i<r;){var a,s;i in o&&(a=o[i],s=e.call(t,a,i,o),n[i]=s),i++}return n})},function(e,t,n){"use strict";var i=n(322),o=need("Btn");window.PrivacyPolicy={},PrivacyPolicy._onAcceptToggle=a;var r={submit:".PrivacyPolicy__submit"};function a(e){var t=e.checked,n=(0,i.$)(r.submit);o.setDisabled(n,!t)}},function(e,t,n){"use strict";var i=c(n(72)),o=c(n(215)),r=c(n(113)),a=c(n(184)),s=n(190),l=c(s),u=n(251);function c(e){return e&&e.__esModule?e:{default:e}}function d(e,t){$$(".messenger__layer_"+e).forEach(function(e){e.classList.toggle("messenger__layer_loading",t)})}function f(e){return $(".messenger__layer_"+e+" .messenger__body")}function p(e){s.Messenger.onMainScroll(e)}function _(e){s.Messenger.onConvoScroll(e),e._isScrolling=!0,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return!window._preventedCheckTop&&(e&&function(e){return e.scrollHeight&&e.scrollTop<=2.5*window.innerHeight}(e))}(e)&&s.Messenger.onConvoAtTop(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e&&function(e){return e.scrollHeight&&e.scrollHeight-e.scrollTop-e.offsetHeight<=1.5*window.innerHeight}(e)}(e)&&s.Messenger.onConvoAtBottom(),e._scrollingTimer&&clearTimeout(e._scrollingTimer),e._scrollingTimer=setTimeout(function(){e._isScrolling=!1},100)}function A(){var e,t,n=s.Messenger.getConvoBody();n&&(n.prevHeight&&n.prevHeight!==n.offsetHeight&&(e=n,t=n.scrollBottom,e.scrollTop=e.scrollHeight-e.offsetHeight-t),n.prevHeight=n.offsetHeight,n.scrollBottom=function(e){return e.scrollHeight-e.scrollTop-e.offsetHeight}(n),m&&requestAnimationFrame(A))}Object.assign(s.Messenger,{scrollMainBodyToTop:function(){$(".messenger__layer_main .messenger__body").scrollTop=0},onMainScroll:(0,i.default)("scrollElem"),onQueryChange:a.default.onChange,onQueryClear:a.default.onClear,onSearchMsgsClick:(0,i.default)(),setQuery:a.default.setQuery,getMainBody:function(e){return f("main")},setMainLoading:function(e){return d("main",e)},onConvoAtTop:(0,i.default)(),onConvoAtBottom:(0,i.default)(),onConvoScroll:(0,i.default)("scrollElem"),setConvoLoading:function(e){return d("convo",e)},getConvoBody:function(){return f("convo")},scrollConvoToBottom:function(){var e=s.Messenger.getConvoBody();e&&(e.scrollTop=e.scrollHeight)},redrawConvoLayer:function(){var e=(0,s.Messenger_renderConvoLayer)();(0,u.cleanScrollView)(s.Messenger.getConvoBody()),$$(".messenger__layer_convo").forEach(function(t){t.innerHTML=e})},getPageLayer:function(){return $(".messenger__layer_page")}}),s.Messenger._onMainScroll=p,s.Messenger._onConvoScroll=_,s.Messenger._onSearchMsgsClick=s.Messenger.onSearchMsgsClick;var m=!1;if(l.default.startPolling=function(){m=!0,A()},l.default.stopPolling=function(){m=!1},Object.assign(l.default,{redraw:function(){$$(".uMessenger").forEach(function(e){return e.outerHTML=(0,l.default)()})},redrawView:function(){$$(".uMessenger").forEach(function(e){return e.className=(0,s.uMessenger_class)()});var e=store.mail,t=e.cur,n=e.peers;t.peerId&&(g(),r.default.togglePin(n[t.peerId].canPin));y()},redrawMailActions:function(){var e=(0,s.uMessenger_hasSelectedMsgs)();$$(".messenger__layer_convo").forEach(function(t){t.$(".messenger__footer").classList.toggle("messenger__footer_actionsOpen",e),r.default.update();var n=store.mail,i=n.cur,o=n.peers;if(!i.peerId||!o[i.peerId].isIncomingMR){var a=t.$(".messenger__write").offsetHeight,s=t.$(".messenger__acts").offsetHeight,l=s-a,u=t.$(".messenger__body");requestAnimationFrame(function(){!u._fixed&&l&&(u.style.paddingBottom=l+"px",u._fixed=!0),l<=0&&(u.style.paddingBottom=0,u._fixed=!1)})}})},redrawPinnedMsg:g,setPinnedVisibility:function(e){var t=store.mail,n=t.peers,i=t.cur,o=n[i.peerId].hasPinnedMsg;$$(".messenger").forEach(function(t){t.classList.toggle("messenger_pinnedVisible",o&&e),t.classList.toggle("messenger_pinnedHidden",o&&!e)})},redrawBanner:function(){var e=(0,s.uMessenger_getBanner)();$$(".messenger__banner").forEach(function(t){t.innerHTML=e,t.classList.toggle("messenger__bannerVisible",!!e)})},redrawMRsHint:y,expandPeerBefore:function(){if(!$(".load_before_closed"))return;var e=s.Messenger.getConvoBody();if(o.default.safari_mobile){var t=function(){var t=e.scrollHeight-e.scrollTop-e.offsetHeight;setStyle(e,"overflow","hidden"),$$(".load_before_closed").forEach(function(e){return e.classList.remove("load_before_closed")}),e.scrollTop=e.scrollHeight-t-e.offsetHeight,setStyle(e,"overflow","auto")};e.isScrolling?(v&&clearInterval(v),v=setInterval(function(){e.isScrolling||(clearInterval(v),t())},10)):t()}else if(e.scrollTop<=184){var n=e.scrollHeight-e.scrollTop-e.offsetHeight;$$(".load_before_closed").forEach(function(e){return e.classList.remove("load_before_closed")}),e.scrollTop=e.scrollHeight-n-e.offsetHeight}},scrollToMsg:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=Msg.getElem(e);if(!i)return!1;var o=s.Messenger.getConvoBody();if($(".mailScrap__loading_before"),t)o.scrollTop=i.offsetTop-.18*o.offsetHeight;else{var r=$(".typing_id_curConvo").offsetHeight;o.scrollTop=i.offsetTop-.5*(o.offsetHeight+2)+(i.offsetHeight+r)/2,i.offsetHeight>o.offsetHeight&&(o.scrollTop=i.offsetTop)}return n&&(addClass("msg_highlight",i),setTimeout(function(){removeClass("msg_highlight",i)},1500)),!0},loadMailPage:(0,i.default)()}),o.default.safari_mobile){var h=null;s.Messenger.onConvoScroll(function(e){e.isScrolling=!0,h&&clearTimeout(h),h=setTimeout(function(){return e.isScrolling=!1},50)})}var v=null;function g(){var e=store.mail,t=e.peers,n=e.cur,i=(0,s.uMessenger_getPinnedMsg)(),o=t[n.peerId].hasPinnedMsg;$(".messenger__pinned").innerHTML=i,MailHat_convo.setHasPinnedMsg(o)}function y(){var e=store.mail.cur,t=e.countMR,n=t&&"all"===e.folder&&!e.query&&!e.forwardFromId,i=$(".messenger__mrsHint");if(n){var o=t?(0,s.uMessenger_renderMRsHint)(t):"";i.innerHTML=o}i.classList.toggle("messenger__mrsHint_hidden",!n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};function o(e){var t=store.mail.cur.drafts;return t||(t=lsGet("mail_drafts_"+e),t=store.mail.cur.drafts=t||{}),t}function r(e,t){var n=e.users.filter(function(e){return e!==t});return n.length!==e.users.length&&(e.count=e.count-(e.users.length-n.length),e.users=n),e}function a(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(function(e,t){return e.count+=t.count,t.users.reduce(function(e,t){return-1===e.users.indexOf(t)?e.users.push(t):e.count--,e},e)},{users:[],count:0,type:"mixed"})}t.getKeyboardState=function(e){var t=store.mail.cur.keyboards,n=t[e];n||(n=t[e]={});return n},t.getKeyboardType=function(){if(!store.mail.cur)return"";return store.mail.cur.keyboardType||""},t.setKeyboardType=function(e){if(!store.mail.cur)return;store.mail.cur.keyboardType=e},t.loadDrafts=o,t.getPeerDraft=function(e,t){var n=o(e);return n[t]||(n[t]={})},t.setPeerDraft=function(e,t,n,o){var r=store.mail.cur.drafts;r||(r=store.mail.cur.drafts=r||{});if(o){var a=r[t],s=a&&a.editing&&a.editing.id===o?a.editing:void 0;r[t]=i({},a,{editing:i({},s,n,{id:o})})}else r[t]=i({},r[t],n,{editing:void 0});lsSet("mail_drafts_"+e,r)},t.pushPeerAttachments=function(e,t){var n=store.mail.peers[e];n.attachmentsStack.push(n.attachmentsHTML),n.attachmentsHTML=t},t.popPeerAttachments=function(e){var t=store.mail.peers[e],n=t.attachmentsStack.pop();n||(n=Brick({mix:"cp_attached_wrap",attrs:'id="attached_wrap"'}));t.attachmentsHTML=n},t.setPeerTyping=function(e,t){var n=store.mail.cur.typings[e];n||(n=store.mail.cur.typings[e]={});"text"!==t.type&&"audio"!==t.type||(t.count?n[t.type]=t:n[t.type]=null);if(n.text&&n.audio){var i=a(n.text,n.audio);n.mixed=i.count>1?i:null}else n.mixed=null},t.removePeerTypingUser=function(e,t){var n=store.mail.cur.typings[e];if(!n)return;var i=n.audio,o=n.text;i&&((i=r(i,t)).count?n.audio=i:n.audio=null);o&&((o=r(o,t)).count?n.text=o:n.text=null);if(n.text&&n.audio){var s=a(n.text,n.audio);n.mixed=s.count>1?s:null}else n.mixed=null},t.filterPeerTypingUser=r,t.replacePeer=function(e,t){var n=store.mail,i=n.scraps.folder,o=i.indexOf(e);-1!==o&&(t?i.splice(o,1,t):i.splice(o,1));Object.keys(n.rolls.folder).forEach(function(i){var o=n.rolls.folder[i],r=o.indexOf(e);-1!==r&&(t?o.splice(r,1,t):o.splice(r,1))}),t&&(n.rolls.peer[t]=n.rolls.peer[e],n.reached.peer.before[t]=n.reached.peer.before[e],n.reached.peer.after[t]=n.reached.peer.after[e]);e!==t&&(n.rolls.peer[e]&&n.rolls.peer[e].forEach(function(i){var o=n.msgs[i];o&&(t?(o.peerId=t,o.authorId===e&&(o.authorId=t)):delete n.msgs[i])}),delete n.rolls.peer[e],delete n.reached.peer.before[e],delete n.reached.peer.after[e],delete n.members[e],delete n.peers[e])},t.removePeer=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=store.mail;if(!1!==t.lists){var i=n.scraps.folder,o=i.indexOf(e);-1!==o&&i.splice(o,1),Object.keys(n.rolls.folder).forEach(function(t){var i=n.rolls.folder[t],o=i.indexOf(e);-1!==o&&i.splice(o,1)})}!1!==t.msgs&&n.rolls.peer[e]&&n.rolls.peer[e].forEach(function(e){var t=n.msgs[e];t&&delete n.msgs[e]});!1!==t.lists&&(delete n.rolls.peer[e],delete n.reached.peer.before[e],delete n.reached.peer.after[e]);!1!==t.data&&(delete n.members[e],delete n.peers[e])},t.addPeer=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=store.mail;if(t.msgs){var i=t.msgs;n.rolls.peer[e]=i,n.reached.peer.before[e]=!1,n.reached.peer.after[e]=!1}else n.rolls.peer[e]||(n.rolls.peer[e]=[],n.reached.peer.before[e]=!1,n.reached.peer.after[e]=!1);var o=n.msgs[n.rolls.peer[e][0]];n.rolls.folder.all.unshift(e),n.cur.folder&&n.scraps.folder.unshift(e);o&&(o.isUnread&&n.rolls.folder.unread.unshift(e),o.isImportant&&n.rolls.folder.important.unshift(e))},n(102)},function(e,t,n){"use strict";var i=window.FeedAssistanceStats;i.registerTrackingCls("feedAssistance_promoButton"),i.onStartViewElement(function(e){if(i.getElementType(e)===i.BLOCKS.BLOCK_TYPE_PROMO_BUTTON){if(e._promoButtonClickHandlerAdded)return;var t=geByClass1("feedAssistancePromoButtonInstallApp__button",e),n=t?"install_app":"",o=t||e;addEvent(o,"click",function(){!function(e,t,n){i.dispatchEvent({type:i.EVENTS.EVENT_PROMO_BUTTON,data:i.serializeEventData(i.EVENTS.EVENT_PROMO_BUTTON_SUB,e,t,n)})}(e,i.EVENTS.SUB_EVENT_PROMO_BUTTON_CLICK,n)}),e._promoButtonClickHandlerAdded=!0}})},function(e,t,n){"use strict";var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};window.groupInvitationClick=function(e,t){var n=t.$btn,i=n.getAttribute("href");(n.nextElementSibling||n.previousElementSibling).remove(),ajax.post(i,{_ajax:1},{onDone:function(){}}),n.closest(".BtnStack").outerHTML='\n    <div class="notification__tempText">'+e+"</div>\n  "},window.apiCallAction=function(e,t,n,i){var o=i.$btn,r=o.getAttribute("href"),a=o.nextElementSibling||o.previousElementSibling,s=t?'<span class="notification__tempIcon '+t+'Icon"></span>':"";a&&a.remove(),ajax.post(r,{_ajax:1},{}),o.closest(".BtnStack").outerHTML='\n    <div class="notification__tempText">'+s+e+"</div>\n  "},window.NotifyItem={_onPhotoTagAcceptClick:function(e,t,n){var i=n.$btn,o=i.getAttribute("href");i.nextElementSibling||i.previousElementSibling;ajax.post(o,{_ajax:1},{onDone:function(){}}),i.closest(".BtnStack").outerHTML='\n      <div class="notification__tempText">'+t+"</div>\n    "},_onPhotoTagDeclineClick:function(e,t,n){var i=n.$btn,o=i.getAttribute("href");i.nextElementSibling||i.previousElementSibling;ajax.post(o,{_ajax:1},{onDone:function(){}}),i.closest(".BtnStack").outerHTML='\n      <div class="notification__tempText">'+t+"</div>\n    "},_onHideClick:function(e,t){e.preventDefault();var n=e.target,i=n.getAttribute("href"),o=i+"&action=hide",r=i+"&action=restore";(!t||confirm(t))&&ajax.post(o,{_ajax:1},{onDone:function(){var e=n.closest(".notificationList__items")||n.closest(".notificationList"),t=n.closest(".notification"),i=t.getAttribute("id"),o=e.closest(".notificationList");if(hide(t),NotifyItem._onBodyScroll(),o.classList.contains("notificationList_type_unread")){var a=o.$(".Pad__title"),s=parseInt(a.innerText,10)-1;a.innerText=langNumeric(s,lang.mobile_notifications_new)}var l=!0;each(geByClass("notification",e),function(e,t){isVisible(t)&&(l=!1)}),l&&o.classList.add("Pad_empty");var u=window.Snackbar;u&&u.init&&u.init({text:lang.mobile_notifications_hidden,action:{url:r,text:lang.mobile_notifications_restore,onclick:"return NotifyItem._onRestoreClick(event, '"+i+"');"}})}})},_onRestoreClick:function(e,t){e.preventDefault();var n=e.target,i=ge(t),o=n.closest(".SnackbarItem"),r=n.getAttribute("href");ajax.post(r,{_ajax:1},{onDone:function(){ge(t).style.display="",remove(o);var e=i.closest(".notificationList__items")||i.closest(".notificationList"),n=e.closest(".notificationList");if(n.classList.contains("notificationList_type_unread")){var r=n.$(".Pad__title"),a=parseInt(r.innerText,10)+1;r.innerText=langNumeric(a,lang.mobile_notifications_new)}var s=!0;each(geByClass("notification",e),function(e,t){isVisible(t)&&(s=!1)}),s||n.classList.remove("Pad_empty")}})},_onBodyScroll:function(){$$(".notification_actionsOpen").forEach(function(e){e.classList.remove("notification_actionsOpen")}),window.removeEventListener("scroll",NotifyItem._onBodyScroll)},_onActionTriggerClick:function(e){window.addEventListener("scroll",NotifyItem._onBodyScroll);var t=e.closest(".notification");t.classList.remove("notification_reverse"),t.classList.toggle("notification_actionsOpen"),$$(".notification_actionsOpen").forEach(function(e){e!==t&&e.classList.remove("notification_actionsOpen")}),t.$(".notification__actionsBubble").getBoundingClientRect().y<50&&t.classList.add("notification_reverse")}},window.FriendRequest={_onAcceptClick:function(e,t){var n=t.$btn,i=n.getAttribute("href"),o=n.nextElementSibling||n.previousElementSibling;o&&o.remove(),ajax.post(i,{_ajax:1},{onDone:function(){}}),n.closest(".BtnStack").outerHTML='\n      <div class="notification__tempText">'+e+"</div>\n    "},_onDeclineClick:function(e,t){var n=t.$btn,i=n.getAttribute("href"),o=n.nextElementSibling||n.previousElementSibling;o&&o.remove(),ajax.post(i,{_ajax:1},{onDone:function(){}}),n.closest(".BtnStack").outerHTML='\n      <div class="notification__tempText">'+e+"</div>\n    "}},window.GroupNotify={deleteSource:function(e,t){return ajax.post("feed.php",{gid:e,hash:t,act:"group_notify_delete_source"},{onDone:function(){}}),!1},addSource:function(e,t,n){this.processQuery("group_notify_add_source",e,t,n)},editSource:function(e,t){this.processQuery("group_notify_edit_source",e,t)},processQuery:function(e,t,n,o){var r=$(".group_notify_general .Control_type_switcher input.Control__native").checked?1:0,a={};$$(".group_notify_params .Control_type_switcher input.Control__native").forEach(function(e){a["type_"+e.name]=e.checked?1:0}),ajax.post("feed.php",i({gid:t,hash:n,unmuted:r,from:o},a,{act:e}),{onDone:function(){}})},gn_grProcess:function(e,t,n,i){ajax.post("club"+e,{act:"user_action",mid:t,hash:n,from:"top_notifier",action:i},{onDone:function(){}})}}},,function(e,t,n){"use strict";var i={init:function(e){var t=this;this.store=extend({},e),this.loadCount=20,this.store.offset=this.loadCount,this.isLoading=!1,this.elems={wrap:geByClass1("author-page"),nav:geByClass1("author-page-nav",this.wrap),header:geByClass1("author-page-header",this.wrap),content:geByClass1("author-page__inner",this.wrap),spinner:geByClass1("author-page__spinner",this.wrap)},this._onScrollHandler=this._onScrollHandler.bind(this),addEvent(window,"scroll touchstart",this._onScrollHandler),e.isStandalone&&(window.al=!1),window.cur.destroy.push(function(){removeEvent(window,"scroll touchstart",t._onScrollHandler)})},_getLoadOffset:function(){return this.store.offset},_showLoader:function(){this.isLoading=!0,addClass(this.elems.spinner,"active")},_hideLoader:function(){this.isLoading=!1,removeClass(this.elems.spinner,"active")},_onScrollHandler:function(){var e=this,t=this.elems,n=t.nav,i=t.header,o=t.content,r=this.store.totalCount>this._getLoadOffset();toggleClass(n,"author-page-nav_shown",i.getBoundingClientRect().bottom-n.clientHeight<0),r&&window.scrollTop()+2*window.innerHeight>o.offsetHeight&&this._loadMore(this.store.sortBy,this._getLoadOffset(),function(t){e.elems.content.innerHTML+=t})},_loadMore:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments[2];this.isLoading||(e&&(this.store.sortBy=e),isFunction(i)||(i=function(){}),this._showLoader(),ajax.post("author_page.php",{act:"load_more",author_id:this.store.authorId,sort_by:e||this.store.sortBy,count:this.loadCount,offset:void 0!==n?n:this._getLoadOffset()},{onFail:function(){t._hideLoader()},onDone:function(e){t._hideLoader(),t.store.offset+=20,e&&i(e)}}))},subscribe:function(e,t,n){ajax.post("author_page.php",{act:"subscribe",author_id:t,hash:n},{onDone:function(t,n){toggleClass(e,"Btn_theme_secondary",t),e.innerHTML=n}})},sortBy:function(e,t){var n=this;e.preventDefault(),Unfold.setActive(e.target.parentNode),t!==this.store.sortBy&&(addClass(this.elems.content,"loading"),this._loadMore(t,0,function(e){n.elems.content.innerHTML=e,n.store.offset=n.loadCount,removeClass(n.elems.content,"loading")}))}};window.AuthorPage=i},function(e,t,n){"use strict";var i,o=n(68),r=(i=o)&&i.__esModule?i:{default:i};var a=window,s=a.setStyle,l=a.geByClass1;r.default.onPostMessage(function(e,t){"resizeFrame"===e&&s(l("pageMoneyTransfer__iframe"),"height",t.height+40)})},function(e,t,n){"use strict";window.Element&&!Element.prototype.closest&&(Element.prototype.closest=function(e){var t,n=(this.document||this.ownerDocument).querySelectorAll(e),i=this;do{for(t=n.length;--t>=0&&n.item(t)!==i;);}while(t<0&&(i=i.parentElement));return i})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{!i&&s.return&&s.return()}finally{if(o)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.parseFwd=s,t.convertKludgesToAttaches=function(e,t){var n=[];e.fwd_count?n.push({type:"mail",id:-t,object:{fwd_count:e.fwd_count}}):e.fwd&&n.push({type:"mail",id:-t,object:{fwd_count:s(e.fwd).length}});for(var i=1;e["attach"+i+"_type"];++i)"call"===e["attach"+i+"_type"]?n.push({type:e["attach"+i+"_type"],id:e["attach"+i],initiatorId:o(e["attach"+i+"_call_initiator_id"]),state:e["attach"+i+"_call_state"],duration:o(e["attach"+i+"_call_duration"]),receiverId:o(e["attach"+i+"_call_receiver_id"])}):n.push({type:e["attach"+i+"_type"],id:e["attach"+i],kind:e["attach"+i+"_kind"],productId:e["attach"+i+"_product_id"]});e.geo&&n.push({type:"geo",id:e.geo});return n},t.isReservedPeer=function(e){if(0==e)return!0;return!1},t.isUserPeer=function(e){return e>0&&e<2e9},t.isChatPeer=function(e){return e>2e9};var o=window.intval;function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=e.split("_"),o=i(n,2);return[o[0],o[1],t]}var a={};function s(e){if(a[e])return a[e];for(var t=e?e.length:0,n=[],o=[],s="",l=0;l<t;l++){var u=e[l],c=u.charCodeAt(0);c>=48&&c<=57||"_"===u||"-"===u?s+=u:"("!==u&&")"!==u&&":"!==u&&","!==u||(""!==s&&(o.push(s),n.push("id"),s=""),o.push(u),n.push(u))}s.length>0&&(o.push(s),n.push("id"));var d=function e(t,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(a>50)return[[],t.length];for(var s=[],l="";o<t.length;){var u=t[o];if("id"===u)l=n[o];else if(","===u&&l)s.push(r(l)),l="";else if("("===u){var c=e(t,n,o+1,a+1),d=i(c,2),f=d[0];o=d[1],s.push(r(l,f)),l=""}else if(")"===u)return""!==l&&s.push(r(l)),[s,o];o++}return l&&s.push(r(l)),[s,o]}(n,o),f=i(d,1)[0];return Object.keys(a).length>300&&(a={}),a[e]=f,f}},function(e,t,n){"use strict";var i=window,o=i.geBySel1,r=i.geByClass1,a=i.gpeByClass,s=i.each,l=i.removeClass,u=i.addClass,c=i.hasClass,d=i.attr,f=i.addEvent,p=i.removeEvent,_=i.ajax,A=(i.replace,i.domClosestOverflowHidden),m={OPEN_CLASS:"reply_owner_show",OPEN_BOTTOM_CLASS:"reply_owner_open_bottom",NO_LIMIT_CLASS:"reply_owner_picker_nolimit",CONTAINER_CLASS:"reply_owner_picker_container",PICKER_CLASS:"reply_owner_picker",PICKER_ITEM_CLASS:"reply_owner_option",LOADING_CLASS:"reply_owner_loading",IMAGE_CLASS:"_reply_owner_image",SELECTED_IMAGE_CLASS:"_reply_owner_selected_image",SELECTED_IMAGE_CONTAINER_CLASS:"reply_owner_selected_image",OPTION_CLASS:"reply_owner_option",PICKER_MAX_HEIGHT:null,LOADING_SHOW_TIME:300,container:null,picker:null,clickEvent:"ontouchend"in document.documentElement?"touchend":"click",clickHandler:null,requestHandler:null,request:null,loading:!1,setElements:function(e){this.container=a(this.CONTAINER_CLASS,e),this.picker=r(this.PICKER_CLASS,this.container),this.clickHandler=this.clickHandler||bind(this.onDocumentClick,this),this.requestHandler=this.requestHandler||bind(this.onDocumentClickBeforeLoad,this)},unsetElements:function(){p(document.body,this.clickEvent,this.clickHandler),p(document.body,this.clickEvent,this.requestHandler),this.container=this.picker=null},show:function(e){this.setElements(e),u(this.OPEN_CLASS,this.container),this.calcPosition()},hide:function(){l(this.OPEN_CLASS,this.container),l(this.OPEN_BOTTOM_CLASS,this.container),this.unsetElements()},toggle:function(){toggleClass(this.OPEN_CLASS,this.container),this.calcPosition(),c(this.OPEN_CLASS,this.container)?(this.scrollToSelected(),f(document.body,this.clickEvent,this.clickHandler)):(this.hide(),this.unsetElements())},calcPosition:function(){var e=ge("mhead").offsetHeight,t=this.picker.getBoundingClientRect(),n=(window.pageYOffset||document.documentElement.scrollTop,A(this.picker)),i=!0;n&&n.getBoundingClientRect().bottom<this.container.getBoundingClientRect().bottom+this.PICKER_MAX_HEIGHT?i=!1:c(this.LOADING_CLASS,this.container)?i=t.top-e-this.PICKER_MAX_HEIGHT+t.height<0:c(this.OPEN_BOTTOM_CLASS,this.container)||(i=t.top-e<0),toggleClass(this.OPEN_BOTTOM_CLASS,this.container,i)},onDocumentClick:function(e){var t=e.target;t===this.container||a(this.CONTAINER_CLASS,t)||this.hide()},onDocumentClickBeforeLoad:function(e){var t=e.target;t===this.container||a(this.CONTAINER_CLASS,t)||this.cancelRequest()},cancelRequest:function(){this.request&&(this.request.abort(),this.unsetElements())},getList:function(){var e=this;if(!this.loading){this.PICKER_MAX_HEIGHT=parseInt(getStyle(this.picker,"maxHeight"),10);var t=o('input[name="from_oid"]',this.container).value,n=o('input[name="post_oid"]',this.container).value;this.loading=!0;var i=setTimeout(function(){u(e.LOADING_CLASS,e.container),e.calcPosition()},this.LOADING_SHOW_TIME);f(document.body,this.clickEvent,this.requestHandler),this.request=_.post("/wall.php",{act:"get_reply_clubs_list",oid:t,post_oid:n},{onDone:function(t){clearTimeout(i),e.picker.innerHTML=t,e.onLoadEnd(),e.toggle(e.picker)},onFail:function(){e.onLoadEnd()}})}},onLoadEnd:function(){this.loading=!1,l(this.LOADING_CLASS,this.container),p(document.body,this.clickEvent,this.requestHandler)},onChange:function(e){var t=a(this.OPTION_CLASS,e),n=r(this.IMAGE_CLASS,t).src;s(geByClass(this.SELECTED_IMAGE_CLASS),function(){this.src=n}),d(r("al"+this.SELECTED_IMAGE_CLASS),"href",d(t,"data-href")),this.hide()},onClick:function(e){this.setElements(e),geByClass(this.PICKER_ITEM_CLASS,this.picker).length?this.toggle():this.getList()},scrollToSelected:function(){var e=a(this.OPTION_CLASS,o(":checked",this.picker));this.PICKER_MAX_HEIGHT||(this.PICKER_MAX_HEIGHT=parseInt(getStyle(this.picker,"maxHeight"),10)),e&&(this.picker.scrollTop=e.offsetTop-this.PICKER_MAX_HEIGHT/2+e.offsetHeight/2)}};window.replyOwnerPicker=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{!i&&s.return&&s.return()}finally{if(o)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.imageProxyURL=function(e,t){var n=[];return r(t,function(e,t){switch(e){case"size":o=(""+t).split("x"),r=i(o,2),a=r[0],l=r[1],a=a?s(a):"",l=l?s(l):"",t=a+"x"+l}var o,r,a,l;t&&n.push(e+"="+t)}),n.length?e+"&"+n.join("&"):e};var o=window,r=o.each,a=o.intval;function s(e){return 0<e&&e<1?Math.round(100*e)/100:a(e)}},function(e,t,n){"use strict";var i=window,o=i.hide,r=i.ge,a=i.ce,s=i.append,l=i.geByClass1,u=i.val,c=i.addClass,d=i.show,f=i.obj2qs,p=i.unescapeAttr,_=i.elfocus,A=i.lockButton,m=i.unlockButton,h=i.extend,v=i.scrollToEl,g=i.remove,y=i.gpeByTag,w=i.each,b=i.removeClass,D=window.geo,C=window.ajax,E=window.nav,S=function(){var e=null,t=!1,n=!1,i={},k=[],M=0,T=null,x="",I="";function P(e,t){return!t&&H(e)}function B(e){n=!1;var i=r("medias_map"),o=r("attached_wrap");i||(i=a("div",{id:"medias_map",className:"pi_medias"}),s(i,o));var f=+e[1]||0,p=e[3]||"",_=e[4]||"",A=e[5]||"",m=(+e[6].lat||0)+"_"+(+e[6].lng||0),h=l("medias_map",i),v='<div class="medias_map_close" onclick="checkin.remove();"><i class="i_close">&nbsp;</i></div><div class="medias_map_label" onclick="checkin.changePlace();">'+p+(A?", "+A:_?", "+_:"")+"</div>",g='<input type="hidden" name="place_id" value="'+f+'"><input type="hidden" name="place" value="'+m+'">';h?u(h,v+g):u(i,v='<div class="medias_map">'+v+g+"</div>");c("cp_geo_btn_sel","geo_btn"),t=!0,d(i)}function F(t){return H(e)}function L(){u("place_add_box",""),o("place_add_box"),d("places_box")}function O(t,n){N();var o=i[n];o&&(e={latitude:+o[6].lat||0,longitude:+o[6].lng||0},n?B(o):R(e,o))}function N(e){if(!T)return!0;u("m",T),T=null,v(l("create_post_extra","mcont"));var t=E.path+(E.params?"?"+E.params:"");return E.go(t,null,{push_only:!0,no_push:e}),!1}function R(e,i){n=!0;var o=r("medias_map"),s=r("attached_wrap");o||(o=a("div",{id:"medias_map",className:"pi_medias"}),s.appendChild(o));var f=e.latitude,p=e.longitude,_=(window.devicePixelRatio,i&&i[4]||!1),A=l("medias_map",o),m=_?'<div class="medias_map_close" onclick="checkin.remove();"><i class="i_close">&nbsp;</i></div><div class="medias_map_label" onclick="checkin.changePlace();">'+_+"</div>":"",h='<input type="hidden" name="map" value="'+(f+"_"+p+"_0")+'">';A?u(A,m+""+h):u(o,'<div class="medias_map">'+m+h+"</div>");t=!0,c("cp_geo_btn_sel","geo_btn"),d(o)}function j(){e=null,i={},k=[],M=0,C.post(I,{_ajax:1}),g("medias_map")}function H(e){var t=window.al;g("feed_extra_field");var n=Math.round(1e8*e.latitude)/1e8,i=Math.round(1e8*e.longitude)/1e8,o=y("form","geo_btn"),r=a("input",{id:"feed_extra_field",type:"hidden",name:"add_place",value:n+","+i});if(!o)return E.go(E.path+"?act=places&lat="+n+"&lng="+i);var l=!1;return w(o,function(e,t){if("submit"===t.type)return l=t,!1}),l?(s(r,o),window.al&&t.ver?E.go(l):o.submit()):void 0}function V(t){t&&t.coords&&P(e={latitude:+t.coords.latitude||0,longitude:+t.coords.longitude||0})}function $(e){S.remove(),o("geo_waiting")}return{toggle:function(){t?S.remove():S.add()},addNewPlace:function(){var t=u("place_name_fld"),n=u("place_address_fld");return t?(A("place_add_btn"),C.post("/places.php",{_ajax:1,act:"add_place",latitude:e.latitude,longitude:e.longitude,title:t,address:n,hash:x},{onDone:function(e,t){if(m("place_add_btn"),e){var n={};n[e]=t,h(i,n),k.splice(k[0]?0:1,0,e),L(),O(0,e)}},onFail:function(){m("place_add_btn");var e=Array.prototype.slice.call(arguments).shift(),t=r("place_add_form");switch(e){case 2:t&&t.submit()}}}),!1):(_("place_name_fld"),!1)},addPlaceShow:function(t,n){var i=window.lang,r="/places.php"+f({act:"add_place",latitude:e.latitude,longitude:e.longitude,hash:x});u("place_add_box",'<h4 class="sub_header">'+i.mobile_geo_new_place_header+'</h4><div class="form_item fi_fat"><form id="place_add_form" action="'+r+'" method="post"><dl class="fi_row"><dt class="fi_label">'+i.mobile_geo_place_name_label+'</dt><dd class="iwrap"><input type="text" class="textfield" id="place_name_fld" name="title" /></dd></dl><dl class="fi_row"><dt class="fi_label">'+i.mobile_geo_place_address_label+'</dt><dd class="iwrap"><input type="text" class="textfield" id="place_address_fld" name="address" /></dd></dl><dl class="fi_row"><dd><input class="button" type="submit" id="place_add_btn" value="'+i.mobile_geo_place_add_btn+'" onclick="return checkin.addNewPlace(this);" /><a class="near_btn" onclick="checkin.addPlaceCancel(); return false;">'+i.mobile_cancel+"</a></dd></dl></form></div>"),u("place_name_fld",p(t)||""),u("place_address_fld",p(n)||""),o("places_box"),d("place_add_box"),_(t?"place_address_fld":"place_name_fld")},addPlaceCancel:L,selectPlace:O,changePlace:F,back:N,refreshCurrentPosition:function(){D.getCurrentPosition(V,$)},getCurrentAddress:function(){return i[0]&&i[0][5]||""},savePlaces:function(e){h(i,e)},add:function(n){if(!n&&t)return F();n&&(n.latitude||n.longitude)&&n.place?(e={latitude:+n.latitude||0,longitude:+n.longitude||0},n.place[1]?B(n.place):R(e,n.place),P(e,!0)):(D.getCurrentPosition(V,$),d("geo_waiting"))},add_place:function(n){if(!n&&t)return F();n&&(n.latitude||n.longitude)&&n.place?(e={latitude:+n.latitude||0,longitude:+n.longitude||0},n.place[1]?B(n.place):R(e,n.place),P(e,!0)):(D.getCurrentPosition(V,$),d("geo_waiting"))},remove:function(){t=!1,b("cp_geo_btn_sel","geo_btn"),j()},stash:function(o){if(!o)return[e,t,n,i,k,M,T];e=o[0],t=o[1],n=o[2],i=o[3],k=o[4],M=o[5],T=o[6]},init:function(r,a,s){return o("geo_waiting"),e=null,t=!1,n=!1,i={},k=[],M=0,T=null,x=a||"",I=s||"",r&&S.add(r),D.init()}}}();window.checkin=S},function(e,t,n){"use strict";var i=window,o=i.domPN,r=i.remove,a=i.lockButton,s=i.addClass,l=i.obj2qs,u=i.domCA,c=i.intval,d=i.geByClass1,f=i.getLang,p=i.domData,_=i.page,A=i.nav,m=(i.onDOMReady,i.each),h=i.addEvent,v=i.cdf,g=i.domChildren,y=i.append,w=i.Friends,b=i.ajax;window.FeedAssistanceRecommendedFriendsSlider={hideRecommended:function(e,t,n){var i=o(e);if(!i)return!1;var a=z(i);!function(e){var t=o(e);if(r(e),t&&!t.firstElementChild){var n=u(t,F);r(n)}}(i);var s=D+l({act:C,hash:n,id:t,from:M,block_id:a});return b.post(s,{_ajax:1}),!1},onPrettyCardBtnClick:function(e,t,n,i){return function(e,t,n){if(hasClass(S,e))return!1;var i=z(e);return s(k,e),a(e),w.accept(t,n,M,i,function(t){var n=t||f(x);unlockButton(e),removeClass(k,e),s(S,e),e.textContent=n,function(e){var t=function(e){var t=u(e,L);if(t)return d(I,t)}(e);s(P,t)}(e)},function(t,n){t===V&&A.hard_go(n),removeClass(k,e),unlockButton(e)}),!1}(e,t,n)},onScrollSlider:function(e){if(($=e)._lastScroll=$.scrollLeft,e.ajaxIsRunning||e.allLoaded)return;e.scrollLeft+e.clientWidth>=e.scrollWidth/2&&function(e){if(e.currentPage=e.currentPage||1,e.currentPage++>=H)return void(e.allLoaded=!0);var t=c(p(e,"offset"))||R,n=c(p(e,"prev-post")),i=z(e),o=D+l({act:T,offset:t,"prev-post":n,block_id:i});e.ajaxIsRunning=!0,b.post(o,{_ajax:1},{onDone:function(t,n,i){p(e,"offset",n);var o=d(B,e),r=v(i),a=g(r);y(r,o),m(a,function(){FeedAssistanceStats.register(this,"feed")}),e.ajaxIsRunning=!1,e.allLoaded=t<=n},onFail:function(){setTimeout(function(){return e.ajaxIsRunning=!1},j)}})}(e)}},FeedAssistanceStats.registerTrackingCls("feedAssistance_recommendedFriends"),_.onRestore(function(){if(U=!0,$){var e=geByClass("prettyCard_friend",$);m(e,function(){FeedAssistanceStats.forceRegister(this,"feed")})}}),_.onChange(function(){$&&$._lastScroll&&U&&($.scrollLeft=$._lastScroll);A.cur===O&&($=null);U=!1,"user_rec"===A.getQuery("from")&&(e=d("acceptFriendBtn"))&&h(e,"click",function(){c(p(e,"uid")),FeedAssistanceStats.dispatchEvent({type:FeedAssistanceStats.EVENTS.EVENT_ACCEPT_FRIEND,data:FeedAssistanceStats.serializeEventData(N,e,"profile")})});var e}),FeedAssistanceStats.onStartViewElement(function(e){var t=FeedAssistanceStats.getElementType(e);if(t===FeedAssistanceStats.BLOCKS.BLOCK_TYPE_RECOMMENDED_SLIDER||t===FeedAssistanceStats.BLOCKS.BLOCK_TYPE_RECOMMENDED_SLIDER){if(e._friendsSliderHandlersAdded)return;h(e,"scroll wheel touchmove",W),h(e,"click",q);var n=geByClass("prettyCard_friend",e);m(n,function(){FeedAssistanceStats.register(this,"feed"),FeedAssistanceStats.setParenViewableX(this,e)}),FeedAssistanceStats.forceProcessTrack(),e._friendsSliderHandlersAdded=!0}});var D="/friends",C="hide_possible",E="prettyCard__button",S="prettyCard__button_accepted",k="prettyCard__button_loading",M="feed",T="recommended_carousel",x="mobile_friends_feed_recom_got_notification",I="prettyCard__closeButton",P="prettyCard__closeButton_hidden",B="Slider__line",F=".feedAssistance_recommendedFriends",L=".prettyCard",O="/feed",N="click_recommended_friends_slider",R=20,j=500,H=3,V=2,$=void 0,U=void 0;function z(e){var t=u(e,F);return c(p(t,"block-id"))}function q(e){var t=e.target;if(t=u(t,".prettyCard__bodyLink")||t,p(t,"friend-link")&&FeedAssistanceStats.dispatchElementEvent(FeedAssistanceStats.EVENTS.EVENT_OPEN_USER,t),hasClass(t,E)){var n=hasClass("goodAuthorsSlider",FeedAssistanceStats.getRoot(t.fake_btn||t))?"authors_rec":"user_rec";FeedAssistanceStats.dispatchEvent({type:FeedAssistanceStats.EVENTS.EVENT_ACCEPT_FRIEND,data:FeedAssistanceStats.serializeEventData(N,t,n)})}}function W(){FeedAssistanceStats.onScroll()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(72),r=(i=o)&&i.__esModule?i:{default:i};var a=window,s=a.addEvent,l=a.removeEvent,u={onIframeReady:(0,r.default)("{ is_api, check_transfer_url, on_success_url }"),onPostMessage:(0,r.default)(),onAcceptCookieClick:(0,r.default)()};function c(e){var t=void 0;if(e.origin.match(/^https?:\/\/([a-zA-Z0-9\-\.]+\.)?money\.mail\.ru$/)){try{t=JSON.parse(e.data)}catch(e){t={}}"billing"===t.type&&u.onPostMessage(t.action,t.action_params)}}u.onIframeReady(function(){s(window,"message",c),window.cur.destroy.push(function(){l(window,"message",c)})}),window.BasisMoneyTransfer=u,t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(77)),o=r(n(131));function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){return(0,o.default)({mix:i.default.class("Avatar__image",a({},t,!0)),attrs:l(e)})}function l(e){return i.default.attr("style","background-image: url('"+e+"')")}t.default=function(e){var t,n=e.photos||[e.photo],r=(n=Array.isArray(n)?n:[n]).length,u="";if(r>1)for(var c=0;c<r;c++)u+=s(n[c],c);var d=void 0;d=40===e.size?"m":36===e.size?"s":e.size?e.size:"xl";return(0,o.default)({mix:i.default.class(e.mix,"Avatar",(t={},a(t,r,!0),a(t,"size",d),t)),url:e.url,attrs:1===r?l(n[0]):"",inner:u})}},function(e,t,n){"use strict";var i,o=n(28),r=(i=o)&&i.__esModule?i:{default:i};Object.assign(r.default,{setValue:function(e,t){if(!e)return;var n=(0,o.Oval_isHidden)(t);e.innerText=t,e.classList.toggle(a.hidden,n)}});var a={hidden:"Oval_hidden"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.emojiJoiners=t.emojiRegEx=t.emojiCharSeq=void 0,t.emojiMap=function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).replaceSymbols;if(r.default.safari&&r.default.safari_mobile)return e;for(var i={D83DDE07:/(\s|^)([0OÎ]:\))([\s\.,]|$)/g,D83DDE09:/(\s|^)(;-\)+)([\s\.,]|$)/g,D83DDE06:/(\s|^)([XÕxõ]-?D)([\s\.,]|$)/g,D83DDE0E:/(\s|^)(B-\))([\s\.,]|$)/g,D83DDE0C:/(\s|^)(3-\))([\s\.,]|$)/g,D83DDE20:/(\s|^)(&gt;\()([\s\.,]|$)/g,D83DDE30:/(\s|^)(;[oîOÎ])([\s\.,]|$)/g,D83DDE33:/(\s|^)(8\|)([\s\.,]|$)/g,D83DDE32:/(\s|^)(8-?[oîOÎ])([\s\.,]|$)/g,D83DDE0D:/(\s|^)(8-\))([\s\.,]|$)/g,D83DDE37:/(\s|^)(:[XÕ])([\s\.,]|$)/g,D83DDE28:/(\s|^)(:[oîOÎ])([\s\.,]|$)/g,2764:/(\s|^)(&lt;3)([\s\.,]|$)/g},o=0;o<2;o++)for(var a in i)e=e.replace(i[a],function(e,n,i,o){return(n||"")+t(a)+(o||"")});var i={D83DDE0A:/(:-\))([\s\.,]|$)/g,D83DDE03:/(:-D)([\s\.,]|$)/g,D83DDE1C:/(;-[PÐ])([\s\.,]|$)/g,D83DDE0B:/(:-[pð])([\s\.,]|$)/g,D83DDE12:/(:-\()([\s\.,]|$)/g,"263A":/(:-?\])([\s\.,]|$)/g,D83DDE0F:/(;-\])([\s\.,]|$)/g,D83DDE14:/(3-?\()([\s\.,]|$)/g,D83DDE22:/(:&#039;\()([\s\.,]|$)/g,D83DDE2D:/(:_\()([\s\.,]|$)/g,D83DDE29:/(:\(\()([\s\.,]|$)/g,D83DDE10:/(:\|)([\s\.,]|$)/g,D83DDE21:/(&gt;\(\()([\s\.,]|$)/g,D83DDE1A:/(:-\*)([\s\.,]|$)/g,D83DDE08:/(\}:\))([\s\.,]|$)/g,D83DDC4D:/(:like:)([\s\.,]|$)/g,D83DDC4E:/(:dislike:)([\s\.,]|$)/g,"261D":/(:up:)([\s\.,]|$)/g,"270C":/(:v:)([\s\.,]|$)/g,D83DDC4C:/(:ok:|:îê:)([\s\.,]|$)/g};for(var a in i)e=e.replace(i[a],function(e,n,i){return t(a)+(i||"")});n&&(e=e.replace(s,function(e){return u(e,t)}));return e},t.emojiReplace=u;var i,o=n(215),r=(i=o)&&i.__esModule?i:{default:i};var a=t.emojiCharSeq=/[0-9\uD83D\uD83C\uD83E\uDB40]/,s=t.emojiRegEx=/((?:[\u203C\u2049\u2122\u2328\u2601\u260E\u261d\u2626\u262A\u2638\u2639\u263a\u267B\u267F\u2702\u2708]|[\u2600\u26C4\u26BE\u2705\u2764]|[\u2194-\u2199\u21AA\u21A9]|[\u231A-\u231B]|[\u23E9-\u23EF]|[\u23F0-\u23F4]|[\u23F8-\u23FA]|[\u24C2]|[\u25AA-\u25AB]|[\u25B6\u25C0]|[\u25FB-\u25FE]|[\u2602-\u2618]|[\u2648-\u2653]|[\u2660-\u2668]|[\u26A0-\u26FA]|[\u2692-\u269C]|[\u262E-\u262F]|[\u2622-\u2623]|[\u2709-\u2764]|[\u2795-\u2797]|[\u27A1]|[\u27BF]|[\u2934-\u2935]|[\u2B05-\u2B07]|[\u2B1B]|[\u2B50\u2B55]|[\u303D]|[\u3297\u3299]|[\uE000-\uF8FF]|[\uD83D\uD83C\uD83E][\uDC00-\uDFFF]|\uDB40[\uDC20-\uDC7F]|[0-9]\u20E3|[\u0023-\u0039\u203C-\u21AA\u1F3F3]\uFE0F\u20E3|[\u200C\u200D\u2640\u2642\uFE0F])+)/g,l=t.emojiJoiners=["2640","2642","200D","200C"];function u(e,t){var n=0,i="",o="",r="",s=[],u=[],c=!0;e.match(/\uFE0F\u20E3/g)&&(e=e.replace(/\uFE0F/g,""));do{if(r=e.charCodeAt(n++)){var d=r.toString(16).toUpperCase(),f=e.charAt(n-1);if(8419!=r)i+=d,o+=f,f.match(a)||(u.push(i),s.push(o),i="",o="");else{var p=n-2,_=e.charAt(p);u.push("003"+_+"20E3"),s.push(_),i="",o=""}}else c=!1}while(c);i&&(u.push(i),s.push(o));var A="",m=!1,h=!1;for(var n in i="",o="",u){d=u[n],f=s[n];if(d&&"FE0F"!=d)if(f.match(/\uDB40[\uDC20-\uDC7F]/))i+=d,o+=f,h=!1;else if(f.match(/\uD83C[\uDFFB-\uDFFF]/))i+=d,o+=f;else if(m)i+=d,o+=f,m=!1;else if(-1===l.indexOf(d)){if(f.match(/\uD83C[\uDDE6-\uDDFF]/)){if(h){i+=d,o+=f,h=!1;continue}h=!0}else h&&(h=!1);i&&(A+=t(i,o,!0)),i=d,o=f}else i?(m=!0,i+=d,o+=f):A+=f,h=!1}return i&&(A+=t(i,o,!0)),A}},function(e,t,n){"use strict";function i(){var e=[],t=function(){var e=this,t=arguments;if("function"!=typeof t[0]){for(var n=e.length,i=!1,o=0;o<n;o++)!0===e[o].apply(null,t)&&(i=!0);return i}Array.prototype.slice.call(t).forEach(function(t){return e.push(t)})}.bind(e);return t.off=function(e){e?function(e,t){for(;;){var n=e.indexOf(t);if(!(n>=0))break;e.splice(n,1)}}(this,e):this.length=0}.bind(e),t._fns=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=Object.assign(i,{kind:function(){var e={};return function(t){return e[t]||(e[t]=i())}}}),window.befall=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Messenger=void 0;var i,o=n(190),r=(i=o)&&i.__esModule?i:{default:i};n(55),n(141),t.default=r.default,t.Messenger=o.Messenger,window.uMessenger=r.default,window.Messenger=o.Messenger},function(e,t,n){"use strict";var i,o=n(78),r=(i=o)&&i.__esModule?i:{default:i};var a=window,s=a.gpeByClass,l=a.setStyle,u="-webkit-tap-highlight-color";r.default._onMouseDown(function(e){for(var t=e;!(!(t=s("msg_item",t))||t&&attr(t,"data-id")););t&&(l(t,u,"transparent"),setTimeout(function(){l(t,u,"initial")},400))})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(210)),o=r(n(132));function r(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){return{tag:"label",class:i.default.class("VotingForm__bcg",{light:"default"===t.type}),inner:[{class:"VotingForm__bcgPreview",inner:[(0,o.default)({bcg:t,photoHeight:48}),{class:i.default.class("VotingForm__bcgTextGhost",{0:!0})},{class:i.default.class("VotingForm__bcgTextGhost",{1:!0})},{class:i.default.class("VotingForm__bcgTextGhost",{2:!0})},{class:i.default.class("VotingForm__bcgTextGhost",{3:!0})},{class:i.default.class("VotingForm__bcgTextGhost",{4:!0})},{class:i.default.class("VotingForm__bcgTextGhost",{5:!0})}]},{tag:"input",class:"VotingForm__bcgRadio",type:"radio",name:e,checked:t.checked?"checked":null,value:t.id},{class:"VotingForm__bcgControl"}]}}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(342),r=(i=o)&&i.__esModule?i:{default:i};n(81),n(12),n(98),n(191),t.default=r.default,window.q=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(72),r=(i=o)&&i.__esModule?i:{default:i};var a={_onMouseDown:(0,r.default)(),_onCancelClick:(0,r.default)()};window.MoneyTransferButton=a,t.default=a},,function(e,t,n){"use strict";var i=window,o=(i.nav,i.attr,i.ajax),r=function(){function e(e){var t=e.closest(".si_body");return{buttons:$(".si_links",t),message:$(".si_msg",t)}}return{sendRequest:function(t,n){t&&t.preventDefault();var i=n.getAttribute("href");ActionMenu.closeMenu();var r=e(n);o.post(i,{_ajax:1},{onDone:function(e){!function(e){hide(e.buttons),show(e.message)}(r),val(r.message,e)}})},cancelRequest:function(t,n){t&&t.preventDefault();var i=n.getAttribute("href"),r=e(n);o.post(i,{_ajax:1},{onDone:function(e){}}),function(e){hide(e.message),show(e.buttons)}(r)}}}();window.GroupsInvite=r},function(e,t,n){"use strict";var i,o=n(342),r=(i=o)&&i.__esModule?i:{default:i};Object.assign(r.default,{html:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var o="";return e.forEach(function(e,t){var i=n[t];o+=e+(i||0===i?i:"")}),o}})},function(e,t,n){"use strict";var i=n(322),o=n(1),r=window.cdf,a=window.ajax,s=window.ownerPhotoUpload,l=window.nav;var u={onDone:function(e,t,n,i){var r=(0,o.ge)(e)||(0,o.geByClass1)("like_box","z")||(0,o.geByClass1)("like_box")||(0,o.geByClass1)("wall_item_for_like_"+e);if(r&&e){var a;a=(0,o.hasClass)("wall_item",r)||(0,o.hasClass)("market_item",r)?(0,o.geByClass1)("wi_like_wrap",r):(0,o.geByClass1)("item_like",r);var s=(0,o.geByClass1)("item_repost",r),l=(0,o.geByClass1)("like_wrap",r);a&&(a.innerHTML=t||"",(0,o.toggleClass)("is_empty",a,!t),(0,o.toggle)(a,t)),s&&(s.innerHTML=n||"",(0,o.toggle)(s,n)),l&&(0,o.val)(l,i||"")}},onFail:function(){var e=Array.prototype.slice.call(arguments);switch(e.shift()){case 2:l.hard_go(e[0])}}},c={onDone:function(e,t,n,i,r){var a=window.photo;if(u.onDone.apply(this,arguments),this.photo_id){var s=a.get(this.photo_id);if(s){var l=(0,o.ce)("div",{innerHTML:s.likes});(0,o.val)((0,o.geByClass1)("item_like",l),t),s.likes=(0,o.val)(l),s.publish='<span class="item_repost">'+n+"</span>",s.likes_cnt=(0,o.intval)(((0,o.attr)((0,o.geByClass1)("v_like",l),"data-like_count")||"").replace(/\D+/g,"")),s.likes_me=r;l=(0,o.ce)("div",{innerHTML:s.actions});var c=(0,o.geByClass1)("like_wrap",l);(0,o.val)(c,i),s.actions=(0,o.val)(l),a.save(s)}}},onFail:u.onFail},d={onDone:function(){var e=window.photo;if(this.photo_id){var t=e.get(this.photo_id);t&&(t.tag_info="",e.save(t));var n=(0,o.geByClass1)("photo_view"),i=(0,o.geByClass1)("pv_tag_wrap",n);(0,o.val)(i,"")}}},f={onDone:function(e,t,n){var i=window.photo,r=window.menu,a=(0,o.geByClass1)("photo_view"),s=(0,o.geByClass1)("photo_msg"),l=!!t;if(a&&s){(0,o.val)(s,t||""),(0,o.toggleClass)("photo_deleted",a,l);var u=i.get(e);u&&(u.deleted=t,i.save(u)),n&&r&&r.refresh({pp:n})}}},p={onDone:function(e,t){var n=window.isNewMail&&(0,i.$)(".messenger")&&this.link.closest(".msg");if((0,o.val)(e,t),n){var r=Number(n.className.match(/msg_id_(\d+)/)[1]);store.mail.msgs[r].textFull=n.$(".msg__text").innerHTML}}},_={onDone:function(e){this.link&&((0,o.after)(r(e),(0,o.gpeByClass)("pic_body_wrap",this.link)),(0,o.hide)(this.link))}},A={onStart:function(){(0,o.addClass)("cm_item_loading",this.link)},onDone:function(e){this.link&&(0,o.val)(this.link.parentNode,e)}},m={onDone:function(e,t){if(e){var n=window.photo;(0,o.remove)(e+"_msg");var i=(0,o.ge)(e);if(i){if(t){var r=(0,o.ce)("div",{id:e+"_msg",className:(i.className||"")+" post_message_item"});(0,o.val)(r,'<div class="pi_cont">'+t+"</div>"),(0,o.after)(r,i),(0,o.hide)(i),(0,o.geByClass1)("rtm_reply_wrap",i)&&window.reply&&window.reply.edithide()}else(0,o.show)(e);if(this.photo_id){var a=n.get(this.photo_id);if(a){var s=(0,o.geByClass1)("photoview"),l=(0,o.geByClass1)("comments_wrap",s);a.comments_html=(0,o.val)(l)}}}}}},h={onDone:function(e,t,n,i){if(e){(0,o.remove)(e+"_msg");var r=(0,o.ge)(e);if(r)if(t){var a=(/^([a-z]+)_item$/i.exec(n||"")||[])[1]||"inline",s=(0,o.ce)("div",{id:e+"_msg",className:a+"_item "+a+"_message_item"}),l=i||"message_item_cont";(0,o.val)(s,'<div class="'+l+'">'+t+"</div>"),(0,o.after)(s,r),(0,o.hide)(r)}else!1===t?(0,o.hide)(r):(0,o.show)(r)}}},v={onDone:function(e,t,n){if(e){var i=(0,o.ge)(e),r=(0,o.getY)(i)||(0,o.getY)(e+"_msg"),a=(0,o.getH)(i)||(0,o.getH)(e+"_msg"),s=r+(c<320?a:0)-(0,o.scrollTop)();if((0,o.remove)(e+"_msg"),i){var l=(0,o.hasClass)("wall_item",i)||(0,o.hasClass)("post",i)?"wall":"post";if(n){var u=(0,o.ce)("div",{id:e+"_msg",className:l+"_item post_message_item"});(0,o.val)(u,'<div class="pi_cont">'+n+"</div>"),(0,o.after)(u,i)}if(t){(0,o.each)((0,o.geByClass)(l+"_item"),function(){var e=!!this.id&&this.id.match(/^wall((-?\d+)_(-?\d+)(_\d+)?)$/),i=(0,o.attr)(this,"data-copy"),r=!!i&&i.match(/^(-?\d+)_(-?\d+)$/);if(!e)return!0;(!e[4]&&e[2]==t||e[4]&&e[3]==t||r&&r[1]==t)&&(0,o.toggleClass)("post_item_ignored",this,n)});var c=(0,o.getCw)(),d=(r=(0,o.getY)(i)||(0,o.getY)(e+"_msg"),a=(0,o.getH)(i)||(0,o.getH)(e+"_msg"),r+(c<320?a:0)-s);(0,o.geByClass1)("wall_item")===i&&(d=0),(0,o.scrollTop)(d)}}}}},g={onDone:function(e,t){if(e){var n=(0,o.ge)(e);if((0,o.remove)(e+"_msg"),n&&t){var i=(0,o.hasClass)("wall_item",n)||(0,o.hasClass)("post",n)?"wall":"post",r=(0,o.ce)("div",{id:e+"_msg",className:i+"_item post_message_item"});(0,o.val)(r,'<div class="pi_cont">'+t+"</div>"),(0,o.after)(r,n)}(0,o.toggleClass)("post_item_ignored",n,t)}}},y={onDone:function(e,t,n){if(e){var i=(0,o.ge)(e);if((0,o.remove)(e+"_msg"),i){if(n){var r=(0,o.ce)("div",{id:e+"_msg",className:"wall_item post_message_item"});(0,o.val)(r,'<div class="pi_cont">'+n+"</div>"),(0,o.after)(r,i)}(0,o.toggleClass)("post_item_ignored",i)}}}},w={onStart:function(){var e=(0,o.gpeByClass)("show_more_wrap",this.link),t=(0,o.geByClass1)("show_more",e)||this.link,n=(0,o.ce)("div",{id:"show_more_loading",className:"show_more_loading",innerHTML:'<i class="i_loading">&nbsp;</i>'}),i=(0,o.ce)("div",{id:"show_more_wrap",className:"show_more_wrap"});(0,o.attr)(n,"data-href",(0,o.getHref)(t)),i.appendChild(n),(0,o.before)(i,e),(0,o.remove)(e)},onDone:function(e){var t=window.cur;a.tAlProcess=(new Date).getTime();var n=(0,o.ge)("show_more_wrap"),i=r(e);(0,o.before)(i,n),(0,o.remove)(n),a.prepare_nav("mcont"),a.prepare_click("mcont"),(0,o.onBodyScrollForce)(100),a.tAlModule=t.module,a.tAlRender=(new Date).getTime(),(0,o.resizePosters)()}},b={onStart:w.onStart,onDone:function(e,t){w.onDone.apply(null,arguments),Bookmarks.pushItemsToStore(t)}},D={onStart:w.onStart,onDone:function(e,t){var n=window.cur;a.tAlProcess=(new Date).getTime();var i=(0,o.geByClass1)("photos_page","mcont"),s=(0,o.ge)("show_more_wrap"),l=r(t);e=e.replace(/<img src="([^"]+)" class="/gi,'<img data-src="$1" class="_image ');var u=r(e);i&&i.appendChild(u),(0,o.before)(l,s),(0,o.remove)(s),a.prepare_nav("mcont"),a.prepare_click("mcont"),(0,o.onBodyScrollForce)(100),a.tAlModule=n.module,a.tAlRender=(new Date).getTime(),(0,o.resizePosters)()}},C={onStart:w.onStart,onDone:function(e,t){var n=window.cur;a.tAlProcess=(new Date).getTime();var i=(0,o.geByClass1)("audios_block",(0,o.geByClass1)("audios","mcont")),s=(0,o.ge)("show_more_wrap"),l=r(t),u=r(e);i&&i.appendChild(u),(0,o.before)(l,s),(0,o.remove)(s),a.prepare_nav("mcont"),a.prepare_click("mcont"),a.tAlModule=n.module,a.tAlRender=(new Date).getTime()}},E={onDone:function(e){var t=this.link.parentNode;(0,o.val)(t,e)}},S={onStart:function(){(0,o.addClass)("mva_item_loading",this.link)},onDone:function(e,t){(0,o.removeClass)("mva_item_loading",this.link),e.upload_url||t&&l.hard_go(t),s&&s.crop(e)||t&&l.hard_go(t)},onFail:function(){(0,o.removeClass)("mva_item_loading",this.link)}},k={onStart:function(){var e=this.link,t=(0,o.gpeByClass)("notify_lite",e);if(t)return(0,o.remove)(t);for(;e=e.parentNode;)if((0,o.hasClass)("notify_item",e)){(0,o.hasClass)("notify_panel",e.parentNode)?(0,o.remove)(e.parentNode):(0,o.remove)(e);break}}},M={onStart:function(){var e=(0,o.geByClass)("pagination","mcont");(0,o.each)(e,function(e,t){(0,o.before)((0,o.ce)("div",{className:"summary_loading",innerHTML:'<i class="i_loading"></i>'}),t.firstChild)})},onDone:function(e,t,n){var i=window.mail,r=(0,o.ge)("messages"+t);r&&((0,o.val)(r,e),i.onMessagesRepainted(!0),!this.save&&(0,o.scrollToEl)()),this.save&&i.saveDialog({messages:e},t),this.clear&&((0,o.val)((0,o.geByTag1)("textarea","write_form"),""),(0,o.remove)((0,o.geByClass1)("pi_medias","write_form"))),(0,o.removeClass)("cp_attach_btn_sel",(0,o.geByClass1)("cp_attach_btn")),window.isNewMail&&MailScrap.clearSystemMessage2(),n&&n.play_animation_msg_id&&StickersSettings.getAutoplay()&&StickersAnimation.loadStickerInMvkIMAndPlay(n.play_animation_msg_id)},onFail:function(){switch(Array.prototype.slice.call(arguments).shift()){case 2:this.link.form&&this.link.form.submit()}}},T={onStart:function(){var e=(0,o.geByClass)("pagination","mcont");(0,o.each)(e,function(e,t){(0,o.before)((0,o.ce)("div",{className:"summary_loading",innerHTML:'<i class="i_loading"></i>'}),t.firstChild)})},onDone:function(e,t){var n=window.mail,i=(0,o.ge)("dialogs");i&&((0,o.val)(i,e),!this.no_scroll&&(0,o.scrollToEl)(),n.cacheDialogsPage()),n.save(t)}},x={onFail:function(e,t){if(e===a.RESPONSE_CAPTCHA){var n=this.link&&this.link.form;t+="&code="+(n&&n.code?n.code.value:""),l.hard_go(t)}}},I={onStart:function(){var e=(0,o.gpeByClass)("friendsList__showMoreBtnWrap",this.link),t=(0,o.geByClass1)("friendsList__showMoreBtn",e)||this.link,n=(0,o.ce)("div",{id:"show_more_loading",className:"wait_loading"}),i=(0,o.ce)("div",{id:"show_more_wrap",className:"friendsList__showMoreBtnWrap"});(0,o.attr)(n,"data-href",(0,o.getHref)(t)),i.appendChild(n),(0,o.before)(i,e),(0,o.remove)(e)},onFail:function(){var e=this,t=this.link.getAttribute("data-href")||this.link.getAttribute("href");setTimeout(function(){a.post(t,{_ajax:1},{onDone:I.onDone.bind(e),onFail:I.onFail.bind(e)})},500)},onDone:w.onDone},P={onDone:function(e,t){if(e){var n=(0,o.ge)(e);n&&n.parentNode&&t&&(0,o.replace)(r(t),n.parentNode)}}},B={onDone:function(e,t){if(e){var n=(0,o.geByClass)(e);if(n.length&&t)for(var i=0,a=n.length;i<a;i++)n[i].parentNode&&(0,o.replace)(r(t),n[i].parentNode)}}},F={onDone:function(e,t,n){if(e){var i=(0,o.geByClass)(e);if(i.length&&t)for(var a=0,s=i.length;a<s;a++)i[a].parentNode&&(0,o.replace)(r(t),i[a].parentNode);n&&Bookmarks.showSuccessSnack(n)}}},L={onDone:function(e,t,n,i){if(e){var r=(0,o.ge)(e);if(r){var a=(0,o.geByClass1)("wia_close",r);if(a&&((0,o.val)(a,n),a.href=t),(0,o.hasClass)("single_wall_item",r)){var s=(0,o.ge)("nc_form"),l=(0,o.geByClass1)("wall_replies");s?(0,o.toggle)(s,!!i):i&&(l?domInsert(l,i):(domInsertAfter((0,o.ce)("div",{innerHTML:i}),r),l=(0,o.geByClass1)("wall_replies"))),(0,o.toggleClass)("closed_comments",l,!i)}}}}};window.Like=u,window.PhotoLike=c,window.PhotoTag=d,window.PhotoDelete=f,window.Poll=p,window.CopyHistory=_,window.ToggleMenu=A,window.Comment=m,window.ItemDelete=h,window.FeedIgnore=v,window.FeedIgnoreItem=g,window.FeedIgnoreComments=y,window.Wall=w,window.Bookmark=b,window.BookmarkToggle=F,window.Photos=D,window.Audios=C,window.FixPost=E,window.ProfileMove=S,window.Notify=k,window.Dialog=M,window.Dialogs=T,window.LoginCheckAuthCodePage=x,window.WallSubscribe=P,window.FeedSubscribe=B,window.ImportedFriends=I,window.CloseComments=L},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(277),r=(i=o)&&i.__esModule?i:{default:i};t.default=r.default},function(e,t,n){"use strict";var i=a(n(72)),o=n(235),r=a(n(106));function a(e){return e&&e.__esModule?e:{default:e}}Object.assign(r.default,{onUnreadClick:(0,i.default)(),onBackClick:(0,i.default)(),onBackToDialogClick:(0,i.default)(),onCancelEditing:(0,i.default)(),setModifiers:o.MailHat_convo.setModifiers,redrawCounter:function(){var e=store.mail.cur.countUnread;if(!nav.getQuery("community")){var t=geBySel1(".mmi_mail .mm_counter2");e>0?(t.innerText=e,attr(t,"style","display: inline")):hide(t)}o.MailHat_main.setUnreadCount(e)},redrawOnline:p,redraw:d,startStatusUpdate:u,cancelStatusUpdate:c}),o.MailHat_main.onUnreadClick(r.default.onUnreadClick),o.MailHat_main.onBurgerClick(menu.open),o.MailHat_main.onCancelForwardTap(r.default.onBackToDialogClick),o.MailHat_convo.onBackTap(r.default.onBackClick),o.MailHat_convo.onCancelEditingTap(r.default.onCancelEditing),uVK.onReady(l),uVK.onReady(f),page.onChange(f);var s=void 0;function l(){store.mail&&store.mail.cur&&(store.mail.cur.peerId&&u())}function u(){var e=store.mail.cur;(e?e.peerId:null)?s=setTimeout(function(){p(),u()},3e4):c()}function c(){s&&clearTimeout(s)}function d(){$$(".mailHat").forEach(function(e){return e.outerHTML=(0,r.default)()})}function f(){}function p(){var e=window.lang,t=store.mail,n=t.cur,i=t.peers,o=n?n.peerId:null;if(o){var r=i[o];if(r.lastActionTime&&!r.isOnline){var a=n.timeshift,s=function(e,t){var n=window.lang,i="";e+=t;var o=parseInt(Date.now()/1e3)-e;if(o<60)i=n.mobile_profile_status_just_now;else if(o<3600){var r=intval(o/60);i=langWordNumeric(r,n.mobile_profile_status_word_mins_ago,n.mobile_profile_status_mins_ago)}else if(o<14400){var a=intval(o/3600);i=langWordNumeric(a,n.mobile_profile_status_word_hours_ago,n.mobile_profile_status_hours_ago)}else i=function(e){var t=1e3*e,n=new Date(t),i=new Date,o=window.lang;return n.getFullYear()!=i.getFullYear()&&n.getTime()<i.getTime()-1728e5||Math.abs(n.getTime()-i.getTime())>157248e5?langDate(t,o.mobile_mail_date,0,o.months_sm_of,!1):langDate(t,o.mobile_mail_short_date_time,0,o.months_sm_of,!1)}(e);return i}(r.lastActionTime,a);r.offlineText=langSex(r.sex,e.mobile_mail_last_activity_tip).replace("{time}",s)}d()}}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(77)),o=r(n(131));function r(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){return(0,o.default)({mix:i.default.class(e.mix,"ScrollView"),attrs:e.attrs,inner:e.inner})}},function(e,t,n){"use strict";var i=window,o=i.langNumeric,r=i.show,a=i.hide,s=function(){var e=document.getElementsByClassName("gift_create_post_counter");return{counter:function(t){var n=e[0];if(n){var i=t.value.length,s=t.maxLength;if(i>s)t.value=t.value.substr(0,s);else if(i>s/2){var l=Math.max(s-i,0);n.innerText=o(l,lang.text_N_symbols_remain),r(n)}else a(n)}}}}();window.GiftsSendFormCounter=s},,function(e,t,n){"use strict";var i=window,o=i.ajax,r=i.obj2qs,a=i.parseJSON,s=i.autoScroll,l=i.ImportedFriends;window.Friends={onImportSuccess:befall("serviceId","friendsHtml","total"),onImportFailed:befall("serviceId"),accept:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:f,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:f;g(c,e,t,n,i,o,r)},decline:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:f,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:f;g(d,e,t,n,i,o,r)},makeImportRequest:function(e,t,n){if(!window.XMLHttpRequest)return void(window.location=e);o.plainpost(e,{_ajax:1},function(e){return y(e,t,n)},function(){return b(n)},!0)}};var u="/friends",c="accept",d="decline",f=null,p="/friends.php?act=save_contacts&type=",_="friendsImport__loading",A=_+"_hidden",m="friendsImport__result",h=m+"_shown",v="friendsList__footerBtn_showMore";function g(e,t,n,i,a,s,l){var c={act:e,hash:n,id:t};i&&(c.from=i),a&&(c.block_id=a);var d=u+r(c);o.post(d,{_ajax:1},{onDone:s,onFail:l})}function y(e,t,n){var i=a(e),r=i.user,s=i.user_hash,l=i.contacts,u=p+n,c;if(i.error){b(n);return}o.post(u,{_ajax:1,user:r,userhash:s,hash:t,contacts:l},{onDone:function e(t,i){return w(n,t,i)},onFail:function e(){return b(n)}})}function w(e,t,n){var i=geByClass1(_),o=geByClass1(m);if(addClass(A,i),o){o.innerHTML=t;addClass(h,o)}if(s(function(){return geByClass1(v)},l,{no_cache:!0}),Friends.onImportSuccess(e,t,n),window.opener){window.opener.Friends.onImportSuccess(e,t,n)}}function b(e){Friends.onImportFailed(e),window.opener&&(window.opener.Friends.onImportFailed(e),window.close())}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n(1);function i(e){return"number"==typeof e||"string"==typeof e&&e}t.default={class:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[e];return Object.keys(t).forEach(function(o){if(i(o)){var r=t[o];!0===r?n.push(e+"_"+o):i(r)&&n.push(e+"_"+o+"_"+r)}}),n.join(" ")},setMod:function(e,t,n){var o=new RegExp("\\s*"+t+"(_[-a-zA-Z]+)?"),r=void 0;r=!0===n?" "+t:i(n)?" "+t+"_"+n:"";o.test(e.className)?e.className=e.className.replace(o,r):e.className+=r}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uMailWrite_KeyboardButton=t.uMailWrite_KeyboardRow=t.uMailWrite_ToBottomInner=t.uMailWrite_Attachments=t.uMailWrite_ReplyHTML=t.uMailWrite_Reply=void 0;var i=C(['\n      <div class="uMailWrite uMailWrite_unableToWrite">\n        ','\n        <div class="uMailWrite__unableToWriteText">\n          ',"\n        </div>\n      </div>\n    "],['\n      <div class="uMailWrite uMailWrite_unableToWrite">\n        ','\n        <div class="uMailWrite__unableToWriteText">\n          ',"\n        </div>\n      </div>\n    "]),o=C(['\n    <form\n      class="','"\n      method="POST"\n      action="/mail?act=send&to=',"&hash=","&from=dialog",'"\n      ','\n    >\n      <div class="uMailWrite__toBottom" ',">","</div>\n      ","\n      ","\n      ","\n      ","\n      ","\n      ","\n    </form>\n  "],['\n    <form\n      class="','"\n      method="POST"\n      action="/mail?act=send&to=',"&hash=","&from=dialog",'"\n      ','\n    >\n      <div class="uMailWrite__toBottom" ',">","</div>\n      ","\n      ","\n      ","\n      ","\n      ","\n      ","\n    </form>\n  "]),r=C(["\n    ","\n    ","\n  "],["\n    ","\n    ","\n  "]),a=C(['\n    <div class="uMailWrite__main">\n      <div class="uMailWrite__button uMailWrite__buttonAttach">','</div>\n      <div class="uMailWrite__button uMailWrite__buttonKeyboard" ',">",'</div>\n      <div class="uMailWrite__button uMailWrite__buttonStickers" ',">","",'</div>\n      <button class="','" type="submit">\n        ',"\n        ","\n        ","\n        ","\n        ","\n        ","\n        ",'\n      </button>\n      <div class="uMailWrite__textareaContainer">\n        <textarea\n          class="uMailWrite__textarea"\n          name="message"\n          placeholder="','"\n          maxlength="4096"\n          ',"\n          ","\n          ","\n          ","\n          ","\n          ","\n          ",'\n        ></textarea>\n        <div class="uMailWrite__textareaGhost"></div>\n      </div>\n    </div>\n  '],['\n    <div class="uMailWrite__main">\n      <div class="uMailWrite__button uMailWrite__buttonAttach">','</div>\n      <div class="uMailWrite__button uMailWrite__buttonKeyboard" ',">",'</div>\n      <div class="uMailWrite__button uMailWrite__buttonStickers" ',">","",'</div>\n      <button class="','" type="submit">\n        ',"\n        ","\n        ","\n        ","\n        ","\n        ","\n        ",'\n      </button>\n      <div class="uMailWrite__textareaContainer">\n        <textarea\n          class="uMailWrite__textarea"\n          name="message"\n          placeholder="','"\n          maxlength="4096"\n          ',"\n          ","\n          ","\n          ","\n          ","\n          ","\n          ",'\n        ></textarea>\n        <div class="uMailWrite__textareaGhost"></div>\n      </div>\n    </div>\n  ']),s=C(['\n    <div class="uMailWrite__SVGIcon uMailWrite__SVGIcon_','"></div>\n  '],['\n    <div class="uMailWrite__SVGIcon uMailWrite__SVGIcon_','"></div>\n  ']),l=C(['\n    <div class="uMailWrite__keyboard ScrollView">\n\n    </div>\n  '],['\n    <div class="uMailWrite__keyboard ScrollView">\n\n    </div>\n  ']),u=C(['\n    <div class="uMailWrite__keyboardRow">\n      ',"\n    </div>\n  "],['\n    <div class="uMailWrite__keyboardRow">\n      ',"\n    </div>\n  "]),c=C(['\n    <div class="uMailWrite__buttonKeyboardIcon"></div>\n  '],['\n    <div class="uMailWrite__buttonKeyboardIcon"></div>\n  ']),d=C(['\n    <div class="uMailWrite__templates">\n      <div class="uMailWrite__templatesHeader">\n        ','\n        <a class="uMailWrite__templatesAdd" href="','" ',">\n          ",'\n        </a>\n      </div>\n      <div class="uMailWrite__templatesBody ScrollView"></div>\n    </div>\n  '],['\n    <div class="uMailWrite__templates">\n      <div class="uMailWrite__templatesHeader">\n        ','\n        <a class="uMailWrite__templatesAdd" href="','" ',">\n          ",'\n        </a>\n      </div>\n      <div class="uMailWrite__templatesBody ScrollView"></div>\n    </div>\n  ']),f=C(['\n    <div class="','">\n      ',"\n      ","\n      ","\n    </div>\n  "],['\n    <div class="','">\n      ',"\n      ","\n      ","\n    </div>\n  "]),p=C(['\n    <div class="',' _preventMenuOpen">\n      ',"\n      ","\n    </div>\n  "],['\n    <div class="',' _preventMenuOpen">\n      ',"\n      ","\n    </div>\n  "]),_=C(['\n    <div class="uMailWrite__attachedMsgs">\n      ',"\n      ","\n      ",'\n      <div class="uMailWrite__attachedMsgsText">',"</div>\n    </div>\n  "],['\n    <div class="uMailWrite__attachedMsgs">\n      ',"\n      ","\n      ",'\n      <div class="uMailWrite__attachedMsgsText">',"</div>\n    </div>\n  "]),A=C(['\n    <input type="hidden" name="attached_messages" value="','" />\n  '],['\n    <input type="hidden" name="attached_messages" value="','" />\n  ']),m=D(n(77)),h=(D(n(326)),D(n(131))),v=D(n(355)),g=D(n(293)),y=D(n(268)),w=D(n(163)),b=n(356);D(n(282));function D(e){return e&&e.__esModule?e:{default:e}}function C(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function E(){var e=store.mail,t=e.cur,n=e.peers,i=n[t.peerId]?n[t.peerId].countUnread:null,o=i?(0,g.default)({mix:"uMailWrite__toBottomValue",value:i}):"",a=(0,v.default)({mix:"uMailWrite__toBottomIcon",icon:"arrowDown"});return m.default.html(r,o,a)}function S(e){return m.default.html(s,e)}function k(e){var t=store.mail.cur,n=store.mail.members,i=t.peerId,o=t.msgReply[i],r=o?store.mail.msgs[o]:null,a="",s="";if(r){var l=(0,b.Msg__authorName)(n[r.authorId],i,t.userId);a=(0,b.Msg__reply)(r,l,e),s='\n      <input type="hidden" name="attached_messages" value="'+r.id+'" />\n      <input type="hidden" name="has_reply" value="true" />\n    '}var u=m.default.class("uMailWrite__reply",{visible:!!a}),c=M();return m.default.html(f,u,a,c,s)}function M(){return(0,w.default)({class:"uMailWrite__replyClose",onClick:m.default.onClick("uMailWrite.onReplyClose")})}function T(e){var t=store.mail,n=t.cur,i=t.peers[e].attachmentsHTML,o=m.default.class("uMailWrite__attachments",function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},e,!0)),r=n.msgAttached[e]||[],a=r.length,s="";a>0&&(s=function(e,t){var n=window.lang,i=m.default.onClick("uMailWrite.onAttachedMsgsRemove"),o=(0,v.default)({mix:"uMailWrite__attachedMsgsIcon",icon:"msgMini"}),r=(0,v.default)({mix:"uMailWrite__attachedMsgsRemove",icon:"close9",attrs:i}),a=langNumeric(e,n.mobile_mail_messages),s=function(e){return m.default.html(A,e)}(t);return m.default.html(_,s,r,o,a)}(a,r.join(";")));return m.default.html(p,o,s,i)}t.default=function(){var e=window.lang,t=store.mail,n=t.cur.peerId;if(!n)return'<form class="uMailWrite"></form>';var r=t.peers[n];if(r.unableToWrite){if(r.isChannel)return"";var s=r.kickedMessage||e.mobile_msg_mail_privacy_error,u=(0,v.default)({mix:"uMailWrite__unableToWriteIcon",icon:"warning"});return m.default.html(i,u,s)}var f=m.default.onSubmit("uMailWrite._onSubmit","event","this"),p=m.default.onClick("uMailWrite.onToBottomClick"),_=(0,h.default)({mix:"uMailWrite__popupStickers _preventMenuOpen",inner:""}),A=k(null),g=T(n),w=function(e){var t=window.lang,n=store.mail,i=n.cur,o=n.queue,r=m.default.onMouseDown("uMailWrite._onStickersClick","event"),s=m.default.onMouseDown("uMailWrite._onKeyboardClick","event"),l=n.peers[e],u=i.groupId,d=Math.abs(u),f=u?"&community="+d:"",p=(0,y.default)({icon:"attach",name:"uMailWrite_attachments",position:"bottomLeft",items:[{text:i.inlineUploadHTML.replace(/mail\d+/g,"mail"+e),icon:"camera"},{text:t.mobile_attachments_add_photo_vk,url:"/attachments?act=choose_photo&target=mail"+e+f,icon:"photo"},{text:t.mobile_attachments_add_video,url:"/attachments?act=choose_video&target=mail"+e+f,icon:"video"},{text:t.mobile_attachments_add_audio,url:"/attachments?act=choose_audio&target=mail"+e+f,icon:"audio"},{text:t.mobile_attachments_add_doc,url:"/attachments?act=choose_doc&target=mail"+e+f,icon:"doc"},l.canAttachMoney?{text:t.mobile_attachments_add_money,url:"/attachments?act=attach_money&target=mail"+e+f,icon:"money"}:null,l.canAttachPoll?{text:t.mobile_attachments_add_poll,url:"/attachments?act=attach_poll&target=mail"+e+f,icon:"poll_blue",mix:"uMailWrite__pollUnfoldItem"}:null]}),_=m.default.onKeyUp("uMailWrite._onKeyUp"),A=m.default.onInput("uMailWrite._onInput","event","this"),h=m.default.onKeyDown("uMailWrite._onKeyDown","event","this"),g=m.default.onFocus("uMailWrite._onFocus","event","this"),w=m.default.onBlur("uMailWrite._onBlur","event","this"),b=m.default.onClick("uMailWrite._onClick","event","this"),D=(0,v.default)({mix:"uMailWrite__buttonSendIcon",icon:"send"}),C=(0,v.default)({mix:"uMailWrite__buttonSendIcon",icon:"send",active:!0}),E=S("accept"),k=S("remove"),M=S("templates"),T=S("templatesActive"),x=(0,v.default)({mix:"uMailWrite__buttonSendIcon",icon:"spinner"}),I=(0,v.default)({mix:"uMailWrite__buttonStickersIcon",icon:"sticker"}),P=(0,v.default)({mix:"uMailWrite__buttonStickersIcon",icon:"sticker",active:!0}),B=m.default.html(c),F=l.attachmentsHTML.length,L=i.msgAttached[i.peerId],O=L&&L.length,N=!!(o[i.peerId]||[]).length,R=m.default.class("uMailWrite__button","uMailWrite__buttonSend",{send:!0,sendActive:!!(F>150||O),loading:N});return m.default.html(a,p,s,B,r,I,P,R,D,C,x,E,k,M,T,t.mobile_mail_message_placeholder,g,_,A,h,g,w,b)}(n),b=m.default.html(l),D=function(){var e=window.lang,t=(0,v.default)({icon:"plus"}),n=store.mail.cur.peerId,i=store.mail.cur.communityParam,o="/mail?act=template&from="+n+i,r=m.default.onClick("uMailWrite.loadTemplatePage","event","this",o);return m.default.html(d,e.mobile_mail_templates_panel_title,o,r,t)}(),C=E(),M=m.default.class("uMailWrite",{canAttachMoney:!!r.canAttachMoney,canAttachPoll:!0});return m.default.html(o,M,n,r.hashSend,t.cur.communityParam,f,p,C,A,g,w,_,b,D)},t.uMailWrite_Reply=k,t.uMailWrite_ReplyHTML=function(e,t,n){var i=m.default.class("uMailWrite__reply",{visible:!0}),o=void 0;o=n?'\n      <input type="hidden" name="mail_edit_attach_fwd" value="1" />\n    ':'\n      <input type="hidden" name="attached_messages" value="'+e+'" />\n      <input type="hidden" name="has_reply" value="true" />\n    ';var r=M();return m.default.html(f,i,t,r,o)},t.uMailWrite_Attachments=T,t.uMailWrite_ToBottomInner=E,t.uMailWrite_KeyboardRow=function(e){return m.default.html(u,e)},t.uMailWrite_KeyboardButton=function(e,t){var n=m.default.class("uMailWrite__keyboardButton",{primary:"primary"===e.color,positive:"positive"===e.color,negative:"negative"===e.color}),i=m.default.onClick("uMailWrite._onKeyboardButtonClick","event",{action:e.action,authorId:t.author_id});return(0,w.default)({class:n,onClick:i,text:e.action.label})}},,function(e,t,n){"use strict";function i(){$(o.self).classList.toggle(r.restCodesShown)}window.ReservedCodes={},ReservedCodes._onShowRestCodesClick=i;var o={self:".ReservedCodes"},r={restCodesShown:"ReservedCodes_restCodesShown"}},function(e,t,n){"use strict";n(248)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.emojiSymbolToByteHex=function(e){var t=e.split("").map(function(e){return e.charCodeAt(0).toString(16)}).filter(function(e){return"fe0f"!==e.toLowerCase()}).map(function(e){return String.fromCodePoint(parseInt(e,16))}).join("");return encodeURIComponent(t).replace(/%/gi,"").toLowerCase()},t.emojiByteHexToSymbol=function(e){var t=e.length%2==1,n=t?e.slice(0,1):"",i=t?e.slice(1):e,o="";try{o=decodeURIComponent("%"+(r=i,r.split("").reduce(function(e,t,n){var i=(n+1)%2==0;return e+t+(i?" ":"")},"").trim().split(/\s+/)).join("%"))}catch(e){}var r;return n+o},t.emojiRemoveSkinToneModifiers=function(e){return e.replace((0,i.emojiRegex)(),o)};var i=n(224);function o(e){return e.replace(i.skinToneModifierRegex,"")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(106),r=(i=o)&&i.__esModule?i:{default:i};n(84),t.default=r.default,window.uMailHat=r.default},function(e,t,n){"use strict";Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var i=arguments[1],o=0;o<n;){var r=t[o];if(e.call(i,r,o,t))return r;o++}}})},function(e,t,n){"use strict";var i,o=n(342),r=(i=o)&&i.__esModule?i:{default:i};Object.assign(r.default,{list:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Array.isArray(e)||(e=[e]);return t?e.map(t).join(""):e.join("")}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(284),r=(i=o)&&i.__esModule?i:{default:i};t.default=r.default,window.BookmarksPageItem=r.default},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";var i=need("Voting"),o=window,r=o.attr,a=o.removeClass,s=o.addClass,l=o.hasClass,u=o.toggleClass,c=o.ge,d=o.val,f=o.geByClass1,p=o.langNumeric,_=o.each,A=o.lockButton,m=window.browser,h=window.ajax,v=window.nav,g=window.page,y=window.mail,w=window.im,b=function(){var e,t,n=[],o=!1,b=!1,C={};function E(e){return function(){if(!o)return e.apply(this,arguments)}}function S(e){return"A"===e.tagName}function k(){b=n.length>0,u("vk_messages_actions_visible",document.body,b)}function M(){b&&(C={},_(n,function(e,t){a("mi_selected",f("_msg"+t))}),o=!1,n=[],k())}function T(){return!!window.getSelection&&window.getSelection().toString().length>0}function x(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];o=!0,A(e),w.off(),h.click("/mail",{},{url_params:{act:r?"spam":"delete",peer:t,hash:i,ids:n.join(","),community:D()}})}function I(){return Boolean(e)}function P(){c("dialogs")&&I()?s("vk_dialogs_forwarding",document.body):e="",M()}return g.onChange(P),y.onShowDialogsPageFromCache(P),y.onShowDialogFromCache(P),y.onMessagesRepainted(function(){_(n,function(e,t){s("mi_selected",f("_msg"+t))})}),{onMessageClick:E(function(e){var t=e.target,o=e.currentTarget,u=S(t)||S(t.parentNode);t.closest("."+i.cls)?e.stopPropagation():(u&&M(),m.uc_mini||T()||u||setTimeout(function(){var e,t,i,u,c;T()||(u=r(i=o,"data-id"),(c=n.indexOf(u))>=0?(n.splice(c,1),a("mi_selected",i),delete C[u]):(n.push(u),s("mi_selected",i),C[u]=l("msg_item_important",i)),k(),e=window.lang,t=Math.max(n.length,1),d(f("messagesActions__row_counter"),p(t,e.mobile_mail_messages_selected).replace("{count}",t)))},40))}),remove:E(x),reply:E(function(e,t,i){o=!0,A(e),h.click("/attachments",{},{url_params:{act:"add",target:"mail"+t,hash:i,object:"mail"+n.join(";"),community:D()}})}),forward:E(function(i,r){o=!0,A(i),e="mail"+n.join(";"),t=r;var a=D(),s=a?"?community="+a:"";v.go(location.pathname+s,null,{ignore_cur_process:!0})}),spam:E(function(e,t,n){x(e,t,n,!0)}),close:E(M),toggleImportant:E(function(e){var t,i=n.length,o=0;for(t=0;t<i;t++)if(!C[n[t]]){o=1;break}for(t=0;t<i;t++)u("msg_item_important",f("_msg"+n[t]),1===o);h.post("/mail",{_ajax:1,act:"mark_important",ids:n,val:o,hash:e}),M()}),hasFwdMessages:I,attachFwdMessages:function(n){h.click("/attachments",{},{url_params:{act:"add",target:"mail"+n,hash:t,object:e,community:D()}}),e=""}}}();function D(){return v.getQuery("community")}window.MessagesActions=b},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o,r,a=(i=["\n    <",' class="','" '," ",">\n      ","\n    </",">\n  "],o=["\n    <",' class="','" '," ",">\n      ","\n    </",">\n  "],Object.freeze(Object.defineProperties(i,{raw:{value:Object.freeze(o)}}))),s=n(77),l=(r=s)&&r.__esModule?r:{default:r};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=l.default.list(e.inner),n=void 0,i=void 0;e.url?(n="a",i=l.default.attr("href",e.url)):(n=e.tag||"div",i="");return l.default.html(a,n,e.mix,i,e.attrs,t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(152)),o=r(n(209));function r(e){return e&&e.__esModule?e:{default:e}}Object.assign(i.default,{accept:function(e,t,n){o.default.setLoading(t,!0),ajaxRequest("/mail",{act:"mrs_accept",peer_id:n,hash:store.mail.hash.mrs},function(e){e.error&&o.default.setLoading(t,!1)},function(){o.default.setLoading(t,!1)})},reject:function(e,t,n){o.default.setLoading(t,!0),ajaxRequest("/mail",{act:"mrs_reject",peer_id:n,hash:store.mail.hash.mrs},function(e){e.error&&o.default.setLoading(t,!1)},function(){o.default.setLoading(t,!1)})}}),t.default=i.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{!i&&s.return&&s.return()}finally{if(o)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.getConnectionType=function(){var e=navigator.connection;if(!e)return"";var t=e.effectiveType,n=e.downlink;switch(t){case"slow-2g":return"GPRS";case"2g":return"EDGE";case"3g":return"3G";case"4g":return n>8?"wi-fi":"LTE"}return""},t.saveNavigationStatEvent=function(e){var t=e.storyRawId,n=e.source,r=e.action,a=t.split("_"),s=i(a,2),l=s[0],u=s[1];"reply"===n&&(n="replies_list");var c={ownerId:l,storyId:u,source:n,action:r};o.push(c)},t.serializeNavigationStats=function(){var e=o.map(function(e){var t=e.ownerId,n=e.storyId,i=e.source,o=e.action;return[t,n,i,o].join(",")}).join(";");return o=[],e},t.saveViewerStartTime=function(e){var t=e.storyRawId,n=e.source,o=e.time,a=t.split("_"),s=i(a,2),l=s[0],u=s[1],c={ownerId:l,storyId:u,source:n,time:o};r.push(c)},t.serializeLoadingStats=function(){var e=r.map(function(e){var t=e.ownerId,n=e.storyId,i=e.source,o=e.time;return[t,n,i,o].join(",")}).join(";");return r=[],e};var o=[];var r=[];t.hasStatToSerialize=function(){return r.length||o.length}},function(e,t,n){"use strict";Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(279),r=(i=o)&&i.__esModule?i:{default:i},a=n(235);function s(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=window.lang;if(!t&&!n)return null;var r={showMedias:[o.mobile_mail_show_medias,"attach"],deleteHistory:[o.mobile_mail_delete_history,"delete"],blockCommunity:[o.mobile_mail_block_community,"block"],unblockCommunity:[o.mobile_mail_unblock_community,"allow"],chatAdd:[o.mobile_mail_add_to_chat,"plus"],chatUnpinMsg:[o.mobile_mail_unpin_msg,"unpin","unpin"],chatShowPinnedMsg:[o.mobile_mail_pin_show,"show","showPinned"],chatHidePinnedMsg:[o.mobile_mail_pin_hide,"hide","hidePinned"],chatInfo:[o.mobile_mail_chat_info,"info"],chatDeleteHistory:[o.mobile_mail_delete_chat_history,"delete"],chatReturn:[i?o.mobile_mail_return_to_channel:o.mobile_mail_chat_return,"revert","returnToChat"],chatLeave:[i?o.mobile_mail_channel_leave:o.mobile_mail_chat_leave,"close16","leaveChat"],markAsAnswered:[o.mobile_mail_mark_as_answered,"answered"],removeImportantMark:[o.mobile_mail_remove_important_mark,"important"],markAsImportant:[o.mobile_mail_mark_as_important,"important"],unbanUser:[o.mobile_settings_blacklist_unban_user,"allow"],banUser:[o.mobile_settings_blacklist_ban_user,"block"],inviteLink:[i?o.mobile_mail_channel_invite_link:o.mobile_mail_invite_link,"invite"]},a={text:r[e][0],icon:r[e][1],attrs:n,url:t};return r[e][2]&&(a.name=r[e][2]),a}t.default=function(){var e=store.mail.cur.peerId,t=store.mail.cur.page;if(e)return function(e){var t=store.mail,n=t.peers[e],i=e>2e9,o={title:n.title,photos:n.avatarImages,actions:function(e){var t=store.mail,n=t.peers[e].actionUrls,i=t.peers[e].isChannel,o=[];o=e>-2e9&&e<0?[s("showMedias",n.showMedia),s("deleteHistory",n.flushHistory),s("blockCommunity",n.blockCommunity),s("unblockCommunity",n.unblockCommunity)]:e>2e9?[s("chatInfo",n.chatInfo,"",i),s("chatAdd",n.addToChat),s("inviteLink",n.inviteLink,"",i),s("showMedias",n.showMedia),n.unpinMsg?s("chatUnpinMsg",n.unpinMsg):"",n.unpinMsg?s("chatShowPinnedMsg",null,'onmousedown="uMessenger.onShowPinnedMsgClick()"'):"",n.unpinMsg?s("chatHidePinnedMsg",null,'onmousedown="uMessenger.onHidePinnedMsgClick()"'):"",s("chatDeleteHistory",n.flushHistory),s("chatReturn",n.returnToChat,"",i),s("chatLeave",n.leaveChat,"",i)]:t.cur.groupId?[s("showMedias",n.showMedia),s("markAsAnswered",n.communityMarkAsAnswered),n.isDialogImportant?s("removeImportantMark",n.communityToggleImportant):s("markAsImportant",n.communityToggleImportant),n.isBlacklisted?s("unbanUser",n.userBan):s("banUser",n.userBan),s("deleteHistory",n.flushHistory)]:[s("showMedias",n.showMedia),s("deleteHistory",n.flushHistory)];return o}(e),editing:t.cur.editing};if(i){var r=i?e-2e9:null;if(o.url="/mail?act=info&chat="+r,o.membersCount=n.countMembers,o.hasPinnedMsg=n.hasPinnedMsg,o.isChannel=n.isChannel,o.isChannel){var l=-n.ownerId;o.url="/club"+l}}else o.url=n.profileUrl,o.isOnline=n.isOnline,o.onlinePlatform=n.onlinePlatform,o.offlineText=n.offlineText;return(0,a.MailHat_convo)(o)}(e);if(t)return function(e){return(0,a.MailHat_page)(e)}(t);return n=store.mail.cur,i=Math.abs(n.groupId),o=i?"&community="+i:"",l=i?"?community="+i:"",(0,a.MailHat_main)({folder:n.folder,urls:{all:"/mail"+l,unrespond:"/mail?act=unrespond"+o,unread:"/mail?act=unread"+o,important:"/mail?act=important"+o},unreadCount:n.countUnread,importantCount:n.countImportant,withUnrespond:!!i,forwarding:!!n.forwardFromId,notifier:(0,r.default)()});var n,i,o,l}},function(e,t,n){"use strict";var i,o=n(72);(i=o)&&i.__esModule;var r="tabs_block",a="mhb_back",s="TopMenu_open",l="TopMenu__switcher_on",u=function(){return geByClass1(r)},c=function(){return geByClass1(a)},d=function(){return geByClass1("TopMenu__switcher")},f=function(){return geByClass1("tab_item_top")},p=!0,_=0;function A(e){stopEvent(e),preventEvent(e),_=300,p&&(toggleClass(l,d()),"touchstart"===e.type&&setTimeout(function(){nav.go(f(),null)},130))}function m(e){gpeByClass(r,e.target)||gpeByClass(a,e.target)||(stopEvent(e),preventEvent(e),removeClass(s,u()),h())}function h(){removeEvent(window,"touchstart mousedown",m)}window.TopMenu={onHeaderClick:function(e){if(!p)return;var t=u();if(stopEvent(e),preventEvent(e),hasClass(s,t))removeClass(s,t);else{var n=c(),i=f();addClass(s,t),geByClass1("_hfixed")&&setStyle(t,"max-height",window.innerHeight-70),append(t,n),addEvent(window,"touchstart mousedown",m),addEvent(i,"touchstart mousedown",A),addEvent(i,"click",function(e){stopEvent(e),preventEvent(e)}),cur.destroy.push(h),cur.destroy.push(function(){return removeEvent(i,"touchstart mousedown",A)})}}},nav.onBeforeGo(function(){p=!1,setTimeout(function(){removeClass(s,u()),_=0,p=!0},_)})},function(e,t,n){"use strict";var i=window,o=i.Groups,r=i.Friends,a=i.FeedAssistanceStats,s=i.hasClass,l=(i.each,i.geByClass1),u=i.nav,c=i.domCA,d=i.domPN,f=i.page,p=i.ge,_=i.addEvent,A=i.attr,m=i.escapeAttr;window.FeedAssistanceExploreBait={onSubscribeLinkClick:function(e,t,n,i,u,d){var f=s(e,h),p=f?i:n,_=f?getLang(b):getLang(w),S=!f,k=l(y,e),T=(x=e,I=c(x,E),intval(domData(I,"block-id")));var x,I;k&&(toggleClass(v,k,S),toggleClass(g,k,!S));A(e,"aria-label",m(_)),toggleClass(h,e,S),u===C?function(e,t,n,i){var r=n?o.leave:o.enter,s=n?a.EVENTS.SUB_EVENT_EXPLORE_BAIT_UNSUBSCRIBE:a.EVENTS.SUB_EVENT_EXPLORE_BAIT_SUBSCRIBE;i&&M(s),r.call(o,e,t,D)}(t,p,f,d):function(e,t,n,i,o){var s=n?r.decline:r.accept,l=n?a.EVENTS.SUB_EVENT_EXPLORE_BAIT_UNSUBSCRIBE:a.EVENTS.SUB_EVENT_EXPLORE_BAIT_SUBSCRIBE;o&&M(l),s.call(r,e,t,D,i)}(t,p,f,T,d);return!1}},a.registerTrackingCls("post_exploreBait"),a.onStartViewElement(function(e){if(a.getElementType(e)===a.BLOCKS.BLOCK_TYPE_EXPLORE_BAIT){if(e._exploreBaitClickHandlerAdded)return;S=!0,_(e,"click",function(e){!function(e){var t=e.target,n=!0,i=!1,o=void 0;try{for(var r,a=T[Symbol.iterator]();!(n=(r=a.next()).done);n=!0){var s=r.value;if(!0===s.call(null,t))return}}catch(e){i=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(i)throw o}}}(e)}),e._exploreBaitClickHandlerAdded=!0}}),u.onBeforeGo(function(e){if(!S)return void(k=!1);if(!function(e){return e.tagName&&"explore-bait"===domData(e,"post-type")}(e))return;k=s("item_replies",e),function(e){var t=!0,n=!1,i=void 0;try{for(var o,r=["pi_text_more","wi_date","pi_text","i_replies","v_replies","item_replies"][Symbol.iterator]();!(t=(o=r.next()).done);t=!0){var l=o.value;if(s(l,e))return M(a.EVENTS.SUB_EVENT_EXPLORE_BAIT_OPENED),!0}}catch(e){n=!0,i=e}finally{try{!t&&r.return&&r.return()}finally{if(n)throw i}}}(e)}),f.onChange(function(){if(!S)return;k&&(e=p("nc_submit"),_(e,"click",function(){M(a.EVENTS.SUB_EVENT_EXPLORE_BAIT_COMMENT)}));var e});var h="post__subscribeBtn_unsubscribe",v="post__subscribeBtnIcon_unsubscribe",g="post__subscribeBtnIcon_subscribe",y="post__subscribeBtnIcon",w="mobile_groups_you_are_in_public",b="mobile_groups_public_subscribe",D="feed",C="group",E=".post_exploreBait",S=!1,k=!1;function M(e){a.dispatchEvent({type:a.EVENTS.EVENT_EXPLORE_BAIT,data:a.serializeEventData(a.EVENTS.EVENT_EXPLORE_BAIT_SUB,e)})}var T=[function(e){if("A"!==e.tagName||!s("item_sel",e))return s("item_like",e)?(M(a.EVENTS.SUB_EVENT_EXPLORE_BAIT_LIKE),!0):!s("i_like",e)&&!s("v_like",e)||s("item_sel",d(e))?void 0:(M(a.EVENTS.SUB_EVENT_EXPLORE_BAIT_LIKE),!0)},function(e){if(domData(e,"post-owner-type"))return M("user"===domData(e,"post-owner-type")?a.EVENTS.SUB_EVENT_EXPLORE_BAIT_OPEN_USER:a.EVENTS.SUB_EVENT_EXPLORE_BAIT_OPEN_GROUP),!0},function(e){var t={report:a.EVENTS.SUB_EVENT_EXPLORE_BAIT_REPORT,hide:a.EVENTS.SUB_EVENT_EXPLORE_BAIT_HIDE}[domData(e,"post-action")];if(t)return M(t),!0}]},function(e,t,n){"use strict";var i=n(322);window.VotingStatsFilters={},VotingStatsFilters._onCountryChange=r;var o={countrySection:".VotingStatsFilters__section_country",citySection:".VotingStatsFilters__section_city"};function r(e){var t=e.$option,n=(0,i.$)(o.countrySection),r=(0,i.$)(o.citySection),a=t.getAttribute("data-city-section-html");r&&(r.outerHTML=""),a&&n.insertAdjacentHTML("afterend",a)}},function(e,t,n){"use strict";n(200),n(105),n(351),n(97),n(20),n(161),n(263),n(53),n(133),n(114),n(332),n(269),n(62),n(165),n(134),n(349),n(197),n(195),n(177),n(180),n(31),n(185)},function(e,t,n){"use strict";var i=window,o=i.parseRusKeys,r=i.parseLatKeys,a=i.parseLat,s=i.parseCyr,l=i.escapeRE,u=i.val,c=i.onBodyScrollForce,d=i.extend,f=i.len,p=i.removeClass,_=i.geByClass1,A=i.addClass,m=i.show,h=i.hide,v=i.alLoadingFix,g=i.cancelEvent,y=i.elfocus,w=i.elblur,b=i.ge,D=i.addEvent,C=i.attr,E=i.initAutoScroll,S=window.ajax;function k(e){var t,n,i,M,T,x;k.getQueryREs=le;var I,P,B,F,L,O=[],N={},R={},j={},H={},V=!1,$=null,U=null,z=null,q=0,W=[],Y=null,G=null,X=null,Q=!1,K=!1,J=10,Z=30,ee=!0,te=!1,ne=!1,ie=!1,oe=0,re=0,ae=!1,se=e&&"au_search_field"===e.field&&C(b(e.field),"data-newsearch");function le(e){e=e.replace(/https?:\/\/(m\.)?vk\.com\/([^#]+#\/)?/,"");for(var t,n,i,u=K,c=[e,n=o(e,u)||e,i=r(e,u)||e,a(n),s(i)],d={},f=[],p=0,_=c.length;p<_;p++)c[p]&&!d[c[p]]&&(d[c[p]]=!0,t=(t=l(c[p])).replace(/[её]/gi,"[её]").replace(/(e|yo)/gi,"(?:e|yo)"),f.push(new RegExp("(^|\\s|\\(|>)("+t+")","gi")));return f}function ue(e,n,o){if(clearTimeout(U),!o)return U=setTimeout(function(){ue(e,n,!0)},10),!1;var r=u(e)||"";if($==r)return!1;var a,s="_"+r,l=R[s],m=le(r);if(!se&&!l&&r.length>2&&R["_"+r.slice(0,-2)]){var h="_"+r.slice(0,-2);R[h]&&H[h]&&!R[h].length&&(!ie||ie&&!j[h])&&(H[s]=!0,l=R[s]=[],ie&&(j[s]=""))}if(!l){l=[];if(!r&&O.length)for(var v=q,g=q+Math.min(J,O.length);v<g;v++)l.push([O[v]]),0;else{var y={},w=0;for(v=0,g=O.length;v<g;v++){var b=O[v];if(N[b]){if(y[b]=!0,(a=ce(m,N[b][0]))&&(l.push([b,a]),++w>=Z))break;0}}if(w<Z)for(var b in N)if(!y[b]&&(a=ce(m,N[b][0]))){if(l.push([b,a]),++w>=Z)break;0}}H[s]=H[s]||!r&&O.length||l.length>2*J,H[s]=H[s]||ie&&l.length>J}return H[s]||!ee&&!ie||I||function e(n,o,r){var a=se?800:200;clearTimeout(z);if(!r)return z=setTimeout(function(){e(n,o,!0)},a),!1;S.post(t,{_ajax:1,q:o},{onDone:function(e,t,i){P&&P.apply(null,arguments);for(var r,a="_"+o,s=R[a]||[],l={},u=le(o),_=0,A=s.length;_<A;_++)l[s[_][0]]=!0;for(var _=0,A=t.length;_<A;_++){var m=t[_];l[m]||((r=ce(u,e[m][0]))||Q||!o)&&s.push([m,r])}H[a]=!0,R[a]=s,ie&&(j[a]=i||""),N=d(e,N),ee=!te||f(N)<te,$==o?(de(s,j[a]),c()):delete R[a],p("input_loading",n)},onFail:function(){delete R["_"+o],p("input_loading",n)}});_("al_loading",i)||A("input_loading",n)}(e,r),R[s]=l,$=r,de(l,j[s]),B&&B(r),ne&&!$&&(oe=J),c(),!1}function ce(e,t){if(!t)return!1;var n=[t],i=/([№])/gi;-1!==t.search(i)&&n.push(t.replace(i,""));for(var o=0;o<n.length;o++)for(var r=0,a=e.length;r<a;r++)if(-1!==n[o].search(e[r]))return e[r];return!1}function de(e,t){var n="";if(G&&i){for(var o=0,r=e.length;o<r;o++){var a=e[o][0],s=e[o][1];if(N[a]){var l=N[a].slice(1);if(s)for(var c in W){var d=W[c];l[d]&&(l[d]=l[d].replace(s,'$1<em class="found">$2</em>'))}n+=G.apply({id:a,q:$,highlight:function(e){return(""+e).replace(s,'$1<em class="found">$2</em>')},template:function(e,t){return(""+e).replace(/%(\d+)%|#(\d+)#/g,function(e,n,i){return+i?(""+t[i-1]).replace(s,'$1<em class="found">$2</em>'):+n&&t[n-1]||""})}},l)}}n||H["_"+$]||!ee&&!ie||I||(p("input_loading",M),p("_si_container_loading",i),n=$?'<div class="al_loading qs_loading">&nbsp;</div>':'<div id="al_loading"></div>'),!n&&X&&(n=X($)),u(i,Y?Y(n,$,ne,t):n+(t||"")),x&&($?m(x):h(x)),!$&&v(),F&&F($)}}d(this,{go:function(e){return!M||(ue(M,e,!0),M.blur(),g(e),!1)},redraw:function(){var e="_"+$;de(R[e],j[e]),c()},clear:function(e,t){return u(M,""),t?y(M):w(M),ue(M,e,!0),g(e),!1},blur:function(){w(M)},init:function(e){i=b((e=e||{}).container)||null,M=b(e.field)||null,T=b(e.btn)||null,x=b(e.clear_btn)||null,$=null,V&&t==e.action&&e.init_once||(R={},j={},H={},t=e.action||"",n=e.al_action||t,O=e.top_items||[],N=e._cache||{},W=e.hl_fields||[],Y=e.tpl||null,G=e.item_tpl||null,X=e.null_tpl||null,Q=e.soft_filter||!1,K=e.need_invalid_keys||!1,J=e.top_len||10,te=e.load_limit||!1,P=e.onLoaded||!1,B=e.onFiltered||!1,F=e.onRendered||!1,L=e.onFocusChanged||!1,ne=e.al_need||!1,q=!ne&&e.init_offset||0,ie=e.global_search||!1,I=e.no_search_query||!1);var o=null;t&&i&&M&&G&&(ee=!0!==t&&(!te||f(N)<te),D(M,"focus",function(e){clearTimeout(o),L&&L.call({q:$},!0),function t(n){!n&&ue(M,e,!0),o=setTimeout(t,100)}(!0)}),D(M,"keydown keypress change blur",function(e){"blur"==e.type&&(clearTimeout(o),L&&L.call({q:$},!1)),ue(M,e,"keydown"!=e.type&&"keypress"!=e.type)}),e._new||T&&!C(T,"onclick")&&C(T,"onclick","return qsearch.go(event);"),!ne||V&&e.init_once||(oe=J,re=f(N),E(function(){var e=(_("_si_container",i)||i).childNodes;return e[oe]||e[e.length-1]},function(){var e=_("_si_container",i)||i;if(!ae&&!$)if(oe+J>re&&ee)ae=!0,A(e,"_si_container_loading"),S.post(n,{_ajax:1,offset:re},{onDone:function(n,i){P&&P.apply(null,arguments);var o=f(n);if(ae=!1,p(e,"_si_container_loading"),te||(O=O.slice(0,re).concat(i)),re+=o,N=d(n,N),ee=!0!==t&&(!te&&o||f(N)<te),!$){oe+=J;for(var r=[],a=0,s=Math.min(oe,O.length);a<s;a++)r.push([O[a]]);de(r,j._),c()}},onFail:function(){ae=!1,p(e,"_si_container_loading")}});else if(oe<O.length){oe+=J;for(var o=[],r=0,a=Math.min(oe,O.length);r<a;r++)o.push([O[r]]);de(o,j._),c()}})),!e.skip_init_filter&&ue(M,null,!0),V=!0)}}),e&&this.init(e)}var M=new k;window.QuickSearch=k,window.qsearch=M},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(219),r=(i=o)&&i.__esModule?i:{default:i};n(47),t.default=r.default,window.Typing=r.default,Object.assign(window,{Typing_renderNames:o.Typing_renderNames,Typing_isEmpty:o.Typing_isEmpty})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(115),r=(i=o)&&i.__esModule?i:{default:i};n(214),t.default=r.default,window.MailActs=r.default},function(e,t,n){"use strict";var i=[];[window.Element,window.CharacterData,window.DocumentType].forEach(function(e){e&&i.push(e.prototype)}),i.forEach(function(e){e.hasOwnProperty("remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){null!==this.parentNode&&this.parentNode.removeChild(this)}})})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=c(['\n    <div class="','">\n\n      ','\n\n      <div class="mailActs__counter"></div>\n\n      <div class="mailActs__buttons">\n        <div class="mailActs__buttonsIn">\n          ',"\n          ",'\n        </div>\n        <div class="mailActs__chevron">\n          <div class="mailActs__chevronIn">\n            ',"\n            ","\n            ","\n            ","\n            ",'\n          </div>\n          <div class="mailActs__chevronMore">\n            <div class="mailActs__chevronMoreIcon" ','></div>\n            <div class="mailActs__chevronList">\n              ',"\n              ","\n              ","\n              ","\n              ","\n            </div>\n          </div>\n        </div>\n      </div>\n\n    </div>\n  "],['\n    <div class="','">\n\n      ','\n\n      <div class="mailActs__counter"></div>\n\n      <div class="mailActs__buttons">\n        <div class="mailActs__buttonsIn">\n          ',"\n          ",'\n        </div>\n        <div class="mailActs__chevron">\n          <div class="mailActs__chevronIn">\n            ',"\n            ","\n            ","\n            ","\n            ",'\n          </div>\n          <div class="mailActs__chevronMore">\n            <div class="mailActs__chevronMoreIcon" ','></div>\n            <div class="mailActs__chevronList">\n              ',"\n              ","\n              ","\n              ","\n              ","\n            </div>\n          </div>\n        </div>\n      </div>\n\n    </div>\n  "]),o=c(['\n    <button class="','" ',">\n      ","\n    </button>\n  "],['\n    <button class="','" ',">\n      ","\n    </button>\n  "]),r=c(['\n    <button class="','" aria-label="','" ',"></button>\n  "],['\n    <button class="','" aria-label="','" ',"></button>\n  "]),a=c(['\n    <div class="','" ',">","</div>\n  "],['\n    <div class="','" ',">","</div>\n  "]),s=u(n(77)),l=u(n(355));function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function d(e){var t=window.lang,n=s.default.class("mailActs__button",{type:e}),i=s.default.onClick("MailActs._onButtonClick",e),r="reply"===e?t.mobile_mail_messages_actions_reply:t.mobile_mail_messages_actions_forward;return s.default.html(o,n,i,r)}function f(e,t){var n=window.lang,i=s.default.class("mailActs__icon",{type:e}),o=s.default.onClick("MailActs._onButtonClick",e),a=t.isPinned?n.mobile_mail_messages_actions_unpin:n.mobile_mail_messages_actions_pin,l=t.isImportant?n.mobile_mail_messages_actions_important_off:n.mobile_mail_messages_actions_important,u=void 0;switch(e){case"edit":u=n.mobile_mail_messages_actions_edit;break;case"pin":u=a;break;case"important":u=l;break;case"remove":u=n.mobile_mail_messages_actions_delete;break;case"spam":u=n.mobile_mail_messages_actions_spam}return s.default.html(r,i,u,o)}function p(e,t){var n=window.lang,i=s.default.class("mailActs__chevronListItem",{type:e}),o=s.default.onClick("MailActs._onButtonClick",e),r=t.isPinned?n.mobile_mail_messages_actions_unpin:n.mobile_mail_messages_actions_pin,l=t.isImportant?n.mobile_mail_messages_actions_important_off:n.mobile_mail_messages_actions_important,u=void 0;switch(e){case"edit":u=n.mobile_mail_messages_actions_edit;break;case"pin":u=r;break;case"important":u=l;break;case"remove":u=n.mobile_mail_messages_actions_delete;break;case"spam":u=n.mobile_mail_messages_actions_spam}return s.default.html(a,i,o,u)}t.default=function(e){e||(e={});window.lang;var t=s.default.onClick("MailActs._onMoreClick"),n=(0,l.default)({mix:"mailActs__close",icon:"close12",attrs:s.default.onClick("MailActs._onCloseClick")}),o=d("reply"),r=d("forward"),a=f("edit",e),u=f("pin",e),c=f("important",e),_=f("remove",e),A=f("spam",e),m=p("edit",e),h=p("pin",e),v=p("important",e),g=p("remove",e),y=p("spam",e),w=s.default.class("mailActs",{canPin:e.canPin,pinned:e.isPinned,important:e.isImportant,isChannel:e.isChannel});return s.default.html(i,w,n,o,r,a,u,c,_,A,t,m,h,v,g,y)}},function(e,t,n){"use strict";var i,o=n(215),r=(i=o)&&i.__esModule?i:{default:i};var a,s=window,l=s.qs2obj,u=s.preventEvent,c=s.im,d=s.nav,f=s.toggle,p=s.attr,_=s.ge,A=s.val,m=s.geByClass1,h=s.removeClass,v=s.show,g=s.hide,y=s.qsearch,w=s.toggleClass,b=s.intval,D=s.mail;function C(){return l(d.params)}function E(e){return"dialogs"===e.tab||!e.q}function S(e){var t=d.getQuery("community");return t?(e?"?":"&")+"community="+t:""}function k(){var e=window.lang;y.init({init_once:!0,action:"/mail?act=write&fast=1",container:_("ma_search_items"),field:_("ma_search_field"),btn:_("ma_search_btn"),top_items:[],_cache:{},item_tpl:function(e,t,n,i,o){return this.id>2e9||-1===this.id?'<a href="'+(e||"")+'" class="simple_item'+(-1==this.id?" simple_item_create":"")+'">'+(t||"")+'<div class="si_body"><span class="si_owner">'+this.highlight(n||"")+"</span>"+(i||"")+(o?'<div class="si_slabel">'+o+"</div>":"")+"</div></a>":'<a href="'+(e||"")+'" class="inline_item"><div class="ii_body">'+(t||"")+'<span class="ii_owner">'+this.highlight(n||"")+"</span>"+(i||"")+"</div></a>"},null_tpl:function(){return'<div class="service_msg_box"><div class="service_msg service_msg_null">'+e.mobile_mail_no_peers+"</div></div>"},need_invalid_keys:r.default.desktop,onLoaded:function(e){for(var t in e)D.saveDialog(e[t][e[t].length-1],t)}})}c.clearSearchInput=function(e){if(u(e),E(C())){var t=_("ma_search_field");A(t,""),c.onFilterKeyDown(t)}else d.go("/mail"+S(!0))},c.onFilterKeyDown=function(e){setTimeout(function(){var t=window.lang,n=encodeURIComponent(e.value),i=C();if(f(m("mail_search_clear_button"),n),p(m("tab_dialogs_search"),"href",n?"/mail?tab=dialogs&q="+n+S():"/mail"+S(!0)),p(m("tab_messages_search"),"href","/mail?q="+n+S()),E(i)){var o,r=_("mail_tabs"),s=_("ma_search_items"),l=_("dialogs"),u=i.offset;if(h("mail_show_filtered",m("mail")),a&&clearTimeout(a),w("dialogs_filter_without_important",_("dialogs_filter"),n||0===b(A(m("dialogs_filter_button_important")))),n)v(r),v(s),g(l),a=setTimeout(function(){o="/mail?tab=dialogs&q="+n+(u?"&offset="+u:"")+S(),"/mail"!==d.path||C().act||d.go(o,null,{push_only:!0})},200);else{if(g(r),g(s),v(l),!d.getQuery("community")){var c=m("mhb_back"),y=m("mh_header");A(y,t.mobile_mail_head_title),h("mhi_back",y),c.outerHTML=c.outerHTML.replace("<a","<div").replace("</a>","</div>")}o="/mail"+(u?"?offset="+u:"")+S(!u),d.go(o,null,{push_only:!0})}}},40)},D.onShowWritePageFromCache(k),D.onShowDialogsPageFromCache(k)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(322),o=s(n(72)),r=s(n(215)),a=n(1);function s(e){return e&&e.__esModule?e:{default:e}}var l=window.clog,u={onBeforeRedirect:(0,o.default)("url"),onBeforePageParse:(0,o.default)(),onRedirect:(0,a.se)(),_tStart:!1,_tAlStart:!1,RESPONSE_CAPTCHA:2,_init:function(){try{new XMLHttpRequest&&(u._req=function(){return new XMLHttpRequest})}catch(t){var e=window.ActiveXObject;try{new e("Msxml2.XMLHTTP")&&(u._req=function(){return new e("Msxml2.XMLHTTP")})}catch(t){try{new e("Microsoft.XMLHTTP")&&(u._req=function(){return new e("Microsoft.XMLHTTP")})}catch(e){u._req=!1}}}},_getreq:function(){return u._req||u._init(),u._req()},_al_reqs:[],_last_req:null,save_req:function(e){u._al_reqs.push(e||u._last_req)},abort_reqs:function(){(0,a.each)(u._al_reqs,function(e,t){t.readyState<4&&t.abort()}),u._al_reqs=[]},_failed_relogin:!1,_failed_reqs:[],save_failed_req:function(e,t,n,i){u._failed_reqs.push([e,t,n,i])},repeat_reqs:function(){(0,a.each)(u._failed_reqs,function(){var e=this.shift();u._post.apply(null,this),(0,a.remove)(e)}),u._failed_reqs=[]},plainpost:function(e,t,n,i,o,r,s,l){var c=u._last_req=u._getreq(),d="string"!=typeof t?(0,a.ajx2q)(t):t;c.onreadystatechange=function(){4==c.readyState&&(c.status>=200&&c.status<300?n&&n(c.responseText,c):i&&i(c.responseText,c))};try{c.open("POST",e,!0)}catch(e){return!1}return c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o||l||c.setRequestHeader("X-Requested-With","XMLHttpRequest"),c.send(d),c},post:function(e,t,n){return"/"!=e.substr(0,1)&&(e="/"+e),e=e.split("#")[0],u._post(e,t,n||{})},onPrepared:(0,a.se)(),prepare_click:function(e){var t=window.al;if(r.default.ios&&!(r.default.ios>=7)&&window.al&&t.ver){var n=[],i=!1;e&&"a"==(e.tagName||"").toLowerCase()?n.push(e):(0,a.isArray)(e)?n=e:(n=(0,a.geByTag)("a",e),i=!0);for(var o=0,s=n.length;o<s;o++){var l=n[o],u=l&&l.target||"";if(l&&l.getAttribute&&(!i||!l.getAttribute("data-href")&&(0,a.checkElementNav)(l,{skip_onclick:!0})&&"_blank"!=u)){var c=l.getAttribute("href");if(null==c||!(0,a.isHttpHref)(c))continue;(0,a.attr)(l,"data-href",(0,a.getHref)(l)),(0,a.attr)(l,"href",!1)}}}},click:function(e,t,n){var i=window.nav;t=t||{};var o,r=!1,s={_ajax:1},l=(0,a.extend)(t,{link:e});if(n=n||{},t.onStart){var c=u.tAlGetParam();u.tAlStart=(new Date).getTime(),c&&(s._talstat=c)}if(n.use_cache){var d=(0,a.ge)(!0===n.use_cache?"preload_data":n.use_cache),f=d.innerHTML.replace(/(^<!--|-->$)/g,""),p=f.split("--\x3e\x3c!--");if(f)d.innerHTML="",t.onStart&&t.onStart.apply(l),n.nav&&i.go(r,null,{push_only:!0}),t.onDone&&t.onDone.apply(l,p),(e=(0,a.geByClass1)("show_more",(0,a.geByClass1)("pcont","mcont")))&&u.click(e,{onDone:function(){var e="";(0,a.each)(arguments,function(t,n){e+="\x3c!--"+(n||"")+"--\x3e"}),d.innerHTML=e,(0,a.ge)("show_more_loading")&&u.click(!1,t,n)}});else t.onStart&&t.onStart.apply(l),n.nav&&i.go(r,null,{push_only:!0});return!1}if(!e)return!0;if(e.form){if(e.disabled)return!0;var _=e.form,A={};r=(_.action||"").replace(/^https?:\/\/[^\/]+/i,""),(0,a.each)(_,function(t,n){return!(n.name&&!n.disabled)||("radio"===n.type&&!n.checked||("checkbox"===n.type&&!n.checked||("button"===n.type||("submit"===n.type&&n!==e||("image"===n.type&&n!==e||void(A[n.name]=n.value))))))}),"image"==e.type&&(A[e.name]=e.value,A[e.name+".x"]=1,A[e.name+".y"]=1),_.method&&"get"!=_.method?(0,a.extend)(s,A):r=r.split("?",1).shift()+(0,a.obj2qs)(A)}else e.getAttribute&&(r=e.getAttribute("data-href")||e.getAttribute("href"));if(r||(r=e.pathname?e.pathname+e.search+e.hash:e),!r)return!0;(0,a.extend)(s,n.url_params||{});var m=window.pStats,h=m.getSeenData();if(h){var v=window.cur;s._pstat=h.data,v&&v.module&&(s._pstatref=v.module)}return(o=u.post(r,s,{onDone:function(){h&&m.onSend(h.seen),n.lock&&(0,a.unlockButton)(e),t.onDone&&t.onDone.apply(l,arguments),(n.nav||n.scroll)&&(0,a.scrollToHash)()},onFail:function(){n.lock&&(0,a.unlockButton)(e),t.onFail&&t.onFail.apply(l,arguments),(n.nav||n.scroll)&&(0,a.scrollToHash)()}}))&&(t.onStart&&t.onStart.apply(l),n.nav&&i.go(r,null,{push_only:!0}),n.lock&&(0,a.lockButton)(e)),!o},prepare_nav:function(e){},nav:function(e,t){var n=window.nav,o=window.page,s=window.menu,c=window.cur;(t=t||{}).nav=t.nav||{};var d,f=(0,a.getHref)(e),p=o.getHash(t.nav);if(!(f=n.checkUrl(f)))return!1;"/"!=f.substr(0,1)&&(f="/"+f),s.close(null,!0);var _=u.tGetParam();if(u.tStart=(new Date).getTime(),t.need_restore&&s&&s.closeSearch(),window.isNewMail&&(t.need_restore&&t.nav.push&&u.abort_reqs(),n.onBeforeGo2(t.nav.path,(0,a.qs2obj)(t.nav.params),t.nav.push,t)))return u.abort_reqs(),!0;if(t.need_restore&&t.nav.push&&(d=o.restore(p)))return u.abort_reqs(),d.lm&&(0,a.extend)(d.lm,{tn:!1,bn:!1}),o.set(p,d),t.zProcess&&(t.zProcess(d.st),delete t.zProcess),n.set(t),u.tModule=window.cur.module,u.tRestoreRender=(new Date).getTime(),!0;var A=!1,m=!1;if(t.fast)A=!0,o.set(p,!1,{before:!0,beforeAppend:t.beforeAppend,afterAppend:t.afterAppend}),m=t.onAfterFast||!1;else if(t.target&&t.target.className){var h,v=(h=/(?:^|\s)(al_([a-z_]+)(-?[0-9]+)?)(?:\s|$)/i.exec(t.target.className))&&h[1]||!1,g=h&&h[2]||!1;switch(g){case"menu":A=!0,o.set(p,!1,{before:!0,beforeAppend:function(e){var n=(0,i.$)(".vk__page");if(n.className=n.className.replace("vk__page_notifications",""),window.isNewMail){var r=(0,a.geByClass1)("mcont",e)||(0,a.geByClass1)("layout__basis");(0,a.val)(r,'<div class="pcont bl_cont"><div id="al_loading"></div></div>')}else(0,a.val)((0,a.geByClass1)("mcont",e),'<div class="pcont bl_cont"><div id="al_loading"></div></div>');o.setMhead(e,(0,a.attr)(t.target,"data-header"),"/")},afterAppend:function(){window.isNewMail&&"/mail"===p?(0,a.alLoadingFix)((0,a.geByClass1)("layout").offsetHeight):(0,a.alLoadingFix)(),(0,a.scrollTop)(0)}});break;case"tab":A=!0,o.set(p,!1,{before:!0,beforeAppend:function(e){(0,a.val)((0,a.geByClass1)("upanel",e),'<div id="al_loading"></div>'),(0,a.val)((0,a.geByClass1)("basisDefault",e),'<div id="al_loading"></div>');var t=(0,a.geByClass1)("tabs_block",e)||(0,a.geByClass1)("tabs",e),n=(0,a.geByClass1)("active",t);n&&((0,a.hasClass)("tab_item_top",n)?((0,a.removeClass)("tab_item_cur",(0,a.geByClass1)("tab_item_cur",t)),(0,a.addClass)("tab_item_cur",(0,a.geByClass1)("tab_item",t))):((0,a.removeClass)("tab_item_cur",(0,a.geByClass1)("tab_item_cur",t)),(0,a.addClass)("tab_item_cur",n)))},afterAppend:function(){(0,a.alLoadingFix)()}},t);break;case"post":A=!0,o.set(p,!1,{before:!0,beforeAppend:function(e){var n=window.lang,i=(0,a.clone)((0,a.gpeByClass)("post_item",t.target)),r=i.id,s=(0,a.outer)((0,a.gpeByTag)("a",(0,a.geByClass1)("pi_img",i))).replace("pi_img","op_img"),l=(0,a.gpeByTag)("div",(0,a.geByClass1)("pi_author",i)),u=(0,a.remove)((0,a.geByClass1)("pi_date",i)),c=(0,a.outer)((0,a.remove)((0,a.geByClass1)("explain",l))),d=(0,a.remove)((0,a.geByClass1)("pi_fronly",i)),f=(0,a.outer)(l),p=(0,a.geByClass1)("pi_body",i),_=(0,a.geByClass1)("pi_text_more",p),A=(u=(0,a.geByClass1)("pi_date",i),(0,a.geByClass1)("pi_info",p)),m=(0,a.geByClass1)("pi_links",p),h=(0,a.geByClass1)("replies_link",m),v=(0,a.val)((0,a.remove)((0,a.geByClass1)("pi_actions_wrap",i))),g=(0,a.val)((0,a.remove)((0,a.geByClass1)("item_replies",A)))?(0,a.val)(h):n.mobile_wall_post_replies_title,y=h?'<a name="comments"></a><h4 class="slim_header">'+(g||"")+'</h4><div id="al_loading"></div>':"";if(_){var w=_.nextSibling?_:_.parentNode;w.nextSibling.style.display="inline",w.style.display="none"}(0,a.val)(m,(0,a.outer)((0,a.geByClass1)("like_wrap",p))),u&&(0,a.attr)(u,"data-date")&&(0,a.val)(u,(0,a.attr)(u,"data-date")),o.setMhead(e,(0,a.attr)(t.target,"data-header"),!0),(0,a.val)((0,a.geByClass1)("mcont",e),function(e,t,n,i,o,r,a,s){return'<div class="pcont bl_cont"><div class="owner_panel">'+(t||"")+'<div class="op_cont">'+(n||"")+'<div class="op_info"><span class="item_date">'+(i||"")+'</span></div></div></div><div id="'+(e||"")+'" class="post_item single_post_item"><div class="pi_cont"><div class="pi_head">'+(o||"")+'</div><div class="pi_body">'+(r||"")+"</div></div>"+(s||"")+"</div>"+(a||"")+"</div>"}(r,s,f,(0,a.val)(u)+(d?'<b class="pi_fronly"></b>':""),c,(0,a.val)(p),y,v))},afterAppend:function(e){var n=(0,a.geByTag1)("h4",e);n&&(0,a.alLoadingFix)(t.nav.hash?(0,a.getCh)()-n.offsetHeight:0),t.nav.hash?(0,a.scrollToHash)(t.nav.hash):(0,a.scrollTop)(0)}},t);break;case"wall":A=!0,o.set(p,!1,{before:!0,beforeAppend:function(e){var n=window.lang,i=(0,a.clone)((0,a.hasClass)("wall_item",t.target)?t.target:(0,a.gpeByClass)("wall_item",t.target)),r=i.id,s=(0,a.geByClass1)("wi_body",i),u=(0,a.geByClass1)("wi_buttons",i),c=(0,a.geByClass1)("item_like",u),d=(0,a.geByClass1)("v_like",c),f=(0,a.geByClass1)("item_share",u),p=(0,a.geByClass1)("v_share",f),_=(0,a.remove)((0,a.geByClass1)("item_replies",u)),A=!!_&&(0,a.geByClass1)("v_replies",_),m=+(0,a.stripTags)((0,a.val)(A)).replace(/\D/g,""),h=(0,a.geByClass1)("pi_text_more",s),v=(0,a.geByClass1)("wi_date",i),g=m?(0,a.langNumeric)(m,n.mobile_wall_post_comments):n.mobile_wall_post_replies_title,y=_&&m<50?'<a name="comments"></a><h4 class="slim_header">'+(g||"")+'</h4><div id="al_loading"></div>':"";if(l("item_replies",_),(0,a.remove)((0,a.geByClass1)("wi_actions_btn",i)),(0,a.remove)((0,a.geByClass1)("post__subscribeBtn",i)),(0,a.remove)((0,a.geByClass1)("post__extraHeader",i)),d?(0,a.val)(d):(0,a.append)((0,a.ce)("span",{className:"v_like"}),c),p?(0,a.val)(p):(0,a.append)((0,a.ce)("span",{className:"v_share"}),f),h){var w=h.nextSibling?h:h.parentNode;w.nextSibling.style.display="inline",w.style.display="none"}v&&(0,a.attr)(v,"data-date")&&(0,a.val)(v,(0,a.attr)(v,"data-date")),o.setMhead(e,(0,a.attr)(t.target,"data-header"),!0),(0,a.val)((0,a.geByClass1)("mcont",e),function(e,t,n){return'<div class="pcont"><div class="wall_item single_wall_item" id="'+(e||"")+'">'+(t||"")+"</div>"+(n||"")+"</div>"}(r,(0,a.val)(i),y))},afterAppend:function(e){var n=(0,a.geByTag1)("h4",e);n&&(0,a.alLoadingFix)(t.nav.hash?(0,a.getCh)()-n.offsetHeight:0),t.nav.hash?(0,a.scrollToHash)(t.nav.hash):(0,a.scrollTop)(0)}},t);break;case"pinfo":A=!0,o.set(p,!1,{before:!0,beforeAppend:function(e){var t=window.lang,n=(0,a.geByClass1)("owner_panel",e),i=(0,a.geByClass1)("pp_img",n),r=(0,a.geByClass1)("op_header",n),s=(0,a.geByClass1)("lvi",r),l=(0,a.geByClass1)("pp_last_activity",n),u=(0,a.ce)("div");(0,a.addClass)("mhi_back",(0,a.geByClass1)("mh_header",e)),(0,a.val)(n,'<img src="'+(0,a.escapeAttr)((0,a.attr)(i,"src")||"")+'" class="op_img"><div class="op_cont"><h2 class="op_header">'+(0,a.stripTags)((0,a.val)(r))+'</h2><div class="pp_online">'+(s?t.mobile_online:(0,a.val)(l))+"</div></div>"),(0,a.each)((0,a.geByClass)("_pinfo",e),function(e,t){u.appendChild(t)}),(0,a.val)((0,a.geByClass1)("ipanel",e),"<div>"+(0,a.val)(u)+'</div><div id="al_loading"></div>'),o.setMhead(e,!1,!0)},afterAppend:function(){(0,a.alLoadingFix)(),(0,a.scrollTop)(0,10)}},t);break;case"player":A=!0,o.set(p,!1,{before:!0,beforeAppend:function(e){var t=window.lang,n=window.audio,i=n.playlist(),r=n.playlist_q(),s=((i[0]||{}).id||"").split("_").slice(2).join("_")||"";o.setMhead(e,t.mobile_menu_player_head_title,!0),(0,a.val)((0,a.geByClass1)("mcont",e),'\n                <div class="pcont audioPage">\n                  <div class="audioPage__header">\n                    '+AudioPlaylist.tplPlayerSearch(s)+'\n                  </div>\n                  <div id="au_search_items" class="upanel bl_cont">\n                    <div class="audios_block audios_list _si_container" data-query="'+(0,a.escapeAttr)(r)+'"></div>\n                  </div>\n                </div>'),(0,a.val)("m",e.innerHTML)}},t),m=function(){var e=window.qsearch,t=window.audio,n=t.playlist(),i=((n[0]||{}).id||"").split("_").slice(2).join("_")||"",o="/audio"+(0,a.obj2qs)({act:"player",list:i}),s=[],l={};(0,a.each)(n,function(e,t){s.push(t.id);l[t.id]=[t.artist+" "+t.title,t.id,t.src,t.artist,t.title,t.dur,t.can_add,!1,t.cover_style,t.is_disabled,t.mix,t.subtitle,t.is_explicit]}),e.init({action:o,al_action:o,container:(0,a.ge)("au_search_items"),field:(0,a.ge)("au_search_field"),btn:(0,a.ge)("au_search_btn"),top_items:s,_cache:l,tpl:function(e,n,i,o){return n?o||(""==o?'<div class="audios_block audios_list _si_container" data-query="'+(0,a.escapeAttr)(n)+'">'+e+"</div>":'<div class="audios_block audios_list _si_container" data-query="'+(0,a.escapeAttr)(n)+'"><div class="al_loading qs_loading">&nbsp;</div></div>'):'<div class="audios_block audios_list _si_container" data-query="'+(0,a.escapeAttr)(t.playlist_q())+'">'+e+"</div>"},item_tpl:function(e,t,n,i,o,r,a,s,l,u,c,d){var f=window.audioplayer;return f&&f.getDOMFromAudio({id:e,src:t,dur:o,artist:this.highlight(n),title:this.highlight(i),can_add:r,can_del:a,cover_style:s,is_disabled:l,mix:u,subtitle:c,is_explicit:d},!0,this.q)||""},null_tpl:function(e){var t=window.lang;return'<div class="service_msg_box"><div class="service_msg service_msg_null">'+(e?t.mobile_audio_search_not_found.replace("%s",(0,a.htsc)(e)):t.mobile_audio_no_audio)+"</div></div>"},soft_filter:!0,need_invalid_keys:r.default.desktop,top_len:50,global_search:!0,onRendered:function(){var e=window.audioplayer;e&&e.initAudio()},al_need:!0,init_offset:0});var u=t.getCurrentId(),c=(0,a.ge)("audio"+u);if(c){var d=(0,a.getY)(c)+c.offsetHeight/2-(0,a.getCh)()/2;(0,a.scrollTop)(d)}};break;case"photo":A=!0,o.set(p,!1,{before:!0,beforeAppend:function(e){var n=(0,a.geByTag1)("img",t.target),i=n&&n.src||"/images/mobile/blank.gif",r="",s="",l=((0,a.attr)(n,"data-src_big")||"").split("|"),u=l[0],c=+l[1]||0,d=+l[2]||0,f=!0;if(c&&d||(c=n&&n.width||0,d=n&&n.height||0,f=!1),u){if(c&&d){var p=Math.min(604,(0,a.getCw)())/c,_=Math.min(604,Math.ceil(p>=1&&f?d:d*p));r+="height:"+_+"px;"}r+="background:url("+i+") #f7f7f7 no-repeat center top;",_>100&&(0,a.each)(["-moz-","-o-","-webkit-",""],function(e,t){r+=t+"background-size:contain;"}),i=u}else s+="width:100%;";o.setMhead(e,(0,a.attr)(t.target,"data-header"),!0),(0,a.val)((0,a.geByClass1)("mcont",e),function(e,t,n){return'<div class="pcont bl_cont"><div class="media_view photo_view"><div class="pv_summary">&nbsp;<div class="summary_loading" style="float:left;"><i class="i_loading"></i></div></div><div class="pv_body"><div class="thumb_item" style="'+(t||"")+'"><img src="'+e+'" class="ph_img" alt="" style="'+(n||"")+'" /></div></div><div id="al_fill"></div></div></div>'}(i,r,s))},afterAppend:function(){(0,a.alLoadingFix)(0,"al_fill"),(0,a.scrollTop)(0)}},t);break;case"u":case"g":case"p":case"e":A=!0,o.set(p,!1,{before:!0,beforeAppend:function(e){var n,i=window.lang,r=v.substr(2),s=(0,a.geByClass1)(r,e,"a")||(0,a.geByClass1)(r,e,"span"),l=(0,a.stripTags)((0,a.attr)(t.target,"data-name")||(0,a.attr)(s,"data-name")||(0,a.val)(s)||""),u=s&&s.parentNode&&(0,a.geByClass1)("lvi",s.parentNode),c=((0,a.outer)(u),(0,a.geByClass1)(r,e,"img")),d=c&&c.src||(0,a.attr)(t.target,"data-photo")||"/images/mobile/blank.gif";"u"==g?n=l.split(" ").shift():"g"==g?n=i.mobile_group_head_title:"p"==g?n=i.mobile_public_head_title:"e"==g&&(n=i.mobile_event_head_title),o.setMhead(e,n,"/"),(0,a.val)((0,a.geByClass1)("mcont",e),function(e,t,n){return"g"===g||"p"===g||"e"===g?'<div class="al_loading"></div>':'<div class="pcont fit_box"><div class="owner_panel profile_panel"><img src="'+(e||"")+'" class="pp_img" /><div class="pp_cont"><h2 class="op_header">'+(t||"")+'</h2></div></div><div id="al_loading"></div>'}(d,l))},afterAppend:function(){(0,a.alLoadingFix)(),(0,a.scrollTop)(0)}},t);break;case"playlists":A=!0,o.set(p,!1,{before:!0,beforeAppend:function(e){var n=(0,a.geByClass)("audioPlaylists__item",e),i="";n&&(0,a.each)(n,function(e,t){i+=AudioPlaylist.tplSearchListItem({href:(0,a.attr)((0,a.geByClass1)("audioPlaylists__itemLink",t),"href"),thumb_style:(0,a.attr)((0,a.geByClass1)("audioPlaylists__itemCover",t),"style"),grid_covers:(0,a.val)((0,a.geByClass1)("audioPlaylists__itemCover",t)),title:(0,a.val)((0,a.geByClass1)("audioPlaylists__itemTitle",t)),author_name:(0,a.val)((0,a.geByClass1)("audioPlaylists__itemAuthor",t)),short_stats:(0,a.val)((0,a.geByClass1)("audioPlaylists__itemStats",t))},!0)});var r=AudioPlaylist.tplPlayerSearch("",!0),s=AudioPlaylist.tplPlaylistsPage(i,r);(0,a.val)((0,a.geByClass1)("mcont",e),'<div class="pcont bl_cont">'+s+"</div>"),o.setMhead(e,(0,a.attr)(t.target,"data-header"),"/"),(0,a.scrollTop)(0)}});break;case"empty":case"playlist":A=!0,o.set(p,!1,{before:!0,beforeAppend:function(e){(0,a.val)((0,a.geByClass1)("mcont",e),'<div class="pcont bl_cont"><div id="al_loading"></div></div>')},afterAppend:function(){(0,a.alLoadingFix)(),(0,a.scrollTop)(0)}});break;case"news_subsection":A=!0,o.set(p,!1,{before:!0,beforeAppend:function(e){var t=(0,a.geByClass1)("news_subsections",e);t&&!(0,a.hasClass)("summary_loading",t.firstChild)&&(0,a.before)((0,a.ce)("div",{className:"summary_loading",innerHTML:'<i class="i_loading"></i>'}),t.firstChild)}});default:(c=window.cur).al_fast&&c.al_fast[g]&&(A=!0,o.set(p,!1,c.al_fast[g](t),t))}}if(u.abort_reqs(),t.local){var y=!0;o.set(p,{},{after:!0,no_scroll:!0,force:!0},!1),m&&m()}else{var w=(0,a.qs2obj)(t.nav.params);(0,a.extend)(w,t.params||{}),window.al&&window.al.menu||(w._nlm=1),_&&(w._tstat=_);var b=window.pStats,D=b.getSeenData();D&&(w._pstat=D.data,c&&c.module&&(w._pstatref=c.module)),w._ref||(w._ref=(n.path||"").substr(1));y=u.post(f,w,{onPageDone:function(e,n,i,r,a){var s=window.cur;D&&b.onSend(D.seen),u.tProcess=(new Date).getTime(),o.set(p,{title:e,html:n,js:i,lm:r,bc:a,st:t.st||0},{after:A,no_scroll:A},!A&&t),u.tModule=s.module,u.tRender=(new Date).getTime()}});u.save_req()}return A&&(t.zProcess&&(t.zProcess(),delete t.zProcess),n.set(t),u.tModule=c.module,u.tFastRender=(new Date).getTime()),y},confirm:function(e){function t(t,n,i,o){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t,n,i){return!!confirm(t)&&u.click(e,i,{url_params:{hash:n}})}),_post:function(e,t,n){var i=function(e,t){n.onFail&&n.onFail.call(window,0,e,t)};return u.plainpost(e,t,function(o){var r=!1;try{r=(0,a.parseJSON)(o)}catch(e){r=!1}!1===r?i():u.parseResponse(r,e,t,n)},i)},parseResponse:function(e,t,n,i){var o=window.al,r=window.nav,s=window.menu,l=window.page,c=e.shift(),d=e.shift(),f=e.shift(),p=t.indexOf("community")>=0,_=p?window.al&&c>o.ver:window.al&&c>o.ver||!!window.menu&&!s.refreshCounters(d);switch(!1===d||p||(0,a.setNotify)(d[2]),f){case 0:if(_)return r.hard_go(r.cur,null,{replace:!0});var A=e.shift();i&&i.onDone&&((0,a.isArray)(e)?i.onDone.apply(window,A):i.onDone.call(window,A));break;case 1:u.onRedirect(!0,e[0]);var m=e.shift(),h=e.shift(),v=e.shift();if(window.isNewMail&&u.onBeforeRedirect(m))break;if(_||h)r.hard_go(m);else if(v){(0,a.setDocumentDomain)();var g=m+(-1==m.indexOf("?")?"?":"&")+"__extra=1",y=(0,a.createIframe)({src:g})}else r.go(m,null,{ignore_cur_process:!0});break;case u.RESPONSE_CAPTCHA:m=e.shift();i&&i.onFail?(e.unshift(m),e.unshift(f),i.onFail.apply(window,e)):r.hard_go(m);break;case 3:l.need_hard_go=_;var w=e[3];if(w&&w.rdr&&window.al&&o.menu&&(0,a.getW)("vk_wrap")>=614){r.go(w.rdr,null,{replace:!0});break}(i=i||{}).onPageDone||(i.onPageDone=function(e,n,i,o,a){r.go(t,null,{push_only:!0}),l.set(l.getHash(r),{title:e,html:n,js:i,lm:o,bc:a})}),i.onPageDone.apply(window,e);break;case 4:if(i.redirectToLoginPage){g=e.shift();return window.location=g,!1}if(!u._failed_relogin){g=e.shift(),m=e.shift();(0,a.setDocumentDomain)();y=(0,a.createIframe)({src:g})}u._failed_relogin=!0,u.save_failed_req(y,t,n,i)}},onReLoginDone:function(){u.repeat_reqs(),u._failed_relogin=!1},tGetParam:function(){if(u.tStart&&u.tModule){var e=u.tFastRender-u.tStart,t=u.tRestoreRender-u.tStart,n=u.tProcess-u.tStart,i=u.tRender-u.tProcess,o=["/"==u.tModule.substr(0,1)?u.tModule.substr(1):u.tModule,e,t,n,i];for(var r in o)(!o[r]||o[r]<0)&&(o[r]=0);return u.tStart=!1,o.join(",")}},tAlGetParam:function(){if(u.tAlStart&&u.tAlModule){var e=u.tAlProcess-u.tAlStart,t=u.tAlRender-u.tAlProcess,n=["al_"+("/"==u.tAlModule.substr(0,1)?u.tAlModule.substr(1):u.tAlModule),e,t];for(var i in n)(!n[i]||n[i]<0)&&(n[i]=0);return u.tAlStart=!1,n.join(",")}},refreshLinks:function(e,t){if(e){var n=(0,a.geByClass1)("mmi_fv","lm_cont"),i=n&&(0,a.geByClass1)("lfm_item",n),o=(0,a.geByClass1)("mmi_fv","mfoot"),r=o&&(0,a.geByClass1)("lfm_item",o),s=(0,a.ge)("fv_link"),l=(0,a.geBySel1)('link[rel="canonical"]');(0,a.attr)(i,"href",e),(0,a.attr)(r,"href",e),(0,a.attr)(s,"href",e),(0,a.attr)(l,"href",(0,a.attr)((0,a.ge)("mcont"),"data-canonical"))}if(t){var u=(0,a.geByClass1)("mmi_app","lm_cont"),c=u&&(0,a.geByClass1)("lfm_item",u),d=(0,a.geByClass1)("mmi_app","mfoot"),f=d&&(0,a.geByClass1)("lfm_item",d),p=(0,a.ge)("app_link"),_=!!t&&"return nav.app_go(this, event, '"+(0,a.escapeStr)(t)+"');";(0,a.attr)(c,"onclick",_),(0,a.attr)(f,"onclick",_),(0,a.attr)(p,"onclick",_)}}};window.ajax=u,t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{!i&&s.return&&s.return()}finally{if(o)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.default=window.Url={make:function(e,t){var n=need("nav");if(!t)return e;var o=e.split("?"),r=i(o,2),a=r[0],s=r[1],l={},u=[];s&&s.split("&").map(function(e){var n=e.split("="),o=i(n,2),r=o[0],a=o[1];r in t||(t[r]=a)});if(Object.keys(t).forEach(function(e){var i,o=t[e];!0===o&&(o=n.getQuery(e)),("string"==typeof(i=o)&&i||function(e){return"number"==typeof e&&!isNaN(e)}(o))&&(l[e]=o)}),Object.keys(l).forEach(function(e){u.push(e+"="+encodeURIComponent(l[e]))}),0===u.length)return a;return a+"?"+u.join("&")}}},function(e,t,n){"use strict";var i=need("page"),o=need("audio"),r=need("onDOMReady"),a=need("audioplayer"),s=need("AudioSpecialForYou");function l(){c(),o.onInit(c),o.onSelect(c),i.onChange(c)}function u(){d()?a.playPause():a.playFirst(),c()}function c(){s.setPlaying(o.playing()&&d())}function d(){var e=a.getCurrentElem();return e&&!!e.closest(s.selector)}window.uAudioBlock={},r(l),uAudioBlock._onSpecialPlayAllClick=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var i=Object.assign({},{tick:100,onEnd:function(){},onTick:function(){},onStart:function(){},onPause:function(){},onStop:function(){}},n);this.left=t,this.initialTime=t,this.tick=i.tick,this.onEnd=i.onEnd,this.onTick=i.onTick,this.onStart=i.onStart,this.onPause=i.onPause,this.onStop=i.onStop,this.started=!1}return e.prototype.stop=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.started&&(this.pause(e),this.left=this.initialTime,e||this.onStop())},e.prototype.pause=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.timer&&(this.timer=clearInterval(this.timer),this.started=!1,e||this.onPause())},e.prototype.start=function(){var e=this;if(this.started)return!1;var t=new Date(Date.now()+this.left).getTime();this.started=!0,this.timer=setInterval(function(){var n=(new Date).getTime();e.left=t-n,e.left<=0?(e.onTick(0),e.onEnd(),e.stop(!0)):e.onTick(e.left)},this.tick),this.onStart()},e.prototype.isStarted=function(){return this.started},e.prototype.getTimeLeft=function(){return this.left},e}();t.default=i},function(e,t,n){"use strict";var i=n(322);window.TabRow={setSelectedTab:function(e,t){var n=(0,i.$)(r.tabRowById(e)),a=n.$(r.tabSelected),s=n.$(r.tabById(t));a.classList.remove(o.selected),s.classList.add(o.selected)},setTabUrl:function(e,t,n){(0,i.$)(r.tabRowById(e)).$(r.tabById(t)).setAttribute("href",n)}};var o={selected:"TabRow__tab_selected"},r={tabRowById:function(e){return'.TabRow[data-id="'+e+'"]'},tabById:function(e){return'.TabRow__tab[data-id="'+e+'"]'},tabSelected:".TabRow__tab_selected"}},function(e,t,n){"use strict";var i,o=n(72),r=(i=o)&&i.__esModule?i:{default:i};var a=window,s=a.se,l=a.remove,u=a.gpeByTag,c=a.ce,d=a.each,f=a.append,p=a.gpeByClass,_=a.toggleClass,A=a.cancelEvent,m=a.hasClass,h=a.geByClass1,v=a.addClass,g=a.getY,y=a.getH,w=a.scrollTop,b=a.getCh,D=a.removeClass,C=a.checkEvent,E=a.geByClass,S=a.getW,k=a.replaceClass,M=a.escapeRE,T=a.ge,x=a.val,I=a.after,P=a.scrollToEl,B=a.replaceEntities,F=a.toggle,L=a.elfocus,O=a.isUndefined,N=a.isVisible,R=a.clone,j=a.attr,H=a.before,V=a.srand,U=a.extend,z=window.ajax,q=window.nav,W=window.Dialog,Y={onStickersTabSelected:(0,r.default)(),onStickerClick:(0,r.default)(),onStickersInit:s(),onReplyClick:s(),add_attach:function(e,t){var n=window.al;l("feed_extra_field");var i=u("form",e),o=c("input",{id:"feed_extra_field",type:"hidden",name:"add_attach",value:2});if(i){var r=!1;if(d(i,function(e,t){if("submit"===t.type)return r=t,!1}),r)return f(o,i),window.al&&n.ver?q.go(r,t):i.submit()}return!0},saveDraft:function(e,t,n){e&&e.preventDefault();var i=T("feed_add_form"),o={act:"post",save_draft:1,redirect:n,hash:t};d(i.elements,function(e,t){"submit"!==t.type&&(o[t.name]="checkbox"===t.type?(+t.checked).toString():t.value)}),z.post(window.nav.path,o)},toggleActions:function(e,t){var n=p("post_item",e);return _("pi_actions_opened",n),A(t),!1},wallActions:function(e,t){var n=window.tooltip,i=p("_audioPlaylist",e)||p("wall_item",e)||p("post",e);if(!i)return!0;if(m("wi_actions_opened",i))D("wi_actions_opened",i),n.hide();else{var o=h("wi_actions_wrap",i),r=h("wi_actions",o),a=h("wi_actions_btn",i);Y.wallActionsHide(),v("wi_actions_opened",i);var s=g(i)+45+y(r)+7,l=w()+b();_("wi_actions_top",o,s>l),n.addHandler(Y.wallActionsHide),n.show(o,a)}return A(t),!1},wallActionsHide:function(){var e=window.tooltip;D("wi_actions_opened",h("wi_actions_opened")),e.hide()},wallPostOpen:function(e,t){var n=p("wall_item",e),i=h("wi_date",n);return!i||q.go_after(i,t)},toggleGif:function(e,t,n){return!e||(!!C(t)||(m("current_gif",e)?Y.hideGif(e,t):Y.showGif(e,t,n)))},showGif:function(e,t,n){var i=window.cur;if(!e)return!0;if(C(t))return!0;if(n){if(i.loadedGifs||(i.loadedGifs={}),!i.loadedGifs[e.href]&&!confirm(n))return!1;i.loadedGifs[e.href]=!0}var o=g(e),r=w();d(E("current_gif","mcont"),function(e,t){Y.hideGif(t)}),w(r-(o-g(e)));var a=c("img",{src:e.href,className:"gif_original"});v("current_gif gif_loading",e),f(a,e);var s=function(t){if(S(a)&&y(a)||t){if(clearInterval(l),!m("current_gif",e))return;k("gif_loading","gif_opened",e)}},l=setInterval(s,100);return a.onload=s,A(t)},hideGif:function(e,t){return!e||(!!C(t)||(D("current_gif",e),D("gif_opened",e),D("gif_loading",e),l(h("gif_original",e)),A(t)))},replyNamesRE:function(){var e=window.cur;if(!e.replyNames)return!1;var t=[];return d(e.replyNames,function(){t.push(M(this[0]))}),new RegExp("^("+t.join("|")+")")},replyTo:function(e,t,n,i,o){var r=window.cur;if(C(e))return!0;n=n||0,D("nc_current_reply",h("nc_current_reply"));var a=T("nc_form"),s=T("nc_message"),l=h("nc_reply_name",a),u=p("near_btn",l),c=T("nc_reply_as"),d=x(s),A=Y.replyNamesRE();if(n){var m=T(t+"_"+n),b=g(m)+y(m),E=w();I(a,m),v("nc_current_reply",h("pi_reply_wrap",m)),w(E+g(m)+y(m)-b);var S=r.replyNames[i]||{},k=S[0]||"",M=S[1]||"";d=d?A?d.replace(A,k):d:k,Y.onReplyClick(!0,k)}else{f(a,h("wall_replies")),P(a);M="";d=A?d.replace(A,""):d}return x(s,B(d)),x(l,M),F(u,n),c&&(x(c,+o),_("cp_post_as_group",a,+o)),x("nc_reply_to",n),r.replyTo=n,L(s),!1},stickersInit:function(){if(!window.isNewMail||!h("messenger")){var e=window.cur,t=window.Scroller,n=T("stickers_panel");if(n){var i=h("sp_body",n),o=h("sp_stickers_tabs",n);e.scroller&&e.scroller.destroy(),e.scroller=new t(i,{byPage:!0}),e.scroller.init(),e.destroy.push(function(){e.scroller.destroy()}),e.tabScroller&&e.tabScroller.destroy(),e.tabScroller=new t(o),e.tabScroller.init(),e.destroy.push(function(){e.tabScroller.destroy()}),Y.onStickersInit(!0)}}},stickersToggle:function(e,t){var n=window.cur;if(!n.stickers)return!0;O(t)&&(t=!N("stickers_panel"));var i=T("write_form")||T("nc_form"),o=T("stickers_panel"),r=h("cp_sticker_btn",i);return!o||(F(o,t),_("cp_sticker_btn_sel",r,t),t&&n.tabScroller&&n.tabScroller.onShow(),!1)},stickersClick:function(e,t){var n=window.cur;return n.stickers&&n.stickers[t]?(window.isNewMail&&(window.uMailWrite.drawStickers(),window.uMailWrite.openStickersPanel()),Y.stickersToggle(null,!0),Y.stickersSelectTab(null,t)):q.go(e)},stickersStoreOpen:function(e){var t=window.cur;return z.click(e,!1,{url_params:{reply_to:t.replyTo||0}})},stickersSelectTab:function(e,t){var n=window.cur;if(!window.isNewMail&&n.tabScroller&&!n.tabScroller.canClick())return!1;var i=T("stickers_panel"),o=h("sp_body",i),r=h("sp_tab_selected",i);if(n.stickers[t]){n.scroller&&n.scroller.destroy(),x(o,n.stickers[t]),n.scroller&&n.scroller.init(),e||(e=h("sp_tab"+t,i)),D("sp_tab_selected",r),v("sp_tab_selected",e);var a=g(i),s=a+S(i),l=w(),u=l+b();(a<l||s>u)&&P(i),n.tabScroller&&n.tabScroller.showElem(e),StickersAnimation&&StickersAnimation.loadAutoplayAnimationStickers()}return window.isNewMail&&Y.onStickersTabSelected(),!1},addRecentSticker:function(e,t,n){var i=window.cur,o=p("sticker_item",e);if(i.stickers&&i.stickers[-1]&&o){var r=c("div",{innerHTML:i.stickers[-1]}),a=R(o),s=h("sticker_thumb",a),u=h("stickers_list",r);j(s,"onclick","return post.sendSticker(this, "+t+", true, 'recent');"),d(E("sticker"+t,u),function(){l(this)}),H(a,u.firstChild);var f=0;d(E("sticker_item",u),function(){window.isNewMail?f++>=16&&l(this):f++>=8&&l(this)}),i.stickers[-1]=x(r),n&&Y.stickersSelectTab(!1,-1)}},sendSticker:function(e,t,n,i){if(window.isNewMail&&Y.onStickerClick(t,i))return Y.addRecentSticker(e,t,n),!1;var o=window.cur;if(o.scroller&&!o.scroller.canClick())return!1;Y.stickersToggle(e,!1);var r=T("write_submit"),a={lock:!0,url_params:{media:"sticker"+t,_af:V()}};if(n&&!i&&(a.url_params.media_from="recent"),o.ref&&(a.url_params.ref=o.ref,o.ref=void 0),o.refSource&&(a.url_params.ref_source=o.refSource,o.refSource=void 0),!i){var s=j(e,"href");s&&(i=s.split("sticker_referrer=")[1].split("&")[0])}return i&&(a.url_params.sticker_referrer=i),Y.addRecentSticker(e,t,n),r?z.click(r,U({save:!0},W),a):(r=T("nc_submit"))?z.click(r,{},a):void 0},toggleMarkAsAds:function(e,t){A(t);var n=$("input",e);n.checked=!n.checked;var i=$("input[name='mute_notifications']");i&&(i.checked=n.checked,i.disabled=n.checked)},toggleSender:function(e,t){t.stopPropagation(),t.preventDefault();var n=e.querySelector("input");n.checked=!n.checked;var i={group:[],user:["marked_as_ads","signed","close_comments","mute_notifications"]},o=$("input[name='marked_as_ads']");$$(".Control.Control_type_checkbox.Row").forEach(function(e){if(!m("Control__blocked",e)){var t=e.querySelector("input[name]");if("from_group"!==t.name)n.checked&&!i.group.includes(t.name)?t.disabled=!n.checked:!n.checked&&i.user.includes(t.name)&&(t.disabled=!n.checked),"mute_notifications"===t.name&&o&&o.checked&&(t.disabled=!0);else{var r=$(".header__user"),a=$(".header__group"),s=$(".post_timer"),l=$("input[name=postpone]"),u=$("input#add_post_btn");if(n.checked?(r.classList.add("header_hidden"),a.classList.remove("header_hidden"),s.style.visibility="",l.disabled=!1):(r.classList.remove("header_hidden"),a.classList.add("header_hidden"),s.style.visibility="hidden",l.disabled=!0),u){var c=u.value;u.value=u.dataset.value,u.dataset.value=c}}}})}};window.post=Y},function(e,t,n){"use strict";var i,o=n(72);var r={onClose:(0,((i=o)&&i.__esModule?i:{default:i}).default)(),inited:!1,width:!1,height:!1,onResize:null,_lastNav:!1,_opened:!1,_destroy:!1,init:function(){r.inited||(r.inited=!0,r.initEvents())},initEvents:function(){var e=function(e){r.fixHeight(vkNow()+2e3,e)};addEvent(window,"orientationchange",e),onBodyResize(e),e(!0)},opened:function(){return hasClass("z_opened",window.bodyNode)!==r.opened&&toggleClass("z_opened",window.bodyNode,r._opened),r._opened},toggle:function(e,t){return!!checkEvent(e)||(r.opened()?r.close(e,t):r.open(e,t),!1)},open:function(e,t){return!!checkEvent(e)||!r.opened()&&(thover.clear(),r.init(),r._st=scrollTop(),r._lastNav=!1,addClass("z_opened",window.bodyNode),r._opened=!0,r.fixHeight(vkNow()+2e3,!0),scrollTop(0),!1)},close:function(e,t){return!!checkEvent(e)||!!r.opened()&&(thover.clear(),val("z",""),removeClass("z_opened",window.bodyNode),r._lastNav={cur:nav.cur,path:nav.path,params:nav.params,hash:nav.hash},r._opened=!1,r._destroy&&(r._destroy(),r._destroy=!1),scrollTop(r._st,1),r._st=!1,r.onResize=null,r.onClose(),!1)},updateSize:function(){var e=ge("z");e&&e.offsetWidth&&e.offsetHeight&&(r.width=e.offsetWidth,r.height=e.offsetHeight,r.onResize&&r.onResize())},fixHeight:function(e,t){if((r._opened||t)&&(e&&!(vkNow()>e)||t)){var n=getCw(),i=getCh();(r._lastWidth!=n||r._lastHeight!=i||t)&&(r._lastWidth=n,r._lastHeight=i,setStyle("z","height",i),r.updateSize(),scrollTop()||scrollTop(0)),clearTimeout(r._fixTo),r._fixTo=setTimeout(r.fixHeight,50,e)}},create:function(e,t){val("z",e),r._destroy=t}};window.zlayer=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={},o=function(e,t,n,o){delete i[t],1===o?Emoji.favorite.addFavoriteSticker(e,t,n):-1===o&&Emoji.favorite.deleteFavoriteSticker(e,t,n)};t.Stickers={toggleFavorite:function(e,t,n){if(t&&t.stopPropagation(),!hasClass(e,"on")&&Emoji.stickers[Emoji.TAB_FAVORITE_STICKERS].stickers.length>=Emoji.favoriteLimit&&!Emoji.favoriteLimitNoticed){var r=langStr(getLang("purchases_stickers_favorite_limit_notice"),"%s",Emoji.favoriteLimit);return setTimeout(showFastBox(getLang("global_error"),r).hide,3e3),ajax.post("stickers.php",{act:"favorite_limit_noticed",value:1}),Emoji.favoriteLimitNoticed=!0,!1}var a=attr(e,"data-sticker-id"),s=attr(e,"data-hash");return!(!a||!s)&&!i[a]&&(i[a]=1,toggleClass(e,"on"),void ajax.post("/stickers.php",{act:"toggle_favorite",sticker_id:a,hash:s},{onDone:o.pbind(n,a,e)}))},getStickerUrl:function(e,t){var n={id:e,size:t};return window.isMVK?rs(window.store.stickers.url_template,n):getTemplate("stickers_sticker_url",n)}}},function(e,t,n){"use strict";var i=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{!i&&s.return&&s.return()}finally{if(o)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=n(251),r=window,a=r.preventEvent,s=r.val,l=r.ce,u=r.replaceEntities,c=r.elfocus,d=r.parseLat,f=r.parseCyr,p=r.show,_=r.hide,A=r.extend,m=(r.isEmpty,r.nav),h=r.addEvent,v=r.trim,g=(r.cancelEvent,r.geByClass),y=r.getXY,w=r.domPS,b=r.domNS,D=r.browser,C=function(){var e={UP:38,DOWN:40,RETURN:13,ESC:27},t="MentionContainer_opened",n="Mention_inited",r="Mention_noScroll",C="MentionItem_active",E={},S={},k=!1;function M(){E={ignoredTerm:null,curValue:"",curTerm:"",curPos:"",input:{}},S={container:null,scroll:null,index:{},cache:{},shown:[],lastQ:null,text:null,requestTimer:null,opts:{}}}M();var T=!0;function x(){T=!1}function I(){var e,t,n,i,o,r=s(E.input),a=Math.max(r.lastIndexOf("@"),r.lastIndexOf("*")),u=!1;if(a>-1){var c=function(e){if(void 0!==e.selectionStart)return e.selectionStart!==e.selectionEnd?e.selectionEnd:e.selectionStart;if(void 0!==window.getSelection){var t=window.getSelection();if(!t||!t.rangeCount)return 0;var n=t.getRangeAt(0),i=n.cloneRange(),o=l("div");return i.selectNodeContents(e),i.setEnd(n.startContainer,n.startOffset),o.appendChild(i.cloneContents()),s(o).replace(/\n$/,"").length}return 0}(E.input),d=r.substr(0,c);a=Math.max(d.lastIndexOf("@"),d.lastIndexOf("*"));var f=d.match(/(^|[\s.,:\'\"\u00BB\u00AB;>\)\(]|\#[\w_\.\u0400-\u04FF]+)[@\*]([^,@\*\(\)\?\!\s\n\r \u00A0]*)$/);f&&"."!==f[2].substr(-1)&&(u=f[2])}!1===u&&delete E.ignoredTerm,void 0!==E.ignoredTerm&&u==E.ignoredTerm&&(u=!1),E.curValue=r,E.curTerm=u,E.curPos=a,S.text=u,!1===E.curTerm?F():(j(!1,E.curTerm),B(),e=ge("mhead").offsetHeight,t=S.container.getBoundingClientRect(),n=E.input.offsetHeight,i=parseInt(getStyle(S.scroll,"maxHeight"),10),o=!1,o=hasClass("Mention_openToBottom",S.container)?t.top-n-i<e:t.bottom-i<e,y(E.input)[1]>=e+i&&(o=!1),toggleClass("Mention_openToBottom",S.container,o),toggleClass("Mention_openToBottom",S.opts.appendTo,o))}function P(e){E.input=e}function B(){document.addEventListener("click",L,!0),addClass(t,S.opts.appendTo),p(S.container),function(){if(!k){var e=D.ipad?"touchend":"click";k=!0,h(window,e,F),h(window,"touchmove",x),m.onBeforeGo(F)}}()}function F(e){!D.ipad||T?e&&e.target&&gpeByClass(n,e.target)&&!gpeByClass("uMailWrite__button",e.target)&&!hasClass("uMailWrite__button",e.target)||hasClass(t,S.opts.appendTo)&&(removeClass(t,S.opts.appendTo),_(S.container),function(){if(k){var e=D.ipad?"touchend":"click";removeEvent(window,e,F),removeEvent(window,"touchmove",x),m.onBeforeGo.off(F),k=!1}}()):T=!0}function L(e){var t=e.target;t&&!gpeByClass(n,t)&&(e.preventDefault(),e.stopImmediatePropagation(),F()),document.removeEventListener("click",L,!0)}function O(e,t){var n,i=void 0,o=void 0,r="",a=S.opts.searchKeys,s={};for(i=0,n=a.length;i<n;++i)r+=" "+(t[a[i]]||"").replace(S.opts.delimeter," ").replace(/<[^>]*>/g,"");for(r+=(d(r)||"")+(f(r)||""),r=v(r.toLowerCase()).split(/\s+/),i=0;i<r.length;i++)for(o=1;o<=S.opts.wholeIndex;o++){var l=r[i].substr(0,o);s[l]||(S.index[l]||(S.index[l]=[]),S.index[l].push(e),s[l]=1)}}function N(){var e=v(S.text);e&&ajax.post(S.opts.url,A({str:e,mobile:1},S.opts.params||{}),{onDone:function(t){S.cache[e]=R(e).concat(t),H(S.cache[e],!0)}})}function R(e){if(!(e=v(e.toLowerCase().replace(S.opts.delimeter," "))))return S.cache[""];var t=S.opts.wholeIndex;if(e.length<=t&&-1===e.indexOf(" "))return S.index[e]||[];var n=0,i="",o=void 0,r=void 0;for(o=0,r=(e=e.split(" ")).length;o<r;++o){var a=e[o].substr(0,t),s=S.index[a];if((!i||!s||s.length<n)&&(n=s?s.length:0,i=a),!n)return[]}var l=[],u=S.opts.searchKeys,c=u.length,p=e.length;for(o=0,r=S.index[i].length;o<r;++o){for(var _=S.index[i][o],A=S.opts.items[_],m=!1,h="",g=0;g<c;++g)h+=" "+(A[u[g]]||"").replace(S.opts.delimeter," ").replace(/<[^>]*>/g,"");h=(h+=(d(h)||"")+(f(h)||"")).toLowerCase();for(var y=0;y<p;++y)if(-1===h.indexOf(" "+e[y])){m=!0;break}m||l.push(_)}return l}function j(e,t){if(S.cache[""])if(t=void 0!==t?t:v(S.text),S.lastQ!==t||e){S.lastQ=t,clearTimeout(S.requestTimer);var n=S.cache[t];n?H(n,!0):(H(n=R(t),!S.opts.url),S.opts.url&&(S.requestTimer=setTimeout(N,S.opts.requestWait)))}else B()}function H(e,t){var n=[];S.shown=[];for(var i=e.slice(0,S.opts.maxItems),u=0,c=i.length;u<c;++u){var d=i[u];isArray(d)||(d=S.opts.items[d]),S.shown[d[0]]||(S.shown[d[0]]=d,n.push(V(d)))}S.container&&S.opts.appendTo.contains(S.container)||(S.container=l("div"),addClass("Mention",S.container),S.scroll=l("div"),addClass("ScrollView Mention__scroll",S.scroll),(0,o.setScrollView)(S.scroll,{topBanner:!1}),S.opts.appendTo.appendChild(S.container),S.container.appendChild(S.scroll),h(S.scroll,"touchmove",function(e){hasClass(r,S.scroll)&&a(e)})),toggleClass("Mention_empty",S.container,!n.length),s(S.scroll,n.join("")),S.scroll.scrollTop=0,U(),setTimeout(function(){toggleClass(r,S.scroll,!function(){if(!D.ios&&!D.ipad)return!0;if(S.scroll.scrollHeight>S.scroll.offsetHeight)return!0;return!1}())},0)}function V(e){var t=i(e,4),n=t[0],o=t[1],r=t[2];return'<div class="MentionItem" onclick="Mention.onSelect(\''+n+'\');" onmouseover="Mention.onItemHover(this);">\n              <div class="MentionItem__cell">\n                <img src="'+t[3]+'" class="MentionItem__img"/>\n              </div>\n              <div class="MentionItem__cell MentionItem__cell_name">\n                <div class="MentionItem__name">'+o+'</div>\n                <div class="MentionItem__tag">'+r+"</div>\n              </div>\n            </div>"}function $(){var e=geByClass1(C,S.container),t=e.offsetTop;S.scroll.scrollTop=t-e.offsetHeight-parseInt(getStyle(S.scroll,"paddingTop"),10)}function U(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=g("MentionItem",S.container);if(t.length){var n=t.find(function(e){return hasClass(C,e)});e?(removeClass(C,n),addClass(C,e)):n||addClass(C,t[0])}}function z(e,t){setTimeout(function(){P(t),I()},0)}return{onKeyUp:function(t,n){t.keyCode!==e.UP&&t.keyCode!==e.DOWN&&(j(!0),P(n),I())},onKeyDown:function(n,i){var o;hasClass(t,S.opts.appendTo)&&(n.keyCode===e.UP?(function(){var e=geByClass1(C,S.container);if(e){var t=w(e);t&&(U(t),$())}else U(),$()}(),n.preventDefault()):n.keyCode===e.DOWN?(function(){var e=geByClass1(C,S.container);if(e){var t=b(e);t&&(U(t),$())}else U(),$()}(),n.preventDefault()):n.keyCode===e.RETURN?(o=geByClass1(C,S.container))&&(o.click(),1)&&n.preventDefault():n.keyCode===e.ESC&&(F(),n.preventDefault()))},onFocus:z,onClick:z,onSelect:function(e){var t=S.shown[e];t&&function(e){if(!e)return!1;var t=e[2].replace("@",""),n=void 0,i=E.curValue.substr(0,E.curPos),o=E.curValue.substr(E.curPos),r=!!i.match(/\#[\w_\.\u0400-\u04FF]+$/i);S.opts.preferDomain&&e[9]&&(r=!0),r||(n=u(e[8]||e[1]));var a=new RegExp("^(@|\\*)"+escapeRE(E.curTerm)+"(?:\\s+\\((?:(.*?)\\))?\\s*)?","");o=o.replace(a,function(e,i,o){var a=i+t+" ";return r||(a+="("+n.replace(/[\(\)\]\[]/g,"")+") "),a}),r||!i||i.match(/[\.\(\)\?\!\s\n\r\'\"\u00BB\u00AB \u00A0]$/)||(o=" "+o),F(),s(E.input,i+o),c(E.input),S.opts.afterInsert&&S.opts.afterInsert(E.input)}(t),F()},onItemHover:function(e){U(e)},init:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};M(),S.opts=A({appendTo:document.body,url:"hints",params:{act:"a_json_friends",from:"composer"},delimeter:/[\s\(\)\.,\-]+/g,requestWait:300,wholeIndex:2,maxItems:51,searchKeys:[1,4],preferDomain:!1,defaultItems:[],items:[],afterInsert:function(){}},e),addClass("Mention_inited",S.opts.appendTo),S.scroll&&removeClass(r,S.scroll),function(){var e=S.opts.defaultItems,t=S.opts.items,n=[],i=void 0,o=void 0;for(i=0,o=e.length;i<o;++i)n.push(i);for(S.cache[""]=n,i=0,o=t.length;i<o;++i)O(i,t[i])}()}}}();window.Mention=C},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(157),r=(i=o)&&i.__esModule?i:{default:i};t.default=r.default,window.Control=r.default},function(e,t,n){"use strict";s(n(72));var i=s(n(313)),o=n(167),r=s(o),a=n(267);function s(e){return e&&e.__esModule?e:{default:e}}Object.assign(r.default,{onTap:i.default.onTap,redrawOnline:function(e){var t=store.mail.peers[e];if(t){var n=(0,o.uConvo_getOnline)(t);i.default.setOnline(e,n)}},redrawUnread:function(e){if(!store.mail.peers[e])return;var t=(0,o.uConvo_getUnreadCount)(e);i.default.setUnreadCount(e,t)},redrawLastMsg:function(e){var t=(0,o.uConvo_getLastMsg)(e);t&&i.default.setLastMsg(e,t.textShort,t.dateShort)},redrawTyping:function(e){var t=(0,a.uTyping_getPeerTyping)(e),n=t&&1===t.count&&t.users[0]===e,r=(0,o.uConvo_getTyping)(e,n);i.default.setTyping(e,r)},redrawImportant:function(e,t){i.default.setImportant(e,t)}})},function(e,t,n){"use strict";var i=n(322),o=need("ajax"),r=need("onDOMReady"),a=need("onBodyResize");window.CookiePolicy={},r(l),CookiePolicy._onHideClick=c;var s={body:"body",fixedHeader:"._hfixed",cookiePolicy:".CookiePolicy"};function l(){(0,i.$)(s.cookiePolicy)&&(u(),a(u))}function u(){if((0,i.$)(s.fixedHeader)){var e=(0,i.$)(s.body),t=(0,i.$)(s.cookiePolicy).offsetHeight,n=parseInt(getComputedStyle(e).paddingBottom,10);e.style.paddingBottom=n+t+7+"px"}}function c(e,t){e.preventDefault();var n=t.getAttribute("href");t.closest(s.cookiePolicy).style.display="none",a("__clear",u),o.post(n,{_ajax:1})}},function(e,t,n){"use strict";var i,o=n(322),r=n(326),a=(i=r)&&i.__esModule?i:{default:i};window.SearchPanel={setQuery:function(e,t){var n=(0,o.$)(l.inputById(e));t=t||"",n.value!==t&&(n.value=t,d(n,t))}},SearchPanel._onInput=u,SearchPanel._onClearClick=c;var s={hasQuery:"SearchPanel_hasQuery"},l={searchPanel:".SearchPanel",input:".SearchPanel__input",inputById:function(e){return'.SearchPanel[data-id="'+e+'"] .SearchPanel__input'}};function u(e,t){var n=e.value;d(e,n),a.default.handle(t,{query:n})}function c(e){var t=e.closest(l.searchPanel).$(l.input);t.value="",t.oninput()}function d(e,t){e.closest(l.searchPanel).classList.toggle(s.hasQuery,!!t)}},function(e,t,n){"use strict";var i,o=n(238),r=(i=o)&&i.__esModule?i:{default:i};window.landingsSlider=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(102),r=(i=o)&&i.__esModule?i:{default:i};t.default=r.default,window.Brick=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(339),r=(i=o)&&i.__esModule?i:{default:i};t.default=r.default,window.VotingBcg=r.default},function(e,t,n){"use strict";Array.prototype.some||(Array.prototype.some=function(e){if(null==this)throw new TypeError("Array.prototype.some called on null or undefined");if("function"!=typeof e)throw new TypeError;for(var t=Object(this),n=t.length>>>0,i=arguments.length>=2?arguments[1]:void 0,o=0;o<n;o++)if(o in t&&e.call(i,t[o],o,t))return!0;return!1})},function(e,t,n){"use strict";window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MailHat__unreadCount=t.MailHat__convoDetails=t.MailHat_getOnlineText=t.MailHat_page=t.MailHat_convo=t.MailHat_main=t.MailHat__icon=t.MailHat__Title=t.MailHat=void 0;var i=m(['\n    <div class="mailHat '," "," "," ",'">\n      <div class="mailHat__left">','</div>\n      <div class="mailHat__center">','</div>\n      <div class="mailHat__right">',"</div>\n    </div>\n  "],['\n    <div class="mailHat '," "," "," ",'">\n      <div class="mailHat__left">','</div>\n      <div class="mailHat__center">','</div>\n      <div class="mailHat__right">',"</div>\n    </div>\n  "]),o=m(['\n    <div class="','" ',">\n      ","\n      ","\n    </div>\n  "],['\n    <div class="','" ',">\n      ","\n      ","\n    </div>\n  "]),r=m(['\n    <div class="mailHat__unreadCount mailHat__unreadCount_length_','">\n      ',"\n    </div>\n  "],['\n    <div class="mailHat__unreadCount mailHat__unreadCount_length_','">\n      ',"\n    </div>\n  "]),a=m(['\n    <div class="mailHat__forwardTitle">\n      ',"\n    </div>\n  "],['\n    <div class="mailHat__forwardTitle">\n      ',"\n    </div>\n  "]),s=m(['\n    <div class="mailHat__editingTitle">\n      ',"\n    </div>\n  "],['\n    <div class="mailHat__editingTitle">\n      ',"\n    </div>\n  "]),l=m(['\n    <div class="mailHat__title">\n      ',"\n    </div>\n  "],['\n    <div class="mailHat__title">\n      ',"\n    </div>\n  "]),u=m(['\n    <a class="','" href="','">\n      ','\n      <div class="mailHat__convoBody">\n        <div class="mailHat__convoTitle">',"</div>\n        ","\n      </div>\n    </a>\n  "],['\n    <a class="','" href="','">\n      ','\n      <div class="mailHat__convoBody">\n        <div class="mailHat__convoTitle">',"</div>\n        ","\n      </div>\n    </a>\n  "]),c=m(['\n    <div class="mailHat__convoDetails">\n      <div class="mailHat__convoDetailsText">',"</div>\n      ","\n    </div>\n  "],['\n    <div class="mailHat__convoDetails">\n      <div class="mailHat__convoDetailsText">',"</div>\n      ","\n    </div>\n  "]),d=A(n(77)),f=A(n(355)),p=A(n(268)),_=A(n(34));function A(e){return e&&e.__esModule?e:{default:e}}function m(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function h(e){var t=e.forwarding?"mailHat_forwarding":"",n=e.hasPinnedMsg?"mailHat_hasPinnedMsg":"",o="mailHat_type_"+e.type,r=e.editing?"mailHat_editing":"";return d.default.html(i,o,t,n,r,e.left,e.center,e.right)}function v(e){var t=void 0;return e>999?(e="999+",t=4):t=e>99?3:e>9?2:1,d.default.html(r,t,e)}function g(){return y({mix:"mailHat__back",icon:"back",attrs:d.default.onMouseDown("MailHat_convo.onBackTap")})}function y(e){return(0,f.default)({mix:d.default.class("mailHat__icon",e.mix),icon:e.icon,attrs:e.attrs,url:e.url})}function w(e){var t=window.lang,n=e.membersCount,i="",o="";if(n>0)o=e.isChannel?langNumeric(n,t.mobile_mail_channel_N_members):langNumeric(n,t.mobile_mail_N_members);else{var r=e.onlinePlatform;o=b(e.isOnline,e.offlineText),"mobile"===r&&(i=(0,f.default)({mix:d.default.class("mailHat__onlineIcon",{platform:"mobile"}),icon:"phoneMini"}))}return d.default.html(c,o,i)}function b(e,t){var n=window.lang;return e?n.mobile_mail_online:t}t.MailHat=h,t.MailHat__Title=function(e){return d.default.html(l,e.title)},t.MailHat__icon=y,t.MailHat_main=function(e){var t=(0,f.default)({mix:"mailHat__burger",icon:"burger",attrs:d.default.onClick("MailHat_main.onBurgerClick")}),n=function(e,t,n,i){var o=window.lang;return(0,p.default)({mix:"mailHat__folder",items:[{name:"all",text:o.mobile_mail_tab_all,active:"all"===e,url:t.all},n?{name:"unrespond",text:o.mobile_mail_tab_unrespond,active:"unrespond"===e,url:t.unrespond}:"",{name:"unread",text:o.mobile_mail_tab_unread,active:"unread"===e,url:t.unread},{name:"important",text:o.mobile_mail_tab_important,active:"important"===e,count:i,url:t.important}]})}(e.folder,e.urls,e.withUnrespond,e.importantCount),i=(u=e.unreadCount,c=d.default.class("mailHat__unread",{hasUnread:u>0}),_=(0,f.default)({mix:"mailHat__unreadIcon",icon:"msg"}),A=v(u),m=d.default.onClick("MailHat_main.onUnreadClick"),d.default.html(o,c,m,_,A)),r=(0,f.default)({mix:"mailHat__cancelForward",icon:"back",attrs:d.default.onMouseDown("MailHat_main.onCancelForwardTap")}),s=(l=window.lang,d.default.html(a,l.mobile_mail_choose_recipient));var l;var u,c,_,A,m;return h({type:"main",left:""+t+r,center:""+n+s,right:""+e.notifier+i,forwarding:e.forwarding})},t.MailHat_convo=function(e){var t=g(),n=(0,f.default)({mix:"mailHat__cancelEditing",icon:"close",attrs:d.default.onMouseDown("MailHat_convo.onCancelEditingTap")}),i=function(e){var t=d.default.class("mailHat__convo",{mobile:e.mobile}),n=(0,_.default)({mix:"mailHat__convoAvatar",photos:e.photos,size:36}),i=w(e);return d.default.html(u,t,e.url,n,e.title,i)}(e),o=(r=window.lang,d.default.html(s,r.mobile_mail_message_editing));var r;return h({type:"convo",left:""+t+n,center:""+i+o,right:(a=e.actions,(0,p.default)({mix:"mailHat__actions",icon:"dots",position:"topRight",items:a})),hasPinnedMsg:e.hasPinnedMsg,editing:e.editing});var a},t.MailHat_page=function(e){return h({type:"page",left:""+g(),center:"",right:"",hasPinnedMsg:!1,editing:!1})},t.MailHat_getOnlineText=b,t.MailHat__convoDetails=w,t.MailHat__unreadCount=v},function(e,t,n){"use strict";var i=a(n(112)),o=n(138),r=a(o);function a(e){return e&&e.__esModule?e:{default:e}}Object.assign(r.default,{redraw:function(){if(!store.mail.cur.peerId)return;var e=i.default.getElem("curConvo"),t=(0,o.uCurConvoTyping_getParams)();q.parseClass("typing",e.className).animation===t.animation?i.default.setTyping(e,t):e.outerHTML=(0,i.default)(t)}})},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uCurConvoTyping_getParams=void 0;var i,o=n(112),r=(i=o)&&i.__esModule?i:{default:i},a=n(267);function s(){var e=store.mail.cur.peerId,t=(0,a.uTyping_getPeerTyping)(e),n=void 0,i=void 0;return t&&("mixed"===t.type?(n="dots",i="mixed"):"audio"===t.type?(n="audio",i="audio"):"text"===t.type&&(n="dots",i="")),{id:"curConvo",typing:(0,a.uTyping_getNames)(t),typingCount:t?t.count:0,dimmed:!0,animation:n,text:i}}t.default=function(){return(0,r.default)(s())},t.uCurConvoTyping_getParams=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MailScrap_class=t.MailScrap_SystemMessageInner=t.MailScrap_ItemsInner=t.MailScrap_Item=t.MailScrap_EmptyInner=void 0;var i=A(['\n    <div class="','">\n      ',"\n      ","\n      ","\n      ","\n      ","\n      ","\n      ","\n    </div>\n  "],['\n    <div class="','">\n      ',"\n      ","\n      ","\n      ","\n      ","\n      ","\n      ","\n    </div>\n  "]),o=A(['\n    <div class="','">\n      ',"\n    </div>\n  "],['\n    <div class="','">\n      ',"\n    </div>\n  "]),r=A(['\n    <div class="mailScrap__empty mailScrap__empty_','">\n      ',"\n    </div>\n  "],['\n    <div class="mailScrap__empty mailScrap__empty_','">\n      ',"\n    </div>\n  "]),a=A(["\n    <div ",">\n      ","\n    </div>\n  "],["\n    <div ",">\n      ","\n    </div>\n  "]),s=p(n(77)),l=p(n(131)),u=p(n(164)),c=p(n(271)),d=p(n(352)),f=p(n(201));function p(e){return e&&e.__esModule?e:{default:e}}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function A(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function m(e){for(var t=store.mail,n=t.cur,i=t.msgs,o=t.scraps[e],r=o.length,a=[],l=!1,u=0;u<r;u++){if(u>0&&"peer"===e&&!l){var c=i[o[u-1]],d=i[o[u]];if(d.isUnread&&!c.isUnread&&d.authorId!==n.viewerId){l=!0,a.push(h(e,o[u],!0));continue}}a.push(h(e,o[u]))}return s.default.list(a)}function h(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=store.mail.cur,o="";if("folder"===e)o="important"===i.folder?v(t):g(t);else if("search"===e){if("peers"===i.tab)o=function(e){return(0,f.default)(e)}(t);else o=v(t)}else if("peer"===e){o=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,d.default)({msgId:e,withDivider:t})}(t,n)}else if("mrs"===e){o=g(t)}return o}function v(e){var t=store.mail.msgs[e].peerId;return(0,f.default)(t,e)}function g(e){return(0,f.default)(e,"last")}function y(e){var t=s.default.class("mailScrap__loading",_({},e,!0)),n=(0,u.default)();return s.default.html(o,t,n)}function w(e){var t=window.lang,n=store.mail.cur,i="";switch(e){case"peer":i=t.mobile_mail_history_is_empty;break;case"mrs":i=t.mobile_mail_mrs_empty_info;break;case"folder":i={all:t.mobile_mail_no_messages,important:t.mobile_mail_no_important,unread:t.mobile_mail_no_unreaded,unrespond:t.mobile_mail_sublist_empty}[n.folder];break;case"search":"msgs"===n.tab&&(i=t.mobile_mail_not_found),"peers"===n.tab&&(i=t.mobile_mail_no_peers)}return i}function b(e){var t,n=store.mail,i=n.cur,o=n.reached,r=!0,a=!1,l=!1,u=!1;if("peer"===e){var c=i.peerId,d=n.scraps.peer,f=d.length,p=n.rolls.peer[c]||[];r=o.peer.before[c]&&d[0]===p[0],a=last(d)===last(p)&&o.peer.after[c],0===f&&(a=!0);var A=c?n.peers[c]:null;A&&(l=!!A.systemMessageCode,A.isChannel&&(u=A.ownerId!==i.viewerId))}else if("mrs"===e)a=o.mrs;else if("folder"===e)a=o.folder[i.folder];else if("search"===e){var m=i.tab;i.query;if("peers"===m){var h=n.scraps.search.length;a=o.search[i.tab][i.query]||h>0}else a=o.search[i.tab][i.query]}return s.default.class("mailScrap",(_(t={},e,!0),_(t,"empty",function(e){var t=store.mail,n=t.cur,i=t.scraps,o=t.reached,r=!1;switch(e){case"peer":var a=n.peerId,s=t.rolls.peer[a];0===(s?s.length:0)&&o.peer.after[a]&&o.peer.before[a]&&(r=!0);break;case"mrs":0===i.mrs.length&&o.mrs&&(r=!0);break;case"folder":0===i.folder.length&&o.folder[n.folder]&&(r=!0);break;case"search":0===i.search.length&&o.search[n.tab][n.query]&&(r=!0)}return r}(e)),_(t,"systemMessage",l),_(t,"reachedBefore",r),_(t,"reachedAfter",a),_(t,"tab","search"===e&&i.tab),_(t,"isChannel",u),t))}t.default=function(e){var t=e.scrap,n="peer"===t,o=b(t),u=n?y("before"):"",d=y("after"),f=y("center"),p=function(e){var t=s.default.class("mailScrap__items",_({},e,!0)),n=m(e);return(0,l.default)({mix:t,inner:n})}(t),A=function(e){var t=w(e);return s.default.html(r,e,t)}(t),h=n?(0,c.default)():"",v=n?(g=store.mail.cur.notification||"",D=s.default.onClick("MailScrap.clearSystemMessage2"),s.default.html(a,D,g)):"";var g,D;return s.default.html(i,o,u,p,A,d,h,v,f)},t.MailScrap_EmptyInner=w,t.MailScrap_Item=h,t.MailScrap_ItemsInner=m,t.MailScrap_SystemMessageInner=function(){window.lang;var e=store.mail;return e.cur.notification||""},t.MailScrap_class=b},function(e,t,n){"use strict";var i=n(322);function o(){var e=(0,i.$)(r.intro),t=new Scroller(e,{byPage:!0,ignoreMouseWheel:!0,noAutoScroll:!0});t.init(),cur.destroy.push(function(){return t.destroy()})}window.AuthCheckIntro={},AuthCheckIntro._onMount=o;var r={intro:".AuthCheckIntro"}},function(e,t,n){"use strict";var i=w(n(215)),o=(w(n(326)),w(n(131)),w(n(356))),r=w(n(113)),a=w(n(175)),s=w(n(201)),l=w(n(33)),u=w(n(96));n(151);var c=w(n(354)),d=(w(n(155)),w(n(271))),f=n(267),p=w(n(9)),_=n(190),A=w(_),m=n(0),h=n(56),v=n(247),g=n(251),y=n(1);function w(e){return e&&e.__esModule?e:{default:e}}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var D=window.clog,C=!1;uVK.onReady(J),_.Messenger.onQueryChange(te),_.Messenger.onQueryClear(ne),s.default.onTap(N),u.default.onUnreadClick(k),u.default.onBackClick(ye),u.default.onBackToDialogClick(we),u.default.onCancelEditing(at),l.default.onAttachedMsgsRemove(O),l.default.onToBottomClick(Ae),l.default.onMsgSend(B),o.default.onClick(qe),o.default.onRestoreClick(We),o.default.onReplyClick(Ye),o.default.onForward(Xe),Voting.onHtmlUpdate(ut),_.Messenger.onMainScroll(_e),_.Messenger.onConvoScroll(me),_.Messenger.onSearchMsgsClick(ee),_.Messenger.onConvoScroll(A.default.expandPeerBefore),_.Messenger.onConvoAtTop(de),_.Messenger.onConvoAtBottom(fe),r.default.onCloseClick(Le),r.default.onRemoveClick(Oe),r.default.onImportantClick(Ve),r.default.onReplyClick(Ue),r.default.onForwardClick(ze),r.default.onSpamClick(He),r.default.onPinClick(Be),r.default.onEditClick(Fe),a.default.onConfirmDelete(Re),PinnedMsg.onHideClick(Ze),c.default.onRejectAll(ft),im.onNewMsg(F),im.onEditMsg(L),im.onMultiTyping(De),im.onRecordingAudio(Ee),im.onOnlineChange(Se),im.onMsgReadByMe(ke),im.onMsgReadByOther(Me),im.onMsgImportantRemove(j),im.onMsgImportantAdd(R),im.onMsgRemove(H),im.onPeerKeyboard(U),im.onPeerBanner(Y),im.onPeerConvert(G),im.onMsgRequestChange(X),im.onDialogImportant(z),im.onUnreadCount(q),im.onResync(W),nav.onPopState(Te),nav.onBeforeGo(xe),nav.onBeforeGo2(Ie),page.onChange(Pe),uVK.onReady(nt),page.onChange(nt),uVK.onReady(it),page.onChange(it),page.onChange(P),page.onChange(lt),uVK.onReady(P),uVK.onReady(Ke),uVK.onReady(lt),uVK.onOrientationChange(I),A.default.loadMailPage(ct),A.default.onShowPinnedMsgClick=Je,A.default.onHidePinnedMsgClick=Ze,A.default.onBannerButtonClick=et,A.default.onBannerTextClick=tt;var E=!1,S=0;function k(){_.Messenger.scrollMainBodyToTop()}function M(){(0,g.preventDocumentScroll)();var e=_.Messenger.getMainBody();e&&(0,g.setScrollView)(e);var t=$(".leftMenu__searchItems");t&&(0,g.setScrollView)(t,{topBanner:!1,overscrollY:!1})}function T(){(0,g.restoreDocumentScroll)()}function x(){(0,g.preventDocumentScroll)({topBanner:!1}),(0,g.setScrollView)(_.Messenger.getConvoBody(),{topBanner:!1})}function I(){i.default.safari_mobile&&document.activeElement.blur()}function P(){var e=nav.getQuery("msg")||nav.getQuery("id")||nav.getQuery("edit_msg_id");e?requestAnimationFrame(function(){A.default.scrollToMsg(e)}):requestAnimationFrame(_.Messenger.scrollConvoToBottom)}function B(e){var t=store.mail.cur;storeMethods.injectMail({msgs:b({},e.id,e)}),t.groupId&&(e.adminId=t.userId),ve(e,!0)}function F(e){-1===store.mail.cur.localOutMsgIds.indexOf(e.randomId)&&ve(e)}function L(e){ve(e)}function O(){var e=store.mail,t=e.cur;e.peers;(0,h.setPeerDraft)(t.viewerId,t.peerId,{msgs:void 0},t.editing),t.msgAttached[t.peerId]=[],l.default.uiRedrawAttachments(t.peerId)}function N(e){var t=store.mail,n=(t.cur,t.rolls),i=t.msgs,o=Number(qs2obj(e.split("?")[1]).peer);i[last(n.peer[o]||[])];return Z(e)}function R(e){var t=store.mail,n=t.cur,i=t.msgs,r=t.scraps,a=t.rolls,s=i[e];if(s&&(s.isImportant=!0,a.folder.important=a.folder.important.concat(e).filter(unique).sort(desc),o.default.toggleImportant(e,!0),"important"===n.folder)){var l=r.folder.slice();r.folder=r.folder.concat(e).filter(unique).sort(desc),p.default.redrawFolder(l)}}function j(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=store.mail,i=n.cur,r=n.msgs,a=n.scraps,s=n.rolls,l=r[e];if(l&&(l.isImportant=!t,arrayRemove(s.folder.important,e),o.default.toggleImportant(e,!1),"important"===i.folder)){var u=a.folder.slice();arrayRemove(a.folder,e),p.default.redrawFolder(u)}}function H(e){var t=store.mail,n=t.cur,i=t.msgs,a=t.scraps,s=t.rolls,c=t.peers,d=i[e];if(d&&!n.msgRemoved[e]){delete i[e],arrayRemove(s.peer[d.peerId],e),n.peerId===d.peerId&&(arrayRemove(a.peer,e),o.default.remove(e,!0),n.msgSelected[e]&&(delete n.msgSelected[e],r.default.setCount(Object.keys(n.msgSelected).length),A.default.redrawMailActions()),a.peer.length?p.default.checkDivider():p.default.redrawPeer()),d.isImportant&&n.countImportant--;var f=c[d.peerId],_=f.isIncomingMR,m=f.isRejectedMR;d.isUnread&&d.authorId!==n.viewerId&&(c[d.peerId].countUnread=c[d.peerId].countUnread-1,_||m||c[d.peerId].countUnread<=0&&(n.countUnread=n.countUnread-1),l.default.redrawToBottom(),u.default.redrawCounter()),s.peer[d.peerId].length?V(d,e):ajaxRequest("/mail",{act:"get_last_msg",peer_id:d.peerId,user_id:n.userId},function(t,n){n&&(storeMethods.injectMail(t),s.peer[d.peerId].push(n)),V(d,e)},function(){V(d,e)})}}function V(e,t){var n=store.mail,i=n.cur,o=(n.msgs,n.scraps),r=n.rolls,a=n.peers,s=a[e.peerId],l=s.isIncomingMR,u=s.isRejectedMR;r.peer[e.peerId].length||(l||u?arrayRemove(r.mrs,e.peerId):(arrayRemove(r.folder.all,e.peerId),arrayRemove(r.folder.unread,e.peerId),arrayRemove(r.folder.unrespond,e.peerId)),"mrs"===i.page?arrayRemove(o.mrs,e.peerId):"important"!==i.folder&&arrayRemove(o.folder,e.peerId)),r.peer[e.peerId]=r.peer[e.peerId].filter(unique).sort(asc),l||u?r.mrs=r.mrs.filter(unique).sort(Qe):(0===s.countUnread&&(r.folder.unread=r.folder.unread.filter(function(t){return t!==e.peerId})),r.folder.all=r.folder.all.filter(unique).sort(Qe),r.folder.unread=r.folder.unread.filter(unique).sort(Qe),i.groupId&&(r.folder.unrespond=r.folder.unrespond.filter(unique).sort(Qe))),"mrs"===i.page?(o.mrs=o.mrs.filter(unique).sort(Qe),p.default.redrawMRs()):"important"===i.folder?(arrayRemove(o.folder,t),p.default.redrawFolder()):"all"===i.folder?(o.folder=o.folder.filter(unique).sort(Qe),p.default.redrawFolder()):"unread"===i.folder?(0===a[e.peerId].countUnread&&arrayRemove(o.folder,e.peerId),o.folder=o.folder.filter(unique).sort(Qe),p.default.redrawFolder()):"unrespond"===i.folder&&(o.folder=o.folder.filter(unique).sort(Qe),p.default.redrawFolder())}function U(e){var t=store.mail,n=t.peers,i=t.cur;if(n[e]){var o=(0,h.getKeyboardState)(e);if(!(Date.now()-o.updateTime<=500)){var r=o.updateTime;ajaxRequest("/mail",{act:"get_peers",peer_ids:[e]},function(t){r===o.updateTime&&(storeMethods.injectMail(t),e==i.peerId&&l.default.renderKeyboardIfNeeded({update:!0}))})}}}function z(e,t){var n=store.mail.peers[e];n&&(n.isImportant=t),s.default.redrawImportant(e,t)}function q(e){nav.getQuery("community")||function(e){if(setNotify(e),!window.al||!window.al.menu)return;var t=window.al,n=new Array(t.menu.length);n[2]=e,menu.refreshCounters(n)}(e);var t=store.mail.cur;t&&(t.countUnread=e,u.default.redrawCounter())}function W(){im.pause(),K(function(){im.resume()})}function Y(e){Date.now()-S<=500||ajaxRequest("/mail",{act:"get_peers",peer_ids:[e]},function(t){var n=store.mail.cur;storeMethods.injectMail(t),e==n.peerId&&A.default.redrawBanner()})}function G(e,t){Q(t,function(n){(0,h.replacePeer)(e,t),storeMethods.injectMail(n);var i=store.mail.cur;e===i.peerId?(p.default.redrawFolder(),t===i.peerId?ae(t):Z("/mail?act=show&peer="+t,{replace:!0})):i.folder&&p.default.redrawFolder()})}function X(e,t){var n=store.mail.cur;n&&("created"!==t&&C||("created"===t&&C&&(C=!1),"created"===t?(n.countMR+=1,Q(e,function(t){(0,h.removePeer)(e),storeMethods.injectMail(t),n.folder&&(p.default.redrawFolder(),A.default.redrawMRsHint()),n.peerId===e&&ae(e)})):"canceled"===t?(n.countMR=Math.max(n.countMR-1,0),Q(e,function(t){(0,h.removePeer)(e),storeMethods.injectMail(t),n.folder&&(p.default.redrawFolder(),A.default.redrawMRsHint()),n.peerId===e&&ae(e)})):"rejected"===t?(n.countMR=Math.max(n.countMR-1,0),Q(e,function(t){(0,h.removePeer)(e),storeMethods.injectMail(t),n.folder&&(p.default.redrawFolder(),A.default.redrawMRsHint()),n.peerId===e&&ae(e)})):"accepted"===t&&(n.countMR=Math.max(n.countMR-1,0),Q(e,function(t){(0,h.addPeer)(e),storeMethods.injectMail(t),n.folder&&(p.default.redrawFolder(),A.default.redrawMRsHint()),n.peerId===e&&ae(e)}))))}function Q(e,t){im.pause(),ajaxRequest("/mail",{act:"get_peers",peer_ids:[e]},function(e){t(e),im.resume()})}function K(e){var t=store.mail,n=t.cur,i=t.msgs,o=t.scraps,r=t.rolls;r.folder[n.folder]=[],o.folder=[],_.Messenger.setMainLoading(!0),ajaxRequest("/mail",{act:"all"===n.folder?null:n.folder,offset:0},function(t,a){if(store.mail.cur){storeMethods.injectMail(t),"all"!==n.folder&&"unread"!==n.folder||Object.keys(t.msgs).forEach(function(e){e=toInt(e);var n=t.msgs[e].peerId;r.peer[n]=(r.peer[n]||[]).concat(e).filter(function(e){return!!i[e]}).filter(unique).sort(asc)});var s="important"===n.folder,l=s?desc:Qe,c=Object.keys(s?t.msgs:t.peers).map(toInt).sort(l).filter(function(e){return-1===o.folder.indexOf(e)}),d=[].concat(c).filter(unique).sort(l);r.folder[n.folder]=d,o.folder=first(20,d),store.mail.reached.folder[n.folder]=a,p.default.redrawFolder(),u.default.redrawCounter(),_.Messenger.setMainLoading(!1),e&&e()}})}function J(){"/mail"!==location.pathname&&0!==location.pathname.indexOf("/write")||dt()}function Z(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=ie(e);return e=makeUrl(e),n&&location.pathname+location.search!==e&&nav.go(e,!1,{push_only:!0,replace:!0===t.replace}),n||(p.default.resetPrevScraps(),store.mail={},store.uiLastId=0,store.uiState={}),n}function ee(){Z("/mail?q="+store.mail.cur.query+"&tab=messages")}function te(e){var t=te;if(t.timer&&clearTimeout(t.timer),store.mail.cur){var n=store.mail.cur,i=!n.query;if(e){var o="msgs"===n.tab?"&tab=messages":"",r=makeUrl("/mail?q="+e+o);ie(r),i?Z(r):t.timer=setTimeout(function(){Z(r,{replace:!0})},300)}else Z("/mail",{replace:!0})}}function ne(){_.Messenger.setMainLoading(!1),_.Messenger.setConvoLoading(!1),te.clearTimer(),Z("/mail",{replace:!0})}function ie(e){var t=(e=makeUrl(e)).split("?"),n=t[0],i=qs2obj(t[1]),o=store.mail,r=o.cur,a=o.scraps;if(r){var s=i.act,l=i.peer,c=i.chat,d=i.email,f=i.m,m=toInt(i.msg)||toInt(i.id)||null,h="messages"===i.tab?"msgs":"peers",v=i.q||"",y=+i.community||0;if(xe())return!0;if("/mail"!==n||"add_to_chat"===s||"flush_history"===s||"info"===s||"msg"===s||"unpin"===s||"leave_chat"===s||"new_chat"===s||"chat_preview"===s||"return_to_chat"===s||"show_medias"===s||"toggle_community_block"===s||"community_toggle_important"===s||"ban_user"===s||"community_mark_answered"===s||"invite_link"===s||"reset_link"===s||"send"===s||"show"===s&&i.id||70==f||71==f||76==f||784==f||783==f||786==f||785==f||787==f)return D("[mail nav] Exit Mail"),T(),(0,g.cleanScrollView)(_.Messenger.getConvoBody()),im.off(),A.default.stopPolling(),void u.default.cancelStatusUpdate();if((r.groupId?-r.groupId:0)===y){m&&(E=!0),p.default.clearSystemMessage2();var w=l?toInt(l):c?toInt(c)+2e9:d?-toInt(d)-2e9:null,b="unread"===s||"important"===s||"unrespond"===s?s:"all",C=function(e){switch(e){case"template":case"mrs":return!0}return!1}(s),S=!C&&!!r.page,k=r.query!==v||r.tab!==h,M=r.page;if(S&&(r.page=null),k&&w&&("peers"===r.tab?store.mail.cur.mvk_entrypoint="conversations_search":"msgs"===r.tab&&(store.mail.cur.mvk_entrypoint="message_search")),r.peerId&&!w&&v)D("[mail nav] Peer back to Search"),r.query=v,r.peerId=null,r.tab=h,se(),_.Messenger.setQuery(v),ce();else if(k&&r.peerId===w)r.query=v,r.tab=h,a.search=[],r.tab!==h&&(store.mail.reached.search.msgs={}),A.default.redrawView(),_.Messenger.setQuery(v),p.default.redrawSearch(),v?(D("[mail nav] Search update"),ce()):(D("[mail nav] Search exit"),function(){var e=store.mail,t=e.cur,n=e.scraps;t.query="",t.tab="peers",n.search=[],A.default.redrawView(),p.default.redrawSearch(),_.Messenger.setQuery("")}(),0===a.folder.length&&ue());else if(C){D("[mail nav] Enter Page"),r.page=s,r.peerId&&(r.peerId=null,se()),A.default.redrawView();var x=_.Messenger.getPageLayer();x.classList.toggle("messenger__layer_loading",!0),x.innerHTML=(0,_.Messenger_renderLoadingPage)(),ajaxRequest(e,{},function(e,t){t&&storeMethods.injectMail(t),x.classList.toggle("messenger__layer_loading",!1),x.innerHTML=e})}else r.peerId!==w||S&&w?w?(D("[mail nav] Enter Dialog"),function(e,t){var n=store.mail.cur;if("mrs"===t.page)n.backUrl="/mail?act=mrs";else if(n.forwardFromId&&n.forwardFromId!==e)n.backUrl="/mail?act=show&peer="+n.forwardFromId;else if(n.query){var i="msgs"===n.tab?"&tab=messages":"";n.backUrl="/mail?q="+n.query+i}else if(n.folder&&!n.forwardFromId){var o="";"all"!==n.folder&&(o="?act="+n.folder),n.backUrl="/mail"+o}else n.backUrl=null}(w,{page:M}),ae(w,m)):(D("[mail nav] Exit Dialog"),se(),oe(b),_.Messenger.getMainBody().scrollTop=0,ue()):w&&f?(D("[mail nav] Peer System Msg"),store.mail.peers[w].systemMessageCode=toInt(f),p.default.updateClass("peer"),p.default.redrawSystemMessage(),_.Messenger.scrollConvoToBottom()):(r.folder!==b||S&&b)&&(D("[mail nav] Enter Folder"),oe(b),_.Messenger.getMainBody().scrollTop=0,ue());return!0}}}function oe(e){var t=store.mail,n=t.cur,i=t.scraps,o=t.rolls;n.folder=e,re()?K():(i.folder=first(20,o.folder[e]),p.default.folderSetItems(i.folder),A.default.redrawView(),u.default.redraw())}function re(){var e=store.mail,t=e.rolls,n=e.cur,i=e.msgs,o=t.folder[n.folder];return!o||("important"===n.folder?o.some(function(e){return!i[e]}):o.some(function(e){return!(t.peer[e]&&t.peer[e].length>0)}))}function ae(e,t){var n=store.mail,i=n.cur,o=n.msgs,r=n.peers,a=n.scraps,c=n.rolls,d=n.reached;if(r[e]){var f=c.peer[e]||[];if(t||!(r[e].countUnread>0)||r[e].isIncomingMR||r[e].isRejectedMR){i.peerId=e,a.peer=[],Ke(),t?(a.peer=[t],c.peer[e]=[],d.peer.before[e]=!1,d.peer.after[e]=!1):(a.peer=last(20,f),h()),store.mail.reached.peer.after[e]=!0,p.default.updateClass("peer"),A.default.redrawView(),_.Messenger.redrawConvoLayer(),nt(),u.default.startStatusUpdate(),p.default.peerSetItems(a.peer),l.default.init(),x(),t||le(e);r[e];t&&(p.default.updateClass("peer"),A.default.scrollToMsg(t)),t?de(t):de(),(0,y.resizePosters)(),requestAnimationFrame(function(){t||_.Messenger.scrollConvoToBottom(),AudioMessagePlayer.redrawWaves(),requestAnimationFrame(function(){t||_.Messenger.scrollConvoToBottom()})})}else{_.Messenger.setConvoLoading(!0),window._preventedCheckTop=!0,E=!0,i.peerId=e,a.peer=[],Ke(),s.default.redrawUnread(e),A.default.redrawView(),_.Messenger.redrawConvoLayer(),nt(),u.default.startStatusUpdate(),h(),p.default.peerSetItems([]),l.default.init(),x();var m={act:"show",peer_id:e,msg:"unread",reply_msg_id:i.msgReply[i.peerId]};ajaxRequest("/mail",m,function(t,n,i){if(store.mail.cur){var r=t.rolls.peer[e];if(storeMethods.injectMail(t),d.peer.after[e]=n,d.peer.before[e]=i,f=c.peer[e]||[],(arrayIntersects(r,f)||n&&0===f.length)&&(c.peer[e]=f.concat(r).filter(unique).sort(asc)),store.mail.cur.peerId===e){l.default.preventShowToBottom(),a.peer=r.slice(),geByClass1("mailScrap__items_peer").innerHTML="",p.default.updateClass("peer"),p.default.peerSetItems(r),AudioMessagePlayer.redrawWaves(),le(e);var s=r.find(function(e){return o[e].isUnread});A.default.scrollToMsg(s,!0,!1),requestAnimationFrame(function(){window._preventedCheckTop=!1,E=!1,_.Messenger.setConvoLoading(!1)})}}})}}else ajaxRequest("/mail",{act:"get_peers",peer_ids:[e]},function(n){storeMethods.injectMail(n),r[e]?ae(e,t):window.location.reload()});function h(){i.forwardFromId&&($e(),i.forwardFromId=null)}}function se(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=store.mail,n=t.cur,i=t.scraps;u.default.cancelStatusUpdate(),at(),n.peerId=null,n.mvk_entrypoint="",i.peer=[],Ke(),n.hasAttachments=!1,e.keepSelected||(n.msgSelected={}),A.default.redrawView(),u.default.redraw(),l.default.reset(),(0,g.cleanScrollView)(_.Messenger.getConvoBody()),M(),requestAnimationFrame(function(){r.default.setCount(0),A.default.redrawMailActions(),d.default.redraw(),requestAnimationFrame(function(){p.default.peerSetItems(i.peer)})})}function le(e,t){t||(t=function(){});var n=store.mail.peers[e];n&&(n.isIncomingMR||n.isRejectedMR)||(!n||n.countUnread>0?ajaxRequest("/mail",{act:"read_dialog",peer_id:e,hash:n.hashRead},function(){ke(null,e)}):setTimeout(function(){ke(null,e)},500))}function ue(){var e=ue,t=e.locked||(e.locked={}),n=store.mail,i=n.cur,o=n.scraps,r=n.rolls,a=n.reached,s=i.folder,l=o.folder,c=r.folder[s],d="folder_"+s,f=a.folder[s]&&last(l)===last(c);if(_.Messenger.setMainLoading(0===l.length&&!f),!t[d]&&!f){var m="important"===s,h=re(),v=m?desc:Qe,g=[];if(0===l.length)g=first(20,c);else{var y=c.indexOf(last(l));g=y>=0?c.slice(y+1,y+21):[]}if(g.length&&!h){var w=l.concat(g).filter(unique).sort(v);o.folder=w,p.default.folderAddItems(g)}else{t[d]=!0;var b="all"===s?null:s,D=h?0:l.length;ajaxRequest("/mail",{act:b,offset:D},function(e,n){if(store.mail.cur){storeMethods.injectMail(e),Object.keys(e.peers).forEach(function(e){store.mail.reached.peer.after[e]=!0}),"all"!==s&&"unread"!==s||Object.keys(e.msgs).forEach(function(t){t=toInt(t);var n=e.msgs[t].peerId;r.peer[n]=(r.peer[n]||[]).concat(t).filter(unique).sort(asc)});var f=Object.keys(m?e.msgs:e.peers).map(toInt).sort(v).filter(function(e){return-1===l.indexOf(e)}),g=c.concat(f).filter(unique).sort(v);r.folder[s]=g,n&&(a.folder[s]=n),t[d]=!1,i.folder===s&&(o.folder=g,p.default.updateClass("folder"),p.default.folderAddItems(f),_.Messenger.setMainLoading(!1),h&&(p.default.folderSetItems(o.folder),A.default.redrawView(),u.default.redraw()))}})}}}function ce(){var e=ce,t=e.locked||(e.locked={}),n=store.mail,i=n.cur,o=n.scraps,r=n.rolls,a=n.reached,s=i.tab,l=i.query,u="search_msgs_"+s+"_"+l,c=o.search,d=r.search[s][l]||[],f=a.search[s][l]&&last(c)===last(d);if(_.Messenger.setMainLoading(0===c.length&&!f),!t[u]&&!f){var A=[];if("peers"===s&&(d.length||(d=function(){var e=store.mail,t=e.cur,n=e.peers,i=(e.rolls,Object.keys(n).map(toInt)),o=[];return QuickSearch.getQueryREs(t.query).forEach(function(e){i.forEach(function(t){n[t].title.match(e)&&o.push(t)})}),o.filter(unique).sort(Qe)}()),d.length))if(0===c.length)A=first(20,d);else{var m=d.indexOf(c);A=m>=0?d.slice(m+1,m+41):[]}if(A.length&&(o.search=c.concat(A).filter(unique),p.default.redrawSearch(),p.default.updateClass("search"),_.Messenger.setMainLoading(!1)),!A.length||"peers"===s){var h="msgs"===s?{act:"search",q:l,offset:o.search.length,messages:1}:{act:"search",q:l};e.timer&&clearTimeout(e.timer),e.timer=setTimeout(function(){t[u]=!0,ajaxRequest("/mail",h,function(e,n){if(store.mail.cur){t[u]=!1,storeMethods.injectMail(e);var c=Object.keys("peers"===s?e.peers:e.msgs).map(toInt),f="peers"===s?Qe:desc,A=d.concat(c).filter(unique).sort(f);r.search[s][l]=A,n&&(a.search[s][l]=n),i.tab===s&&i.query===l&&(_.Messenger.setMainLoading(!1),o.search=o.search.concat(c).filter(unique).sort(f),p.default.redrawSearch(),p.default.updateClass("search"))}})},300)}}}function de(e){if(!$(".load_before_closed")){var t=de,n=t.locked||(t.locked={}),i=store.mail,o=i.cur,r=i.scraps,a=i.rolls,s=i.reached;if(o){var u=o.peerId,c=r.peer,d=a.peer[u]||[],f="peer_before_"+u,m=s.peer.before[u]&&c[0]===d[0],h=o.msgReply[u];if(_.Messenger.setConvoLoading(c.length<1&&!m),!n[f]&&!m){var v=_.Messenger.getConvoBody(),g=!arrayIntersects(c,d),y=first(c),w=y?d.indexOf(y):-1,b=0===c.length?last(10,d):w>=0?d.slice(w-20,w):[];if(b.length&&!e){if(v.scrollTop>6e3&&!g)return;if(window._preventedCheckTop)return;var D=r.peer.slice(),C=c.concat(b).filter(unique).sort(asc);r.peer=C,p.default.peerAddItemsBefore(b.filter(function(e){return-1===D.indexOf(e)})),AudioMessagePlayer.redrawWaves(),p.default.updateClass("peer"),_.Messenger.setConvoLoading(!1)}else{if(!u)return;var S={act:"show",peer_id:u,msg:c[0],direction:e?"around":"before",reply_msg_id:h},k=c[0];n[f]=!0,ajaxRequest("/mail",S,function(t,i,o){if(store.mail.cur){e&&setTimeout(function(){E=!1},10),n[f]=!1,storeMethods.injectMail(t);var m=Object.keys(t.msgs).map(toInt).filter(function(e){return-1===c.indexOf(e)}),h=c.concat(m).filter(unique).sort(asc);if(o&&(s.peer.before[u]=!0),i&&(s.peer.after[u]=!0),d=a.peer[u]||[],(arrayIntersects(h,d)||o&&0===d.length)&&(a.peer[u]=(a.peer[u]||[]).concat(h).filter(unique).sort(asc)),store.mail.cur.peerId===u){if(l.default.preventShowToBottom(),v.scrollTop>6e3&&!g)return;var y=r.peer.slice();r.peer=h,p.default.updateClass("peer"),k?(p.default.peerAddItemsBefore(m.filter(function(e){return-1===y.indexOf(e)&&e<k}),!0),p.default.peerAddItemsAfter(m.filter(function(e){return-1===y.indexOf(e)&&e>k}),!0)):p.default.peerAddItemsBefore(m,!0),e&&(A.default.scrollToMsg(e),_.Messenger.setConvoLoading(!1)),AudioMessagePlayer.redrawWaves(),_.Messenger.setConvoLoading(!1),A.default.expandPeerBefore(),setTimeout(A.default.expandPeerBefore,100),e&&$e(),l.default.redrawReply()}}})}}}}}function fe(){var e=fe,t=e.locked||(e.locked={}),n=store.mail,i=n.cur,o=n.scraps,r=n.rolls,a=n.reached;if(!E&&i){var s=i.peerId,l=o.peer,u=r.peer[s]||[],c="peer_after_"+s;if(!(t[c]||a.peer.after[s]&&last(l)===last(u))){var d=_.Messenger.getConvoBody(),f=!arrayIntersects(l,u),A=function(){return d.scrollHeight-d.scrollTop-d.offsetHeight},m=last(l),h=m?u.indexOf(m):-1,v=h>=0?u.slice(h+1,h+21):[];if(!v.length||nav.getQuery("msg")||nav.getQuery("id")){if(!s)return;var g={act:"show",peer_id:s,msg:last(l),direction:"after"};t[c]=!0,ajaxRequest("/mail",g,function(e,n){if(store.mail.cur){t[c]=!1,storeMethods.injectMail(e);var i=Object.keys(e.msgs).map(toInt).filter(function(e){return-1===l.indexOf(e)}).sort(asc),d=l.concat(i).filter(unique).sort(asc);if(n&&(a.peer.after[s]=n),u=r.peer[s]||[],(arrayIntersects(d,u)||n&&0===u.length)&&(r.peer[s]=(r.peer[s]||[]).concat(d).filter(unique).sort(asc)),store.mail.cur.peerId===s){if(A()>6e3&&!f)return;n&&p.default.updateClass("peer"),o.peer=d,p.default.updateClass("peer"),p.default.peerAddItemsAfter(i),AudioMessagePlayer.redrawWaves()}}})}else{if(A()>6e3&&!f)return;var y=l.concat(v).filter(unique).sort(asc);o.peer=y,p.default.peerAddItemsAfter(v),p.default.updateClass("peer"),AudioMessagePlayer.redrawWaves()}}}}te.clearTimer=function(){self=te,self.timer&&(clearTimeout(self.timer),self.timer=null)};var pe=!1;function _e(e){var t=store.mail,n=t.cur,i=t.scraps,o=t.rolls,r=e.scrollTop,a=e.scrollHeight,s=e.offsetHeight;if(n)if(!n.query&&r<=20&&i.folder.length){if(pe){pe=!1;i.folder.slice();i.folder=first(20,o.folder[n.folder]),p.default.folderCutItems(20)}}else r>20&&(pe=!0,a-r-s<window.innerHeight&&(n.query?ce():ue()))}function Ae(){var e=store.mail,t=e.cur,n=e.scraps,i=e.rolls,o=e.reached,r=n.peer,a=i.peer[t.peerId]||[];if(a.length&&last(r)===last(a)&&o.peer.after[t.peerId])_.Messenger.scrollConvoToBottom(),l.default.hideToBottom(),p.default.updateClass("peer");else{var s=t.peerId;ajaxRequest("/mail",{act:"show",peer_id:s},function(e,t){if(store.mail.cur){var r=e.rolls.peer[s];i.peer[s]=r.slice(),storeMethods.injectMail(e),o.peer.after[s]=!0,store.mail.cur.peerId===s&&(l.default.preventShowToBottom(),n.peer=r.slice(),geByClass1("mailScrap__items_peer").innerHTML="",p.default.peerAddItemsBefore(r),p.default.updateClass("peer"),_.Messenger.scrollConvoToBottom(),AudioMessagePlayer.redrawWaves())}})}}function me(e){var t=me;t.timer||(t.timer=setTimeout(function(){t.timer=null,function(e){var t=store.mail,n=t.cur,i=t.scraps,r=t.msgs,a=t.peers;if(!n)return;var s=i.peer.find(function(e){return r[e]&&r[e].isUnread&&r[e].authorId!==n.viewerId}),u=e.scrollTop,c=e.scrollHeight-u-e.offsetHeight;if(s){var d=o.default.getElem(s),f=e.scrollHeight-d.offsetTop;c-f<=100&&le(n.peerId)}e._prevScroll||(e._prevScroll=0),c<300&&$(".mailScrap_reachedAfter")?l.default.hideToBottom():u>e._prevScroll-5||n.peerId&&a[n.peerId].countUnread?l.default.showToBottom():l.default.hideToBottom();e._prevScroll=u}(e)},50))}function he(e){return vk.id==e.peerId&&!cur.groupId||2&e.flags}function ve(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.peerId,i=e.msgId,o=e.authorId,r=e.text,a=e.date,c=e.hasAttachments,v=e.flags,g=e.adminId,y=e.isService,w=e.isStealth,D=e.keyboard,C=store.mail,E=C.cur,S=C.peers,k=(C.msgs,C.members),M=C.rolls,T=C.scraps,x=C.reached;i||(i=e.id),g&&o>0&&(o=-o);var I=E.groupId?E.groupId===o:E.userId===o,P=!I,B=S[n]&&0===S[n].countUnread&&P,F=!!e.edited||!!e.refreshed,L=S[n]&&S[n].pinnedMsgId==i;if(!t&&(y||!r||c||!S[n]||!k[o]||g&&!k[g]||/\[[a-z]+\d+\|.+\]/.test(r)||L)){if(!F&&P)(0,h.getKeyboardState)(n).updateTime=Date.now();return F||w||!B||(E.countUnread+=1,u.default.redrawCounter()),im.pause(),void ajaxRequest("/mail",{act:"message",message_id:i,forcePinned:L},function(e,t){if(store.mail.cur){storeMethods.injectMail(e);var r=S[n],a=r.isIncomingMR,u=r.isRejectedMR;if(t.unpin){S[n].pinnedMsg="",S[n].hasPinnedMsg=!1;var c=ot();delete c[n],rt(c),E.peerId===n&&(A.default.redrawPinnedMsg(),nt())}else t.pinned&&(S[n].pinnedMsg=t.pinned,S[n].hasPinnedMsg=!0,E.peerId===n&&(A.default.redrawPinnedMsg(),nt()));if(F)p.default.peerReplaceItems([i]);else{var m=last(M.peer[n]||[]);if(M.peer[n]=(M.peer[n]||[]).concat(i).filter(unique).sort(asc),w||a||u||(M.folder.all=M.folder.all.concat(n).filter(unique).sort(Qe),P&&(M.folder.unread=M.folder.unread.concat(n).filter(unique).sort(Qe)),E.groupId&&(P?M.folder.unrespond=M.folder.unrespond.concat(n).filter(unique).sort(Qe):arrayRemove(M.folder.unrespond,n))),n===E.peerId&&l.default.renderKeyboardIfNeeded({update:!0}),!w&&!a&&!u){if("all"===E.folder){var v=T.folder.slice();T.folder=T.folder.concat(n).filter(unique).sort(Qe),p.default.redrawFolder(v)}else if("unread"===E.folder&&P){var g=T.folder.slice();T.folder=T.folder.concat(n).filter(unique).sort(Qe),p.default.redrawFolder(g)}else if("unrespond"===E.folder){var y=T.folder.slice();P?T.folder=T.folder.concat(n).filter(unique).sort(Qe):arrayRemove(T.folder,n),p.default.redrawFolder(y)}x.peer.after[n]||(x.peer.after[n]=!0,x.peer.before[n]=!1)}if(a&&T.mrs){var b=T.mrs.slice();T.mrs=T.mrs.concat(n).filter(unique).sort(Qe),p.default.redrawMRs(b)}if(E.peerId===n&&(arrayIntersects(T.peer,M.peer[n])||0===T.peer.length)&&last(T.peer)===m){T.peer=T.peer.concat(i).filter(unique).sort(asc);var D=_.Messenger.getConvoBody(),C=D.scrollTop+D.offsetHeight>=D.scrollHeight-2;p.default.peerAddItemsAfter([i]);var k=D.scrollHeight-D.scrollTop-D.offsetHeight<400;C&&_.Messenger.scrollConvoToBottom(),D.scrollTop+D.offsetHeight===D.scrollHeight&&_.Messenger.scrollConvoToBottom(),k?le(n):l.default.showToBottom(),o===E.viewerId&&p.default.removeDivider(),o!==E.viewerId&&e.msgs&&e.msgs[i]&&StickersAnimation.checkSettingsAndLoad(e.msgs[i],!0)}}if(!F){var I=(0,f.uTyping_getPeerTyping)(n);I&&I.users.length&&((0,h.removePeerTypingUser)(n,o),n===E.peerId&&d.default.redraw(),s.default.redrawTyping(n))}w||(s.default.redrawLastMsg(n),s.default.redrawUnread(n)),n===E.peerId&&AudioMessagePlayer.redrawWaves(),im.resume()}},function(){im.resume()})}var O=S[n],N=O.isIncomingMR,R=O.isRejectedMR,j=e.textShort||(I?'<span class="convo__msgAuthor">'+lang.mobile_mail_you+":</span> "+r:o!==n?'<span class="convo__msgAuthor">'+k[o].firstName+":</span> "+r:r),H=void 0;"string"==typeof e.textInput?H=e.textInput:r&&(H=r.replace(/<br>/g,"\n").replace(/\[((id|club)\d+)\|@(\S+?)]/g,"@$3").replace(/\[((id|club)\d+)\|(\S+?)]/g,"@$1 ($3)"));var V=store.mail.msgs[i],U=_.Messenger.getConvoBody(),z=V?!V.isUnread:E.viewerId===n||E.peerId===n&&P&&U.scrollHeight-U.scrollTop-U.offsetHeight<400&&!!$(".mailScrap_reachedAfter");if(!t){var q=void 0;q=e.replaced?!!V&&V.edited:!(!e.edited&&!e.refreshed);var W={id:i,peerId:n,authorId:o,date:a,dateShort:e.dateShort||a,textShort:j,textFull:e.textFull||mail.wrapLinks(r,v),textInput:H,body:e.body||r||"",isUnread:!z,edited:q,canE:t?e.canE:he(e),attaches:e.attaches||{},forwards:e.forwards||0,hasReply:!!e.hasReply};g&&(W.adminName=e.adminName||(g===E.userId?lang.mobile_mail_you:k[g].name),W.adminUrl=e.adminUrl||k[g].url),storeMethods.injectMail({msgs:b({},i,W)})}if(!z||N||R||(ajaxRequest("/mail",{act:"read_message",msg_id:i,peer_id:n,hash:S[n].hashRead},function(){}),ke(null,n)),F)p.default.peerReplaceItems([i]);else{var Y=last(M.peer[n]||[]);M.peer[n]=(M.peer[n]||[]).concat(i).filter(unique).sort(asc),w||N||R||(M.folder.all=M.folder.all.concat(n).filter(unique).sort(Qe),x.peer.after[n]||(x.peer.after[n]=!0,x.peer.before[n]=!1));var G=S[n];if(P){if(D){if(D.buttons&&D.buttons.length){G.keyboard=Object.assign(D,{author_id:o,chat_local_id:i});var X=document.createElement("div");G.keyboard.buttons.forEach(function(e){e.forEach(function(e){var t=e.action.label;X.textContent=t;var n=X.innerHTML;e.action.label=(0,m.emojiToHTML)(n),e.action.rawLabel=t})}),X=null}else G.keyboard=null;(0,h.getKeyboardState)(n).updateTime=Date.now(),n===E.peerId&&l.default.renderKeyboardIfNeeded({update:!0})}w||(N&&!R&&(M.folder.unread=M.folder.unread.concat(n).filter(unique).sort(Qe)),G.countUnread||(G.countUnread=0),G.countUnread+=1),n!==E.peerId&&w||l.default.redrawToBottom()}if(!w&&!N&&!R)if(B&&(E.countUnread+=1,u.default.redrawCounter()),E.groupId&&(P?M.folder.unrespond=M.folder.unrespond.concat(n).filter(unique).sort(Qe):arrayRemove(M.folder.unrespond,n)),"all"===E.folder){var Q=T.folder.slice();T.folder=T.folder.concat(n).filter(unique).sort(Qe),p.default.redrawFolder(Q)}else if("unread"===E.folder&&o!==E.viewerId){var K=T.folder.slice();T.folder=T.folder.concat(n).filter(unique).sort(Qe),p.default.redrawFolder(K)}else if("unrespond"===E.folder){var J=T.folder.slice();P?T.folder=T.folder.concat(n).filter(unique).sort(Qe):arrayRemove(T.folder,n),p.default.redrawFolder(J)}if(N&&T.mrs){var Z=T.mrs.slice();T.mrs=T.mrs.concat(n).filter(unique).sort(Qe),p.default.redrawMRs(Z)}if(E.peerId===n&&(arrayIntersects(T.peer,M.peer[n])||0===T.peer.length)&&last(T.peer)===Y){T.peer.slice();T.peer=T.peer.concat(i).filter(unique).sort(asc);var ee=_.Messenger.getConvoBody(),te=ee.scrollTop+ee.offsetHeight>=ee.scrollHeight-2;p.default.peerAddItemsAfter([i]),t&&p.default.peerGoToBottom();var ne=ee.scrollHeight-ee.scrollTop-ee.offsetHeight<400;te&&_.Messenger.scrollConvoToBottom(),P&&(ne||l.default.showToBottom()),o===E.viewerId&&p.default.removeDivider()}o===E.viewerId&&StickersAnimation.checkSettingsAndLoad(e,!0)}if(!F){var ie=(0,f.uTyping_getPeerTyping)(n);ie&&ie.users.length&&((0,h.removePeerTypingUser)(n,o),n===E.peerId&&d.default.redraw(),s.default.redrawTyping(n))}w||(s.default.redrawLastMsg(n),s.default.redrawUnread(n)),n===E.peerId&&AudioMessagePlayer.redrawWaves()}function ye(){if(store.mail.cur){var e=store.mail.cur.backUrl;store.mail.cur.backUrl=null,e?history.back():(Z("/mail",{replace:!0}),M())}}function we(){var e=store.mail.cur,t=e.msgSelected,n=e.forwardFromId;e.forwardFromId=null,Object.keys(t).forEach(function(e){delete t[e]}),o.default.unselectAll(),A.default.redrawMailActions(),n&&ae(n)}var be={};function De(e,t,n){var i=store.mail,o=i.cur,r=i.peers,a=r?r[e]:null;if(a&&!a.isIncomingMR&&!a.isRejectedMR){var l=(0,h.filterPeerTypingUser)({type:"text",users:t,count:n},o.viewerId);(0,h.setPeerTyping)(e,l);var u=be[e];u&&clearTimeout(u),l.count&&l.users.length&&(be[e]=setTimeout(function(){be[e]=null,De(e,[],0)},7e3)),e===o.peerId&&d.default.redraw(),s.default.redrawTyping(e)}}var Ce={};function Ee(e,t,n){var i=store.mail,o=i.cur,r=i.peers;if(r?r[e]:null){var a=(0,h.filterPeerTypingUser)({type:"audio",users:t,count:n},o.viewerId);(0,h.setPeerTyping)(e,a);var l=Ce[e];l&&clearTimeout(l),a.count&&a.users.length&&(Ce[e]=setTimeout(function(){Ce[e]=null,Ee(e,[],0)},7e3)),e===o.peerId&&d.default.redraw(),s.default.redrawTyping(e)}}function Se(e){var t=e.userId,n=e.isOnline,i=e.onlinePlatform,o=e.lastActionTime,r=store.mail,a=r.cur,l=r.peers[t];l&&(l.isOnline=n,e.isOnline&&(l.onlinePlatform=i),o&&(l.lastActionTime=o),s.default.redrawOnline(t),a.peerId===t&&u.default.redrawOnline())}function ke(e,t){var n=store.mail,i=n.cur,r=n.peers,a=n.msgs,c=n.scraps,d=n.rolls;if(i){var f=i.peerId===t?c.peer:[],_=d.peer[t]||[],A=r[t];if(_.concat(f).forEach(function(e){var t=a[e];t&&t.isUnread&&t.authorId!==i.viewerId&&(delete t.isUnread,o.default.markAsRead(e))}),A?A.countUnread&&(i.countUnread-=1,A.countUnread=0):i.countUnread-=1,arrayRemove(d.folder.unread,t),"unread"===i.folder){var m=c.folder.slice();arrayRemove(c.folder,t),p.default.redrawFolder(m)}u.default.redrawCounter(),l.default.redrawToBottom(),s.default.redrawUnread(t)}}function Me(e,t){var n=store.mail,i=n.cur,r=n.msgs,a=n.rolls,l=n.scraps,u=a.peer[t]||[];if(r[e])for(var c=u.indexOf(e);c>=0;){var d=r[u[c]];d.authorId===i.viewerId&&d.isUnread&&(delete d.isUnread,o.default.markAsRead(d.id)),c--}else last(u)&&e<=last(u)&&u.forEach(function(e){var t=r[e];t.authorId===i.viewerId&&t.isUnread&&(delete t.isUnread,o.default.markAsRead(t.id))});i.peerId===t&&l.peer.forEach(function(e){var t=r[e];t.authorId===i.viewerId&&t.isUnread&&(delete t.isUnread,o.default.markAsRead(t.id))}),s.default.redrawUnread(t)}function Te(){if(xe())return!0;var e=store.mail.cur;if(e&&e.forwardFromId)return we(),!0;i.default.safari_mobile&&document.activeElement.blur();var t=qs2obj(location.search.slice(1)).act;if(!$(".uMessenger")&&"/mail"===location.pathname&&"show_medias"!==t)return nav.go(location,null,{no_push:!0,need_restore:!1}),!0;var n=new RegExp(/z=photo/).test(location.search);if($(".uMessenger")&&!n&&!ge("z_photoview")&&!ge("StoriesView")){var o=ie(location.pathname+location.search);return o&&nav.go(location.pathname+location.search,null,{no_push:!0,push_only:!0}),o}}function xe(){var e=xe;if(mediaUpload.isUploading)return e.noAlert||alert(unescapeAttr(lang.mobile_mail_wait_until_uploaded)),e.noAlert=!0,setTimeout(function(){e.noAlert=!1},10),!0}function Ie(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=store.mail.cur;if(!("/mail"===n&&o&&o.groupId||i.replace))return!t.m&&geByClass1("uMessenger")?Z(n):void 0}function Pe(){window.isNewMail&&(store.mail.cur?"/mail"!==location.pathname&&0!==location.pathname.indexOf("/write")?T():dt():te.clearTimer())}function Be(){var e=store.mail,t=e.cur,n=(e.msgs,e.peers),i=e.hash,r=t.msgSelected,a=toInt(Object.keys(r)[0]),s=n[t.peerId];t.hasAttachments=!1,t.msgSelected={},s.pinnedMsgId=a,s.hasPinnedMsg=!0,o.default.unselectAll(),A.default.redrawMailActions(),ajaxRequest("/mail?act=pin",{hash:i.pin,chat:nav.getQuery("chat")||store.mail.cur.peerId-2e9,msg:a,_ajax:1})}function Fe(){var e=store.mail,t=e.cur,n=e.msgs,i=(e.peers,e.hash),r=e.replies,a=t.msgSelected,s=toInt(Object.keys(a)[0]),c=t.peerId,d=(0,h.getPeerDraft)(t.viewerId,t.peerId),f=n[s],p=function(e){f.hasReply||d&&d.editing&&d.editing.id==s&&d.msgs&&(t.msgAttached[c]=d.msgs),f.hasReply?(t.msgReply[c]=s,r[s]=o.default.getReplyHTML(s)):t.msgReply[c]=null,l.default.redrawReply(),l.default.onAttachedMsgsRemove(),l.default.uiRedrawAttachments(c),l.default.setModifiers({editing:!0}),u.default.setModifiers({editing:!0}),A.default.redrawMailActions(),Le(),l.default.setText(e)};if(t.editing==s){var _=void 0;return _=d&&d.editing&&d.editing.id==s?d.editing.text||"":f.textInput,void p(_)}t.editing=s,st(),ajaxRequest("/mail?act=edit_message_start",{hash:i.edit,edit_msg_id:s,peerId:c,_ajax:1},function(e,n){(0,h.pushPeerAttachments)(t.peerId,e),p(n)})}function Le(){var e=store.mail.cur.msgSelected;Object.keys(e).forEach(function(t){delete e[t]}),o.default.unselectAll(),r.default.setCount(0),A.default.redrawMailActions()}function Oe(){var e=store.mail,t=(e.msgs,e.cur),n=Object.keys(t.msgSelected).every(Ne);1!==Object.keys(t.msgSelected).length||n?a.default.open({canDeleteForAll:n}):je()}function Ne(e){var t=store.mail,n=t.msgs,i=(t.cur,t.peers),o=vk.id,r=n[e],a=nav.getQuery().community,s=i[r.peerId];return!(!r||r.authorId!==o&&r.authorId!==-a)&&(!(r.peerId===o&&!a)&&(333!==r.peerId&&(!(Date.now()/1e3-r.ts>86400)&&!(s.kicked||s.closed||s.unableToWrite||s.kickedMessage))))}function Re(){var e,t,n,i,o,r=store.mail.cur.editing;r?(e=r,t=store.mail,n=t.cur,t.hash,t.msgs,i=t.peers,o=n.peerId,H(e),ajaxRequest("/mail",{act:"delete_for_all",peer:o,ids:e+"",hash:i[o].hashRemove},function(){}),A.default.redrawMailActions(),at(!0)):je(!1,a.default.isDeleteMessagesForAll()),a.default.close()}function je(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=store.mail,i=n.cur,r=(n.hash,n.msgs,n.peers),a=i.peerId,s=i.msgRemoved,l=i.msgSelected,u=Object.keys(l);u.forEach(function(n){delete l[n=+n],t?H(n):(s[n]=!e||"spam",e?o.default.spam(n):o.default.remove(n))}),ajaxRequest("/mail",{act:t?"delete_for_all":e?"spam":"delete",peer:a,ids:u.join(","),hash:r[a].hashRemove},function(){}),A.default.redrawMailActions()}function He(){je(!0)}function Ve(){var e=store.mail,t=e.cur,n=e.hash,i=e.msgs,r=t.msgSelected,a=Object.keys(r),s=a.some(function(e){return!i[e].isImportant})?1:0;a.forEach(function(e){delete r[e],i[e].isImportant!=!!s&&(s?t.countImportant++:t.countImportant--),i[e].isImportant=!!s,o.default.toggleImportant([e],!!s)}),ajaxRequest("/mail",{act:"mark_important",ids:a,hash:n.important,val:s},function(){}),o.default.unselectAll(),A.default.redrawMailActions()}function $e(){var e=store.mail.cur,t=e.peerId,n=Object.keys(e.msgSelected).map(toInt);e.msgAttached[t]=n,(0,h.setPeerDraft)(e.viewerId,e.peerId,{msgs:n,reply:void 0},e.editing),e.msgReply[t]&&!e.editing&&ajaxRequest("/mail",{act:"reply_cancel",peer_id:store.mail.cur.peerId,hash:store.mail.hash.reply}),e.msgReply[t]=null,e.msgSelected={},o.default.unselectAll(),r.default.setCount(0),l.default.redrawReply(),l.default.uiRedrawAttachments(t),A.default.redrawMailActions()}function Ue(){var e=store.mail,t=e.cur,n=e.flags,i=t.peerId;if(!(0,v.isContactPeer)(i)){if(!n.replies)return $e();var a=toInt(Object.keys(t.msgSelected)[0]);t.msgReply[i]=a,(0,h.setPeerDraft)(t.viewerId,t.peerId,{reply:a,msgs:void 0},t.editing),ajaxRequest("/mail",{act:"reply_start",hash:store.mail.hash.reply,peer_id:store.mail.cur.peerId,msg_id:a}),t.msgAttached[i]=[],t.msgSelected={},o.default.unselectAll(),r.default.setCount(0),l.default.redrawReply(),l.default.uiRedrawAttachments(i),A.default.redrawMailActions(),l.default.openKeyboard("text")}}function ze(){var e=store.mail.cur;(0,v.isContactPeer)(e.peerId)||(e.forwardFromId=e.peerId,e.query="",e.tab="peers",_.Messenger.setQuery(""),se({keepSelected:!0}),oe("all"),_.Messenger.getMainBody().scrollTop=0,ue())}function qe(e){if(store.mail.cur){var t=store.mail,n=t.cur,i=t.peers,o=t.msgs,a=t.flags,s=n.msgRemoved,u=n.msgSelected,c=i[n.peerId];if(l.default.hideStickersPanel(),!s[e]){u[e]?delete u[e]:u[e]=!0;var d=Object.keys(u),f=d.length,p=1===f&&d[0]==i[n.peerId].pinnedMsgId,_=d.reduce(function(e,t){return e&&o[t].isImportant},!0);r.default.setCount(f),r.default.setModifiers({pinned:p,important:_}),r.default.setLabels({pinned:p,important:_}),(0,v.isContactPeer)(n.peerId)?r.default.toggleQuickButtons(!1):r.default.toggleQuickButtons(!0),a.replies&&(1!==f||c.isIncomingMR?r.default.setReplyAvailable(!1):r.default.setReplyAvailable(!0));var m=toInt(Object.keys(u)[0]),h=1==f&&o[m];if(r.default.setEditAvailable(h&&h.canE&&!c.unableToWrite),r.default.setImportantAvailable(f>0&&n.viewerId>0),c.canPin){var g=toInt(Object.keys(u)[0]);r.default.togglePin(1===f&&g!==c.pinnedMsgId)}else r.default.togglePin(!1);A.default.redrawMailActions()}}}function We(e){var t=store.mail,n=t.cur,i=t.hash,r=t.msgs[e],a="spam"===n.msgRemoved[e]?"nospam":"restore";delete n.msgRemoved[e],o.default.restore(e),ajaxRequest("/mail",{act:a,id:e,hash:i.restore},function(){}),r.isImportant&&(n.countImportant++,R(e)),p.default.redrawFolder()}function Ye(e,t){store&&store.mail&&store.mail.cur&&!store.mail.cur.msgRemoved[e]?A.default.scrollToMsg(e)||ajaxRequest("/mail",{act:"get_msgs",msgs:[e]},function(n){storeMethods.injectMail(n);var i=store.mail,o=i.msgs,r=i.cur;r.peerId&&(o[e]?ae(r.peerId,e):Ge(e,t))}):Ge(e,t)}function Ge(e,t){if(t){var n=nav.getQuery();"show"===n.act&&(n.msg=t,nav.go(location.pathname+obj2qs(n),!1,{replace:!0,push_only:!0}))}var i="/mail?act=msg&id="+(t||e)+"&reply="+ +!!t,o=nav.getQuery("community");o&&(i+="&community="+o),nav.go(i,null,{force:!0})}function Xe(e){var t=store.mail.cur;t&&(t.msgSelected=b({},e,!0),statlogsValueEvent("messages_channel_forward_click",0),ze())}function Qe(e,t){var n=store.mail.rolls,i=n.peer[e]||[0],o=n.peer[t]||[0];return(last(o)||0)-(last(i)||0)}function Ke(){if(store.mail.cur){var e=!!store.mail.cur.peerId;$$(".vk__page_mail").forEach(function(t){return t.classList.toggle("messenger_noPullToRefresh",e)})}}function Je(){var e=store.mail.cur.peerId,t=$(".pinnedMsg");if(t){Number(t.dataset.id);var n=ot();delete n[e],rt(n),nt()}}function Ze(){var e=store.mail.cur.peerId,t=$(".pinnedMsg");if(t){var n=Number(t.dataset.id),i=ot();i[e]=n,rt(i),nt()}}function et(e,t){var n=store.mail,i=n.cur,o=n.peers[i.peerId];ajaxRequest("/mail",{act:"banner_callback",hash:o.hashBanner,peer_id:i.peerId,callback_data:t}),S=Date.now(),o.banner=null,A.default.redrawBanner()}function tt(e){var t=$(".messenger__banner_content");t&&t.classList.toggle("messenger__banner_contentExpanded")}function nt(){var e=store.mail,t=e.cur;e.peers;if(t){var n=t.peerId;if(n){var i=$(".pinnedMsg"),o=ot()[n],r=i?intval(i.dataset.id):null;A.default.setPinnedVisibility(r&&o!==r)}}}function it(){if(store.mail.cur&&store.mail.cur.peerId){var e=$(".pinnedMsg");if(e)if(!Number(e.dataset.id)){var t=store.mail.cur.peerId,n=ot();delete n[t],rt(n)}}}function ot(){return lsGet("messenger.pinHidden")||{}}function rt(e){lsSet("messenger.pinHidden",e)}function at(e){var t=store.mail.cur;if(t&&t.editing){t.editing=!1,st(),!0!==e&&ajaxRequest("/mail?act=edit_message_cancel",{peerId:t.peerId}),(0,h.popPeerAttachments)(t.peerId),(0,h.setPeerDraft)(t.viewerId,t.peerId,{});var n=(0,h.getPeerDraft)(t.viewerId,t.peerId);t.msgAttached[t.peerId]=n.msgs||[],t.msgReply[t.peerId]=n.reply||null,l.default.setText(n&&n.text||""),l.default.setModifiers({editing:!1}),u.default.setModifiers({editing:!1}),l.default.uiRedrawAttachments(t.peerId),l.default.redrawReply();var i=_.Messenger.getConvoBody();i.scrollTop+i.offsetHeight>=i.scrollHeight-2&&_.Messenger.scrollConvoToBottom()}}function st(){var e=nav.getQuery();store.mail.cur.editing?e.edit_msg_id=store.mail.cur.editing||void 0:delete e.edit_msg_id,nav.go(location.pathname+obj2qs(e),!1,{replace:!0,push_only:!0})}function lt(){if(store.mail.msgs){var e=+nav.getQuery("edit_msg_id");e&&store.mail.msgs[e]&&(store.mail.cur.msgSelected[e]=!0,Fe())}}function ut(e){var t=e.closest("."+o.default.class);if(t){var n=o.default.getId(t);store.mail.msgs[n].textFull=o.default.getTextHtml(t)}}function ct(e){Z(e)}function dt(){var e;((store.mail.cur||store.mail.page)&&M(),store.mail.cur)&&(im.on(),e=qs2obj(location.search.slice(1)),store.mail.cur.mvk_entrypoint=e.mvk_entrypoint||"notifications"===e.from&&"notifications"||"",nav.getQuery("msg")||nav.getQuery("id")||_.Messenger.scrollConvoToBottom(),A.default.startPolling(),store.mail.cur.peerId&&(x(),l.default.init(),ke(0,store.mail.cur.peerId)),addEvent(window,"resize",y.resizePosters))}function ft(){var e=store.mail.cur.countMR;store.mail.cur.countMR=0,C=!0,store.mail.rolls.mrs.forEach(function(e){(0,h.removePeer)(e)}),ajaxRequest("/mail",{act:"mrs_reject",all:!0,hash:store.mail.hash.mrs},function(t){if(t.error)return store.mail.cur.countMR=e,C=!1,void c.default.cancelRejeectLoading();A.default.redrawView(),Z("/mail")},function(){store.mail.cur.countMR=e,C=!1,c.default.cancelRejeectLoading()})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(311),r=(i=o)&&i.__esModule?i:{default:i};t.default=function(){var e=window.store,t="/feed?section=notifications";return(0,r.default)({url:t,count:e.notificationsCount,onclick:["nav.onMenuItemClick",t]})}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var r=t.PlayerFlash=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.opts=t||{},window._flashVoiceInstance=this}return e.prototype.fadeVolume=function(e,t){return this.setVolume(e),t()},e.prototype.destroy=function(){re(e.PLAYER_EL_ID)},e.prototype.onReady=function(t){if(this._player)return t(!0);if(!1===this._player)return t(!1);this._onReady=t;ge(e.PLAYER_EL_ID)||document.body.appendChild(ce("div",{id:e.PLAYER_EL_ID,className:"fixed"}));var n=this;renderFlash(e.PLAYER_EL_ID,{url:"/swf/audio_lite.swf",id:"flash_voice_player",height:2},{swliveconnect:"true",allowscriptaccess:"always",wmode:"opaque"},{onPlayFinish:"VoicePlayerFlash.onAudioFinishCallback",onLoadProgress:"VoicePlayerFlash.onAudioLoadProgressCallback",onPlayProgress:"VoicePlayerFlash.onAudioProgressCallback"})&&setTimeout(function(){n._checkFlashLoaded()},50)},e.prototype.setUrl=function(e,t){this._trackOptions={},t&&"object"===(void 0===t?"undefined":i(t))&&(this._trackOptions=t,t=t.callback),this._url!=e?(this._url=e,this._player&&this._player.loadAudio(e),t&&t(!0)):t&&t(!0)},e.prototype.setVolume=function(e){this._player&&this._player.setVolume&&this._player.setVolume(e)},e.prototype.play=function(){this._player&&this._player.playAudio()},e.prototype.seek=function(e){var t=(this._total||0)*e;this._player&&this._player.playAudio(t)},e.prototype.pause=function(){this._player&&this._player.pauseAudio()},e.prototype.isFullyLoaded=function(){return!1},e.prototype.getPlayedTime=function(){return 0},e.prototype.getCurrentProgress=function(){return this._currProgress||0},e.prototype.getCurrentBuffered=function(){return this._currBuffered||0},e.prototype.stop=function(){this._player&&this._player.stopAudio()},e.prototype._checkFlashLoaded=function(){var e=ge("flash_voice_player");if(this._checks=this._checks||0,this._checks++,this._checks>10)return this._player=!1,(t=this._onReady)&&t(!1);if(e&&e.paused){var t;this._player=e,(t=this._onReady)&&t(!0),this._onReady=null}else{var n=this;setTimeout(function(){n._checkFlashLoaded()},100)}},e.onAudioFinishCallback=function(){var e=window._flashVoiceInstance;e.opts.onEnd&&e.opts.onEnd()},e.onAudioProgressCallback=function(e,t){var n=window._flashVoiceInstance;t&&(n._total=t,n._currProgress=e/t,n.opts.onProgressUpdate&&n.opts.onProgressUpdate(n._currProgress))},e.onAudioLoadProgressCallback=function(e,t){var n=window._flashVoiceInstance;n._currBuffered=e/t,n.opts.onBufferUpdate&&n.opts.onBufferUpdate(n._currBuffered)},o(e,[{key:"type",get:function(){return"flash"}},{key:"loaded",get:function(){return!!this._player}}]),e}();window.VoicePlayerFlash=r,r.PLAYER_EL_ID="flash_voice"},function(e,t,n){"use strict";var i,o=n(72),r=(i=o)&&i.__esModule?i:{default:i};var a=window,s=a.parseJSON,l=a.bind,u=a.clog,c=a.ajx2q,d=a.canUploadFile,f=a.attr,p=a.uploadFile,_=a.readFile,A=a.replace,m=a.clone,h=a.ce,v=window.ajax,g={onUploadedDone:(0,r.default)("resp"),fallback:function(e,t){var n=window.nav,i=e.nextSibling;return!!i&&!n.go(i)},onUploadProgress:function(e){window.photoview.updateUpload({progress:e.loaded/e.total})},onUploadComplete:function(e){var t=window.photoview,n=e.target.responseText,i=!1;try{i=s(n)}catch(e){i={error:"ERR_CLIENT_BAD_RESPONSE: bad request response"}}if(i.error)g.onUploadError.call(this,e);else{this.xhr=null,this.photo_res=n,this.photo_size=i.size;var o=this.static_url+i.x_src,r=i.size[0],a=i.size[1],u=Math.min(r,a);t.onClose=l(g.onClose,this),t.openCrop({src:o,max_scale:u/200,onSelect:l(g.onCropSelected,this)})}},onUploadError:function(e){var t=window.photoview;u("upload error.",e.target.responseText),t.close()},onClose:function(e){this.xhr&&this.xhr.abort&&this.xhr.abort()},onCropSelected:function(e,t,n){var i=window.photoview,o=this,r=o.photo_res,a=o.photo_size,s=a[0],l=a[1],u=Math.min(s,l),d=Math.round(e*s),f=Math.round(t*l),p=Math.round(n*u);if(o.upload_edit_url)var _=o.upload_edit_url;else _=o.base_url+"upload.php?"+c({act:"owner_photo_edit",_query:r,_origin:location.protocol+"//"+location.host});o.xhr=v.plainpost(_,{_crop:[d,f,p].join(",")},function(e){g.onCropSuccess.call(o,e)},function(e){g.onCropCancel.call(o)},!0),i.updateCrop({saving:!0})},onCropSuccess:function(e){var t=window.photoview,n=this;n.xhr=v.post("/photos.php?act=done_photo",{_ajax:1,_query:e,_from:n.from},{onDone:function(e){g.onUploadedDone(e),t.close()},onFail:function(){g.onCropCancel.call(n)}})},onCropCancel:function(){window.photoview.updateCrop({saving:!1})},prepareInput:function(e){e.files&&e.files.length&&(e.value="")},start:function(e,t){var n=window.photoview;if(!e||!d())return g.fallback(e,t);var i=e.files[0]||!1,o=f(e,"data-upload-url"),r=f(e,"data-base-url"),a=f(e,"data-static-url"),s=f(e,"data-from");if(!i)return!1;if(!o)return g.fallback(e,t);var u={upload_url:o,base_url:r,static_url:a,file:i,from:s};return u.xhr=p(o,{photo:i},{onProgress:l(g.onUploadProgress,u),onComplete:l(g.onUploadComplete,u),onError:l(g.onUploadError,u)}),_(i,function(e){n.updateUpload({thumb:e})}),A(m(e),e),n.onClose=l(g.onClose,u),n.openUpload({src:null}),!1},getCropFromTag:function(e,t,n){if(!e)return!1;if(3==e.length)var i=+e[0],o=+e[1],r=+e[2];else{i=+e[0]*t/1e4,o=+e[1]*n/1e4,r=+e[2]*t/1e4;var a=+e[3]*n/1e4;if(r>a&&(i+=(r-a)/2,r=a),r<200){var s=(200-r)/2;i-=s,o-=s,r=200}r=Math.min(Math.max(r,200),Math.min(t,n)),i=Math.min(Math.max(i,0),t-r),o=Math.min(Math.max(o,0),n-r)}return[i/t,o/n,r/Math.min(t,n)]},crop:function(e){if(!e||!e.size&&!e.url)return!1;var t=window.photoview,n={upload_edit_url:e.upload_url};if(e.size){n.photo_size=e.size;var i=Math.min(e.size[0],e.size[1]);t.onClose=l(g.onClose,n),t.openCrop({src:e.thumb,max_scale:i/200,rect:g.getCropFromTag(e.rect,e.size[0],e.size[1]),onSelect:l(g.onCropSelected,n)})}else{var o=h("img",{src:e.url,onload:function(){n.photo_size=[o.width,o.height];var i=Math.min(o.width,o.height);t.updateCrop({src:e.thumb,max_scale:i/200,rect:g.getCropFromTag(e.rect,o.width,o.height),onSelect:l(g.onCropSelected,n)})}});t.onClose=l(g.onClose,n),t.openCrop({src:!0})}return!0}};window.ownerPhotoUpload=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PeakAlgorithm=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clear()}return e.prototype.push=function(e){this._max=Math.max(this._max,Math.abs(e))},e.prototype.get=function(){return this._max},e.prototype.clear=function(){this._max=0},e}()},function(e,t,n){"use strict";var i=window,o=i.ajax,r=i.domCA,a=i.remove,s=i.FeedAssistanceStats;window.FeedAssistance={hide:function(e,t,n){var i=r(e,d),c=hasClass(i,f);a(i),c||function(e,t,n){var i=s.getFromRef(e);o.post(l,{_ajax:1,type:t,hash:n,act:u,from:i})}(e,t,n);return!1},setFilled:function(e){var t=hasClass(e,c)?e:r(e,d);addClass(f,t)}};var l="/feed",u="hide_assistance",c="feedAssistance",d="."+c,f="feedAssistance_filled"},function(e,t,n){"use strict";var i,o=n(72),r=(i=o)&&i.__esModule?i:{default:i},a=n(297);var s=window,l=s.hasClass,u=s.ge,c=s.geByClass1,d=s.getCw,f=s.getCh,p=s.attr,_=s.setStyle,A=s.extend,m=s.preventEvent,h=s.isUndefined,v=s.clog,g=s.val,y=s.vkNow,w=s.getW,b=s.getH,D=s.scrollTop,C=s.gpeByClass,E=s.toggleClass,S=s.cancelEvent,k=s.qs2obj,M=s.obj2qs,T=s.removeClass,x=s.addClass,I=s.addEvent,P=s.removeEvent,B=s.len,F=s.show,L=s.each,O=s.hide,N=s.escapeAttr,R=s.htsc,j=s.toggle,H=s.formatNum,V=s.remove,$=s.append,U=s.reflow,z=2,q=window.ajax,W=window.thover,Y=window.nav,G=window.page,X=window.PhotoLike,Q=window.zlayer,K=window.photo,J=function(){var e=!1,t=!1,n=!1,i=!1,o=!1,s=!1,Z=!1,ee=!1,te=!1,ne=!1,ie=!1,oe=!1,re=!1,ae=!1,se=!1,le=!1,ue=!1,ce=!1,de=!1,fe=!1,pe=!1,_e={min_scale:1,max_scale:3,min_scale_limit:.5,max_scale_limit:5,anim_duration:300,inertia_duration:300,bounce_diff:1.5,crop_padding:20,crop_size:250,fps:0};function Ae(e){var t=d()/2,n=f()/2;if(e.touches){for(var i=0,o=0,r=0,a=Math.min(2,e.touches.length);i<a;i++)o+=e.touches[i].pageX,r+=e.touches[i].pageY,0;return a?{pageX:o/a-t,pageY:r/a-n}:{pageX:-t,pageY:-n}}return{pageX:e.pageX-t,pageY:e.pageY-n}}function me(e){return void 0!==e.naturalWidth?{width:e.naturalWidth,height:e.naturalHeight}:((new Image).src=e.src,{width:e.width,height:e.height})}function he(e){var t=p(e,"data-id");return ve((En(gn).tags||{})[t]||[])}function ve(e){return e[0]?{coords:{x:e[0][0],y:e[0][1],w:e[0][2],h:e[0][3]},name:e[1],href:e[2],al:e[3]}:{}}function ge(e){_(t,"overflow",e?"visible":"hidden")}var ye=null,we=null;function be(e,n,i,r,a,s,l,u,c){if(!_e.fps||c){var d=!1,f=!!u&&function(){d||(d=!0,u())};s?(t&&_.animate(t,"transform",{duration:s,func:l},f),ie&&_.animate(ie,!1===a?"transform":"transform, opacity",{duration:s,func:l},f),ae&&_.animate(ae,!1===a?"transform":"transform, opacity",{duration:s,func:l},f),o&&_.animate(o,!1===a?"transform":"transform, opacity",{duration:s,func:l},f),ft=!0):ft&&(t&&_.animate(t),ie&&_.animate(ie),ae&&_.animate(ae),o&&_.animate(o),ft=!1),_.transform(t,{translate:[n,0]}),_.transform(ie,e,[i,r]),sn(e,i,r),!1!==a&&(_(ie,"opacity",a),(Ke||Je)&&(_(ae,"opacity",a),Ze=!0),function(e,t){var n=window.lang;if(e){var i=Q.height,r=i/5,a=i/3.5,s=Math.abs(e),l=s>20?e+(e>0?20-e:-20-e)/_e.bounce_diff:e,u=0===t?0:Math.max(0,Math.min((s-20)/r,.75));t>0&&_.transform(o,{translate:[0,l]}),_(o,"opacity",u);var c=s>a,d=c?"":e>0?" zpv_close_move_down":" zpv_close_move_up",f=c?n.mobile_zphoto_release_to_close:n.mobile_zphoto_move_to_close;g(o,'<div class="zpv_close_msg'+d+'">'+f+"</div>"),(o.is_down&&e<0||!o.is_down&&e>0)&&rn(e>0)}else _.transform(o,{translate:[0,0]}),_(o,"opacity",0)}(r,a)),on(e)}else ye=[e,n,i,r,a,s,l,u,!0],we||De()}function De(){ye&&(be.apply(window,ye),ye=null),clearTimeout(we),we=_e.fps?setTimeout(De,1e3/_e.fps):null}function Ce(e,t,n){Vt(!0),be(je,Be,Ne,Re,pt,e,t,n),pt=!1}function Ee(e,t,n,i){be(e.currentScale,e.curBodyX,e.currentX,e.currentY,!1,t,n,i)}function Se(e){e=function(e){if(!e)return e;var t=ie.width/2,n=ie.height/2;return[e[0]+t,e[1]+n]}(e||[0,0]),_.transformOrigin(ie,e)}var ke,Me,Te,xe,Ie,Pe,Be,Fe,Le,Oe,Ne,Re,je,He,Ve,$e,Ue,ze,qe,We,Ye,Ge,Xe,Qe,Ke,Je,Ze,et,tt,nt,it,ot,rt,at,st,lt,ut,ct,dt,ft,pt,_t=!1,At=!1,mt=null;function ht(e){var t=e[1].pageX-e[0].pageX,n=e[1].pageY-e[0].pageY;return{distance:Math.sqrt(t*t+n*n),angle:180*Math.atan2(n,t)/Math.PI}}function vt(e){var t=ht(e);if(_t){var n=t.distance/_t.scale,i=t.angle-_t.rotation;i<-180&&(i+=360),i>180&&(i-=360),A(_t,{startDistance:n,startAngle:i})}else _t={startDistance:t.distance,startAngle:t.angle,scale:1,rotation:0}}function gt(e){return A({originalEvent:e},e,function(e){if(!_t)return{scale:1,rotation:0};if(e.length<2)return{scale:_t.scale,rotation:_t.rotation};var t=ht(e),n=t.distance/_t.startDistance,i=t.angle-_t.startAngle;i<-90&&(i+=360),i>270&&(i-=360);var o={scale:n,rotation:i};return A(_t,o),o}(e.touches),Ae(e))}function yt(e){var t=e.touches;t&&(t.length>5||t.length<2?_t&&(nn(gt(e)),_t=!1):_t?vt(t):(en(gt(e)),vt(t)))}function wt(e){var t=e.touches;t&&(t.length>5||t.length<2?_t&&(nn(gt(e)),_t=!1):_t&&tn(gt(e)))}function bt(e){var t=e.touches;t&&((t.length>5||t.length<2)&&_t&&(nn(gt(e)),_t=!1),_t&&vt(t))}function Dt(e){m(e);var t=(e.detail?e.detail:e.wheelDelta)>0?1.05:.95,n=A({originalEvent:e},e);At||(At=1,Kt(e),en(A(n,{scale:At}))),tn(A(n,{scale:At*=t})),clearTimeout(mt),mt=setTimeout(function(){nn(A(n,{scale:At})),Zt(e),At=!1},200)}function Ct(){ke=0,Me=0,Te=0,xe=0,Ie=1,Pe=!0,Be=0,Fe=0,Le=0,Oe=1,Ne=0,Re=0,je=1,He=!1,Ve=!1,$e=!1,Ue=!1,ze=!1,qe=!1,We=!1,Ye=!1,Ge=!1,Ze=!1,et=!1,tt=!1,nt=!1,it=!1,!1,lt=!1,ut=!1,ct=!1,dt=!1}function Et(){return{lastScale:Ie,deltaX:ke,deltaY:Me,pointX:Te,pointY:xe,curScale:Oe,currentScale:je,curX:Fe,curY:Le,currentX:Ne,currentY:Re,curBodyX:Be}}function St(e,t,n){n=n||Et();var i=A({},n,e=e||{});if(h(e.deltaX)||h(e.deltaY)?h(e.pointX)||h(e.pointY)?h(e.lastScale)?h(e.currentScale)?h(e.curScale)||(i.currentScale=i.lastScale*i.curScale,i.curX=i.pointX-i.deltaX*i.curScale,i.curY=i.pointY-i.deltaY*i.curScale,i.currentX=i.curX/i.currentScale,i.currentY=i.curY/i.currentScale):(i.curScale=i.currentScale/i.lastScale,i.curX=i.pointX-i.deltaX*i.curScale,i.curY=i.pointY-i.deltaY*i.curScale,i.currentX=i.curX/i.currentScale,i.currentY=i.curY/i.currentScale):(i.curScale=1,i.currentScale=i.curScale*i.lastScale):(i.curX=i.pointX-i.deltaX*i.curScale,i.curY=i.pointY-i.deltaY*i.curScale,i.currentX=i.curX/i.currentScale,i.currentY=i.curY/i.currentScale):(i.pointX=i.curX+i.deltaX*i.curScale,i.pointY=i.curY+i.deltaY*i.curScale),h(e.curX)||(i.curX=e.curX,i.currentX=i.curX/i.currentScale),h(e.curY)||(i.curY=e.curY,i.currentY=i.curY/i.currentScale),t)return i;ke=i.deltaX,Me=i.deltaY,Te=i.pointX,xe=i.pointY,Ie=i.lastScale,Oe=i.curScale,je=i.currentScale,Fe=i.curX,Le=i.curY,Ne=i.currentX,Re=i.currentY,Be=i.curBodyX}function kt(){var e=Q.width||d(),t=Q.height||f();if(pe)var n=e,i=Math.min(_e.crop_size,n-2*_e.crop_padding),o=i,r=i;else o=e,r=t;return{width:o,height:r}}function Mt(e){var t=kt().width,n=(ie.width*e-t)/2,i=-n;return n<=0&&(i=n=0),{min:i,max:n}}function Tt(e){var t=kt().height,n=(ie.height*e-t)/2,i=-n;return n<=0&&(i=n=0),{min:i,max:n}}function xt(){if(pe)var e=1,t=(hn?hn[0]:{max_scale:_e.max_scale}).max_scale;else{var n=me(ie);e=_e.min_scale,t=Math.max(_e.max_scale,n.width/d(),n.height/f())}return{min:e,max:t}}function It(e){v(Le,e);var t=Q.height||f(),i=Math.abs(yn)>=10,o=Math.abs(e)>1,r=t/3.5,a=Math.abs(Le);return Le*e<0&&(i=!0),e=e||0,a>r||!i&&o?(function(e){var t=Q.height||f(),i=2*Math.abs(Re)>t?.85:1.7;St({curY:(e>1?t:e<-1?-t:Le>0?t:-t)/i}),pt=0,Ce(150,"ease-in",Pt),_(n,"width",0),at=!0}(e),!0):(Xt()&&(pt=1,Ce(300),Ue=!1,Je&&(Je=!1,un(!0))),!1)}function Pt(){ce&&J.close()}function Bt(){!1!==ot&&(ge(!1),In(ot),_.transform(oe),_.transform(re),be(1,0,0,0,1),Se(),ot=!1)}function Ft(){var e=1.05*(Q.width||d());Ne-=(e+Be)/je,Be=-e,ot=gn+1,yn--,Ce(300,"ease-out",Bt),_n(!1,!0),Je=!1,J.onPhotoChange&&J.onPhotoChange(gn+1,{no_open:!0,local:de,crop:pe})}function Lt(){var e=1.05*(Q.width||d());Ne+=(e-Be)/je,Be=e,ot=gn-1,yn++,Ce(300,"ease-out",Bt),_n(!1,!0),Je=!1,J.onPhotoChange&&J.onPhotoChange(gn-1,{no_open:!0,local:de,crop:pe})}function Ot(){if(!ut)return!1;var e=function(){if(!ut||ut.length<2)return[0,0,0];for(var e=y(),t=!1,n=ut.pop(),i=ut.length-1;i>=0;i--){var o=e-ut[i][0];if(o>150)break;t=ut[i]}if(!t||!n)return[0,0,0];var r=n[1].pageX-t[1].pageX,a=n[1].pageY-t[1].pageY,s=Math.sqrt(r*r+a*a);return(o=n[0]-t[0])?[s/o,r/o,a/o]:[0,0,0]}(),t=e[0],n=e[1],i=e[2];if(Rt(),!t)return!1;var o=$e||Ue?5.1:4.7,r=t/o,a=n*r-o*r*r/2,s=i*r-o*r*r/2;if(r*=530,a*=140,s*=140,t<.1||!a&&!s)return!1;if(!Ue){var l={};$e||(l.curX=Fe+a,l.curY=Le+s),St(l);var u=Mt(je);l={},Fe<u.min?l.curBodyX=Pe?Fe-u.min:0:Fe>u.max&&(l.curBodyX=Pe?Fe-u.max:0),St(l)}return $e?4.7*n:Ue?4.7*i:r}function Nt(e){ut||(ut=[]),ut.push([y(),e]),ut=ut.slice(-20)}function Rt(){ut=!1}function jt(e,t){var n,i,o,r,a,s,l,u,c,d=(n=[e.curX,e.curY],i=e.currentScale,o=[t.curX,t.curY],r=t.currentScale,a=n[0],s=n[1],l=o[0],u=o[1],1!=(c=r/i)&&[a+(a-l)/(c-1),s+(s-u)/(c-1)]);if(!d)return!1;var f=d[0],p=d[1];return e.deltaX=f-e.curX,e.deltaY=p-e.curY,e.currentX=e.curX/e.currentScale+f-f/e.currentScale,e.currentY=e.curY/e.currentScale+p-p/e.currentScale,t.deltaX=f-t.curX,t.deltaY=p-t.curY,t.currentX=t.curX/t.currentScale+f-f/t.currentScale,t.currentY=t.curY/t.currentScale+p-p/t.currentScale,d}function Ht(e,t,n){var i,o,r,a,s,l,u,p,_,A,m,h,v,g,y,D=Q.width||d(),C=Q.height||f(),E=!1,S=(Math.min(50,D/7),me(ie)),k=D/S.width,M=C/S.height,T=Math.min(1,k,M),x=he(e).coords,I=c("zpv_tl",e),P=w(I),B=b(I),F=(Math.min((D-30)/Math.max(x.w*S.width*T/100,P),(C-30)/(x.h*S.height*T/100+B+5)),function(){o=S.width*T*n.currentScale,r=S.height*T*n.currentScale,a=D/2-o/2+n.currentX*n.currentScale,s=C/2-r/2+n.currentY*n.currentScale,p=a+x.x*o/100,_=s+x.y*r/100,l=x.w*o/100,u=x.h*r/100,i=p+l/2-P/2,_+u+5,m=Math.min(p,i),A=Math.max(l,P),v=m+A,g=(h=_)+(u+B+5),y={}});return n=(n=St(y,t,n))||Et(),F(),m<15?(y.curX=n.curX+(15-m),E=!0):v>D-15&&(y.curX=n.curX-(v-D+15),E=!0),h<15&&(y.curY=n.curY+(15-h),E=!0),n=(n=St(y,t,n))||Et(),F(),g>C-15&&(y.curY=n.curY-(g-C+15),E=!0),n=St(y,t,n),t?n:E}function Vt(e){dt&&(dt=!1,Se(),e||Ce(),an(!0,!0))}function $t(e,t,n){var i={};return n=n||Et(),i.lastScale=e,n=St(i,t,n),!!t&&n}function Ut(e,t,n){var i={};if(n=n||Et(),!Qt())return!!t&&n;i.curScale=e,n=(n=St(i,t,n))||Et();var o=xt();return i={currentScale:n.currentScale},n.currentScale<o.min?i.currentScale=n.currentScale+(o.min-n.currentScale)/_e.bounce_diff:n.currentScale>o.max&&(i.currentScale=n.currentScale+(o.max-n.currentScale)/_e.bounce_diff),n=St(i,t,n),!!t&&n}function zt(e,t){if(!Qt())return!1;var n=!1,i={};t=t||Et();var o=xt();return t.currentScale<o.min?(i.currentScale=o.min,n=!0):t.currentScale>o.max&&(i.currentScale=o.max,n=!0),t=St(i,e,t),e?t:n}function qt(e){if(!Qt())return!1;var t={pageX:0,pageY:0},n=Et(),i=null,o=jt(n,i=Xt(!0,i=Gt(t,!0,i=zt(!0,i=Ut(e=1==e?1/Ie:e,!0,i=Yt(t,!0,n))))));o&&(Se(o),Ee(n),dt=!0),dt&&an(!1,!0),Yt(t),Ut(e),zt(),Gt(t),Xt(),dt?Ee(i,300,!1,Vt):Ce(300),$t(je)}function Wt(e){if(!Qt())return!1;var t=Et(),n=null,i=jt(t,n=Xt(!0,n=zt(!0,n=Ht(e,!0,t))));i&&(Se(i),Ee(t),dt=!0),Ht(e)&&(tt||(tt=t)),dt&&an(!1,!0),zt(),Xt(),dt?Ee(n,300,!1,Vt):Ce(300),$t(je)}function Yt(e,t,n){var i={};return n=n||Et(),i.deltaX=(e.pageX-n.curX)/n.curScale,i.deltaY=(e.pageY-n.curY)/n.curScale,n=St(i,t,n),!!t&&n}function Gt(e,t,n){var i={};n=n||Et(),i.pointX=e.pageX,i.pointY=e.pageY;var o=Mt(n.currentScale),r=Tt(n.currentScale),a=(!He&&!r.max&&!r.min||$e||!Qt())&&!Ue;(Ue||pe&&!He&&!o.max&&!o.min)&&(i.curX=0),a&&(i.curY=n.curY),n=St(i,t,n),i={};var s=!1;return(n=n||Et()).curX<=o.min?ze?(s=!0,i.curBodyX=n.curX-o.min):(i.curX=n.curX+(o.min-n.curX)/_e.bounce_diff,i.curBodyX=Pe?i.curX-o.min:0):n.curX>=o.max&&(qe?(s=!0,i.curBodyX=n.curX-o.max):(i.curX=n.curX+(o.max-n.curX)/_e.bounce_diff,i.curBodyX=Pe?i.curX-o.max:0)),n.curY<r.min?a?i.curY=r.min:Ue||(i.curY=n.curY+(r.min-n.curY)/_e.bounce_diff):n.curY>r.max&&(a?i.curY=r.max:Ue||(i.curY=n.curY+(r.max-n.curY)/_e.bounce_diff)),n=St(i,t,n),t?n:s}function Xt(e,t){var n=!1,i={},o=Mt((t=t||Et()).currentScale),r=Tt(t.currentScale),a=!He&&!r.max&&!r.min||$e||!Qt()&&!Ue;return Ue&&(i.curX=0),a&&(i.curY=t.curY),t.curX<o.min?(i.curX=o.min,i.curBodyX=0,n=!0):t.curX>o.max&&(i.curX=o.max,i.curBodyX=0,n=!0),t.curY<r.min?(i.curY=r.min,n=!0):t.curY>r.max&&(i.curY=r.max,n=!0),t=St(i,e,t),e?t:n}function Qt(){return!ue&&(!!pe||vn[wn.src])}function Kt(e){if(D()||D(0),!at){if(e&&"mousedown"==e.type&&m(e),e.touches&&e.touches.length||!se){if(Bt(),!Ve&&!He){lt=Ae(e);var t=Mt(je);Fe<=t.min&&(ze=!1!==En(gn+1)),Fe>=t.max&&(qe=!1!==En(gn-1))}if(Ve||ue)We=Ye=Ge=!1,Xe=!1;else{clearTimeout(Qe);var n=Ae(e);We&&y()-We<500&&Ye&&(i=n,r=(o=Ye).pageX-i.pageX,a=o.pageY-i.pageY,Math.sqrt(r*r+a*a)<50)?(Ge=y(),Xe=!1):(We=y(),Ye=n,Xe=y())}ue||(Ve=!0)}var i,o,r,a;He||(Pe=!0,ge(!0)),nt=Ae(e),Rt(),Nt(nt),Yt(nt)}}function Jt(e){if(!at&&(m(e),Ve)){if(We=Ye=Ge=!1,Xe=!1,Nt(nt=Ae(e)),ct){if(!(ct<y()))return void Rt();ct=!1,Yt(nt),Ce()}if(lt&&!$e&&!Ue){var t=Math.abs(nt.pageX-lt.pageX),n=Math.abs(nt.pageY-lt.pageY),i=Tt(je);if(!(n>5||t>5))return;n>5&&t<=5&&(1!=je||He||ue||pe?(i.max||i.min)&&(ze=qe=!1):(Ue=!0,Ke&&(Je=!0),un(!1),rn(nt.pageY-lt.pageY>0))),lt=!1,Yt(nt)}!Gt(nt)||$e||Ue||ue||($e=!0,nt.pageX),function(){if(!Ue)return;var e=Math.abs(Le),t=Q.height/2;pt=1-.5*e/t}(),Ce(),$e&&Math.abs(Be)>d()&&Zt(A({originalEvent:e},e,{touches:[]}))}}function Zt(e){if(!at)if(st)st=!1;else{if(m(e),e.touches&&!e.touches.length||!se){var t=Ot();if($e)a=t,s=(Q.width||d())/2,a=a||0,((Be<-s||a<-1)&&ze?(Ft(),1):(Be>s||a>1)&&qe?(Lt(),1):(Xt()&&Ce(300),0))&&(Ct(),ge(!0));else if(Ue)It(t);else if(Ge&&y()-Ge<1e3){!function(e){if(!Qt())return!1;var t=xt(),n={pageX:Te,pageY:xe},i=(je>1?1:t.max)/Ie,o=Et(),r=null;r=Xt(!0,r=Gt(n,!0,r=Ut(i,!0))),e&&(r=Xt(!0,r=Ht(e,!0,r)));var a=jt(o,r);a&&(Se(a),Ee(o),dt=!0),dt&&an(!1,!0),Ut(i),Gt(n),Xt(),e&&(Ht(e),Xt()),dt?Ee(r,300,!1,Vt):Ce(300),$t(je),cn()}(r=e&&Ze&&(l("zpv_tag",e.target)?e.target:C("zpv_tag",e.target))),We=Ye=Ge=!1}else Xt()?Ce(300):t&&(Xt(),Ce(t,"cubic-bezier(0, 1, 1, 1)"));if(Xe)if(y()-Xe>700||e&&"touchcancel"==e.type)Xe=!1;else{if(Xe=!1,e)var n=l("zpv_header",e.target)?e.target:C("zpv_header",e.target),i=l("zpv_zoom_btns",e.target)?e.target:C("zpv_zoom_btns",e.target),o=l("zpv_bottom_body",e.target)?e.target:C("zpv_bottom_body",e.target),r=Ze&&(l("zpv_tag",e.target)?e.target:C("zpv_tag",e.target));e&&(n||i||o||r)?r?function(e,t){if(!rt)return!1;if(!Ze)return!0;he(e);if(l("zpv_tag_selected",e))return l("zpv_tl_wrap",t.target)||C("zpv_tl_wrap",t.target)?Y.go(e,t):(Wt(e),S(t),!1);et&&(We=Ye=Ge=!1),T("zpv_tag_selected",et),et=e,ln(e),x("zpv_tag_selected",et);Ke&&(Je=!0);un(!1),Wt(e),S(t)}(r,e):i&&(We=Ye=Ge=!1,l("zpv_zoomin",e.target)||C("zpv_zoomin",e.target)?function(e){!rt||(W.highlight=!1,W.end(e),He||$e||xt().max<=je||(S(e),qt(pe?1.25:1.45)))}(e):function(e){!rt||(W.highlight=!1,W.end(e),He||$e||xt().min>=je||(S(e),qt(pe?.8:1)))}(e)):et?_n(e):pe||(Qe=setTimeout(function(){un(),an(Ke)},500))}Ve=!1,$e=ze=qe=!1,Rt()}var a,s;e.touches&&(e.touches.length>1||1==e.touches.length&&$e)&&Yt(nt=Ae(e)),(e.touches&&!e.touches.length||!se)&&(lt=!1)}}function en(e){if(!at&&(m(e),We=Ye=Ge=!1,Xe=!1,Rt(),!$e&&!Ue)){Oe=1,Ie=je,He=!0,ze=qe=!1;var t=Mt(je);(t.min>=-5||t.max<=5)&&(Pe=!1,ge(!1)),Yt(Ae(e)),an(!1,!0)}}function tn(e){at||(m(e),We=Ye=Ge=!1,Xe=!1,Rt(),$e||Ue||(it=Ae(e),Ut(e.scale),Gt(it),Ce(),cn()))}function nn(e){at||(m(e),We=Ye=Ge=!1,Xe=!1,Rt(),$e||Ue||(zt()&&((e.touches&&e.touches.length||!se)&&Gt(it),Xt(),Ce(100),ct=y()+100),He=!1,an(!0,!0)))}function on(e){var t=xt(),n=e<t.max,i=e>t.min;E("zpv_zb_disabled",te,!n),E("zpv_zb_disabled",ne,!i)}function rn(e){_(o,e?{top:-35,bottom:"auto"}:{top:"auto",bottom:-35}),o.is_down=e}function an(e,t){var n=Ze;if(e){if(!Qt())return;if(!Ke&&!Je||He)return}Ze=e,e&&sn(je,Ne,Re,t||n!==e),n!==e&&(e&&ln(et),ae&&_.animate(ae,!t&&"opacity",{duration:200,func:"linear"},function(){_(ae,"visibility",e?"visible":"hidden")}),ae&&_(ae,"visibility",e||!t?"visible":"hidden"),ae&&_(ae,"opacity",e?1:0))}function sn(e,t,n,i){if(!He&&Ze){var o=Q.width||d(),r=Q.height||f(),a=me(ie),s=o/a.width,l=r/a.height,u=Math.min(1,s,l),c=a.width*u*e,p=a.height*u*e,A=o/2-c/2+t*e,m=r/2-p/2+n*e;i&&ae&&_.animate(ae),_(ae,{width:Math.round(c),height:Math.round(p)}),_.transform(ae,{translate:[Math.round(A),Math.round(m)]})}}function ln(e){if(e){var t=me(ie),n=Q.width||d(),i=Q.height||f(),o=n/t.width,r=i/t.height,a=Math.min(1,o,r),s=t.width*a*je,l=t.height*a*je,u=he(e).coords,p=c("zpv_tl",e),A=w(p),m=b(p),h=u.x*s/100,v=u.y*l/100,g=u.w*s/100,y=u.h*l/100,D=h+g/2-A/2,C=v+y+5,E=n>s?0-(n-s)/2:0,S=n>s?s+(n-s)/2:s,k=i>l?l+(i-l)/2:l,M=0,T=0;D<E+2?M=E+2-D:D+A>S-2&&(M=S-2-D-A),C+m>k-5&&(T=y>3*m?k-5-C-m:-y-m-10),_.transform(p,{translate:[Math.ceil(M),Math.ceil(T)]})}}function un(e){if(void 0!==e){if(Ke===e)return;Ke=!e}else Je=!1;_(n,"width","auto"),n&&_.animate(n,"opacity",{duration:200,func:"linear"},function(){_.animate(n),_(n,"width",Ke?"auto":0)}),Ke?(_(n,"opacity",0),Ke=!1):(_(n,"opacity",1),Ke=!0)}function cn(){Q.height<604&&!et&&!pe&&(je>1.25?(Ke&&(Je=!0),un(!1)):Je&&(Je=!1,un(!0)))}function dn(e){rt&&(Ve||He||$e||e&&e.touches&&e.touches.length>1||(S(e),J.close()))}function fn(e){if(!(Ve||He||$e||!e||e.shiftKey||e.ctrlKey||e.metaKey||e.altKey)){var t=Mt(je);37==e.keyCode?(S(e),Fe>=t.max&&!1!==En(gn-1)&&(ge(!0),Lt())):39==e.keyCode?(S(e),Fe<=t.min&&!1!==En(gn+1)&&(ge(!0),Ft())):27==e.keyCode&&dn(e)}}function pn(){pe?Bn():an(Ze,!0)}function _n(e,t){return!(!rt&&!t)&&(!et||(T("zpv_tag_selected",et),et=!1,Je&&je<=1.25&&(Je=!1,un(!0)),S(e),!1))}function An(e){"touchstart"==e.type?rt=!e.touches||1==e.touches.length:"touchmove"==e.type?(rt=!1,m(e)):"click"==e.type&&(rt||(S(e),rt=!0))}function mn(e){"touchstart"==e.type?at=!0:"touchmove"==e.type?(at=!0,m(e)):(at=e.touches&&e.length,st=!at)}var hn=!1,vn={},gn=!1,yn=!1,wn=!1,bn=!1,Dn=!1;function Cn(e,t,n,i){var o=t||B(e);if(e&&!n||(hn=null),hn||(hn=new Array(o)),hn.length!=o){var r=hn;hn=new Array(o),A(hn,r)}A(hn,e);var a=function(e){for(var t in hn)if(hn[t].id==e)return+t;return-1}(wn.id);-1==a&&(a=gn),i||In(a)}function En(e){return!(e>=hn.length)&&(!(e<0)&&(hn[e]||{src:!0}))}function Sn(e,t){var n=me(e),i=kt();pe&&(hn[0].loaded=t,t&&(n.width>n.height?_(e,{height:i.height}):_(e,{width:i.width}),_(e,{minWidth:0,maxWidth:"none"})),Bn(!0));if(xn()&&n.width*z>=i.width){var o=i.width/n.width;Oe=o,Ie=o,je=o,_.transform(ie,o)}F(e),ie===e&&an(t,!t)}function kn(e){L([ie,oe,re],function(){var t=p(this,"data-src"),n=C("zpv_thumb_item",this);t==e&&(v("set",e),this.src=t,Sn(this,!0),T("zpv_ti_loading",n),p(this,"data-src",!1))})}function Mn(e,t,n){var i=C("zpv_thumb_item",e);t?!0!==t?e.src==t?Sn(e,!0):vn[t]?(e.src=t,Sn(e,!0)):(n?(e.src=n,Sn(e,!1)):O(e),p(e,"data-src",t),function(e){if(vn[e])kn(e);else{var t=new Image;t.src=e,t.onload=function(){v("loaded",e),vn[e]=!0,kn(e),t=null}}}(t),x("zpv_ti_loading",i)):(n?(e.src=n,Sn(e,!1)):O(e),x("zpv_ti_loading",i)):O(e)}function Tn(){if(ce){!function(){var e=window.lang,t="";if(xn())t=getLang("mobile_gif_popup_title");else{t=e.mobile_photos_photoview_header||"";var n=!1!==ot?ot:gn;t=(t=t.replace("%s",n+1)).replace(/%s|{count}/,hn.length)}g("zpv_summary",t)}(),on(je);var e=En(!1!==ot?ot:gn);if(e&&!0!==e.src){var t="";L(e.tags,function(e,n){if(!e||0==e)return!0;var i=ve(n),o=i.coords,r=i.href?' data-href="'+i.href+'" data-name="'+N(i.name)+'"':"",a=i.al?(i.href?" al"+i.al:"")+" "+i.al:"";t+='<div class="zpv_tag'+a+'" style="left: '+o.x+"%; top: "+o.y+"%; width: "+o.w+"%; height: "+o.h+'%;" data-id="'+e+'"'+r+'><div class="fill"></div><div class="zpv_tl_wrap" id="zpv_tl_wrap"><div class="zpv_tl'+(i.href?"":" zpv_tl_plain")+'">'+R(i.name)+"</div></div></div>"}),g(ae,t),g(s,'<div class="zpv_photo_desc">'+(e.caption||"")+'</div><div class="zpv_bottom_bg"></div>'),j(s,!!e.caption);var n="";if(de||Y.getQuery("community"))n="";else{var o=e.tags&&e.tags[0]||0;n="<tr>"+('<td class="row_table_column"><a href="'+e.like_url+'" class="item_button item_like'+(e.likes_me?" item_likes_me":"")+'" onclick="return photoview.likePhoto(this, \''+e.id+'\');"><i class="i_icon i_like"></i>'+(e.likes_cnt?'<b class="v_value v_like">'+H(e.likes_cnt)+"</b>":"")+"</a></td>")+('<td class="row_table_column"><a href="'+e.photo_url+'#comments" class="item_button item_replies al_photo" onclick="return photoview.openPhoto(this, event, true);"><i class="i_icon i_replies"></i>'+(e.replies_cnt?'<b class="v_value v_replies">'+e.replies_cnt+"</b>":"")+"</a></td>")+('<td class="row_table_last_column"><a href="'+e.photo_url+'" class="item_button item_tags al_photo" onclick="return photoview.openPhoto(this, event);"><i class="i_icon i_tags"></i>'+(o?'<b class="v_value v_tags">'+o+"</b>":"")+"</a></td>")+"</tr>"}g(Z,n),F(i)}else O(i)}}function xn(){return wn.isDoc}function In(e){ce&&(gn=Math.max(0,Math.min(e||0,hn.length)),wn=En(gn),Dn=En(gn-1),bn=En(gn+1),Mn(ie,wn.src,"/images/mobile/blank.gif"),Mn(re,bn.src),Mn(oe,Dn.src),Tn(),J.onUpdate&&J.onUpdate())}function Pn(){if(ce&&fe&&hn){var e=hn[0];if(!e.loaded&&e.progress){var t=c("zpvu_progress","zpv_center");_(t,{width:100*e.progress+"%",visibility:"visible"})}if(!e.read&&e.thumb){e.read=!0;var n=c("zpv_upload_box","zpv_center"),i=c("zpv_upload_img",n);_(i,{backgroundImage:"url("+e.thumb+")"}),T("zpv_thumb_uploading",n)}}}function Bn(t){if(ce&&pe&&hn){var n=hn[0],i=!!n.saving;if(E("item_disabled","zpv_save_button",i||!n.loaded),E("item_disabled","zpv_cancel_button",i),E("zpv_crop_saving",e,i),ue=i,t||Mn(ie,n.src,"/images/mobile/blank.gif"),n.loaded&&n.rect&&!n.rect_inited){n.rect_inited=!0;var o=kt(),r=n.rect[0],a=n.rect[1],s=n.rect[2],l={};l.currentScale=1/s,St(l),zt(),Xt(),l={};var u=ie.width*je,c=ie.height*je,d=r*u,f=a*c;l.curX=(u-o.width)/2-d,l.curY=(c-o.height)/2-f,St(l),Xt(),Ce(0)}}}function Fn(){var r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];ce||(Xe=!1,Qe=!1,Ke=!0,Je=!1,ot=!1,rt=!0,at=!1,st=!1,ft=!1,pt=!1,ue=!1,de=!1,fe=!1,pe=!1,Ct(),function(){var r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],d=window.lang,f="";f=r?(0,a._getLayer)():'<div id="z_photoview"><div class="zpv_siblings"><div id="zpv_left" class="zpv_thumb_item"><img class="zpv_img" alt=""></div><div id="zpv_right" class="zpv_thumb_item"><img class="zpv_img" alt=""></div></div><div class="zpv_body"><div id="zpv_center" class="zpv_thumb_item"><img class="zpv_img" alt=""></div></div><div class="zpv_close_msg_wrap"><div class="zpv_close_msg">'+d.mobile_zphoto_move_to_close+'</div></div><div class="zpv_controls"><div class="mhead zpv_header"><a class="zpv_close_btn" onclick="return photoview.closePhoto(event);"><i class="zpv_close_icon"></i></a><div class="hb_wrap"><h1 id="zpv_summary" class="hb_btn mh_header"></h1></div></div><div class="zpv_zoom_btns"><a class="zpv_zoom_btn zpv_zoomin"><b class="zpv_zb_wrap"><i class="i_icon"></i></b></a><a class="zpv_zoom_btn zpv_zoomout"><b class="zpv_zb_wrap"><i class="i_icon"></i></b></a></div><div class="zpv_bottom"><div class="zpv_photo_desc_wrap"></div><div class="zpv_bottom_body"><table class="zpv_values like_box row_table"></table></div></div></div><div class="zpv_tags"></div><div class="zpva zpv_crop"><div class="zpv_crop_box"></div><div class="zpv_crop_loading"></div></div></div>';var p="/images/mobile/zpv_icons"+(l("x2",window.bodyNode)?"_2x":"")+".png?2";(new Image).src=p,Q.create(f,Ln),e=u("z_photoview"),c("zpv_body",e),t=c("zpv_siblings",e),n=c("zpv_controls",e),ee=c("zpv_zoom_btns",e),o=c("zpv_close_msg_wrap",e),i=c("zpv_bottom",e),s=c("zpv_photo_desc_wrap",e),Z=c("zpv_values",i),te=c("zpv_zoomin",ee),ne=c("zpv_zoomout",ee),ae=c("zpv_tags",e),c("zpv_crop",e),ie=c("zpv_img","zpv_center"),oe=c("zpv_img","zpv_left"),re=c("zpv_img","zpv_right")}(r),function(){if(se=void 0!==document.ontouchmove,le=!1,se){var t=c("zpv_header",e),n=c("zpv_bottom_body",e);I(t,"touchstart touchmove touchend touchcancel",mn),I(n,"touchstart touchmove touchend touchcancel",mn),I(e,"touchstart touchmove click",An),I(e,"touchstart",Kt),I(e,"touchmove",Jt),I(e,"touchend touchcancel",Zt),le?(I(e,"gesturestart",en),I(e,"gesturechange",tn),I(e,"gestureend",nn)):(I(e,"touchstart",yt),I(e,"touchmove",wt),I(e,"touchend touchcancel",bt),I(e,"gesturestart gesturechange gestureend",S))}else I(e,"mousedown",Kt),I(e,"mousemove",Jt),I(window,"mouseup",Zt),I(window,"mousewheel",Dt),I(window,"keydown",fn)}(),ce=!0,U(e),D()||D(0))}function Ln(){ce&&(!function(){if(se){var t=c("zpv_header",e),n=c("zpv_bottom_body",e);P(t,"touchstart touchmove touchend touchcancel",mn),P(n,"touchstart touchmove touchend touchcancel",mn),P(e,"touchstart touchmove click",An),P(e,"touchstart",Kt),P(e,"touchmove",Jt),P(e,"touchend touchcancel",Zt),le?(P(e,"gesturestart",en),P(e,"gesturechange",tn),P(e,"gestureend",nn)):(P(e,"touchstart",yt),P(e,"touchmove",wt),P(e,"touchend touchcancel",bt),P(e,"gesturestart gesturechange gestureend",S))}else P(e,"mousedown",Kt),P(e,"mousemove",Jt),P(window,"mouseup",Zt),P(window,"mousewheel",Dt),P(window,"keydown",fn)}(),e=t=n=o=!1,i=Z=!1,ee=te=ne=!1,ie=oe=re=ae=!1,ce=!1,hn=null)}return{onShow:(0,r.default)(),onHide:(0,r.default)(),likePhoto:function(e,t){return!!rt&&(W.highlight=!1,W.end(),wn.likes_me?(wn.likes_me=!1,--wn.likes_cnt):(wn.likes_me=!0,++wn.likes_cnt),Tn(),q.click(e,A({photo_id:t},X)))},openPhoto:function(e,t,n){var i=window.cur;if(!rt)return!1;var o=i.replyNames,r=i.sticker_panel,a=i.stickers,s=Y.go(e,t,{local:!0,fast:!0,beforeAppend:function(e){g(c("mcont",e),'<div class="pcont"><div class="media_view photo_view"><div class="pv_summary"><div class="summary_loading" style="display: none;"><i class="i_loading"></i></div></div><div class="pv_tag_wrap"></div><div class="pv_body pv_touch pv_touch_full pv_hidden_icons"><a class="thumb_item"><div class="pv_photo_wrap" id="pv_photo_tags" onclick="return photo.closeTags(event);"><img src="/images/mobile/blank.gif" class="ph_img" alt="" /></div></a><div class="pv_nav"><table class="row_table pv_nav_cont"><tr><td class="pv_nav_left"><a class="pv_nav_link"><span class="pv_icon"><i class="i_icon"></i></span></a></td><td class="pv_nav_z"><a class="pv_nav_link"><span class="pv_icon"><i class="i_icon"></i></span></a></td><td class="pv_nav_right"><a class="pv_nav_link"><span class="pv_icon"><i class="i_icon"></i></span></a></td></tr></table></div></div><div class="pv_footer"></div></div></div>'),g("m",e.innerHTML)}});A(i,{replyNames:o,sticker_panel:r,stickers:a,processNav:function(e){var t;if(t=/^\/photo(-?\d+_\d+)$/i.exec(e.nav.path)){var n=k(e.nav.params),i=k(Y.params);if(n.act)return!1;if(n.offset!=i.offset)return!1;if(n.list!=i.list&&!i.z)return!1;e.onPreNav&&e.onPreNav();var o=n.list||"",r=n.rev?"/rev":"";return!K.open(t[1],o+r,null,n.from,!0)}return!1}}),i.destroy.push(function(){K.clear()});var l=window.lang;if(!s&&!(s=Y.go(e,t,{force:!0}))){var u=!0;if(Q._lastNav){var d=Q._lastNav,f=k(d.params);delete f.z,u=d.path+M(f)+d.hash}G.setMhead("m",l.mobile_photos_photo_head_title,u),K.showIcons()}return!0},closePhoto:dn,savePhoto:function(e,t){if(!rt)return!1;if(W.highlight=!1,W.end(),l("item_disabled",e))return!1;if(!pe||!hn)return!1;var n=hn[0],i=kt(),o=ie.width*je,r=ie.height*je,a=(o-i.width)/2-Fe,s=(r-i.height)/2-Le,u=1/je,c=a/o,d=s/r;return n.onSelect&&n.onSelect(c,d,u),!1},cancelPhoto:function(e,t){return!!rt&&(W.highlight=!1,W.end(),!l("item_disabled",e)&&dn())},onClose:null,onUpdate:null,onPhotoChange:null,saveSource:Cn,opened:function(){return ce},openCrop:function(t,n){n=n||{};var o=!ce;fe?fe=!1:Fn(),pe=!0,ue=!1,hn=[t],o&&(Q.open(),Q.onResize=pn),function(){if(ce&&pe){var t=window.lang;g("zpv_summary",t.mobile_zphoto_owner_crop_header),T("zpv_mode_[a-z]+",e,!0),x("zpv_mode_crop",e),on(je),ie.parentNode||(g("zpv_center",""),$(ie,"zpv_center"));var n='<tr><td class="row_table_column"><a class="item_button" id="zpv_save_button" onclick="return photoview.savePhoto(this);"><i class="i_icon i_save"></i><span class="v_value">'+t.mobile_zphoto_save_btn+'</span></a></td><td class="row_table_last_column" width="50%"><a class="item_button" id="zpv_cancel_button" onclick="return photoview.cancelPhoto(this);"><i class="i_icon i_cancel"></i><span class="v_value">'+t.mobile_zphoto_cancel_btn+"</span></a></td></tr>";g(Z,n),F(i),Bn()}}()},updateCrop:function(e){if(!hn)return!1;e=A(hn[0]||{},e),hn=[e],Bn()},openUpload:function(t,n){n=n||{},Fn(),fe=!0,ue=!0,hn=[t],Q.open(),Q.onResize=pn,function(){if(ce&&fe){var t=window.lang;g("zpv_summary",t.mobile_zphoto_upload_header),T("zpv_mode_[a-z]+",e,!0),x("zpv_mode_upload",e),V(ie),g("zpv_center",'<div class="zpva zpv_upload_box zpv_thumb_uploading"><div class="zpv_upload_img"></div><div class="zpvu_progress_wrap"><div class="zpvu_progress"></div></div></div>');var n='<tr><td class="row_table_column" width="50%"><a class="item_button item_disabled" onclick="return false;"><i class="i_icon i_save"></i><span class="v_value">'+t.mobile_zphoto_save_btn+'</span></a></td><td class="row_table_last_column" width="50%"><a class="item_button" onclick="return photoview.cancelPhoto(this);"><i class="i_icon i_cancel"></i><span class="v_value">'+t.mobile_zphoto_cancel_btn+"</span></a></td></tr>";g(Z,n),F(i),Pn()}}()},updateUpload:function(e){if(!hn)return!1;e=A(hn[0]||{},e),hn=[e],Pn()},open:function(e,t,n){var i,r;J.onShow(),Fn((n=n||{}).isDoc),de=n.local||!1,t&&Cn(t,!1,!1,!0),In(e),yn=0,Q.open(),Q.onResize=pn,i=c("zpv_close_msg",o),r=w(i),_(o,{width:r||250})},close:function(){J.onHide(),J.onClose&&J.onClose({local:de})||Q.close()}}}();window.photoview=J},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onOpen=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";if(f)return;v=e,g=!1,f=!0,p=!1,A=0,m=0,y=0,w=0,D={},void 0,C="start",E=0,S=0,window.removeEventListener("resize",T),B()<l&&F(0);var t=document.body;h=t.offsetHeight,t.offsetWidth,(r.default.ipad||(r.default.iphone||r.default.ipod)&&r.default.ios>=8)&&(window.addEventListener("scroll",k),"top"===v&&L()||(I(),x()),"bottom"===v&&r.default.ipad&&requestAnimationFrame(function(){x(),requestAnimationFrame(function(){x()})}))},t.onClose=function(){if(!f)return;g=!1,v=null,f=!1,p=!1,h=0,0,_&&clearTimeout(_);window.removeEventListener("resize",T),window.removeEventListener("scroll",k),window.removeEventListener("scroll",M)},t.isKeyboardOpen=function(){return f},t.adjustBottom=function(){if("bottom"!==v)return;(r.default.ipad||r.default.wkwebview)&&(F(0),x(h))};var i,o=n(215),r=(i=o)&&i.__esModule?i:{default:i};var a=45,s=85,l=200,u=60,c=0,d=0,f=!1,p=void 0,_=void 0,A=void 0,m=void 0,h=void 0,v=void 0,g=!1,y=void 0,w=void 0,b=void 0,D={},C=void 0,E=void 0,S=0;function k(){if(I(),"top"!==v){if("bottom"===v){var e=pageYOffset,t=B();if(p){p=!1;if(t?P(t):h,e===y)return}r.default.wkwebview?w<=5&&x():e>l?e>t?(F(e),r.default.safari&&!r.default.wkwebview&&x()):e<t?D[e]||e>P(t)?(D[e]=!0,x(h)):x():e!==P(t)&&x():t||(e<u?(A===e?m++:(A=e,m=1),m>=3&&(window.removeEventListener("scroll",k),F(A)),setTimeout(function(){x()},300)):x())}}else{if(L())return;if(r.default.wkwebview)return void(0!==pageYOffset&&x(0));var n=innerHeight;if("start"===C&&(n<h?C="animate":x(1)),"animate"===C)if(E=h-n,S||(S=Math.max(1,Math.min(4,Math.floor(E/10)))),E<=0)C="stop";else{var i=r.default.ipad?r.default.version<11?3:2:1;x(Math.min(E,S)*i)}"stop"===C&&x(1)}}function M(){I()}function T(){b&&clearTimeout(b),window.removeEventListener("scroll",k),b=setTimeout(function(){document.activeElement.blur()},100)}function x(e){p=!0;var t=B(),n=void 0;"bottom"===v?n=e||(t&&!r.default.wkwebview?P(t):h):"top"===v&&(n=isFinite(e)?e:1),w++,y=n,window.scrollTo(0,n)}function I(){_&&clearTimeout(_),g||(_=setTimeout(function(){g=!0,_=null,window.removeEventListener("scroll",k),window.removeEventListener("scroll",M),window.addEventListener("resize",T)},500))}function P(e){if(r.default.ipad)return e;if(!r.default.ipad&&!r.default.wkwebview){if(90===Math.abs(window.orientation)&&screen.width>=375)return e;375===screen.width&&812===screen.height&&3===window.devicePixelRatio?e-=s:e-=a}return e}function B(){return 90===Math.abs(window.orientation)?c:d}function F(e){90===Math.abs(window.orientation)?c=e:d=e}function L(){return 90===Math.abs(window.orientation)&&!r.default.ipad}},function(e,t,n){"use strict";var i=n(183),o=window,r=(o.addClass,o.FeedAssistanceStats),a=o.page,s=o.geByClass1,l=o.onDOMReady,u=o.FeedNotifications;l(p),a.onChange(p);var c="feedAssistance_pushNotificationsSwitch",d="enable_browser_notifications",f="m_push_switch";function p(){PushNotifier&&PushNotifier.canBeEnabled().then(function(e){return e&&PushNotifier.getPermission()===i.PUSH_NOTIFIER_PERMISSION_DEFAULT}).then(function(e){if(e){u.addWebActionAcceptHandler(d,_),u.addWebActionDeclineHandler(d,A);var t=s(c);if(!t)return;r.registerTrackingCls(c),r.register(t,"feed")}})}function _(e){return PushNotifier.requestPermission().then(function(t){var n=void 0,o=!0;return unlockButton(e),t===i.PUSH_NOTIFIER_PERMISSION_DEFAULT?o=!1:(n=t===i.PUSH_NOTIFIER_PERMISSION_GRANTED?r.EVENTS.SUB_EVENT_ENABLE_PUSH:r.EVENTS.SUB_EVENT_DECLINE_PUSH,h(e,n),m(),PushNotifier.init(),o)},function(){return A(e)})}function A(e){return unlockButton(e),h(e,r.EVENTS.SUB_EVENT_DECLINE_PUSH),m(),!0}function m(){var e=s(c);remove(e)}function h(e,t){r.dispatchEvent({type:r.EVENTS.EVENT_FEED_ASSISTANCE,data:r.serializeEventData(r.EVENTS.EVENT_FEED_ASSISTANCE,e,f,t)})}},function(e,t,n){"use strict";n(278)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(326)),o=r(n(209));function r(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=window.lang;return i.default.html({class:"MessageRequestBox",inner:[{class:"MessageRequestBox__info",inner:t.mobile_mail_mrs_confirm_info},{class:"MessageRequestBox__buttons",inner:[(0,o.default)({theme:"negative",size:"normal",type:"button",inner:t.mobile_mail_mrs_button_reject,attrs:q.onClick("MessageRequestBox.reject","event","this",e)}),(0,o.default)({theme:"secondary",size:"normal",type:"button",inner:t.mobile_mail_mrs_button_accept,attrs:q.onClick("MessageRequestBox.accept","event","this",e)})]}]})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(326)),o=r(n(282));function r(e){return e&&e.__esModule?e:{default:e}}var a={className:"Btn",setLoading:function(e,t){if(!e)return;var n=e.classList.contains(s.loading);if(t){if(n)return;var i=e.classList.contains(s.secondary),r=(0,o.default)({mix:s.loader,white:!i,large:!0});e.classList.add(s.loading),e.insertAdjacentHTML("afterbegin",r)}else{if(!n)return;var a=e.$(l.loader);e.classList.remove(s.loading),a.remove()}},setDisabled:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.disabled=t}};t.default=a,a._onClick=u;var s={loading:"Btn_loading",secondary:"Btn_theme_secondary",loader:"Btn__loader"},l={loader:"."+s.loader};function u(e,t,n){e.preventDefault(),i.default.handle(n,{$btn:t})}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(103),r=(i=o)&&i.__esModule?i:{default:i};t.default=r.default,window.MessageRequestBox=r.default},function(e,t,n){"use strict";var i,o=n(300),r=(i=o)&&i.__esModule?i:{default:i};Object.assign(r.default,{toggleActive:function(e){e.classList.toggle(a.active)}});var a={active:"Icon_active"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(326),r=(i=o)&&i.__esModule?i:{default:i};var a={setChecked:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];u(e).checked=t},isChecked:function(e){return u(e).checked}};t.default=a,a._onChange=l;var s={control:".Control",native:".Control__native"};function l(e,t){r.default.handle(t,{$control:e.closest(s.control),name:e.name,checked:e.checked,value:e.value})}function u(e){return e.$(s.native)}},function(e,t,n){"use strict";var i=window,o=i.ownerPhotoUpload,r=i.setStyle,a=i.remove,s=i.domData,l=i.geByClass,u=i.geByClass1,c=i.getLang,d=i.FeedAssistance,f=i.FeedAssistanceStats;o.onUploadedDone(function(e){var t=u(p);if(t){var n=u(_,t),i=u(m,t),o=u(A,t),r=u(h,t);(function(e,t){if(window.Image){var n=new Image;n.onload=function(){return w(e,t)},n.src=e}else w(e,t)})(e=function(e){return e.replace(/"/g,"").replace(/'/g,"").replace(/</g,"").replace(/>/g,"")}(e),n),o&&(o.textContent=c(g)),i&&(i.textContent=c(y)),d.setFilled(t),a(r)}}),f.registerTrackingCls("feedAssistance_profilePhoto");var p="feedAssistance_profilePhoto",_="feedAssistanceProfilePhotoContent__avatar",A="feedAssistanceProfilePhotoContent__title",m="feedAssistanceProfilePhotoContent__desc",h="feedAssistance__footerButton",v="feedAssistanceProfilePhotoContent__avatar_uploaded",g="mobile_assistance_profile_photo_uploaded_title",y="mobile_assistance_profile_photo_uploaded_desc";function w(e,t){var n;t&&(addClass(v,t),r(t,"background-image","url("+e+")")),n=e,l("al_u"+vk.id).forEach(function(e){s(e,"photo")&&s(e,"photo",n);var t=u("_u"+vk.id,e);t&&"IMG"===t.tagName&&(t.src=n)})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var r="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQAAAAA=",a=t.PlayerHTML5=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.opts=t||{},this._trackOptions={},this._audioNodes=[],this._currentAudioEl=this._createAudioNode(),this._prefetchAudioEl=this._createAudioNode()}return e.isSupported=function(e){var t=document.createElement("audio");return!!t.canPlayType&&(e=e||'audio/mpeg; codecs="mp3"',!!t.canPlayType(e).replace(/no/,""))},e.prototype.destroy=function(){},e.prototype.getPlayedTime=function(){for(var e=this._currentAudioEl.played,t=0,n=0;n<e.length;n++)t+=e.end(n)-e.start(n);return t},e.prototype._setAudioNodeUrl=function(e,t){window.data&&data(e,"setUrlTimesetUrlTime",t==r?0:vkNow()),e.src=t},e.prototype._createAudioNode=function(e){var t=new Audio,n=this;return this.opts.onBufferUpdate&&addEvent(t,"progress",function(){n._currentAudioEl==t&&n.opts.onBufferUpdate(n.getCurrentBuffered());var e=t.buffered;e.length;1==e.length&&0==e.start(0)&&e.end(0)==t.duration&&(t._fullyLoaded=!0)}),addEvent(t,"stalled",function(){n._currentAudioEl==t&&n._isInvalidDuration()&&n._currentAudioEl.currentTime>=n.duration-1&&n._currentAudioEl.dispatchEvent(new Event("ended"))}),this.opts.onProgressUpdate&&addEvent(t,"timeupdate",function(){n._currentAudioEl==t&&n.opts.onProgressUpdate(n.getCurrentProgress())}),this.opts.onEnd&&addEvent(t,"ended",function(){n._currentAudioEl==t&&n.opts.onEnd()}),this.opts.onSeeked&&addEvent(t,"seeked",function(){n._currentAudioEl==t&&n.opts.onSeeked()}),this.opts.onSeek&&addEvent(t,"seeking",function(){n._currentAudioEl==t&&n.opts.onSeek()}),addEvent(t,"error",function(){n._prefetchAudioEl==t?n._prefetchAudioEl=n._createAudioNode():n._currentAudioEl==t&&n.opts.onFail&&n.opts.onFail()}),addEvent(t,"canplay",function(){if(window.data){var e=data(t,"setUrlTime");e&&(cur.audioLoadTimings=cur.audioLoadTimings||[],cur.audioLoadTimings.push(vkNow()-e),data(t,"setUrlTime",0))}n._prefetchAudioEl,n._currentAudioEl==t&&(n.opts.onCanPlay&&n.opts.onCanPlay(),n._seekOnReady&&(n.seek(n._seekOnReady),n._seekOnReady=!1))}),e&&(this._setAudioNodeUrl(t,e),t.preload="auto",t.volume=this._volume||1,t.load()),this._audioNodes.push(t),t},e.prototype.onReady=function(e){e(!0)},e.prototype.prefetch=function(e){this._prefetchAudioEl&&this._setAudioNodeUrl(this._prefetchAudioEl,r),this._prefetchAudioEl=this._createAudioNode(e)},e.prototype.seek=function(e){var t=this._currentAudioEl;this.duration?t.currentTime=this.duration*e:this._seekOnReady=e},e.prototype.setVolume=function(e){void 0===e&&(e=this._currentAudioEl.volume),this._currentAudioEl.volume=e,this._prefetchAudioEl&&(this._prefetchAudioEl.volume=e),this._volume=e},e.prototype._isInvalidDuration=function(){var e=this._currentAudioEl;return isNaN(e.duration)||e.duration==1/0||0==e.duration},e.prototype.getCurrentProgress=function(){var e=this._currentAudioEl;return this.duration?Math.max(0,Math.min(1,e.currentTime/this.duration)):0},e.prototype.getCurrentBuffered=function(){var e=this._currentAudioEl;return e&&e.buffered.length?Math.min(1,e.buffered.end(0)/e.duration):0},e.prototype.isFullyLoaded=function(){return this._currentAudioEl._fullyLoaded},e.prototype.setUrl=function(t,n){var o=this._currentAudioEl;if(this._seekOnReady=!1,this._trackOptions={},n&&"object"===(void 0===n?"undefined":i(n))&&(this._trackOptions=n,n=n.callback),o.src==t)return this.opts.onCanPlay&&this.opts.onCanPlay(),n&&n(!0);if(this._prefetchAudioEl&&this._prefetchAudioEl.readyState>e.STATE_HAVE_NOTHING)if(this._prefetchAudioEl.src==t){this._currentAudioEl.pause(0),this._setAudioNodeUrl(this._currentAudioEl,r);var a=this;this._prefetchAudioEl.readyState>=e.STATE_HAVE_FUTURE_DATA&&setTimeout(function(){a.opts.onCanPlay&&a.opts.onCanPlay()}),o=this._currentAudioEl=this._prefetchAudioEl,this._prefetchAudioEl=!1}else this._prefetchAudioEl.src&&this._setAudioNodeUrl(this._prefetchAudioEl,r);return o.src!=t&&(this._setAudioNodeUrl(o,t),o.load()),n&&n(!0)},e.prototype.play=function(t){this._prefetchAudioEl.src==t&&this._prefetchAudioEl.readyState>e.STATE_HAVE_NOTHING&&(this._setAudioNodeUrl(this._currentAudioEl,r),this._currentAudioEl=this._prefetchAudioEl,this._prefetchAudioEl=this._createAudioNode(),this.opts.onCanPlay&&this.opts.onCanPlay());var n=this._currentAudioEl;if(n.src)try{n.play()}catch(e){debugLog("Audio: url set failed (html5 impl)")}},e.prototype.pause=function(){var e=this._currentAudioEl;e.src&&e.pause()},e.prototype.stop=function(){var e=this._currentAudioEl;this._setAudioNodeUrl(e,r)},e.prototype._setFadeVolumeInterval=function(e){if(e){if(!this._fadeVolumeWorker&&window.Worker&&window.Blob){var t=new Blob(["         var interval;         onmessage = function(e) {           clearInterval(interval);           if (e.data == 'start') {             interval = setInterval(function() { postMessage({}); }, 20);           }         }       "]);try{this._fadeVolumeWorker=new Worker(window.URL.createObjectURL(t))}catch(e){this._fadeVolumeWorker=!1}}this._fadeVolumeWorker?(this._fadeVolumeWorker.onmessage=e,this._fadeVolumeWorker.postMessage("start")):this._fadeVolumeInterval=setInterval(e,60)}else this._fadeVolumeWorker&&(this._fadeVolumeWorker.terminate(),this._fadeVolumeWorker=null),this._fadeVolumeInterval&&clearInterval(this._fadeVolumeInterval)},e.prototype.fadeVolume=function(e,t){e=Math.max(0,Math.min(1,e));var n=this._currentAudioEl,i=0;if(i=e<n.volume?-.04:.001,Math.abs(e-n.volume)<=.001)return this._setFadeVolumeInterval(),t&&t();var o=n.volume;this._setFadeVolumeInterval(function(){i>0&&(i*=1.2),o+=i;if(i<0?o<=e:o>=e)return this.setVolume(e),this._setFadeVolumeInterval(),t&&t();this.setVolume(o)}.bind(this))},o(e,[{key:"type",get:function(){return"html5"}},{key:"loaded",get:function(){return!0}},{key:"duration",get:function(){var e=this._currentAudioEl,t=isNaN(e.duration)||e.duration==1/0?0:e.duration;return!t&&this._trackOptions.duration&&(t=parseInt(this._trackOptions.duration)),t}}]),e}();a.STATE_HAVE_NOTHING=0,a.STATE_HAVE_FUTURE_DATA=3,a.HAVE_ENOUGH_DATA=4,a.AUDIO_EL_ID="ap_audio"},function(e,t,n){"use strict";var i=n(322);window.Pad={addContent:function(e,t){t&&(0,i.$$)(o.pad(e)).forEach(function(e){var n=e.$(o.content)||e;e.classList.remove(r.empty),n.insertAdjacentHTML("beforeend",t)})}};var o={pad:function(e){return'.Pad[data-id="'+e+'"]'},content:".Pad__content"},r={empty:"Pad_empty"}},function(e,t,n){"use strict";Array.prototype.forEach||(Array.prototype.forEach=function(e){var t,n;if(null==this)throw new TypeError("this is null or not defined");var i=Object(this),o=i.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(arguments.length>1&&(t=arguments[1]),n=0;n<o;){var r;n in i&&(r=i[n],e.call(t,r,n,i)),n++}})},function(e,t,n){"use strict";var i=n(322),o=g(n(72)),r=g(n(77)),a=g(n(215)),s=g(n(9)),l=(g(n(131)),g(n(268))),u=(g(n(163)),n(256)),c=v(n(149)),d=n(251),f=n(56),p=n(91),_=g(p),A=n(304),m=n(0),h=v(n(216));function v(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function g(e){return e&&e.__esModule?e:{default:e}}Object.assign(_.default,{onToBottomClick:(0,o.default)(),onAttachedMsgsRemove:(0,o.default)(),onReplyClose:(0,o.default)(),onSubmit:(0,o.default)(),onMsgSend:(0,o.default)(),showToBottom:function(){if(S)return;T&&(clearTimeout(T),T=null);addClass("uMailWrite__toBottom_visible",(0,i.$)(".uMailWrite__toBottom"))},hideToBottom:function(){clearTimeout(x),T=setTimeout(function(){removeClass("uMailWrite__toBottom_visible",(0,i.$)(".uMailWrite__toBottom"))},100)},preventShowToBottom:function(){S=!0,setTimeout(function(){S=!1},300)},openStickersPanel:Y,redrawReply:oe,uiRedrawAttachments:re,redrawToBottom:function(){(0,i.$$)(".uMailWrite__toBottom").forEach(function(e){return e.innerHTML=(0,p.uMailWrite_ToBottomInner)()})},drawStickers:z,setModifiers:function(e){(0,i.$$)(".uMailWrite").forEach(function(t){var n=r.default.parseClass("uMailWrite",t.getAttribute("class"));t.setAttribute("class",r.default.class("uMailWrite",Object.assign({},n,e)))})},hideStickersPanel:W,setText:Ce,renderKeyboardIfNeeded:Se,openKeyboard:function(e){switch(Me(e),e){case"stickers":Y();break;case"buttons":K();break;case"text":(t=(0,i.$)(".uMailWrite__textarea"))&&t.focus();break;case"templates":Z()}var t},init:function(){var e=store.mail,t=e.cur,n=(e.msgs,t&&(0,f.getPeerDraft)(t.viewerId,t.peerId));n&&!t.editing&&n.text&&function(e){var t=document.createElement("textarea");t.innerHTML=e;var n=t.value;(0,i.$$)(".uMailWrite__textarea").forEach(function(e){return e.value=n});var o=(0,i.$)(".uMailWrite__textareaGhost");o.innerText=n,"\n"===last(n)&&(o.innerHTML+="&nbsp;");N()}(n.text);"templates"===(0,f.getKeyboardType)()?Z():Se();j(),n&&!t.editing&&Array.isArray(n.msgs)&&(t.msgAttached[t.peerId]=n.msgs);n&&!t.editing&&isFinite(n.reply)&&(t.msgReply[t.peerId]=n.reply);oe(),re(t.peerId),(0,i.$$)(".uMailWrite__textarea").forEach(function(e){(0,d.setScrollView)(e,{topBanner:!1,overscrollY:!1})}),(0,i.$$)(".uMailWrite__attachments").forEach(function(e){(0,d.setScrollView)(e,{topBanner:!1,allowY:!1})})},reset:function(){(0,f.setKeyboardType)("")},loadTemplatePage:function(e,t,n){e.preventDefault(),uMessenger.loadMailPage(n)}}),uVK.onReady(R),uVK.onReady(j),_.default._onBlur=pe,_.default._onKeyUp=se,_.default._onKeyDown=ce,_.default._onFocus=fe,_.default._onInput=le,_.default._onSubmit=ae,_.default._onClick=de,_.default._onAttachClick=te,_.default._onStickersClick=q,_.default._onKeyboardClick=G,_.default._onKeyboardButtonClick=X,_.default._onDeleteTemplate=Te,_.default._onConfirmDeleteTemplate=xe,mediaUpload.onRemove(H),mediaUpload.onComplete(U),mediaUpload.onStart(V),mediaUpload.onError($),post.onStickersTabSelected(ne),post.onStickerClick(ie),l.default.onOpen("uMailWrite_attachments")(O),_.default.onToBottomClick(function(){var e=(0,i.$)(".uMailWrite__toBottom_visible");e&&e.classList.remove("uMailWrite__toBottom_visible"),s.default.removeDivider()}),_.default.onReplyClose(function(){var e=store.mail.cur;e.msgReply[e.peerId]=null,(0,f.setPeerDraft)(e.viewerId,e.peerId,{reply:void 0},e.editing),e.editing||ajaxRequest("/mail",{act:"reply_cancel",peer_id:store.mail.cur.peerId,hash:store.mail.hash.reply}),oe()}),_.default.onTemplateClick=function(e,t,n){if(n){var i=void 0;store.mail.cur.templates.some(function(e){if(e.id===n)return i=e,!0}),i&&Ce((0,A.prepareTemplateText)(i.text))}};var y="uMailWrite__popupAttach_open",w="uMailWrite__popupStickers_open",b="uMailWrite__keyboard_open",D="uMailWrite__templates_open",C={canAttachPoll:"uMailWrite_canAttachPoll"},E={mailWrite:".uMailWrite",pollAttachment:".attachment_type_poll"},S=!1,k=!1,M=null,T=null,x=null,I=[],P=void 0,B=void 0,F=debounce(Ae,100),L=debounce(_e,1e3);function O(){function e(e,t){return e=e.replace(/&edit_msg_id=\d+/,"").replace(/=mailedit(-?\d+)/,"=mail$1"),store.mail.cur.editing&&(e=e.replace(/=mail(-?\d+)/,"=mailedit$1"),e+=t?"&edit_msg_id="+store.mail.cur.editing:""),e}(0,i.$$)("a.Unfold__item").forEach(function(t){var n=e(t.getAttribute("href"),!0);t.setAttribute("href",n)}),(0,i.$$)("input.inline_upload").forEach(function(t){t.setAttribute("data-upload-url",e(t.getAttribute("data-upload-url")))})}function N(){var e=(0,i.$)(".uMailWrite__textareaGhost").offsetHeight;(0,i.$$)(".uMailWrite__textarea").forEach(function(t){return setStyle(t,"height",e)}),(0,i.$$)(".uMailWrite__main").forEach(function(t){return setStyle(t,"height",e)}),Ae()}function R(){if("/mail"===location.pathname||0===location.pathname.indexOf("/write")){var e=store.mail.cur;if(e&&e.peerId){var t=geBySel(".uMailWrite__attachments .medias_thumb").length,n=geBySel(".uMailWrite__attachments .medias_row").length,o=(e.msgAttached[e.peerId]||[]).length?1:0;e.hasAttachments=t+n+o>0,(0,i.$$)(".uMailWrite__attachments").forEach(function(t){toggleClass("uMailWrite__attachments_hasAttachments",t,e.hasAttachments)}),function(){var e=(0,i.$)(".uMailWrite__buttonAttach");if(!e)return;var t=(n=(0,i.$)(".uMailWrite__attachments"),(n?n.$$(".thumb_item").length+n.$$(".medias_row").length-n.$$(".fwd_item").length:0)>=10);var n;e.classList.add("uMailWrite__button_disabled",t),t?e.addEventListener("mousedown",De,!0):e.removeEventListener("mousedown",De,!0)}()}}}function j(){var e=store.mail.cur;e&&e.peerId&&(I=function(e){var t=store.mail,n=t.peers,i=t.members,o=t.cur,r=[];return(n[e].memberIds||[]).filter(function(e){return e!==o.viewerId}).forEach(function(e){var t=i[e];if(t){var n=[t.id,t.name,t.url.replace("/","@"),t.avatar,t.url.replace("/",""),null,null,null,t.firstName,t.domain];r.push(n)}}),r}(e.peerId),Mention.init({defaultItems:I,items:I,appendTo:geByClass1("uMailWrite__main"),url:null,params:{},preferDomain:!0,afterInsert:function(t){var n=(0,i.$)(".uMailWrite__textareaGhost"),o=t.value;n.innerText=o,N(),_e(o,e.viewerId,e.peerId)}}))}function H(e){if(store.mail.cur){var t=store.mail,n=t.cur,o=t.peers,r=n.peerId;if(r&&(o[r].attachmentsHTML=geBySel1(".uMailWrite__attachments_"+r+" .cp_attached_wrap").outerHTML,re(r)),e.closest(E.pollAttachment))(0,i.$)(E.mailWrite).classList.add(C.canAttachPoll)}}function V(){store.mail.cur&&(R(),Ae())}function $(){if(store.mail.cur){var e=store.mail,t=e.cur,n=(e.peers,t.peerId);n&&(re(n),Messenger.scrollConvoToBottom())}}function U(){var e=store.mail,t=e.cur,n=e.peers;if(t){var i=t.peerId;i&&(n[i].attachmentsHTML=geBySel1(".uMailWrite__attachments_"+i+" .cp_attached_wrap").outerHTML,Ae())}}function z(){var e=store.mail.cur,t=(0,i.$)(".uMailWrite__popupStickers");t.childElementCount||(t.innerHTML=e.stickersPanelHTML.replace(/mail0/g,"mail"+e.peerId),(0,i.$$)(".sp_body",t).forEach(function(e){(0,d.setScrollView)(e,{topBanner:!1})}),(0,i.$$)(".scroller_wrap",t).forEach(function(e){(0,d.setScrollView)(e,{topBanner:!1,allowY:!1})}),post.stickersSelectTab(null,-1))}function q(e){var t=(0,i.$)(".uMailWrite__popupStickers"),n=hasClass(w,t);e.preventDefault(),z(),Me("stickers"),n?W():Y()}function W(){"stickers"===(0,f.getKeyboardType)()&&(0,f.setKeyboardType)("");var e=(0,i.$)(".uMailWrite__popupStickers");removeClass(w,e),me(!1);var t=ge("stickers_panel");t&&"block"===t.style.display&&(t.style.display="none")}function Y(){(0,f.setKeyboardType)("stickers");var e=(0,i.$)(".uMailWrite__popupStickers");addClass(w,e),post.stickersInit(),me(!0)}function G(e){var t=(0,i.$)(".uMailWrite__keyboard"),n=hasClass(b,t);e.preventDefault(),Me("buttons"),n?Q({store:!0}):K({store:!0})}function X(e,t){var n=t.authorId,i=t.action,o=i.payload,r=i.rawLabel,a=store.mail,s=a.cur,l=a.members,c=a.peers,d=l[n],f=c[s.peerId],p=(0,u.random)();s.localOutMsgIds.push(p);var _=void 0;s.peerId>=2e9?_=d.domain?"@"+d.domain+" "+r:"@"+d.url.replace(/^\//,"")+" ("+d.firstName+") "+r:_=r;statlogsValueEvent("message_send_from_keyboard",0,s.viewerId,s.peerId,n),ve({act:"send",to:s.peerId,from:"dialog",hash:f.hashSend,message:_,media:"",_af:s._af,random_id:p,payload:o})}function Q(e){"buttons"===(0,f.getKeyboardType)()&&(0,f.setKeyboardType)("");var t=(0,i.$)(".uMailWrite__keyboard");if(removeClass(b,t),he(!1),e&&e.store){var n=store.mail.cur.peerId,o=store.mail.peers[n];o&&o.keyboard&&(P[n]=o.keyboard.chat_local_id,lsSet("mail_keyboard_hidden",P))}}function K(e){(0,f.setKeyboardType)("buttons");var t=(0,i.$)(".uMailWrite__keyboard"),n=e&&e.forceRender;addClass(b,t),he(!0);var o=(0,f.getKeyboardState)(store.mail.cur.peerId);!n&&!!o.rendered||function(){var e=store.mail,t=e.cur,n=e.peers,o=t.peerId&&n[t.peerId];if(!o||!o.keyboard||!o.keyboard.buttons)return;var r=o.keyboard.buttons.map(function(e){var t=e.map(function(e){return(0,p.uMailWrite_KeyboardButton)(e,o.keyboard)});return(0,p.uMailWrite_KeyboardRow)(t.join(""))}).join(""),a=(0,i.$)(".uMailWrite__keyboard");a.innerHTML=r,(0,d.setScrollView)(a,{topBanner:!1}),(0,f.getKeyboardState)(t.peerId).rendered=!0}(),e&&e.store&&J()}function J(){var e=store.mail.cur.peerId;P&&(delete P[e],lsSet("mail_keyboard_hidden",P))}function Z(){(0,f.setKeyboardType)("templates");var e=(0,i.$)(".uMailWrite__templates");addClass(D,e),Ae(),ke()}function ee(){"templates"===(0,f.getKeyboardType)()&&(0,f.setKeyboardType)("");var e=(0,i.$)(".uMailWrite__templates");removeClass(D,e),Ae()}function te(e){var t=(0,i.$)(".uMailWrite__popupAttach"),n=(0,i.$)(".uMailWrite__popupStickers");e.preventDefault(),e.stopPropagation(),hasClass(w,n)&&removeClass(w,n),hasClass(y,t)?removeClass(y,t):(addClass(y,t),addEvent(window,"click",function e(n){removeClass(y,t);removeEvent(window,"click",e)}))}function ne(){store.mail.cur&&(cur.scroller&&cur.scroller.destroy(),geByClass1("sp_body").scrollTop=0,removeClass("scroller_wrap",geByClass1("sp_cont")),geByClass("sp_page").forEach(function(e){return removeClass("scroller_page",e)}))}function ie(e,t){if(store.mail.cur){var n=store.mail,o=n.cur,r=n.peers,a=(geByClass1("uMailWrite"),(0,i.$)(".uMailWrite__popupStickers")),s=(0,u.random)();o.localOutMsgIds.push(s);var l=0===t.indexOf("suggestion"),c={act:"send",to:o.peerId,from:"dialog",hash:r[o.peerId].hashSend,message:"",media:"sticker"+e,_af:o._af,random_id:s,sticker_referrer:t},d=o.msgReply[o.peerId];if(d&&(c.attached_messages=d,c.has_reply=!0,(0,f.setPeerDraft)(o.viewerId,o.peerId,{reply:void 0}),ajaxRequest("/mail",{act:"reply_cancel",peer_id:store.mail.cur.peerId,hash:store.mail.hash.reply}),o.msgReply[o.peerId]=null),l){var p=(0,i.$)(".uMailWrite__textarea");p.value="",_e("",o.viewerId,o.peerId),le({},p)}ve(c),Ae(),oe(),removeClass(w,a);var _=ge("stickers_panel");return _&&"block"===_.style.display&&(_.style.display="none"),me(!1),!0}}function oe(){var e=store.mail,t=e.cur,n=e.replies,o=t.msgReply[t.peerId];if(n[o])(0,i.$$)(".uMailWrite__reply").forEach(function(e){e.outerHTML=(0,p.uMailWrite_ReplyHTML)(o,n[o],!!t.editing)});else{var r=o&&Msg.getElem(o),a="";if(r){var s=(0,i.$)(".thumbs_map .thumb_map_img_as_div",r);(a=s&&s.style.backgroundImage)&&(a=a.replace(/^url\((['"])?/,"").replace(/(['"])?\)$/,""))}(0,i.$$)(".uMailWrite__reply").forEach(function(e){e.outerHTML=(0,p.uMailWrite_Reply)(a)})}}function re(e){(0,i.$$)(".uMailWrite__attachments_"+e).forEach(function(t){t.outerHTML=(0,p.uMailWrite_Attachments)(e)}),R(),(0,i.$)(".uMailWrite__textarea")&&Ae();var t=(0,i.$)(E.mailWrite);if(t){var n=!!t.$(E.pollAttachment);t.classList.toggle(C.canAttachPoll,!n)}}function ae(e){if(e&&e.preventDefault(),!mediaUpload.checkUploading())return!1;var t,n=(0,i.$)(".uMailWrite__textarea"),o=store.mail,r=o.cur,l=o.peers,c=(0,u.random)(),d=store.mail.cur.editing,p=d&&store.mail.msgs[d],_=p?{act:"edit_message",id:d,peerId:p.peerId,hash:l[r.peerId].hashSend}:{act:"send",to:r.peerId,from:"dialog",hash:l[r.peerId].hashSend,_af:r._af,random_id:c,entrypoint:store.mail.cur.mvk_entrypoint||""};if(!Ee())return p?MsgDeleteDialog.open({isEditing:!0}):r.groupId&&(t=(0,i.$)(".uMailWrite__templates"),Me("templates"),hasClass(D,t)?ee():Z()),!1;each(geByClass1("uMailWrite"),function(e,t){return!(t.name&&!t.disabled)||("radio"===t.type&&!t.checked||("checkbox"===t.type&&!t.checked||("button"===t.type||("submit"===t.type||("image"===t.type||void(_[t.name]=t.value))))))}),d?(uMailHat.onCancelEditing(!0),ajaxRequest("/mail",_)):(r.localOutMsgIds.push(c),ve(_),store.mail.cur.mvk_entrypoint="",(0,f.popPeerAttachments)(r.peerId),n.value="",_e("",r.viewerId,r.peerId),(0,f.setPeerDraft)(r.viewerId,r.peerId,{msgs:void 0,reply:void 0},r.editing),r.msgReply[r.peerId]&&!r.editing&&ajaxRequest("/mail",{act:"reply_cancel",peer_id:store.mail.cur.peerId,hash:store.mail.hash.reply}),r.msgAttached[r.peerId]=[],r.msgReply[r.peerId]=null,le({},n)),s.default.onSystemMessageClick(),re(r.peerId),oe(),StickersHints.actualizeVisibility();var A=a.default.ios?setTimeout:requestAnimationFrame;k&&(n.focus(),A(function(){return n.focus()}))}function se(){var e=se,t=e.typingData||(e.typingData={});if(0!==(0,i.$)(".uMailWrite__textarea").value.length&&!store.mail.cur.editing){var n=Date.now(),o=store.mail,r=o.cur,a=o.peers,s=r.peerId;s<=-2e9||t[s]&&n-t[s]<5e3||(t[s]=n,ajaxRequest("/mail",{_ajax:1,act:"typing",peer:s,hash:a[s].hashTyping,community:nav.getQuery("community")}))}}function le(e,t){var n=(0,i.$)(".uMailWrite__textareaGhost"),o=t.value;n.innerText=o,"\n"===last(o)&&(n.innerHTML+="&nbsp;");var r=store.mail.cur,a=n.offsetHeight;(0,i.$$)(".uMailWrite__textarea").forEach(function(e){return setStyle(e,"height",a)}),(0,i.$$)(".uMailWrite__main").forEach(function(e){return setStyle(e,"height",a)}),F(),r&&L(o,r.viewerId,r.peerId),ue(e,t,function(){Mention.onKeyUp(e,t)})}function ue(e,t,n){I.length&&(!hasClass("Mention_inited",geByClass1("uMailWrite__main"))&&j(),n(e,t))}function ce(e,t){ue(e,t,function(){Mention.onKeyDown(e,t)}),(10==e.keyCode||13==e.keyCode&&(e.ctrlKey||e.metaKey))&&ae()}function de(e,t){ue(e,t,function(){Mention.onClick(e,t)})}function fe(e,t){(0,f.setKeyboardType)("text");var n=function(){z(),Me("text"),StickersHints.init(),ue(e,t,function(){Mention.onFocus(e,t)})};a.default.ios?n():requestAnimationFrame(function(){requestAnimationFrame(function(){n()})}),clearTimeout(M),k=!0,c.onOpen("bottom")}function pe(e,t){if("text"===(0,f.getKeyboardType)()&&(0,f.setKeyboardType)(""),c.onClose(),M=setTimeout(function(){k=!1},1e3),L._timer&&clearTimeout(L._timer),store.mail&&store.mail.cur){var n=store.mail.cur,i=n.viewerId,o=n.peerId;_e(t.value,i,o)}}function _e(e,t,n){var i=store.mail.cur.editing;(0,f.setPeerDraft)(t,n,{text:e},i)}function Ae(){var e=store.mail,t=e.cur,n=e.queue,o=e.flags;if(t.peerId){var a=!Ee(),s=!!(n[t.peerId]||[]).length||!mediaUpload.checkUploading(),l=!!t.editing,u={sendActive:!a&&!l&&!s,loading:s,editAccept:l&&!a,editRemove:l&&a},c=o.templates&&!(l||!t.groupId||!a||u.loading||u.uploading);u.templates=c&&"templates"!==(0,f.getKeyboardType)(),u.templatesActive=c&&"templates"===(0,f.getKeyboardType)();var d=!(u.sendActive||u.loading||u.editAccept||u.editRemove||u.templates||u.templatesActive);u.disabled=d;var p=r.default.class("uMailWrite__button","uMailWrite__buttonSend",u);(0,i.$$)(".uMailWrite__buttonSend").forEach(function(e){return e.className=p})}}function me(e){var t=r.default.class("uMailWrite__button","uMailWrite__buttonStickers",{active:e});(0,i.$$)(".uMailWrite__buttonStickers").forEach(function(e){return e.className=t})}function he(e){var t=r.default.class("uMailWrite__button","uMailWrite__buttonKeyboard",{active:e});(0,i.$$)(".uMailWrite__buttonKeyboard").forEach(function(e){return e.className=t})}function ve(e){var t=store.mail.cur,n=t.peerId,i=t.ref,o=t.ref_source;if(n){store.mail.queue[n]||(store.mail.queue[n]=[]),o&&(e.ref_source=o,e.ref=i,store.mail.ref_source=void 0,store.mail.ref=void 0);var r=store.mail.queue[n];h.logQueueSize(r.length),r.push(e),function(e){1===store.mail.queue[e].length&&we(e)}(n);var a=store.mail.peers[n];if(a&&a.keyboard&&a.keyboard.one_time)a.keyboard=null,(0,f.getKeyboardState)(n).updateTime=Date.now(),Se()}Ae()}function ye(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];var n="/mail?act=send&to="+e.to+"&from="+e.from+"&hash="+e.hash+"&_af="+e._af;e.ref&&(n+="&ref"+e.ref),e.ref_source&&(n+="&ref_source"+e.ref_source),Object.keys(e).forEach(function(t){"act"!==t&&"to"!==t&&"from"!==t&&"hash"!==t&&"_af"!=t||delete e[t]});var i=h.log({action:"edit_message"===e.act?"edit":"send"});im.pause(),ajaxRequest(n,e,function(e){_.default.onMsgSend(e),function(e){var t=store.mail.queue[e];t.shift();s.default.clearSystemMessage2(),remove(geByClass1("message__newMsgsDivider")),remove(geByClass1("Unfold__item_returnToChat")),t.length?we(e):be()}(t),i.mark("server_post"),i=null,im.resume()},function(t,o,r){if(r instanceof XMLHttpRequest)0===r.status?i.error("server_send","network"):i.error("server_send","server"+r.status);else if(0===t&&null==o&&null==r)i.error("server_send","response_parsing");else switch(t){case 2:i.error("server_send","captcha");break;case 4:i.error("server_send","auth");break;default:i.error("server_send","unknown")}if(i=null,im.resume(),2===t){delete e._ajax,delete e.random_id;var a=document.createElement("div"),s=Object.keys(e);a.innerHTML='\n        <form action="'+n+'" method="POST">\n          '+s.map(function(t){return'<input name="'+t+'" value="'+e[t]+'" />'}).join("")+"\n        </form>\n      ";var l=a.$("form");document.body.appendChild(l),l.submit()}})}function we(e){var t=store.mail.queue[e];t.length?ye(t[0],e):be()}function be(){Ae()}function De(e){e.stopPropagation(),alert(lang.mobile_mail_attachments_limit)}function Ce(e){var t=document.createElement("textarea");t.innerHTML=e;var n=t.value,o=(0,i.$$)(".uMailWrite__textarea");o.forEach(function(e){return e.value=n}),le({},o[0])}function Ee(){return function(){var e=store.mail,t=e.cur;e.peers;return!!t&&t.hasAttachments}()||!!(0,i.$)(".uMailWrite__textarea").value.trim()}function Se(e){if((0,i.$)(".uMailWrite__keyboard")){var t=store.mail,n=t.cur,o=t.peers,a=n.peerId&&o[n.peerId],s=void 0;s=!(n.groupId||!a||a.closed||a.kicked)&&!(!a.keyboard||!a.keyboard.buttons.length);var l=(0,i.$)(".uMailWrite"),u=r.default.parseClass("uMailWrite",l.className);if(u.keyboard!==s&&(l.className=r.default.class("uMailWrite",Object.assign({},u,{keyboard:s}))),(0,f.getKeyboardState)(n.peerId).rendered=!1,s){P||(P=lsGet("mail_keyboard_hidden")||{});var c=a.keyboard,d=P[n.peerId],p=(e&&e.update,!(0,f.getKeyboardType)()||"buttons"===(0,f.getKeyboardType)()),_=!1;d&&(d==c.chat_local_id?p=!1:_=!0),p?K({store:_}):_&&J()}else Q()}}function ke(){var e=store.mail,t=e.cur,n=e.peers,o=t.peerId&&n[t.peerId];if(t.groupId&&o&&!o.closed&&!o.kicked){var r=(0,i.$)(".uMailWrite__templatesBody"),a=t.templates;if(r)return a?void function(e,t){e.innerHTML=(0,A.uMailWrite_TemplatesContent)(t)}(r,a):(function(e){e.innerHTML=(0,A.uMailWrite_TemplatesLoading)()}(r),B||(B=new Promise(function(e){ajaxRequest("/mail",{act:"get_templates"},function(t){e(t)},function(t){e()})})),void B.then(function(e){B=null,store.mail&&store.mail.cur&&(store.mail.cur.templates=e),ke()}))}}function Me(e){var t;"stickers"!==e&&W(),"buttons"!==e&&Q(),"text"!==e&&(t=(0,i.$)(".uMailWrite__textarea"))&&document.activeElement===t&&t.blur(),"templates"!==e&&ee()}function Te(e){var t=store.mail.cur.templates.find(function(t){return t.id===e});if(t){var n=lang.mobile_mail_templates_delete_popup_text;n=n.replace("{name}",(0,m.emojiToHTML)(t.name)),MailDialog.open({body:n,confirmText:lang.mobile_mail_delete_popup_delete,cancelText:lang.mobile_mail_delete_popup_cancel,onConfirm:r.default.onClick("uMailWrite._onConfirmDeleteTemplate",e)})}}function xe(e){var t=store.mail.cur.templates.findIndex(function(t){return t.id===e});if(-1!==t){var n=store.mail.cur.templates.splice(t,1)[0];ajaxRequest("/mail",{act:"delete_template",hash:store.mail.hash.template_delete,id:e},function(e){e.error&&store.mail.cur.templates.push(n)},function(){store.mail.cur.templates.push(n)}),ke()}MailDialog.close()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(182),r=(i=o)&&i.__esModule?i:{default:i};t.default=r.default,window.MailButton=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(330),r=(i=o)&&i.__esModule?i:{default:i};t.default=r.default,window.Spinner=r.default},function(e,t,n){"use strict";Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,i=function(){},o=function(){return n.apply(this instanceof i?this:e,t.concat(Array.prototype.slice.call(arguments)))};return this.prototype&&(i.prototype=this.prototype),o.prototype=new i,o})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Resampler=void 0,t.fastResample=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"peak";return new s({srcSampleRate:e.length,dstSampleRate:t,normalizeAlgorithm:n,truncateTo:0}).push(e)};var i=n(280),o=n(146),r=n(336);var a={avg:i.AverageAlgorithm,peak:o.PeakAlgorithm,quad:r.QuadAlgorithm},s=t.Resampler=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._normalizeAlgorithm=!1,a[t.normalizeAlgorithm]&&(this._normalizeAlgorithm=new a[t.normalizeAlgorithm]),this._srcSampleRate=parseInt(t.srcSampleRate||0),this._dstSampleRate=parseInt(t.dstSampleRate||0),this._truncateTo=1,void 0!==t.truncateTo&&(this._truncateTo=t.truncateTo),this._dstSampleRate>0?this._sampleRate=this._srcSampleRate/this._dstSampleRate:this._sampleRate=0,a[t.algorithm]||(t.algorithm="peak"),this._algorithm=new a[t.algorithm],this._sampleCount=0,this._data=[]}return e.prototype.push=function(e){if(this._sampleRate<=0)return[];for(var t=[],n=void 0,i=0;i<e.length;i++)if(this._truncateTo>0&&(e[i]=Math.min(this._truncateTo,Math.abs(e[i]))),this._sampleCount+=1,this._sampleCount>=this._sampleRate)for(;this._sampleCount>=this._sampleRate;)this._sampleCount-=this._sampleRate,this._sampleCount<=.8&&this._algorithm.push(e[i]),n=this._algorithm.get(),t.push(n),this._normalizeAlgorithm&&this._normalizeAlgorithm.push(n),this._algorithm.clear(),this._sampleCount>.2&&this._algorithm.push(e[i]);else this._algorithm.push(e[i]);if(this._normalizeAlgorithm){var o=this._normalizeAlgorithm.get();if(this._normalizeAlgorithm.clear(),o>0)for(var r=0;r<t.length;r++)t[r]=t[r]/o,this._truncateTo>0&&(t[r]=Math.min(this._truncateTo,Math.abs(t[r])))}return t},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uConvo_getTyping=t.uConvo_getUnreadCount=t.uConvo_getOnline=t.uConvo_getLastMsg=void 0;r(n(77)),r(n(131));var i=r(n(313)),o=n(267);function r(e){return e&&e.__esModule?e:{default:e}}function a(e){return!!e.isOnline&&("desktop"===e.onlinePlatform?"desktop":"mobile")}function s(e){var t=function(e){return store.mail.peers[e]}(e).countUnread;if(0===t){var n=store.mail,i=l(e),o=i?n.msgs[i]:null;o&&o.isUnread&&o.authorId===n.cur.viewerId&&(t=-1)}return t}function l(e){var t=store.mail,n=(t.cur.msgRemoved,t.rolls.peer[e]);return n?last(n):null}function u(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=(0,o.uTyping_getPeerTyping)(e);if(!n)return"";var i=void 0,r=void 0;return"mixed"===n.type?(i="simple-dots",r="mixed"):"audio"===n.type?(i="audio",r="audio"):"text"===n.type&&(i="simple-dots",r=""),{typing:!!t||(0,o.uTyping_getNames)(n),typingCount:n.count,animation:i,text:r,dimmed:!1,compact:!0}}t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n="last"===t,o=store.mail,r=o.peers[e],c=r.url,d=null;if(t){n||(c=c+"&msg="+t);var f=n?l(e):t,p=o.msgs[f];p&&(d={text:p.textShort,date:p.dateShort,unreadCount:s(e),muted:r.isMuted,typing:u(e)})}return(0,i.default)({id:e,url:c,photos:r.avatarImages,title:r.title,online:a(r),important:r.isImportant,profileUrl:r.profileUrl,isLast:n,more:d})},t.uConvo_getLastMsg=function(e){var t=store.mail.msgs,n=l(e);return n?t[n]:null},t.uConvo_getOnline=a,t.uConvo_getUnreadCount=s,t.uConvo_getTyping=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=l(n(326)),o=n(235),r=l(n(9)),a=l(n(209)),s=l(n(77));function l(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=window.lang,n=(0,o.MailHat)({type:"page",left:(0,o.MailHat__icon)({icon:"back",url:"/mail"}),center:(0,o.MailHat__Title)({title:t.mobile_mail_mrs_page_title})}),l=[{class:"MessageRequestsPage__content ScrollView",inner:[{class:"MessageRequestsPage__info",inner:t.mobile_mail_mrs_page_info},i.default.wrap((0,r.default)({scrap:"mrs"}))]},e.count?{class:"MessageRequestsPage__footer",inner:[(0,a.default)({theme:"negative",size:"large",type:"button",inner:t.mobile_mail_mrs_button_reject_all,attrs:s.default.onClick("MessageRequestsPage.rejectAll","event","this")})]}:null];return{class:"messenger__page MessageRequestsPage",inner:[{class:"messenger__header",inner:i.default.wrap(n)},{class:"messenger__body",inner:l}]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(210),r=(i=o)&&i.__esModule?i:{default:i},a=n(255);t.default=function(e){var t=e.url,n=e.inner,i=e.is_icon,o=e.on_click;o&&!e.use_native_onclick&&(o=["Btn._onClick","event","this",o]);var s={class:[e.class,r.default.class("Btn",{theme:e.theme||"regular",size:e.size||"",stretch:e.stretch})],onclick:o,attrs:e.attrs};if(t)return(0,a.mergeObjects)(s,{tag:"a",href:t,role:"button",style:e.style,inner:i?n:{class:"Btn__text",inner:n},target:e.open_in_new_tab?"_blank":null});var l=e.is_submit?"submit":null,u=e.type||l;return(0,a.mergeObjects)(s,{tag:"button",style:e.style,disabled:e.disabled,type:u,inner:i?n:{class:"Btn__text",inner:n}})}},function(e,t,n){"use strict";var i,o=n(189),r=(i=o)&&i.__esModule?i:{default:i};window.uRegisterFloatBtn=r.default},function(e,t,n){"use strict";var i=n(322),o=a(n(347)),r=a(n(126));a(n(346)),a(n(117));function a(e){return e&&e.__esModule?e:{default:e}}window.SwitcherConfirm={},SwitcherConfirm._onSwitcherChange=u,SwitcherConfirm._onConfirmClick=c,SwitcherConfirm._onCancelClick=function(e){return d(e.$btn)},SwitcherConfirm._onPopupOverlayClick=function(e){return d(e.$popup)};var s={checked:function(e){return"SwitcherConfirm_checked_"+(e?"yes":"no")}},l={switcher:".SwitcherConfirm",popup:".SwitcherConfirm__popup",confirm:".SwitcherConfirm__confirm",cancel:".SwitcherConfirm__cancel"};function u(e){var t=e.$control,n=t.closest(l.switcher),r=(0,i.$)(l.popup,n);o.default.open(r),n.$popup=r,n.$control=t,n.checked=e.checked}function c(e,t){var n=t.$btn.closest(l.switcher),r=(0,i.$)(l.confirm,n),a=(0,i.$)(l.cancel,n),u=n.checked;n.isSaving=!0,Btn.setLoading(r,!0),Btn.setDisabled(a,!0),Wd.handle(e,{checked:u,onSuccess:function(){n.isSaving=!1,o.default.close(n.$popup),Btn.setLoading(r,!1),Btn.setDisabled(a,!1),n.classList.toggle(s.checked(!0),u),n.classList.toggle(s.checked(!1),!u)}})}function d(e){var t=e.closest(l.switcher);t.isSaving||(r.default.setChecked(t.$control,!t.checked),o.default.close(t.$popup))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var o=35;void 0===window.isTouch&&(window.isTouch=!1);t.Slider=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t)throw new Error("No element was provided for Slider");t=ge(t),this.options=n||{size:1},void 0===this.options.logfbase&&(this.options.logfbase=o),this.options.backValue=this.options.backValue||0;var i=100*this.options.backValue,r='<div class="slider_slide"><div class="slider_loading_bar" style="opacity: 0; display: none;"></div> '+(this.options.withBackLine?'<div class="slider_back" style="width:'+i+'%"></div>':"")+' <div class="slider_amount"></div> <div class="slider_handler"></div> </div>';this._el=ce("div",{innerHTML:r,className:"slider",id:t.getAttribute("id")||""});var a=this;if(t.classList)for(var s=t.classList,l=0,u=s.length;l<u;l++)addClass(this._el,s[l]);else this._el.className=t.className;each(this._el.attributes,function(e,t){"id"==t.name&&"class"==t.name||a._el.setAttribute(t.name,t.value)}),t.parentNode.replaceChild(this._el,t),this._amountEl=geByClass1("slider_amount",this._el),this._handlerEl=geByClass1("slider_handler",this._el),this._slideEl=geByClass1("slider_slide",this._el),this._backEl=geByClass1("slider_back",this._el),this._progressEl=geByClass1("slider_loading_bar",this._el),this.options.color&&(setStyle(this._amountEl,{backgroundColor:this.options.color}),setStyle(this._handlerEl,{backgroundColor:this.options.color})),this.options.backColor&&setStyle(this._slideEl,{backgroundColor:this.options.backColor}),addClass(this._el,"slider_size_"+this.options.size),this.options.debounce&&(this._onValueChangeDebounced=debounce(this._onValueChange,this.options.debounce)),!isTouch&&n.formatHint&&(addEvent(this._el,"mousemove",this._ev_onMouseOver=this._onMouseOver.bind(this)),addEvent(this._el,"mouseleave",this._ev_onMouseLeave=this._onMouseLeave.bind(this))),addEvent(this._el,isTouch?"touchstart":"mousedown",this._ev_onMouseDown=this._onMouseDown.bind(this)),addEvent(this._el,"click",cancelEvent),this.setValue(this.options.value||0,!this.options.fireChangeEventOnInit,!1),this.setBackValue(this.options.backValue)}return e.prototype.toggleLoading=function(e){e=!!e,toggle(this._progressEl,e),setStyle(this._progressEl,"opacity",e?1:0)},e.prototype.destroy=function(){!isTouch&&this.options.formatHint&&(removeEvent(this._el,"mousemove",this._ev_onMouseOver),removeEvent(this._el,"mouseleave",this._ev_onMouseLeave),removeEvent(this._el,"mousedown",this._ev_onMouseDown));var e=window.re||window.remove;e(this._el),e(this._currHintEl)},e.prototype._updateHint=function(e,t){this._currHintEl||(this._currHintEl=ce("div",{className:"slider_hint",id:"slider_hint"}),this.options.hintClass&&addClass(this._currHintEl,this.options.hintClass),this._el.appendChild(this._currHintEl));var n=this._getPos(),i=Math.round((e.pageX||e.touches[0].pageX)-n[0]),o=this._width;if((i=t?Math.min(Math.max(0,i),o):i)>=0&&i<=o){var r=i/o;this._currHintEl.innerHTML=this.options.formatHint?this.options.formatHint.call(this,r):r;var a=this._currHintEl.getBoundingClientRect();setStyle(this._currHintEl,{left:this._slideEl.offsetLeft+i-(a.right-a.left)/2,top:this._slideEl.offsetTop-(a.bottom-a.top)-10}),!t&&this._toggleHint(!0)}else!t&&this._toggleHint(!1);this.options.formatHint||this._toggleHint(!1)},e.prototype._toggleHint=function(e){toggleClass(this._currHintEl,"visible",e)},e.prototype._onMouseOver=function(t){e._currenSliderDrag||hasClass(this._el,"active")||this._updateHint(t)},e.prototype._onMouseLeave=function(e){hasClass(this._el,"active")||this._toggleHint(!1)},e.prototype._onMouseDown=function(t){(0==t.button||t.touches)&&(delete cur._sliderMouseUpNowEl,addEvent(window,isTouch?"touchmove":"mousemove",this._ev_onMouseMove=this._onMouseMove.bind(this)),addEvent(window,isTouch?"touchend touchcancel":"mouseup",this._ev_onMouseUp=this._onMouseUp.bind(this)),this._onMouseMove(t),e._currenSliderDrag=this,addClass(this._el,"active"),cancelEvent(t))},e.prototype._onMouseUp=function(t){cur._sliderMouseUpNowEl=this._el,removeEvent(window,isTouch?"touchmove":"mousemove",this._ev_onMouseMove),removeEvent(window,isTouch?"touchend touchcancel":"mouseup",this._ev_onMouseUp),this._onValueChange(),removeClass(this._el,"active"),e._currenSliderDrag=!1,this._toggleHint(!1),this.options.onEndDragging&&this.options.onEndDragging(this._currValue),cancelEvent(t)},e.prototype._onMouseMove=function(e){var t=this._getPos(),n=t[0];n=void 0!==e.touches&&e.touches.length>0?e.touches[0].pageX:e.pageX,n=Math.max(n,t[0]),n=Math.min(n,t[0]+this._width),n-=t[0],this.setValue(n/this._width,!0,!0),this._onValueChangeDebounced?this._onValueChangeDebounced():this._onValueChange(),this._toggleHint(!0),this._updateHint(e,!0),cancelEvent(e)},e.prototype._getPos=function(){return this._slidePos=getXY(this._slideEl)},e.prototype._logf=function(e){if(!this.options.log)return e;var t=this.options.logfbase;return(Math.pow(t,e)-1)/(t-1)},e.prototype._unlogf=function(e){if(!this.options.log)return e;var t,n,i=this.options.logfbase;return t=i,n=1+e*(i-1),Math.log(n)/Math.log(t)},e.prototype.setValue=function(e,t,n){if(!hasClass(this._el,"active")||n){var i=n?this._logf(e):e;if(this._currValue!=i){this._currValue=i;var o=n?e:this._unlogf(e);o=100*o+"%",setStyle(this._amountEl,{width:o}),setStyle(this._handlerEl,{left:o}),!t&&this._onValueChange()}}},e.prototype.setBackValue=function(e){toggleClass(this._backEl,"slider_back_transition",e>this._backValue),this._backValue=e;var t=100*e+"%";setStyle(this._backEl,{width:t})},e.prototype._onValueChange=function(){this._lastValue=this._lastValue||0,this._lastValue!=this._currValue&&(this._lastValue=this._currValue,this.options.onChange&&this.options.onChange(this._currValue))},i(e,[{key:"_width",get:function(){if(!this._widthCache){var e=this._el.getBoundingClientRect();this._widthCache=e.right-e.left}return this._widthCache}}]),e}()},function(e,t,n){"use strict";var i,o=n(215),r=(i=o)&&i.__esModule?i:{default:i};function a(e,t,n){if(r.default.wkwebview){attr(t,"onclick",""),attr(t,"href","vk://vk.com/write"+(2e9+e));var i=new Event("click");return t.dispatchEvent(i),void setTimeout(function(){attr(t,"href","/mail?act=show&chat="+e),t.textContent=n})}r.default.android?location.href="https://vk.com/write"+(2e9+e):r.default.ios?(attr(t,"onclick",""),attr(t,"href","/mail?act=show&chat="+e),t.textContent=n,location.href="vk://vk.com/write"+(2e9+e)):location.href="/mail?act=show&chat="+e}window.ChatPreview={join:function(e,t,n){return ajax.post(e,{},{onDone:function(e){a(e,t,n)}}),!1},open:function(e,t,n){return setTimeout(function(){a(e,t,n)}),!1}}},function(e,t,n){"use strict";var i,o=n(215),r=(i=o)&&i.__esModule?i:{default:i};var a=window.setCookie;r.default.ios&&a("remixmvk_iphone_x",r.default.ios&&3===window.devicePixelRatio&&375===window.screen.width&&812===window.screen.height?1:0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(245));t.default=i,window.MsgDeleteDialog=i},function(e,t,n){"use strict";var i=window,o=i.ge,r=i.attr,a=(i.clog,i.lsCheck),s=i.isEmpty,l=i.vkNow,u=i.lsGet,c=i.intval,d=i.lsSet,f=i.extend,p=i.hasClass,_=i.gpeByClass,A=i.each,m=i.geByClass,h=i.addClass,v=i.checkPostsSeen,g=i.hashCode,y=window.ajax,w=window.nav,b={_seen:{},_saved:{},_saveTimer:null,_sendTimer:null,_cleanTimer:null,LS_ADS_EVENTS:"ads.events",postsGetRaws:function(e){var t,n=(e=o(e)).id||"",i=r(e,"data-copy")||"",a={};if("block_"===n.substr(0,6)){a[n]=1,a.block=n.substr(6);var s=r(e,"data-contain");s&&(s=s.split(",")).forEach(function(e){e=e.split(":"),a[e[0]]=c(e[1])||1})}else(t=n.match(/^wall(adsite.*)$/))?a[t[1]]=1:(t=n.match(/^wall(-?\d+_\d+)$/))&&(a[t[1]]=1,(t=i.match(/^(-?\d+_\d+)$/))&&(a[t[1]]=-1));var l=r(e,"data-ad-view");return l&&(a["ad_"+l]=1),a.index=indexOf(domPN(e).children,e)-1,a},seen:function(e){var t,n,i,o,r,a,s,l;if(window.vk.id&&e.length){for(t in window._postsExtras||(window._postsExtras={}),e)for(n in s=e[t].index,l=e[t].block,e[t])"index"!=n&&"block"!=n&&(o=e[t][n],r=b._seen[n],-1==(a=b._saved[n])||-1==r||1==o&&(a||r)||(i=b._seen[n]=o,_postsExtras[n]={index:s,block:l}));i&&(clearTimeout(b._saveTimer),b._saveTimer=setTimeout(b.save,2500),clearTimeout(b._sendTimer),b._sendTimer=setTimeout(b.send,5e3))}},save:function(){if(!a()||s(b._seen))return b._seen;var e,t,n,i,o,r=window.vk,f=Math.floor((r.ts+Math.floor((l()-r.started)/1e3))/3600),p=u("posts_sent")||{},_=u("posts_seen")||{},A=u("posts_extras")||{};for(t in window._postsExtras||(window._postsExtras={}),b._seen)o=b._seen[t],_postsExtras[t]&&(A[t]={index:_postsExtras[t].index,block:_postsExtras[t].block},delete window._postsExtras[t]),"ad"!==(n=t.split("_"))[0]&&"adsite"!==n[0]&&"block"!==n[0]&&(n[0]=c(n[0]),n[1]=c(n[1])),i=(p[n[0]]||{})[n[1]],n[0]!=r.id&&(!i||-1==o&&i>0)&&(_[n[0]]||(_[n[0]]={}),(!_[n[0]][n[1]]||-1==o&&_[n[0]][n[1]]>0)&&(e=_[n[0]][n[1]]=f*o)),b._saved[t]=o;b._seen={},e&&(d("posts_seen",_),d("posts_extras",A))},getSeenData:function(){var e,t,n,i={},s={},l=[];if(a())i=u("posts_seen"),s=u("posts_extras")||{};else for(e in n=b.save()){var d=n[e],f=e.split("_");f[0]=c(f[0]),f[0]&&(f[1]=c(f[1])),i[f[0]]||(i[f[0]]={}),(!i[f[0]][f[1]]||-1==d&&i[f[0]][f[1]]>0)&&(i[f[0]][f[1]]=d)}for(e in i){for(t in n=[],i[e]){var p=i[e][t]>0?t:-t,_=s[e+"_"+t],A=_?(":"+(_.index||"")+":"+(_.block||"")).replace(/:+$/,""):"";"block"!==e||cur._pstatbref||(cur._pstatbref=r(o(e+"_"+t),"data-ref")),n.push(p+A)}n.length&&l.push(e+"_"+n.join(","))}return l.length?{seen:i,data:l.join(";")}:""},onSend:function(e){if(!a())return f(b._saved,b._seen);var t,n,i=u("posts_seen")||{},o=u("posts_sent")||{};for(t in e){for(n in e[t])o[t]||(o[t]={}),-1!=o[t][n]&&(o[t][n]=e[t][n]),(i[t]||{})[n]&&delete i[t][n];i[t]&&s(i[t])&&delete i[t]}d("posts_seen",i),d("posts_sent",o),clearTimeout(b._cleanTimer),b._cleanTimer=setTimeout(b.clean,1e4)},send:function(){var e=window.cur,t=window.vk,n=b.getSeenData();if(n.data){if(!t.id)return b.clear();var i="";e&&e.module?i=e.module:w&&"/feed"==w.cur?i="feed":!w||"/feed?section=podcasts"!==w.cur&&"/feed/podcasts"!==w.cur||(i="feed_podcasts");var o={_ajax:1,act:"ping",_pstat:n.data,_pstatref:i};e._pstatbref&&(o._pstatbref=e._pstatbref),y.post("/",o,{onDone:function(){b.onSend(n.seen)}}),delete e._pstatbref}},clean:function(){var e,t,n,i=window.vk,o=Math.floor((i.ts+Math.floor((l()-i.started)/1e3))/3600),r=u("posts_sent")||{};for(e in r){for(t in r[e])o-((n=r[e][t])>0?n:-n)>24&&delete r[e][t];s(r[e])&&delete r[e]}d("posts_sent",r),b.cleanAdsEvents()},clear:function(){d("posts_seen",{}),d("posts_sent",b._saved=b._seen={}),d(b.LS_ADS_EVENTS,b._lsAdsEvents={})},getStatsObj:function(e){return e=o(e),p("_stats_cont",e)?e:_("_stats_cont",e)},getAdsEvents:function(){var e=b._lsAdsEvents;return e||(e=b._lsAdsEvents=u(b.LS_ADS_EVENTS)||{}),e},cleanAdsEvents:function(){var e=b.getAdsEvents(),t=(new Date).getTime()/1e3|0,n=!1;A(e,function(i,o){t-o>=3600&&(delete e[i],n=!0)}),n&&d(b.LS_ADS_EVENTS,e)},checkPixelEvent:function(e,t){var n=e.getAttribute("data-ad-block-uid"),i=-1!==indexOf(["load","impression"],t);if(!n||!i)return!0;try{var o=g(""+t+n),r=b.getAdsEvents();if(r[o])return!1;var a=(new Date).getTime()/1e3|0;r[o]=a,d(b.LS_ADS_EVENTS,r)}catch(e){try{console.log(e.message)}catch(e){}}return!0},getPixelElements:function(e,t){var n=[];return A(m(t,e),function(){r(this,"data-src")&&n.push(this)}),n},sendPixels:function(e){A(e,function(){r(this,"src",r(this,"data-src")),r(this,"data-src",!1),h("_cntr",this)})},viewed:function(e){if(e=b.getStatsObj(e)){var t=b.getPixelElements(e,"_cntr_view");t.length&&b.checkPixelEvent(e,"impression")&&b.sendPixels(t)}},clicked:function(e){if(e=b.getStatsObj(e)){r(e,"data-clicked","1");var t=b.getPixelElements(e,"_cntr_click");t.length&&b.sendPixels(t),v()}}};b._sendTimer||(b._sendTimer=setTimeout(b.send,1e4)),window.pStats=b},function(e,t,n){"use strict";String.prototype.includes||(String.prototype.includes=function(e,t){return"number"!=typeof t&&(t=0),!(t+e.length>this.length)&&-1!==this.indexOf(e,t)})},function(e,t,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=window.extend,r={_def_opts:{enableHighAccuracy:!0,maximumAge:3e5,timeout:6e4},_provider:null,initW3C:function(){r._provider=navigator.geolocation,r.getCurrentPosition=function(e,t,n){r._provider.getCurrentPosition(function(t){void 0!==t.latitude?e(o(t,{coords:o(t.coords||{},{latitude:t.latitude,longitude:t.longitude})})):e(t)},t,n)}},initGears:function(){var e=window.google;r._provider=e.gears.factory.create("beta.geolocation")},initSymbian:function(){var e=window.device;r._provider=e.getServiceObject("Service.Location","ILocation"),r.getCurrentPosition=function(e,t){r._provider.ILocation.GetLocation({LocationInformationClass:"BasicLocationInformation"},function(n,i,o){4==i?t({code:2,message:"Position unavailable"}):e({timestamp:null,coords:{latitude:o.ReturnValue.Latitude,longitude:o.ReturnValue.Longitude,altitude:o.ReturnValue.Altitude,heading:o.ReturnValue.Heading}})})}},initPalm:function(){r.getCurrentPosition=function(e,t,n){var i={};n&&(n.enableHighAccuracy&&1==n.enableHighAccuracy&&(i.accuracy=1),n.maximumAge&&(i.maximumAge=n.maximumAge),n.responseTime&&(n.responseTime<5?i.responseTime=1:n.responseTime<20?i.responseTime=2:i.timeout=3)),new window.Mojo.Service.Request("palm://com.palm.location",{method:"getCurrentPosition",parameters:i,onSuccess:function(t){e({timestamp:t.timestamp,coords:{latitude:t.latitude,longitude:t.longitude,heading:t.heading}})},onFailure:function(e){1==e.errorCode?t({code:3,message:"Timeout"}):2==e.errorCode?t({code:2,message:"Position unavailable"}):t({code:0,message:"Unknown Error: webOS-code"+e.errorCode})}})}},getCurrentPosition:function(e,t,n){r._provider.getCurrentPosition(e,t,o(r._def_opts,n||{}))},init:function(){var e=window,t=e.google,n=e.device,o=e.Mojo;try{var a="undefined";if(i(navigator.geolocation)!==a)r.initW3C();else if(i(window.google)!==a&&i(t.gears)!==a)r.initGears();else if((void 0===n?"undefined":i(n))!==a&&i(n.getServiceObject)!==a)r.initSymbian();else{if((void 0===o?"undefined":i(o))===a||"Mojo.Service.Request"==typeof o.Service.Request)return!1;r.initPalm()}}catch(e){return!1}return!0}};window.geo=r},function(e,t,n){"use strict";var i,o,r,a,s,l,u=n(72),c=(l=u)&&l.__esModule?l:{default:l};function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f=window,p=f.throttle,_=f.onDOMReady,A=f.addEvent,m=f.lsSet,h=f.lsGet,v=f.hasClass,g=(f.clog,f.domCA),y=f.scrollGetY,w=f.getCh,b=f.nav,D=f.page,C=f.getCw,E=f.ajax,S=f.extend;window.FeedAssistanceStats=(d(i={register:at,forceRegister:function(e,t){e[j]=lt(e),e[V]=t,Ue.push(e)},onScroll:p(ct,50),onStartViewElement:(0,c.default)("element"),onEndViewElement:(0,c.default)("element"),onStopTrackElement:(0,c.default)("element"),onViewedElement:(0,c.default)("element"),onBeforePageChange:_t,onPageChanged:At,getElementType:lt,registerElements:ot,registerTrackingCls:function(e){tt.push(e)},unregisterTrackingCls:it},"unregisterTrackingCls",it),d(i,"setParenViewableX",function(e,t){e[J]=t}),d(i,"forceProcessTrack",st),d(i,"dispatchElementEvent",function(e,t){var n=function(e){return Le[e]}(jt(t[j]||lt(t),e));vt({type:e,data:n(t)})}),d(i,"dispatchEvent",function(e){vt(e)}),d(i,"serializeEventData",ut),d(i,"clearElemsCache",function(){Ue.forEach(function(e){e[q]=!1,e[W]=!1})}),d(i,"_debug",function(){return{started:ze,tracking:Ue,events:et,blindTop:We,blindBottom:Ye}}),d(i,"getFromRef",Yt),d(i,"getRoot",Gt),d(i,"BLOCKS",{}),d(i,"EVENTS",{}),i);var k=.5,M=.25,T=500,x=3e5,I=2500,P=1e4,B=6e3,F=2e4,L=3e4,O=5e3,N=36e4,R=100,j="_feedAssistanceStatsType",H="_feedAssistanceStatsIdled",V="_feedAssistanceStatsModule",$="_feedAssistanceStatsStarted",U="_feedAssistanceStatsProcessed",z="_feedAssistanceStatsEventTs",q="_feedAssistanceStatsCachedY",W="_feedAssistanceStatsCachedX",Y="_feedAssistanceStatsLeft",G="_feedAssistanceStatsHeight",X="_feedAssistanceStatsWidth",Q="_feedAssistanceStatsTop",K="_feedAssistanceStatsBottom",J="_feedAssistanceStatsParentViewableX",Z="BLOCK_TYPE_RECOMMENDED_SLIDER",ee="BLOCK_TYPE_RECOMMENDED_CARD",te="BLOCK_TYPE_DEFAULT",ne="BLOCK_TYPE_EXPLORE_BAIT",ie="BLOCK_TYPE_PROFILE_PHOTO",oe="BLOCK_TYPE_PROMO_BUTTON",re="BLOCK_TYPE_IMPORT_CONTACTS",ae="BLOCK_TYPE_PUSH_SWITCH",se="view_block",le="show_user_rec",ue="open_user",ce="add_friend",de="explore_bait",fe="feed_assistance",pe="hide",_e="promo_button",Ae="SUB_EXPLORE_BAIT",me="view",he="like",ve="comment",ye="opened",we="subscribe",be="unsubscribe",De="open_user",Ce="open_group",Ee="hide",Se="report",ke="seen",Me="filled",Te="enable_push",xe="decline_push",Ie="SUB_PROMO_BUTTON",Pe="clicked",Be=(d(o={},Z,se),d(o,oe,se),d(o,ee,le),d(o,ne,de),d(o,ie,fe),d(o,re,fe),d(o,ae,fe),o),Fe=(d(r={},Z,500),d(r,ee,500),d(r,ne,T),d(r,ie,T),d(r,re,T),d(r,ae,T),r),Le=(d(a={},jt(Z,se),function(e){var t=v("goodAuthorsSlider",Gt(e))?"authors_rec":"user_rec";return ut(se,t,e)}),d(a,jt(oe,se),function(e){var t=geByClass1("feedAssistancePromoButtonInstallApp__button",e)?"promo_install_app":"promo_button";return ut(se,t,e)}),d(a,jt(ee,le),function(e){return ut(le,e)}),d(a,jt(ee,ue),function(e){return ut("click_recommended_friends_slider",e,v("goodAuthorsSlider",Gt(e))?"authors_rec":"user_rec")}),d(a,jt(ne,de),function(){return ut(Ae,me)}),d(a,jt(ie,fe),function(e){return ut(fe,e,"m_ph",ke)}),d(a,jt(re,fe),function(e){return ut(fe,e,"m_mp",ke)}),d(a,jt(ae,fe),function(e){return ut(fe,e,"m_push_switch",ke)}),a),Oe=(d(s={},"click_recommended_friends_slider",function(e,t){return[Qt(e),Date.now(),t].join("|")}),d(s,le,function(e){var t=Qt(e),n=v("goodAuthorsSlider",Gt(e))?"authors_rec":"user_rec",i=Yt(e);return[t,Xt(e),domChildIndex(e),i,n].join("|")}),d(s,se,function(e,t){return[e,domChildIndex(t),Xt(t),Yt(t)].join("|")}),d(s,Ae,function(e){return e}),d(s,fe,function(e,t,n){return[t,n,Yt(e)].join("|")}),d(s,pe,function(e,t){return[e,Xt(t),domChildIndex(t),Yt(t)].join("|")}),d(s,Ie,function(e,t,n){return[domChildIndex(e),t,n||""].join("|")}),s),Ne="feed_other",Re="feedAssistance",je="feedAssistanceStat.events",He="feedAssistanceStat.idled",Ve="/feed",$e="assistance_stats",Ue=[],ze=[],qe=Date.now(),We=0,Ye=0,Ge=!1,Xe=null,Qe=null,Ke=null,Je=null,Ze=null,et=[],tt=[],nt=!1;function it(e){$t(tt,e)}function ot(){var e=[];each(tt,function(){e=e.concat(geByClass(this))}),each(e,function(){at(this,"feed")})}function rt(){ot();var e=Lt();e.length&&(It(e),Ot()),st(),Ct()}function at(e,t){!e[j]&&function(e){return!~Ue.indexOf(e)}(e)&&(e[j]=lt(e),e[V]=t,Ue.push(e))}function st(){mt(y(),w())}function lt(e){return e[j]?e[j]:v("feedAssistance_recommendedFriends",e)?Z:v("prettyCard_friend",e)?ee:v("prettyCard__photo",e)?ee:v("prettyCard__bodyLink",e)?ee:v("post_exploreBait",e)?ne:v("feedAssistance_profilePhoto",e)?ie:v("feedAssistance_promoButton",e)?oe:v("feedAssistance_importContacts",e)?re:v("feedAssistance_pushNotificationsSwitch",e)?ae:te}function ut(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return Oe[e].apply(Oe,n)}function ct(e,t){var n,i=ct;mt(e||y(),t||w()),Ge||nt?(clearTimeout(i.timer),i.timer=setTimeout(dt,150),nt=!1):(Ge=!0,Dt(),n=ge("vk_head"),We=n&&n.offsetHeight,Ye=0)}function dt(){Dt(),bt(),Ge=!1}function ft(){Dt(),Wt(ze),It(et.concat(Rt(ze))),zt(ze),et=[],ze=[],Et()}function pt(){ze.forEach(function(e){e[$]=Date.now()}),Pt(null),Bt(null),bt(),Et(),Ct()}function _t(){Dt(),Wt(ze),et=et.concat(Rt(ze)),zt(ze),ze=[],nt=!0,bt()}function At(){ot(),st()}function mt(e,t){var n=[];Ue.forEach(function(i){Vt(i)?n.push(i):!function(e,t,n){return!e[$]&&yt(e,k,t,n)&&wt(e,k)}(i,e,t)?!function(e,t,n){return e[$]&&(!yt(e,M,t,n)||!wt(e,M))}(i,e,t)?gt(i)&&(ht(i),FeedAssistanceStats.onViewedElement(i)):(i[H]?delete i[H]:(ht(i),FeedAssistanceStats.onEndViewElement(i)),delete i[$]):(i[$]=Date.now(),ze.push(i),FeedAssistanceStats.onStartViewElement(i))}),n.forEach(function(e){$t(Ue,e),FeedAssistanceStats.onStopTrackElement(e)})}function ht(e){$t(ze,e),qt(e),vt(Ht(e)),Ut(e)}function vt(e){e&&et.push(e)}function gt(e){return!!e[$]&&Math.min(x,Date.now()-e[$])>function(e){var t=lt(e);return Fe[t]||T}(e)}function yt(e,t,n,i){if(!e)return!1;e[q]||(e[q]=!0,e[G]=e.offsetHeight,e[Q]=n+e.getBoundingClientRect().top,e[K]=e[Q]+e[G]);var o=i-We-Ye,r=n+We,a=n+i-Ye,s=e[G],l=e[Q],u=e[K];return(u>r&&l<a?Math.min(a,u)-Math.max(r,l):0)>=Math.min(o*t,s*t)}function wt(e,t){var n=e[J];n&&!n[W]&&~Ue.indexOf(n)&&(n[W]=!0,n[X]=n.clientWidth,n[Y]=n.getBoundingClientRect().left+n.clientLeft),e[W]||(e[W]=!0,e[X]=e.offsetWidth);var i=n?n[X]||n.clientWidth:C(),o=n?n[Y]||n.getBoundingClientRect().left+0:0,r=i+o,a=e[X],s=e.getBoundingClientRect().left,l=a+s,u=a*t,c=a*Math.max(0,1-t);return s+u>=o&&l-c<=r}function bt(){Xe=setTimeout(St,I),Qe=setTimeout(kt,P),Ke=setTimeout(Mt,B),Je=setTimeout(Tt,F)}function Dt(){clearTimeout(Xe),clearTimeout(Qe),clearTimeout(Ke),clearTimeout(Je)}function Ct(){Ze=setInterval(xt,L)}function Et(){clearInterval(Ze)}function St(){et.length&&Pt(et)}function kt(){It(et),et=[],Pt(null)}function Mt(){ze.length&&(Bt(Rt(ze)),Ke=setTimeout(Mt,O))}function Tt(){clearTimeout(Ke),Wt(ze),It(Rt(ze)),zt(ze),ze.forEach(function(e){e[H]=!0}),ze=[],Bt(null)}function xt(){et.length>=R&&kt()}function It(e){if(e&&e.length){var t={act:$e};t=S(t,(n={},each(e,function(){n[this.type]?n[this.type].push(this.data):n[this.type]=[this.data]}),n)),E.post(Ve,t)}var n}function Pt(e){Ft(je,e)}function Bt(e){Ft(He,e)}function Ft(e,t){var n=h(e)||{};t?n[qe]=t:delete n[qe],m(e,n)}function Lt(){var e=Lt,t=[],n=h(je)||{},i=h(He)||{};return e.iterator||(e.iterator=function(e){return function(n){Nt(n)&&(t=t.concat(e[n]))}}),Object.keys(n).forEach(e.iterator(n)),Object.keys(i).forEach(e.iterator(i)),t}function Ot(){var e=Ot,t=h(je)||{},n=h(He)||{};e.iterator||(e.iterator=function(e){return function(t){Nt(t)&&delete e[t]}}),Object.keys(t).forEach(e.iterator(t)),Object.keys(n).forEach(e.iterator(n)),m(je,t),m(He,n)}function Nt(e){var t=Number(e);return t!==qe&&Date.now()-t>=N}function Rt(e){var t=[];return e.forEach(function(e){var n=Ht(e);n&&t.push(n)}),t}function jt(e,t){return e+"_"+t}function Ht(e){if(Vt(e))return null;if(!gt(e))return null;var t=function(e){return Be[e[j]]}(e);return{type:t,data:function(e,t){return(0,Le[jt(e[j],t)])(e)}(e,t)}}function Vt(e){return e[U]||!document.body.contains(e)}function $t(e,t){var n=e.indexOf(t);n>=0&&e.splice(n,1)}function Ut(e){Vt(e)||gt(e)&&(e[U]=!0)}function zt(e){each(e,function(){Ut(this)})}function qt(e){e[z]=Date.now()}function Wt(e){e.forEach(qt)}function Yt(e){return(e=Gt(e))&&domData(e,"from-ref")||Ne}function Gt(e){return v(e,Re)||(e=g(e,"."+Re)),e}function Xt(e){var t=(new Date).getTime();return e&&(e[z]||e[$])||t}function Qt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"uid";return intval(domData(e,t))}FeedAssistanceStats.BLOCKS={BLOCK_TYPE_RECOMMENDED_SLIDER:Z,BLOCK_TYPE_RECOMMENDED_CARD:ee,BLOCK_TYPE_EXPLORE_BAIT:ne,BLOCK_TYPE_PROFILE_PHOTO:ie,BLOCK_TYPE_PROMO_BUTTON:oe,BLOCK_TYPE_IMPORT_CONTACTS:re},FeedAssistanceStats.EVENTS={EVENT_OPEN_USER:ue,EVENT_VIEW_BLOCK:se,EVENT_VIEW_RECOMMENDED_CARD:le,EVENT_ACCEPT_FRIEND:ce,EVENT_EXPLORE_BAIT:de,EVENT_EXPLORE_BAIT_SUB:Ae,EVENT_FEED_ASSISTANCE:fe,SUB_EVENT_EXPLORE_BAIT_VIEW:me,SUB_EVENT_EXPLORE_BAIT_LIKE:he,SUB_EVENT_EXPLORE_BAIT_COMMENT:ve,SUB_EVENT_EXPLORE_BAIT_OPENED:ye,SUB_EVENT_EXPLORE_BAIT_SUBSCRIBE:we,SUB_EVENT_EXPLORE_BAIT_UNSUBSCRIBE:be,SUB_EVENT_EXPLORE_BAIT_OPEN_USER:De,SUB_EVENT_EXPLORE_BAIT_OPEN_GROUP:Ce,SUB_EVENT_EXPLORE_BAIT_HIDE:Ee,SUB_EVENT_EXPLORE_BAIT_REPORT:Se,SUB_EVENT_SEEN:ke,SUB_EVENT_FILLED:Me,EVENT_HIDE_BLOCK:pe,SUB_EVENT_ENABLE_PUSH:Te,SUB_EVENT_DECLINE_PUSH:xe,EVENT_PROMO_BUTTON:_e,EVENT_PROMO_BUTTON_SUB:Ie,SUB_EVENT_PROMO_BUTTON_CLICK:Pe},A(window,"blur",ft),A(window,"focus",pt),_(function(){setTimeout(rt,500)}),A(window,"scroll",function(){var e=y(),t=w();ct(e,t)}),b.onBeforeGo(function(){return _t()}),D.onChange(function(){return At()})},function(e,t,n){"use strict";String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")})},function(e,t,n){"use strict";var i,o=n(72),r=(i=o)&&i.__esModule?i:{default:i};var a=window,s=a.ge,l=a.each,u=a.geByTag,c=a.intval,d=a.gpeByClass,f=a.geByTag1,p=a.attr,_=a.val,A=a.geByClass,m=a.isUndefined,h=a.geByClass1,v=a.toggle,g=a.isVisible,y=a.toggleClass,w=a.show,b=a.cancelEvent,D=a.ce,C=a.setStyle,E=a.parseJSON,S=a.replace,k=a.reflow,M=a.after,T=a.addClass,x=a.clog,I=a.uploadFile,P=a.bind,B=a.readFile,F=a.append,L=a.before,O=a.srand,N=a.extend,R=a.canUploadFile,j=a.gpeByTag,H=a.submitBtn,V=a.removeEvent,$=a.addEvent,U=a.clone,z=a.remove,q=window.ajax,W={isUploading:!1,onBeforeRemove:(0,r.default)(),onRemove:(0,r.default)("removeElem"),onStart:(0,r.default)(),onError:(0,r.default)("response"),onComplete:(0,r.default)("response"),_uploadData:{},_uploadQueue:[],_readerQueue:[],_processUploadQueue:!1,_processReaderQueue:!1,fallback:function(e,t){var n=window.post;return e&&n.add_attach(e,t),!1},getLastAttachId:function(){if(!s("attached_wrap"))return 0;var e,t=0;return l(u("input"),function(){if(e=this.name.match(/^attach(\d+)_type$/i)){var n=c(e[1]);t<n&&(t=n)}}),t},refreshAttachIds:function(e){var t=s("attached_wrap");if(t){var n,i=d("mr_x_wrap",e),o=f("input",i),r=c((o&&o.name.match(/^attach(\d+)(_type)?$/i)||[])[1]);if(d("mr_timer",e)){var a=p("add_post_btn","data-value");a&&_("add_post_btn",a)}else r&&l(u("input",t),function(){if(n=this.name.match(/^attach(\d+)(_type)?$/i)){var e=c(n[1]);e==r?this.disabled=!0:e>r&&(this.name="attach"+(e-1)+(n[2]||""))}})}},getAttachesCount:function(){return(A("mr_x_wrap","attached_wrap")||[]).length},refreshUploadState:function(e){m(e)&&(e=W.getAttachesCount());var t=h("mr_timer","attached_wrap"),n=s("attach_photo_btn"),i=h("pi_medias","attached_wrap"),o=h("inline_upload",n),r=p(o,"data-max-attaches")||10;v(i,e>0||g(t)),y("cp_attach_btn_sel",n,e>0),o&&(o.disabled=e>=r),w("attached_options"),w("attached_flush")},checkUploading:function(e){return!W._processUploadQueue||b(e)},attachedPhotoTpl:function(e){return D("div",{id:"upload_item_"+e,className:"medias_thumb thumb_item mr_x_wrap thumb_upload",innerHTML:'<div id="upload_image_'+e+'" class="tu_img"></div><div id="item_progress_wrap_'+e+'" class="tu_progress_wrap"><div id="item_progress_'+e+'" class="tu_progress"></div></div><div id="item_cancel_wrap_'+e+'" class="tu_cancel_wrap" onclick="return mediaUpload.reset(this, event, \''+e+'\');"><div id="item_cancel_'+e+'" class="tu_cancel"></div></div>'})},onUploadProgress:function(e){var t=s("item_progress_"+this.id);C(t,{width:e.loaded/e.total*100+"%",visibility:"visible"})},onUploadComplete:function(e){var t=this,n=e.target.responseText,i=!1;try{i=E(n)}catch(e){i={error:"ERR_CLIENT_BAD_RESPONSE: bad request response"}}i.error?W.onUploadError.call(t,e):(t.xhr=q.post(t.done_url,{_ajax:1,_query:n},{onDone:function(e){var n=s("item_progress_wrap_"+t.id),i=s("upload_image_"+t.id),o=W.getLastAttachId()+1;if(i)var r=D("img",{id:"upload_image_"+t.id,className:"ph_img",onload:function(){if(S(r,i),t.iw&&t.ih){if(t.iw>t.ih==r.width>r.height)var e=Math.min(130,Math.floor(75/t.ih*t.iw));else e=Math.min(130,Math.floor(75/t.iw*t.ih));C(r,"width",e)}k(r),C(r,"opacity",1)},src:e.src});M(D("input",{type:"hidden",name:"attach"+o,value:e.photo_raw}),i),M(D("input",{type:"hidden",name:"attach"+o+"_type",value:"photo"}),i),C(n,"opacity",0),t.attached=!0,t.delete_url=e.delete_url,W._processUploadQueue||(W.isUploading=!1,W.onComplete(e))}}),T("tu_progress_request","item_progress_wrap_"+t.id),t.uploaded=!0,W.uploadQueueNext())},onUploadError:function(e){x("upload error.",e.target.responseText),W.uploadQueueNext(),W.onError(e.target.responseText)},uploadFile:function(e){e.xhr=I(e.upload_url,{photo:e.file},{onProgress:P(W.onUploadProgress,e),onComplete:P(W.onUploadComplete,e),onError:P(W.onUploadError,e)})},readFile:function(e){B(e.file,function(t){var n=s("upload_image_"+e.id);if(n)var i=D("img",{id:"upload_image_"+e.id,className:"ph_img",onload:function(){S(i,n),e.iw=i.width,e.ih=i.height},src:t});W.readerQueueNext()})},addFile:function(e){var t=s("attached_wrap"),n=h("pi_medias",t),i=n?A("medias_thumb",n):[],o=n?h("medias_row",n):null,r=i[i.length-1],a=W.attachedPhotoTpl(e.id);t&&(n||(n=D("div",{className:"pi_medias"}),F(n,t)),r?M(a,r):o?L(a,o):F(a,n),W._processReaderQueue||W.readerQueueNext())},uploadQueueNext:function(){x("next upload"),W._processUploadQueue=!0;var e=W.uploadQueueRemove();if(!e)return x("empty upload"),void(W._processUploadQueue=!1);W.uploadFile(e)},readerQueueNext:function(){x("next reader"),W._processReaderQueue=!0;var e=W.readerQueueRemove();if(!e)return x("empty reader"),void(W._processReaderQueue=!1);W.readFile(e)},queueInsert:function(e){var t=O();return W.getUploadDataById(t)?W.queueInsert(e):(W._uploadData[t]=N(e,{id:t}),W._uploadQueue.push(t),W._readerQueue.push(t),W._uploadData[t])},uploadQueueRemove:function(){var e=W._uploadQueue.shift();return!!e&&W.getUploadDataById(e)},readerQueueRemove:function(){var e=W._readerQueue.shift();return!!e&&W.getUploadDataById(e)},getUploadDataById:function(e){return W._uploadData[e]||!1},delUploadDataById:function(e){delete W._uploadData[e]},start:function(e,t){if(!e||!R())return W.fallback(e,t);var n=e.files,i=e.form||j("form",e),o=H(i),r=s("attach_photo_btn"),a=p(e,"data-upload-url"),u=p(e,"data-done-url"),c=p(e,"data-max-attaches")||10,d=W.getAttachesCount();return a&&u?(l(n,function(){var e={upload_url:a,done_url:u,file:this,uploaded:!1,attached:!1};if(d>=c)return!1;W.queueInsert(e),W.addFile(e),d++}),V(i,"submit",W.checkUploading),$(i,"submit",W.checkUploading),V(o,"click",W.checkUploading),$(o,"click",W.checkUploading),V(r,"click",W.checkUploading),$(r,"click",W.checkUploading),W.refreshUploadState(d),S(U(e),e),W._processUploadQueue||W.uploadQueueNext(),window.isNewMail&&W.onStart(),W.isUploading=!0,!1):W.fallback(e,t)},reset:function(e,t,n){if(b(t),window.isNewMail&&W.onBeforeRemove(e),"/"==n[0]){q.post(n,{_ajax:1}),W.refreshAttachIds(e);var i=d("mr_x_wrap",e)||d("mr_timer",e);z(i)}else{var o=n,r=W.getUploadDataById(o);if(!r)return!1;r.attached?r.delete_url&&(q.post(r.delete_url,{_ajax:1}),W.refreshAttachIds(e)):(r.xhr&&r.xhr.abort&&r.xhr.abort(),r.loaded||W.uploadQueueNext()),z("upload_item_"+o),W.delUploadDataById(o)}return W.refreshUploadState(),window.isNewMail&&W.onRemove(e),!1}};window.mediaUpload=W},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=l(['\n      <a class="','" href=',' target="','" ',">\n        ","\n      </a>\n    "],['\n      <a class="','" href=',' target="','" ',">\n        ","\n      </a>\n    "]),r=l(['\n    <button type="','" class="','" ',">\n      ","\n    </button>\n  "],['\n    <button type="','" class="','" ',">\n      ","\n    </button>\n  "]),a=n(77),s=(i=a)&&i.__esModule?i:{default:i};function l(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}t.default=function(e){var t=e.class?" "+e.class:"";if(t="MailButton"+t,"link"===e.type&&e.link){var n=e.link.href,i=e.link.target||"_blank";return s.default.html(o,t,n,i,e.onClick,e.text)}var a=e.type;"button"===a&&"submit"===a||(a="button");return s.default.html(r,a,t,e.onClick,e.text)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=t.SECOND=1e3,o=t.MINUTE=60*i,r=t.HOUR=60*o;t.DAY=24*r,t.PUSH_NOTIFIER_PERMISSION_GRANTED="granted",t.PUSH_NOTIFIER_PERMISSION_DEFAULT="default",t.PUSH_NOTIFIER_PERMISSION_DENIED="denied"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(39),r=(i=o)&&i.__esModule?i:{default:i};n(291),t.default=r.default,window.MailFilter=r.default},function(e,t,n){"use strict";(function(e){var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=setTimeout;function i(){}function o(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,u._immediateFn(function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var i;try{i=n(e._value)}catch(e){return void a(t.promise,e)}r(t.promise,i)}else(1===e._state?r:a)(t.promise,e._value)})):e._deferreds.push(t)}function r(e,n){try{if(n===e)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"===(void 0===n?"undefined":t(n))||"function"==typeof n)){var i=n.then;if(n instanceof u)return e._state=3,e._value=n,void s(e);if("function"==typeof i)return void l((o=i,r=n,function(){o.apply(r,arguments)}),e)}e._state=1,e._value=n,s(e)}catch(t){a(e,t)}var o,r}function a(e,t){e._state=2,e._value=t,s(e)}function s(e){2===e._state&&0===e._deferreds.length&&u._immediateFn(function(){e._handled||u._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)o(e,e._deferreds[t]);e._deferreds=null}function l(e,t){var n=!1;try{e(function(e){n||(n=!0,r(t,e))},function(e){n||(n=!0,a(t,e))})}catch(e){if(n)return;n=!0,a(t,e)}}function u(e){if(!(this instanceof u))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(e,this)}var c=u.prototype;c.catch=function(e){return this.then(null,e)},c.then=function(e,t){var n=new this.constructor(i);return o(this,new function(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}(e,t,n)),n},u.all=function(e){return new u(function(n,i){if(!e||void 0===e.length)throw new TypeError("Promise.all accepts an array");var o=Array.prototype.slice.call(e);if(0===o.length)return n([]);var r=o.length;function a(e,s){try{if(s&&("object"===(void 0===s?"undefined":t(s))||"function"==typeof s)){var l=s.then;if("function"==typeof l)return void l.call(s,function(t){a(e,t)},i)}o[e]=s,0==--r&&n(o)}catch(e){i(e)}}for(var s=0;s<o.length;s++)a(s,o[s])})},u.resolve=function(e){return e&&"object"===(void 0===e?"undefined":t(e))&&e.constructor===u?e:new u(function(t){t(e)})},u.reject=function(e){return new u(function(t,n){n(e)})},u.race=function(e){return new u(function(t,n){for(var i=0,o=e.length;i<o;i++)e[i].then(t,n)})},u._immediateFn="function"==typeof e&&function(t){e(t)}||function(e){n(e,0)},u._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},window.Promise||(window.Promise=u)}).call(this,n(240).setImmediate)},function(e,t,n){"use strict";var i=window.hide;window.Informer={close:function(e){i(e)}}},function(e,t,n){"use strict";var i=n(322),o=(need("attr"),need("geByClass1"),need("preventEvent")),r=need("Popup");window.SendMoneyForm={},SendMoneyForm._onAmountChange=f,SendMoneyForm._onSubmit=m,SendMoneyForm._onRecommAmountChange=p,SendMoneyForm._onAutoAcceptToggle=h,SendMoneyForm._onNoAmountToggle=v,SendMoneyForm._onChooseCardClick=d,SendMoneyForm._onChooseCardCancelClick=c,SendMoneyForm._onChooseCardContinueClick=l,SendMoneyForm._onCardSelect=u;var a={form:"sendMoneyForm",errorMin:"sendMoneyForm_error_min",errorMax:"sendMoneyForm_error_max",addCardVisible:"sendMoneyForm_addCardVisible",recommErrorMin:"sendMoneyForm_recommErrorMin",recommErrorMax:"sendMoneyForm_recommErrorMax",noAmount:"sendMoneyForm_noAmount",autoAccept:"sendMoneyForm_autoAccept"},s={form:".sendMoneyForm",cardsPopup:".sendMoneyForm__cardsPopup",amountInput:".sendMoneyForm__input_amount",recommInput:".sendMoneyForm__recommAmountInput input"};function l(){var e=(0,i.$)('.Control__native[name="card"]:checked').value,t=(0,i.$)('.Control__native[name="card"]:checked ~ .Control__label').innerText;(0,i.$)('input[name="accept_card"]').value=e,(0,i.$)('input[name="accept_card"]').setAttribute("data-value",e),(0,i.$)(".sendMoneyForm__chooseCard").innerText=t,r.close()}function u(e){var t="-1"===e.value;(0,i.$)(s.form).classList.toggle(a.addCardVisible,t)}function c(){r.close()}function d(){var e=(0,i.$)(s.cardsPopup);r.open(e)}function f(e){_(e),A(e,6);var t=e.closest(s.form),n="1"===t.getAttribute("data-is-chat-request"),o=Number(e.value),r=Number(t.getAttribute("data-max-amount"));if(t.classList.remove(a.errorMin),t.classList.remove(a.errorMax),n||o>r&&t.classList.add(a.errorMax),n){var l=Number(t.getAttribute("data-min-amount")),u=Number(t.getAttribute("data-chat-members-count")),c=Math.ceil(o/u),d=Math.min(r,Math.max(l,c));(0,i.$)(s.recommInput).value=d,t.classList.remove(a.recommErrorMax),t.classList.remove(a.recommErrorMin)}}function p(e){_(e),A(e,6);var t=e.closest(s.form),n=Number(e.value),i=t.getAttribute("data-max-amount");t.classList.remove(a.recommErrorMax),t.classList.remove(a.recommErrorMin),n>i&&t.classList.add(a.recommErrorMax)}function _(e){e.value=parseInt(e.value,10)||""}function A(e,t){e.value=e.value.slice(0,t)}function m(e,t){var n,r=t.$(s.amountInput).value,l=Number(r),u=Number(t.getAttribute("data-min-amount")),c=Number(t.getAttribute("data-max-amount")),d="1"===t.getAttribute("data-is-chat-request"),f=!1;if(t.classList.remove(a.errorMin),t.classList.remove(a.errorMax),d&&(t.classList.remove(a.recommErrorMax),t.classList.remove(a.recommErrorMin)),(n=(0,i.$)('input[name="no_amount"]'))&&n.checked||(l<u||!r||r!==l.toString()?(t.classList.add(a.errorMin),f=!0):l>c&&!d&&(t.classList.add(a.errorMax),f=!0)),d){var p=t.$(s.recommInput).value,_=Number(p);_<u||!p||p!==_.toString()?(t.classList.add(a.recommErrorMin),f=!0):_>c&&(t.classList.add(a.recommErrorMax),f=!0)}if(f)o(e),stopEvent(e);else{o(e),stopEvent(e),t.insertAdjacentHTML("beforeend",'<input id="submit" type="submit" style="display: none" />');var A=(0,i.$)("#submit");ajax.click(A)}}function h(e){(0,i.$)(s.form).classList.toggle(a.autoAccept,e.checked),e.checked?(0,i.$)('input[name="accept_card"]').value=(0,i.$)('input[name="accept_card"]').getAttribute("data-value"):(0,i.$)('input[name="accept_card"]').value=""}function v(e){(0,i.$)(s.form).classList.toggle(a.noAmount,e.checked)}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(83),r=(i=o)&&i.__esModule?i:{default:i},a=n(1);var s=["/restore","/login","/join","/","/settings","/album*","/terms","/privacy","/payments*","/attachments*,","/pages*"],l=void 0;function u(){l&&l.classList.remove(r.default.class.open)}function c(){l&&l.classList.add(r.default.class.open)}onDOMReady(function(){!function e(t){var n,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(0,a.isIosWebView)()||(0,a.isAndroidWebView)()||(0,a.isVkWebView)()||(i||(l=geByClass1(r.default.class.btn),page.onChange(e.bind(this))),t=t?t.split("?")[0]:nav.path,!/^\/photo/.test(t)&&u(),n=t,s.find(function(e){return"*"===n[n.length-1]?e.startsWith(n.slice(0,n.length-1)):n===e})||nav.getQuery("z")?u():c())}(null,!1)}),t.default={_onCloseClick:function(e){r.default._onCloseClick(e),setCookie("remixregbtn",0,0)},show:c,hide:u}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uMessenger_hasSelectedMsgs=t.uMessenger_renderMRsHint=t.uMessenger_getPinnedMsg=t.uMessenger_getBanner=t.uMessenger_class=t.Messenger_renderLoadingPage=t.Messenger_renderConvoLayer=t.Messenger=void 0;var i=E(['\n    <div class="','">\n      <div class="messenger__layer messenger__layer_main">\n        <div class="messenger__header">',"</div>\n        ",'\n      </div>\n      <div class="messenger__layer messenger__layer_convo">\n        ','\n      </div>\n      <div class="messenger__layer messenger__layer_page">',"</div>\n    </div>\n  "],['\n    <div class="','">\n      <div class="messenger__layer messenger__layer_main">\n        <div class="messenger__header">',"</div>\n        ",'\n      </div>\n      <div class="messenger__layer messenger__layer_convo">\n        ','\n      </div>\n      <div class="messenger__layer messenger__layer_page">',"</div>\n    </div>\n  "]),o=E(['\n    <div class="messenger__header">\n      ','\n      <div class="','">','</div>\n      <div class="messenger__pinned">',"</div>\n    </div>\n    ",'\n    <div class="','">\n      <div class="messenger__mrbox">','</div>\n      <div class="messenger__write">','</div>\n      <div class="messenger__acts">','</div>\n    </div>\n    <div class="messenger__dialog"></div>\n  '],['\n    <div class="messenger__header">\n      ','\n      <div class="','">','</div>\n      <div class="messenger__pinned">',"</div>\n    </div>\n    ",'\n    <div class="','">\n      <div class="messenger__mrbox">','</div>\n      <div class="messenger__write">','</div>\n      <div class="messenger__acts">','</div>\n    </div>\n    <div class="messenger__dialog"></div>\n  ']),r=E(['\n    <div class="messenger__convoListNotice">\n      ',"\n    </div>\n  "],['\n    <div class="messenger__convoListNotice">\n      ',"\n    </div>\n  "]),a=E(['\n    <div class="messenger__header">\n      ',"\n    </div>\n    ","\n  "],['\n    <div class="messenger__header">\n      ',"\n    </div>\n    ","\n  "]),s=E(['\n    <div class="messenger__spinner">\n      ',"\n    </div>\n  "],['\n    <div class="messenger__spinner">\n      ',"\n    </div>\n  "]),l=E(['\n      <div class="messenger__banner_icon">\n        <img class="messenger__banner_icon_img" src="','">\n      </div>\n    '],['\n      <div class="messenger__banner_icon">\n        <img class="messenger__banner_icon_img" src="','">\n      </div>\n    ']),u=E(["\n    ",'\n    <div class="messenger__banner_content">\n      <div class="messenger__banner_text" ',">\n        ",'\n      </div>\n      <div class="messenger__banner_buttons">\n        ',"\n      </div>\n    </div>\n    ","\n  "],["\n    ",'\n    <div class="messenger__banner_content">\n      <div class="messenger__banner_text" ',">\n        ",'\n      </div>\n      <div class="messenger__banner_buttons">\n        ',"\n      </div>\n    </div>\n    ","\n  "]),c=E(['\n    <a href="/mail?act=mrs" class="messenger__mrsHintBox">\n      ',"\n    </a>\n  "],['\n    <a href="/mail?act=mrs" class="messenger__mrsHintBox">\n      ',"\n    </a>\n  "]),d=D(n(77)),f=D(n(131)),p=(D(n(355)),D(n(164))),_=D(n(309)),A=D(n(184)),m=D(n(9)),h=D(n(163)),v=D(n(33)),g=D(n(113)),y=D(n(96)),w=n(235),b=D(n(155));function D(e){return e&&e.__esModule?e:{default:e}}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function S(e){var t=window.lang.mobile_mail_search_only_messages,n=(0,A.default)({query:e.query,createUrl:e.createChatUrl}),o=e.mrs?F(e.mrs):"",r=d.default.onClick("Messenger._onSearchMsgsClick"),a=(0,_.default)({mix:"messenger__body",attrs:d.default.onScroll("Messenger._onMainScroll","this"),inner:[(0,f.default)({mix:"messenger__filter",inner:n}),(0,f.default)({mix:d.default.class("messenger__mrsHint",{hidden:!e.mrs}),inner:o}),(0,f.default)({mix:"messenger__searchMsgs",attrs:r,inner:t}),(0,f.default)({mix:"messenger__loadable",inner:[(0,f.default)({mix:"messenger__folderList",inner:e.scrapFolder}),(0,f.default)({mix:"messenger__searchList",inner:e.scrapSearch}),M()]})]});return d.default.html(i,e.mix,e.mailHat,a,e.convo,e.page)}function k(){var e,t=store.mail,n=t.cur,i=t.peers[n.peerId],a=(0,y.default)(),s=T(),l=x(),u=(0,v.default)(),c=i&&i.canPin,p=(0,g.default)({canPin:c,isChannel:i.isChannel}),A=(0,m.default)({scrap:"peer"}),h=i.isIncomingMR?(0,b.default)(n.peerId):"",w=i.isRejectedMR?(e=window.lang,d.default.html(r,e.mobile_mail_mrs_rejected_info)):"",D=(0,_.default)({mix:"messenger__body",attrs:d.default.onScroll("Messenger._onConvoScroll","this"),inner:[(0,f.default)({mix:"messenger__spacer"}),(0,f.default)({mix:"messenger__convoList",inner:[A,w]}),M()]}),C="messenger__banner";l&&(C+=" messenger__bannerVisible");var E=d.default.class("messenger__footer",{actionsOpen:B(),isIncomingMR:i.isIncomingMR});return d.default.html(o,a,C,l,s,D,E,h,u,p)}function M(){var e=(0,p.default)();return d.default.html(s,e)}function T(){var e=store.mail,t=e.cur.peerId;return t&&e.peers[t].pinnedMsg}function x(){var e=store.mail,t=e.cur.peerId,n=t&&e.peers[t],i=n&&n.banner;if(!i)return"";var o="";i.icon&&(o=d.default.html(l,i.icon));for(var r=i.buttons,a=r.length,s=[],c=0;c<a;c++)s.push(I(r[c]));s=d.default.list(s);var f=(0,h.default)({class:"messenger__banner_close",onClick:d.default.onClick("uMessenger.onBannerButtonClick","event")}),p=d.default.onClick("uMessenger.onBannerTextClick","event");return d.default.html(u,o,p,i.text,s,f)}function I(e){var t=d.default.class("messenger__banner_button",{primary:"secondary"!==e.layout,secondary:"secondary"===e.layout}),n=void 0,i=void 0;return"link"===e.type?n={href:e.link}:"callback"===e.type&&(i=d.default.onClick("uMessenger.onBannerButtonClick","event",e.callback_data)),(0,h.default)({class:t,text:e.text,type:"link"===e.type?"link":"button",link:n,onClick:i})}function P(){var e,t=store.mail.cur,n=void 0;n=t.page?"view_page":t.peerId?"view_dialog":t.query&&"msgs"===t.tab?"view_searchMsgs":t.query?"view_searchPeers":"folder_"+t.folder;var i=t.peerId?store.mail.peers[t.peerId]:null;return d.default.class("e","messenger",{isIncomingMR:!!i&&i.isIncomingMR,isRejectedMR:!!i&&i.isRejectedMR},"uMessenger",(C(e={},n,!0),C(e,"community",!!t.groupId),e))}function B(){var e=store.mail.cur.msgSelected;return Object.keys(e).length>0}function F(e){var t=window.lang,n=langNumeric(e,t.mobile_mail_mrs_request_count);return d.default.html(c,n)}t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=store.mail.cur,n=t.query,i=(0,m.default)({scrap:"folder"}),o=(0,m.default)({scrap:"search"}),r=e.page,a="all"!==t.folder||t.query||t.forwardFromId?0:t.countMR;return S({mix:P(),mailHat:(0,y.default)(),convo:k(),page:r,mrs:a,query:n,createChatUrl:"/mail?act=new_chat",scrapFolder:i,scrapSearch:o})},t.Messenger=S,t.Messenger_renderConvoLayer=k,t.Messenger_renderLoadingPage=function(e){var t=(0,w.MailHat_page)(),n=(0,_.default)({mix:"messenger__body",inner:[M()]});return d.default.html(a,t,n)},t.uMessenger_class=P,t.uMessenger_getBanner=x,t.uMessenger_getPinnedMsg=T,t.uMessenger_renderMRsHint=F,t.uMessenger_hasSelectedMsgs=B},function(e,t,n){"use strict";var i,o=n(342),r=(i=o)&&i.__esModule?i:{default:i};Object.assign(r.default,{class:function(){for(var e=[],t=null,n=arguments.length,i=Array(n),o=0;o<n;o++)i[o]=arguments[o];return i.forEach(function(n){"string"==typeof n?(e.push(n),t=n):n&&(e=e.concat(function(e,t){var n,i,o,r=[];return"string"==typeof t&&(o=!0,(i=t)in(n={})?Object.defineProperty(n,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[i]=o,t=n),Object.keys(t).forEach(function(n){var i=t[n];!0===i?r.push(e+"_"+n):i&&r.push(e+"_"+n+"_"+i)}),r}(t,n)))}),e.join(" ")},parseClass:function(e,t){var n={};return t.trim().split(/\s+/).forEach(function(t){if(t!==e){var i=t.replace(e+"_","").split("_");n[i[0]]=!(i.length>1)||i[1]}}),n}})},function(e,t,n){"use strict";var i=window,o=i.cancelEvent,r=i.gpeByClass,a=i.geByClass1,s=i.toggleClass,l=i.hasClass,u=i.ajax,c=i.attr,d=need("Control"),f=need("Popup"),p={init:function(){var e=a("_adultConfirm"),t=a("_adultConfirm__submit",e),n=a("adultConfirm__checkbox",e);s("adultConfirm__submit_disabled",t,!d.isChecked(n))},toggle:function(e){var t=r("_adultConfirm",e.$control),n=a("_adultConfirm__submit",t);s("adultConfirm__submit_disabled",n,!e.checked)},submit:function(e,t){if(o(e),!l("adultConfirm__submit_disabled",t)){var n=r("_adultConfirm",t),i=a("_adultConfirm__form",n),s={_ajax:1};each(geByTag("input",i),function(e,t){var n=t.type.toLowerCase(),i=t.name.toLowerCase();"hidden"!==n&&"checkbox"!==n&&"radio"!==n||(s[i]=t.value)});var d=c(i,"action");u.post(d,s),f.close()}},back:function(e){o(e),window.history?window.history.back():window.location="/"}};window.AdultConfirm=p},,function(e,t,n){"use strict";var i=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{!i&&s.return&&s.return()}finally{if(o)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=s(n(120)),r=n(215),a=s(r);function s(e){return e&&e.__esModule?e:{default:e}}var l=window,u=l.removeEvent,c=l.addEvent,d=(l.addClass,l.removeClass,l.hasClass),f=l.getCookie,p=l.setCookie,_=l.setDocumentDomain,A=function(){_();var e=window.audioSubscribe,t=L(),n=!1,s=I("remixaudio_show_alert_today"),l=I("remixaudio_show_alert_to_three_month"),A=f("remixaudio_date"),m=!1,h=!1,v=new o.default(6e5,{onEnd:function(){B()}}),g="remixaudio_background_play_time_",y=I(g,1),w=I("remixaudio_background_play_time_limit"),b=w-y==0,D=new o.default(1e3*w,{tick:1e3,onTick:function(e){if(!x||M.hidden){var t=w-Math.round(e/1e3);window.audio.playing()?(D.start(),w===y+t?F():w<y+t?(F(),p(g,w,1)):p(g,y+t,1)):D.pause()}else D.pause()},onEnd:function(){F()}}),C=function(){var e=void 0,t=void 0;if(void 0!==document.hidden)e="hidden",t="visibilitychange";else if(void 0!==document.msHidden)e="msHidden",t="msvisibilitychange";else{if(void 0===document.webkitHidden)return[!1,!1];e="webkitHidden",t="webkitvisibilitychange"}return[e,t]}(),E=i(C,2),S=E[0],k=E[1],M={hidden:!1},T=!1,x=S&&k;if(x)e||c(document,k,function(){document[S]?(D.start(),M.hidden=!0):(D.pause(),M.hidden=!1)});else{T=new o.default(18e4,{tick:1e3,onTick:function(e){},onEnd:function(){n=!0,b?F():D.start()}})}function I(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=parseInt(f(e),10);return isNaN(n,10)?t:n}function P(){var e=geByClass1("audioAttention");e&&s<2&&l<10&&(Popup.open(e,!0),v.start(),p("remixaudio_show_alert_today",++s,1),p("remixaudio_show_alert_to_three_month",++l,1),1===l&&p("remixaudio_show_alert_to_three_month_date",A,93))}function B(e){var t=e.$popup;Popup.close(t),v.stop()}function F(){e||(b=!0,window.audio.pause(),D.pause(),P())}function L(){var e=a.default.opera_mini,t=a.default.opera_mobile,n=a.default.msie_mobile,i=a.default.msie_edge,o=a.default.amigo,r=window.opera|window.opr|navigator.userAgent.indexOf(" OPR/")>-1|navigator.userAgent.indexOf(" Coast/")>-1|navigator.userAgent.indexOf(" OPiOS/")>-1,s=navigator.userAgent.indexOf("OPR/")>-1&&navigator.userAgent.indexOf("Mobile")>-1&&navigator.userAgent.indexOf("Presto/")<0,l=navigator.userAgent.indexOf("Opera Mini/")>-1&&navigator.userAgent.indexOf("Presto/")>-1;return(!r||!d("_hover",document.body))&&(void 0===document.hidden||!!(r||s||l||e||t||n||i||o))}function O(){T&&(D.pause(),n=!1,u(document,r.isTouch?"touchstart":"mousedown scroll",O),T.stop())}function N(){u(document,r.isTouch?"touchstart":"mousedown",N()),h=!0,m=!1}return{badBrowser:t,audioSubscribe:e,isSleep:n,hasTouch:h,backgroundPlayCountdown:D,touchTrack:function(){m&&c(document,r.isTouch?"touchstart":"mousedown",N())},touchUnTrack:N,sleepModeStart:function(){T&&(n||T.isStarted()||(c(document,r.isTouch?"touchstart":"mousedown scroll",O),T.start()))},sleepModePause:O,showPaymentAlert:P,hidePaymentAlert:B,isBadBrowser:L,isVisibilityChange:x,isHidden:function(){return M.hidden}}}();window.AudioSubscribe=A},function(e,t,n){"use strict";var i,o,r,a,s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.keys||(Object.keys=(i=Object.prototype.hasOwnProperty,o=!{toString:null}.propertyIsEnumerable("toString"),a=(r=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(e){if("function"!=typeof e&&("object"!==(void 0===e?"undefined":s(e))||null===e))throw new TypeError("Object.keys called on non-object");var t,n,l=[];for(t in e)i.call(e,t)&&l.push(t);if(o)for(n=0;n<a;n++)i.call(e,r[n])&&l.push(r[n]);return l}))},function(e,t,n){"use strict";var i=s(n(2)),o=s(n(307)),r=n(43),a=s(n(331));function s(e){return e&&e.__esModule?e:{default:e}}var l=window,u=l.toggleClass,c=l.geByClass1,d=l.ajax,f=l.addClass,p=l.removeClass,_=l.domCreate,A=l.geByTag1,m=l.domQuery1,h=l.domQuery,v=l.gpeByClass,g=void 0,y=void 0,w=void 0,b=void 0,D=void 0,C=void 0,E=!1,S=[],k=[],M=20,T=.6,x={InProgress:1,NotAvailable:2},I={},P={},B=void 0;function F(e,t){e=e.split("_");for(var n=0;n<t.length;n++){var i=t[n].split("_");if(i[0]==e[0]&&i[1]==e[1])return n}return-1}function L(){return(document.scrollingElement||window.scrollNode||document.body).scrollTop}function O(){return document}function N(e){return h('.articleView__social_buttons[data-article-id="'+e+'"] .articleView__footer_btn_bookmark')}function R(e){if(C!=e.raw_id)if(C=e.raw_id,y.isWebView)!function(e){i.default.send("articleUpdate",{article:q(e),isSubscribedToOwner:e.is_subscribed_to_owner})}(e);else{var t=c("articleView__owner"),n=A("img",t);t&&n&&(n.src=e.owner_photo);var o=A("a",t);t&&o&&(o.href=e.owner_href);var r=c("articleView__ownerName"),a=A("a",r);r&&a&&(a.href=e.owner_href,a.innerHTML=e.owner_name);var s=c("articleView__footer"),l=c("articleView__footer_views");l&&(l.innerHTML=e.views_formatted);var d=c("articleView__social_buttons",s);s&&d&&d.setAttribute("data-article-id",e.raw_id);var f=[m('.articleView__content_misc_block[data-article-id="'+e.raw_id+'"] .articleView__footer_btn_share'),s&&m(".articleView__footer_btn_share",s)];each(f,function(t,n){n&&(n.href="/like?act=publish&object=article"+e.raw_id+"&list="+e.access_hash)});var p=N(e.raw_id),_=JSON.stringify(e.mailru_stats_data);each(p,function(t,n){n&&(n.setAttribute("onclick","Article.fave(this, '"+e.url+"', '"+e.fave_hash+"', "+_+", '"+e.raw_id+"')"),u(n,"_active",e.is_faved))});var h=c("Unfold__item_name_noted");h&&(h.href="/feed?section=search&q=url:https://vk.com"+e.url);var v=c("Unfold__item_name_report");v&&(v.href="/reports?act=add&object=article"+e.raw_id+"_"+e.access_hash+"&refrom=feed")}}function j(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.has_more||(S=S.concat(e.audios_list));var n=new a.default(e,{notFull:!!y.preloadMoreHash,isWebView:y.isWebView,mobile:!0,width:y.width,getScrollTop:L,getScrollNode:O,trackCode:y.trackCode,onScroll:function(t){if(!e.has_more){var n=k[k.length-1],i=v("articleView__content",n.getEl());t>T&&e.next_article_url&&(k.length<M&&(V(e.next_article_url),f(i,"articleView_waitNextArticle")),function(){var e=k[k.length-1];if(e){var t=v("articleView__content",e.getEl()),n=c("articleView__social_buttons",t);n&&show(n)}}()),t>.99&&e.next_article_url&&k.length<M&&V(e.next_article_url,function(e,t){if(e){for(var n=0;n<k.length;n++)if(k[n].getArticle().raw_id==t.raw_id)return;B||(B=setTimeout(function(){var n=_(e);D.appendChild(n),p(i,"articleView_waitNextArticle"),f(n,"articleView_nextPrepared"),requestAnimationFrame(function(){p(n,"articleView_nextPrepared")}),j(t),B=null},400))}}),this.getScreenVisibilityRatio()>.5&&R(e)}},onImageOpen:function(e,t,n){if(y.isWebView){for(var o=[],r=0;r<e.length;r++){var a=e[r],s=[];for(var l in a)a.hasOwnProperty(l)&&s.push({type:l,src:a[l][0],width:a[l][1],height:a[l][2]});o.push(s)}i.default.send("articlePhotoView",{photos:o,index:n})}}});t||n.ready(),k.push(n),H(e),each(geByTag("video"),function(e,t){domData(t,"auto-pause-inited")||(domData(t,"auto-pause-inited",1),t.addEventListener("play",function(){each(geByTag("video"),function(e,n){n!=t&&n.pause()})}))})}function H(e){var t=v("articleView__content",ge("article_view_"+e.raw_id)),n=c("articleView__ads_block",t);o.default.init(e,n,y)}function V(e,t){var n=P[e];n!==x.NotAvailable?isArray(n)?t&&t(n[0],n[1]):(I[e]=I[e]||[],t&&I[e].push(t),n!=x.InProgress&&(P[e]=x.InProgress,d.post("article.php",{act:"view",url:e,scroll_load:1,wall_owner_id:y.wallOwnerId,audio_bridge:intval(y.audioBridge),can_infinite_scroll:intval(y.canInfiniteScroll),web_view:y.isWebView,context:y.context},{onDone:function(t,n){for(var i=I[e],o=0;o<i.length;o++)i[o](t,n);P[e]=[t,n]}}))):t&&t()}function $(){var e=(0,r.getUrlParam)("anchor");e&&function(){var t=document.getElementById(e);if(t){"scrollRestoration"in history&&(history.scrollRestoration="manual");var n=y.isWebView?0:25,i=t.parentNode.parentNode.offsetTop-n;window.setTimeout(function(){var e;e=i,(document.scrollingElement||window.scrollNode||document.body).scrollTop=e},0)}}()}function U(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(E)$();else{y.deviceInfo=e.deviceInfo;var t=k[0],n=t.getArticle();t.ready(),n.has_more?d.post("article.php",{act:"load_more",rev:n.rev,hash:n.has_more_hash,article_owner_id:n.owner_id,article_id:n.id,audio_bridge:intval(y.audioBridge),no_lazy_images:intval(y.noLazyImages),can_infinite_scroll:intval(y.canInfiniteScroll),wall_owner_id:y.wallOwnerId,context:y.context},{onFail:function(){y.failTries>0&&(y.failTries--,setTimeout(function(){U(e)},2e3))},onDone:function(e,i){E=!0,n.audios_list=i.audios_list,n.next_article_url=i.next_article_url,n.has_more=!1,n.audios_list&&n.audios_list.length&&(S=S.concat(n.audios_list));var o=_(e),a=c("article_view",o),s=c("article_view");"figure"!==s.lastElementChild.tagName.toLowerCase()&&s.lastChild.remove();for(var l=s.children.length,d=a.children;l<d.length;)s.appendChild(d[l]);var f=c("article_preload_spinner");f&&f.parentNode.removeChild(f);var p=c("articleView__content_misc_block",o);s.parentNode.appendChild(p),function(){for(var e=c("article").children,t=0;t<e.length;t++){var n=t>0&&e[t-1],i=e[t],o=t+1<e.length&&e[t+1],a=n?n.tagName+"_"+domData(n,"type"):"",s=i?i.tagName+"_"+domData(i,"type"):"",l=o?o.tagName+"_"+domData(o,"type"):"",d=!1,f=!1,p=!1;a&&s==a||(d=!0),l&&s==l||(f=!0),(r.ResizableObjectTypes.includes(+l.type)||l.sep)&&(p=!0),u(i,"article_decoration_first",d),u(i,"article_decoration_last",f),u(i,"article_decoration_before",p)}}(),H(n),$(),t.update()}}):d.post("article.php",{act:"next_url",access_hash:n.access_hash,article_owner_id:n.owner_id,article_id:n.id,wall_owner_id:y.wallOwnerId,context:y.context},{onDone:function(e){e&&(n.next_article_url=e,t.update())}});var i=t.getEl();e.paddingTop&&setStyle(i,"marginTop",intval(e.paddingTop)),e.paddingBottom&&setStyle(i,"marginBottom",intval(e.paddingBottom)),e.noDarkModeTransition&&f(i,"article_dark_no_transition")}}function z(e){var t=null;return each(k,function(n,i){var o=i.getArticle();if(o.raw_id==e)return t=o,!1}),t}function q(e){var t="https://"+y.devHost+"vk.com"+e.url,n={id:e.id,owner_id:e.owner_id,owner_name:e.owner_name,state:"available",can_report:e.can_report,title:e.title,subtitle:"",views:e.views,shares:e.shares,is_favorite:e.is_faved,url:t,view_url:t,access_key:e.access_hash,published_date:e.published_date};return 0!=e.owner_photo.indexOf("/images/")&&(n.owner_photo=e.owner_photo),n}window.ArticleView=a.default,window.Article={init:function(e,t){if((y=t).mobile=!0,y.failTries=50,window.cur&&(window.cur.lang=window.cur.lang||{},extend(window.cur.lang,t.lang||{})),D=c("articleView__content_list"),!y.isWebView){var n,o=L(),r=c("articleView__header"),a=c("articleView__footer"),s=c("articleView__layout");O().addEventListener("scroll",n=function(){var e=s.clientHeight,t=Math.max(0,L()),n=t-o>0,i=t+window.innerHeight+20>e;u(r,"articleView__header--narrow",n),a&&u(a,"articleView__footer--hidden",!i&&n),o=t},{passive:!0}),window.cur&&cur.destroy.push(function(){document.removeEventListener("scroll",n),p(document.body,"article_body_with_transition")}),y.isStandalone&&(window.al=!1)}if(y.preloadMoreHash||show(c("article_layer_prev_next")),y.isWebView){var l=c("article");f(l,"article_webview")}y.isWebView&&y.audioBridge&&(window.audioplayer={playPause:function(e,t){var n=v("audio_item",e.target);if(w&&w!=n&&(p(w,"ai_playing"),w=!1),b&&(p(b,"article_object_audioplaylist_playing"),b=!1),hasClass(n,"ai_playing"))i.default.send("audioPause",{}),p(n,"ai_playing");else{var o=F(t,S),r=S;-1==o&&(r.unshift(t),o=0),i.default.send("audioPlay",{audioIds:r,pos:o}),f(n,"ai_playing"),w=n}}}),y.isWebView?(i.default.send("articleReady"),window.addEventListener("VKWebAppEvent",function(e){var t=e.detail||{};switch(t.type){case"articleOwnerSubscribed":var n=t.ownerId,i=t.isSubscribed;each(k,function(e,t){var o=t.getArticle();if(o.owner_id==n)return o.is_subscribed_to_owner=i,!1});break;case"articleBookmarked":var o=t.articleOwnerId+"_"+t.articleId,r=z(o);r&&(r.is_faved=t.isBookmarked);var a=N(o);each(a,function(e,n){u(n,"_active",!!t.isBookmarked)});break;case"articleWebViewShow":U(t)}}),j(e,!0)):j(e,!1)},fave:function(e,t,n,o,a){var s=!hasClass(e,"_active");d.post("article.php",{act:"fave",url:t,add:intval(s),hash:n}),k.forEach(function(e){var n=e.getArticle();n.url==t&&(n.is_faved=s)}),(0,r.mailruStatsPixel)(s?"fave":"unfave",o);var l=N(a);each(l,function(e,t){u(t,"_active",s)}),y.isWebView&&function(e){var t=z(e);t&&(JSON.stringify({article:q(t)}),i.default.send("articleBookmarked",{article:q(t)}))}(a)},share:function(e,t,n){return function(e){var t=z(e);if(t){var n={article:q(t)};i.default.send("articleShare",n)}}(t),!1},subscribe:function(e,t,n){d.post("article.php",{act:"subscribe",owner_id:t,hash:n},{onDone:function(t,n){u(e,"articleView__subscribed",t),e.innerHTML=n}})},toggleDarkMode:function(e){g||(g=setTimeout(function(){var t=c("articleView__layout");u(t,"article_dark",e),u(document.body,"article_dark",e);var n=intval(hasClass(t,"article_dark"));g=!1,void 0!==e||y.isWebview||d.post("article.php",{act:"set_dark_mode",dark:n});var i=c("articleMenu");i&&Unfold.setTitle(i,"dark_mode",n?getLang("mobile_articles_menu_dark_disable"):getLang("mobile_articles_menu_dark"))},e?0:10))},onWebViewShow:U,audioPlayPlaylist:function(e,t,n){var o=v("article_object_audioplaylist_webview",e);if(w&&(p(w,"ai_playing"),w=!1),b){var r=b;if(p(r,"article_object_audioplaylist_playing"),b=!1,r==o)return i.default.send("audioPause",{}),cancelEvent(n)}var a=F(t,S),s=S;return-1==a&&(s.unshift(t),a=0),i.default.send("audioPlay",{audioIds:s,pos:a}),f(o,"article_object_audioplaylist_playing"),b=o,cancelEvent(n)},onAudioStateChanged:function(e,t){w&&(p(w,"ai_playing"),w=!1),b&&(p(b,"article_object_audioplaylist_playing"),b=!1),e=(e=e.split("_"))[0]+"_"+e[1];var n=ge("audio"+e);n&&u(n,"ai_playing","play"==t);for(var i=geByClass("_article_object_audioplaylist_webview"),o=0;o<i.length;o++)if((domData(i[o],"ids")||"").split(",").indexOf(e)>=0&&"play"==t){f(i[o],"article_object_audioplaylist_playing"),b=i[o];break}}}},function(e,t,n){"use strict";Object.freeze||(Object.freeze=function(e){if(Object(e)!==e)throw new TypeError("Object.freeze can only be called on Objects.");return e});try{Object.freeze(function(){})}catch(e){Object.freeze=(i=Object.freeze,function(e){return"function"==typeof e?e:i(e)})}var i},function(e,t,n){"use strict";var i,o=n(322),r=n(118),a=(i=r)&&i.__esModule?i:{default:i};var s=need("nav"),l=need("page"),u=need("ajax"),c=need("audioplayer"),d=need("TabRow"),f=need("AudioSerp");window.uAudioSerp={},uAudioSerp._onQueryChange=g,uAudioSerp._init=v;var p=300,_={},A=!1,m=null,h=null;function v(){var e,t=need("cur");(e=w(s.getQuery("q")))&&(_[e]=f.getFoundHtml()),t.processNav=y,c.onAdd(b),c.onDel(b)}function g(e){var t=e.query,n=w(t);function i(){var e=!0;n||(e=!1),!n&&A&&(cur.processNav=null,f.toggleTabs(!1),f.setView("spinner"),A=!1),s.go(a.default.make(s.path,{q:t,tab:e})),cur.processNav=y}h&&h.abort(),m&&clearTimeout(m),f.toggleTabs(!0),n in _||!n?i():(f.setView("spinner"),m=setTimeout(i,p))}function y(e){var t=s.path,n=e.nav.path,i=qs2obj(s.params),r=qs2obj(e.nav.params);if(t!==n||r.act)return l.save(s.cur,{title:document.title,bc:(0,o.$)("body").className,html:(0,o.$)(".basis").outerHTML,js:s.getPageJs()}),_={},A=!0,c.onAdd.off(b),c.onDel.off(b),h&&h.abort(),!1;if(i.tab!==r.tab){var p=r.tab||"owned";f.setTab(p),d.setSelectedTab("uAudioSerp",p)}var m=r.q||"",v=w(m);t.q!==r.q&&h&&h.abort();var g=a.default.make(t,{q:m,tab:null}),y=a.default.make(t,{q:m,tab:"global"});return d.setTabUrl("uAudioSerp","owned",g),d.setTabUrl("uAudioSerp","global",y),SearchPanel.setQuery("uAudioSerp",m),m?v in _?(f.setFoundHtml(_[v]),f.setView("found")):(f.setView("spinner"),h=u.post(t,{q:m,_ajax:1},{onDone:function(e){f.setFoundHtml(e),f.setView("found"),_[v]=e}})):f.setView("owned"),!0}function w(e){return(e||"").trim().toLowerCase()}function b(){_={},A=!0}},function(e,t,n){"use strict";n(288)},function(e,t,n){"use strict";var i,o,r,a;Array.from||(Array.from=(i=Object.prototype.toString,o=function(e){return"function"==typeof e||"[object Function]"===i.call(e)},r=Math.pow(2,53)-1,a=function(e){var t=function(e){var t=Number(e);return isNaN(t)?0:0!==t&&isFinite(t)?(t>0?1:-1)*Math.floor(Math.abs(t)):t}(e);return Math.min(Math.max(t,0),r)},function(e){var t=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");var n,i=arguments.length>1?arguments[1]:void 0;if(void 0!==i){if(!o(i))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(n=arguments[2])}for(var r,s=a(t.length),l=o(this)?Object(new this(s)):new Array(s),u=0;u<s;)r=t[u],l[u]=i?void 0===n?i(r,u):i.call(n,r,u):r,u+=1;return l.length=s,l}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(167),r=(i=o)&&i.__esModule?i:{default:i};n(127),t.default=r.default,window.uConvo=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{!i&&s.return&&s.return()}finally{if(o)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.createLongpollConnect=function(e,t){var n=!!e.stopped,i={id:e.id,key:e.key,ts:e.ts,url:e.url,lpstat:e.lpstat||0,version:e.version||u,mode:l,waitTimeout:2,waitAbortFns:[],isStoppedFn:function(){return n},onResult:function(e){e.ts&&r(i.ts,e.ts,e.updates.map(function(e){switch(e[0]){case 0:return s.deleteEvent(e);case 1:return s.replaceFlagsEvent(e);case 2:return s.setFlagsEvent(e);case 3:return s.resetFlagsEvent(e);case 4:return s.addMessageEvent(e);case 5:return s.editMessageEvent(e);case 6:return s.readInboundEvent(e);case 7:return s.readOutboundEvent(e);case 8:return s.gotOnlineEvent(e);case 9:return s.gotOfflineEvent(e);case 10:return s.resetDirectoriesEvent(e);case 11:return s.replaceDirectoriesEvent(e);case 12:return s.setDirectoriesEvent(e);case 13:return s.deleteDialogEvent(e);case 18:return s.replaceMessageEvent(e);case 51:return s.chatChangedEvent(e);case 52:return s.chatUpdatedEvent(e);case 63:return s.typingEvent(e);case 64:return s.recordingAudioEvent(e);case 70:return s.videoCallEvent(e);case 80:return s.unreadCountEvent(e);case 114:return s.notifySettingsChangedEvent(e);case 116:return s.refreshMessageEvent(e);case 117:return s.audioStartEvent(e);case-1:return s.resyncEvent();case-2:return s.refreshLpKeyEvent(e);default:return s.emptyEvent(e)}}))},onData:_(t.onData),onRequestError:_(t.onRequestError),onHistoryLost:A(t.onHistoryLost),onKeyExpired:A(t.onKeyExpired),onLpBroken:A(t.onHistoryLost)},o=t.onEvents;function r(e,t,n){i.ts=t;for(var r=0;r<n.length;++r)n[r].type===a.REFRESH_LP_KEY&&(i.key=n[r].key,i.url=n[r].url);o(e,t,n)}var c={options:i,isStopped:function(){return n},stopConnection:function(){n=!0,i.stopFn&&i.stopFn(),i.stopFn=void 0,this.abortWaiting()},reinitConnection:function(){this.stopConnection(),n=!1,p(i)},abortWaiting:function(){i.waitAbortFns.forEach(function(e){return e()}),i.waitAbortFns=[],i.waitTimeout=2},onLp:r};return p(i),c};var o=n(328),r=n(341),a=n(286),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(a);var l=202,u=6,c=4;function d(e,t){e.waitAbortFns.push(t)}function f(e){if(e.isStoppedFn())return Promise.resolve({ts:0,updates:[]});var t=(0,r.plaingetCancelable)(e.url,{act:"a_check",key:e.key,version:e.version,ts:e.ts,wait:25,mode:e.mode}),n=t.request,a=t.cancel;return e.stopFn=a,n.then(function(t){var n=i(t,2),o=n[0],r=n[1];return e.onData(e,r),e.waitTimeout=2,JSON.parse(o)}).catch(function(t){var n=i(t,2),o=(n[0],n[1]);throw e.onData(e,o),""}).then(function(t){return function(e,t){var n=t.failed?(0,o.abortablePause)(c,null):{},r=n.abort,a=n.pause;switch(t.failed){case 1:return d(e,r),e.onHistoryLost(e,t).then(function(){return e.onResult({ts:t.ts,updates:[[-1]]})}).then(a).then(function(){return f(e)});case 2:return d(e,r),e.onKeyExpired(e,t).then(function(t){var n=i(t,4),o=n[0],r=n[1],a=n[2],s=n[3];return e.onResult({ts:+s,updates:[[-2,o,r+"/"+a],[-1]]})}).then(a).then(function(){return f(e)});case 3:return e.onLpBroken(e,t);default:return t}}(e,t)})}function p(e){e.isStoppedFn()||f(e).then(e.onResult).catch(function(t){return function(e,t){if(e.isStoppedFn())return;e.onRequestError(t),e.waitTimeout=Math.min(64,2*e.waitTimeout);var n=(0,o.abortablePause)(e.waitTimeout,null),i=n.abort,r=n.pause;return d(e,i),r()}(e,t)}).then(function(){return p(e)})}function _(e){return e||function(){}}function A(e){return e?function(){return Promise.resolve(e.apply(void 0,arguments))}:function(){return Promise.reject()}}},function(e,t,n){"use strict";var i,o=n(68);((i=o)&&i.__esModule?i:{default:i}).default.onPostMessage(function(e){"waiterStart"!==e&&"3dsPage"!==e||document.activeElement&&document.activeElement.blur()})},function(e,t,n){"use strict";n(68),n(203),n(61),n(223),n(257),n(40)},function(e,t){e.exports=function(e){var t;if("SELECT"===e.nodeName)e.focus(),t=e.value;else if("INPUT"===e.nodeName||"TEXTAREA"===e.nodeName){var n=e.hasAttribute("readonly");n||e.setAttribute("readonly",""),e.select(),e.setSelectionRange(0,e.value.length),n||e.removeAttribute("readonly"),t=e.value}else{e.hasAttribute("contenteditable")&&e.focus();var i=window.getSelection(),o=document.createRange();o.selectNodeContents(e),i.removeAllRanges(),i.addRange(o),t=i.toString()}return t}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.urlBase64ToUint8Array=function(e){for(var t="=".repeat((4-e.length%4)%4),n=(e+t).replace(/\-/g,"+").replace(/_/g,"/"),i=window.atob(n),o=new Uint8Array(i.length),r=0;r<i.length;++r)o[r]=i.charCodeAt(r);return o}},function(e,t,n){"use strict";var i=window,o=i.geByClass1,r=i.tag,a=i.geByTag1,s=i.ce,l=i.hasClass,u=i.attr,c=i.removeEvent,d=i.addEvent,f=i.qs2obj,p=i.each,_=i.len,A=i.extend,m=i.copy,h=i.onDOMReady,v=i.scrollTop,g=i.getY,y=i.scrollToEl,w=i.scrollToHash,b=i.obj2qs,D=i.escapeAttr,C=i.remove,E=i.val,S=i.toggleClass,k=i.show,M=i.hide,T=i.gpeByClass,x=i.geByTag,I=i.addClass,P=i.checkEvent,B=i.unescapeAttr,F=i.removeClass,L=i.ge,O=i.cancelEvent,N=i.isUndefined,R=window.ajax,j=window.nav,H=window.post,V=window.zlayer,$=function(){var e,t,n,i,U,z,q,W,Y,G,X,Q,K,J,Z=1,ee=!1,te={},ne={},ie={},oe=null,re=null,ae=!1,se=null,le=null,ue=!0,ce=0,de=!1;function fe(){if(!(e=o("photo_view","m")))return j.al_go(j.cur),!1;if(t=o("pv_summary",e),o("photo_msg",e),X=o("pv_tag_wrap",e),U=o("pv_body",e),z=o("thumb_item",U),i=o("pv_nav",U),Y=o("pv_photo_wrap",z),q="a"==r(z)&&z,W=a("img",z),G=o("pv_footer",e),(n=o("summary_loading",t))||(n=s("div",{innerHTML:'<i class="i_loading"></i>',className:"summary_loading"},{display:"none"}),t.appendChild(n)),ee=l("pv_touch_full",U),i){var f=o("pv_nav_left",i),p=o("pv_nav_z",i),_=o("pv_nav_right",i);Q=o("pv_nav_link",f),J=o("pv_nav_link",p),K=o("pv_nav_link",_),u(Q,"onclick","return photo.prev(event);"),u(K,"onclick","return photo.next(event);"),u(q,"onclick",!ee&&"return photo.next(event);"),R.prepare_click([Q,K,q])}return c(window,"orientationchange",ye),d(window,"orientationchange",ye),!0}function pe(){var t=window.photoview;return!!t&&(!!de||(de=!0,t.onPhotoChange=function(e,t){ce=e,be(e,t)},t.onUpdate=function(){},t.onClose=function(t){if(uRegisterFloatBtn.show(),!function(e){var t=f(j.params);if(delete t.z,!e.local&&!e.crop){if(j.tryHistoryBack())return!1;var n=j.path+b(t)+j.hash;j.go(n,null,{push_only:!0})}return!0}(t))return!0;var n=f(j.params);e&&n.list==re&&we(ce,!0)},!0))}function _e(e){var t=window.photoview,n=[];return p(e,function(e,t){if(!t)return!0;n.push(te[t.id]=t)}),oe&&t&&t.saveSource(ve(oe)),n}function Ae(e){return te[e]||{}}function me(e,t,n){if(null!==t){ne[e]||(ne[e]=new Array(n||_(t))),_e(t);var i=ne[e];ae&&i.reverse(),A(i,t),ae?(oe=m(i),i.reverse()):oe=i}else delete ne[e]}function he(e){if("string"!=typeof e)return e;var t=ne[e]||[];return ae?m(t).reverse():t}function ve(e){var t=he(e),n=new Array(t.length),i=f(j.params);for(var o in delete i.z,t){var r=oe[o],a="",s="";r.hash&&(s=b({hash:r.hash})),r.isDoc?(a="doc"+r.id+s,n[o]={id:r.id,photo_url:"/"+a,src:r.original_src,isDoc:!0}):(a="photo"+r.id+"?list="+re+(ae?"&rev=1":"")+(le?"&from="+le:""),n[o]={id:r.id,photo_url:"/"+a,like_url:"/like?act="+(r.likes_me?"del":"add")+"&object=photo"+r.id+"&from="+encodeURIComponent(a)+"&list="+re+"&hash="+r.like_hash,likes_me:r.likes_me,src:r.original_src,tags:r.tags,caption:r.caption,likes_cnt:r.likes_cnt,replies_cnt:r.replies_cnt})}return n}function ge(e,t){for(var n in t||(t=oe),t)if(oe[n].id==e)return+n;return-1}function ye(){j.hash||h(function(){if(o("photo_view")){var e=v();U&&g(U)<e&&y(U)}})}function we(n,i,o){var r=window.cur,s=window.lang,l=oe[n],c=1==oe.length;if(l){j.hash?w(j.hash):ye();var d={};se&&(d.list=se),ae&&(d.rev=1),le&&(d.from=le);var _=b(d),m="photo"+l.id+_,h=l.photo,v=(Ce(n-1)||{}).id,g=(Ce(n+1)||{}).id;if(c||(q.href="/photo"+g+_,Q&&(Q.href="/photo"+v+_),K&&(K.href="/photo"+g+_),R.prepare_click([Q,K,q])),ee){var y="photo"+l.id+"/"+se+(ae?"/rev":""),k=A({},d,{z:y}),M="/photo"+l.id+b(k);if(V._lastNav){var T=V._lastNav;(k=f(T.params)).z=y,M=T.path+b(k)+T.hash}J&&(J.href=M),R.prepare_click(J),u(J,"onclick","return photo.fullscreen('"+D(M)+"', event);")}if(W&&W.src!=h){W.onload=null,C(W);var x="";p(l.tags,function(e,t){if(!e||0==e)return!0;var n=t[0][0],i=t[0][1],o=t[0][2],r=t[0][3];x+='<div class="pv_tag" style="left: '+n+"%; top: "+i+"%; width: "+o+"%; height: "+r+'%;" id="pv_tag'+e+'" onclick="return photo.selectTag('+e+', event, true);"><div class="fill"></div></div>'}),E(Y,'<img src="'+h+'" alt="" class="ph_img" />'+x),W=a("img",Y)}S("photo_deleted",e,!!l.deleted),S("pv_one_photo",U,1==oe.length),E(t,(s.mobile_photos_photo_header||"").replace("%s",ce+1).replace(/%s|{count}/,oe.length)),E(X,l.tag_info||"");var I="",P=(r.sticker_panel||"").split("photo-0_0").join("photo"+l.id),B=(l.comments_html||"").split("\x3c!--stickers_panel--\x3e").join(P);if(l.caption&&(I+='<div class="mv_description">'+l.caption+"</div>"),l.tags_list&&(I+='<dl class="pv_tags_list si_row"><dt>'+s.mobile_photos_on_this_photo+"</dt><dd>"+l.tags_list+"</dd></dl>"),l.was_edited&&(I+='<dl class="si_row"><dt>'+s.mobile_photos_photo_was_edited+"</dt></dl>"),l.album_link&&(I+='<dl class="si_row"><dt>'+s.mobile_photos_photo_album_label+"</dt><dd>"+l.album_link+"</dd></dl>"),l.author_link&&(I+='<dl class="si_row"><dt>'+s.mobile_photos_photo_author_label+"</dt><dd>"+l.author_link+"</dd></dl>"),(l.date||l.likes||l.publish)&&(I+='<div class="vi_values">'+(l.date||"")+(l.likes||"")+(l.publish||"")+"</div>"),E(G,'<div class="like_box bl_cont"><div class="photo_msg bl_none">'+(l.deleted||"")+'</div><div class="mv_details">'+I+'</div><ul class="mv_actions">'+(l.actions||"")+'</ul></div><div class="comments_wrap bl_cont">'+B+"</div>"),H.stickersInit(),r.replyTo=0,R.refreshLinks(l.fv_link,l.app_link),$.closeTags(),!i){var F="/"+m;j.go(F,null,{no_push:i,push_only:!0,replace:o})}}ue||(Ee(),function(){for(var e=0,t=ce+1;e<Z;e++){var n=e+t,i=Ce(n),o=i&&i.photo;if(o&&!ie[o]){var r=ie[o]=new Image;r.src=o,r.onload=function(){ie[o]=!0}}}}())}function be(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.isDoc,i=t.hash,o=window.photoview,r=oe[e];oe.length;if(r){var a=f(j.params);if(a.z=n?"doc"+r.id+"/"+i:"photo"+r.id+"/"+se+(ae?"/rev":""),t.no_open||o.open(e,ve(oe),{local:t.local,isDoc:n}),!t.local&&!t.crop){var s=j.path+b(a)+j.hash;j.go(s,null,{no_push:t.no_push,push_only:!0,replace:t.replace,nav_init:!t.no_open,nav_incr:!0})}}t.local||t.crop||Ee(!0,n)}var De=!1;function Ce(e){return e>0?e%=oe.length:e=(100*oe.length+e)%oe.length,oe[e]}function Ee(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!De){for(var i=window.photoview,o=!1,r=1,a=0;a<5;a++){if(!(l=Ce(s=a+ce))||!l.owner_id){o=s,r=1;break}}if(!1===o)for(a=-1;a>-3;a--){var s,l;if(!(l=Ce(s=a+ce))||!l.owner_id){o=s,r=-1;break}}if(!1!==o){var u=Ce(ce);if(u){De=!0,k(n);var c=window.cur,d=u.owner_id||(u.id||"").split("_")[0],f=s==ce&&u.id?(t?"/doc":"/photo")+u.id+(u.hash?"?hash="+u.hash:""):"/photos.php",p={_ajax:1,oid:d,list:re,offset:o,direction:r,rev:ae?1:0};c.stickers||(p.need_stickers=1),j.getQuery("community")&&(p.community=j.getQuery("community")),R.post(f,p,{onDone:function(t,o,r,a){M(n),De=!1,r&&(c.replyNames||(c.replyNames={}),A(c.replyNames,r)),a&&A(c,a),me(re,t,o||oe.length),e?i&&i.saveSource(ve(re),!1,!0):we(ce,!0)}})}}}}function Se(e,t,n,i){if(oe=[],e){var o=T("thumbs_list",e)||T("wiki_body",e);o&&p(x("img",o),function(){var e=u(this,"data-id"),t=u(this,"data-src_big");if(!e||!t)return!0;var n=(t=t.split("|"))[0],i=+t[1]||0,o=+t[2]||0;oe.push({id:e,original_src:n,width:i,height:o})})}oe.length||oe.push({id:t,original_src:!0,isDoc:n,hash:i})}function ke(){I("pv_icons_hide",U)}return{save:_e,get:Ae,saveSource:me,getSource:he,clear:function(){c(window,"orientationchange",ye)},open:function(e,t,n,i,o){if(P(n))return!0;if(!fe())return!0;if(ae=!1,"/rev"==t.substr(-4)&&(t=t.slice(0,-4),ae=!0),le=i||null,t)re=t;else{var r=Ae(e);re=r.album?"album"+r.album:""}if(se=re,oe=he(re),-1===(ce=ge(e,oe))){if(!(r=Ae(e)).id)return!1;oe=[r],ce=0}ue=oe.length<2,!1;var a=oe[ce]&&e!=oe[ce].id;return we(ce,o&&!a,a),!1},prev:function(e){return!!P(e)||!(De&&!Ce(ce-1))&&(!fe()||(ue?$.close():(--ce<0&&(ce=oe.length-1),we(ce),ke(),!1)))},next:function(e){return!!P(e)||!(De&&!Ce(ce+1))&&(!fe()||!ue&&(++ce>=oe.length&&(ce=0),we(ce),ke(),!1))},close:function(e,t){return!!P(e)},fullscreen:function(e,t){return!!l("pv_photo_tags_selected",U)||j.go(B(e),t,{need_restore:!0})},showIcons:function(){var e=o("photo_view","m");if(!e)return!1;var t=o("pv_body",e);if(!t)return!1;setTimeout(function(){F("pv_hidden_icons",t),setTimeout(function(){I("pv_icons_hide",t)},2e3)},10)},selectTag:function(e,t,n){if(n&&!l("pv_photo_tags_selected",U))return!0;var i=L("pv_tag"+e),r=o("pv_tag_selected","pv_photo_tags_wrap"),a=L("pv_tag_label"+e),s=o("pv_tag_label_selected","pv_tags_list");return l("pv_tag_selected",i)||(F("pv_tag_selected",r),I("pv_tag_selected",i)),l("pv_tag_label_selected",a)?j.go(a,t):(F("pv_tag_label_selected",s),I("pv_tag_label_selected",a),I("pv_photo_tags_selected",U),O(t),!1)},closeTags:function(e){if(!l("pv_photo_tags_selected",U))return!0;var t=o("pv_tag_selected","pv_photo_tags_wrap"),n=o("pv_tag_label_selected","pv_tags_list");return t&&F("pv_tag_selected",t),n&&F("pv_tag_label_selected",n),F("pv_photo_tags_selected",U),O(e),!1},init:function(e,t,n,i,o,r,a){Z=N(a.preload)?1:a.preload,ae=!!o,$.saveSource(e,t,n),h(function(){$.open(i,e+(o?"/rev":""),null,r,!0)})},zopen:function(e,t,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(P(t))return!0;var r=o.isDoc,a=o.hash;if(pe(),ae=!1,"/rev"==i.substr(-4)&&(i=i.slice(0,-4),ae=!0),delete f(j.params).z,le=o.from||!1,i)re=i;else{var s=Ae(n);re=s.album?"album"+s.album:""}if(se=re,(oe=he(re)).length||Se(e,n,r,a),-1===(ce=ge(n,oe))&&(Se(e,n,r,a),ce=ge(n,oe)),-1===ce){if(!(s=Ae(n)).id)return!0;oe=[s],ce=0}ue=oe.length<2,!1;var l=oe[ce]&&n!=oe[ce].id;return be(ce,{no_push:o.no_push&&!l,replace:l,local:o.local,isDoc:r,hash:a}),uRegisterFloatBtn.hide(),O(t),!1},zclose:function(e,t){return uRegisterFloatBtn.show(),!!P(e)}}}();window.photo=$},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(169)),o=r(n(153));function r(e){return e&&e.__esModule?e:{default:e}}Object.assign(i.default,o.default),window.Btn=i.default,t.default=i.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(90),r=(i=o)&&i.__esModule?i:{default:i};t.default=r.default,window.Bem=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(168)),o=r(n(209));function r(e){return e&&e.__esModule?e:{default:e}}Object.assign(i.default,{rejectAll:function(e,t){o.default.setLoading(t,!0),i.default.onRejectAll(t)},onRejectAll:befall()}),t.default=i.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(231),r=(i=o)&&i.__esModule?i:{default:i};n(220),t.default=r.default,window.MailDialog=r.default},,function(e,t,n){"use strict";var i=s(n(77)),o=n(322),r=s(n(72)),a=s(n(115));function s(e){return e&&e.__esModule?e:{default:e}}function l(){store.mail.cur&&p()}function u(e){store.mail.cur&&function(e){var t=e.target,n=$(".mailActs");n&&n.classList.contains("mailActs_menuOpened")&&!t.closest(".mailActs__chevronList")&&!t.closest(".mailActs__chevronMoreIcon")&&n.classList.remove("mailActs_menuOpened")}(e)}function c(e){d({canEdit:e})}function d(e){(0,o.$$)(".mailActs").forEach(function(t){var n=i.default.parseClass("mailActs",t.getAttribute("class"));t.setAttribute("class",i.default.class("mailActs",Object.assign({},n,e)))})}function f(e){switch(e){case"edit":a.default.onEditClick();break;case"remove":a.default.onRemoveClick();break;case"important":a.default.onImportantClick();break;case"reply":a.default.onReplyClick();break;case"forward":a.default.onForwardClick();break;case"spam":a.default.onSpamClick();break;case"pin":a.default.onPinClick()}}function p(){var e=document.querySelector(".mailActs__chevron"),t=e.offsetWidth-1,n=e.querySelectorAll(".mailActs__chevronListItem"),i=e.querySelectorAll(".mailActs__icon");Array.prototype.forEach.call(i,function(e,o){t<36*i.length?t-34>=36*(o+1)?(e.classList.remove("mailActs__icon_hidden"),n[o].classList.add("mailActs__chevronListItem_hidden")):(e.classList.add("mailActs__icon_hidden"),n[o].classList.remove("mailActs__chevronListItem_hidden")):(e.classList.remove("mailActs__icon_hidden"),n[o].classList.add("mailActs__chevronListItem_hidden"))}),d({cutted:t<36*i.length})}function _(){(0,o.$$)(".mailActs").forEach(function(e){return e.classList.toggle("mailActs_menuOpened")})}Object.assign(a.default,{onCloseClick:(0,r.default)(),onRemoveClick:(0,r.default)(),onImportantClick:(0,r.default)(),onReplyClick:(0,r.default)(),onForwardClick:(0,r.default)(),onSpamClick:(0,r.default)(),onPinClick:(0,r.default)(),onMoreClick:(0,r.default)(),onEditClick:(0,r.default)(),setCount:function(e){var t=langNumeric(e,lang.mobile_mail_messages_selected).replace("{count}",e);(0,o.$$)(".mailActs__counter").forEach(function(e){return e.innerText=t}),1!=e&&c(!1);p()},setEditAvailable:c,setImportantAvailable:function(e){d({canImportant:e})},toggleQuickButtons:function(e){$(".mailActs__buttonsIn").hidden=!e},setReplyAvailable:function(e){$(".mailActs__button_type_reply").disabled=!e},togglePin:function(e){(0,o.$$)(".mailActs").forEach(function(t){return t.classList.toggle("mailActs_canPin",e)})},setModifiers:d,setLabels:function(e){var t=window.lang,n=e.pinned?t.mobile_mail_messages_actions_unpin:t.mobile_mail_messages_actions_pin,i=e.important?t.mobile_mail_messages_actions_important_off:t.mobile_mail_messages_actions_important;$(".mailActs__icon_type_pin").setAttribute("aria-label",n),$(".mailActs__icon_type_important").setAttribute("aria-label",i),$(".mailActs__chevronListItem_type_pin").innerHTML=n,$(".mailActs__chevronListItem_type_important").innerHTML=i},update:p}),a.default._onButtonClick=f,a.default._onCloseClick=a.default.onCloseClick,a.default._onMoreClick=_,onBodyResize(l),document.addEventListener("click",u)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=window,o=i.ce,r=i.getCssPropertyName,a=window._ua;a||(t._ua=a=navigator.userAgent.toLowerCase());var s={version:(a.match(/.+(?:me|ox|on|rv|it|era|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],amigo:/amigo.*mrchrome soc/i.test(a),opera:/opera/i.test(a),msie:/msie/i.test(a)&&!/opera/i.test(a),msie6:/msie 6/i.test(a)&&!/opera/i.test(a),msie7:/msie 7/i.test(a)&&!/opera/i.test(a),msie8:/msie 8/i.test(a)&&!/opera/i.test(a),msie9:/msie 9/i.test(a)&&!/opera/i.test(a),mozilla:/firefox/i.test(a),chrome:/chrome/i.test(a)||/crios/i.test(a),safari:!/crios/i.test(a)&&!/chrome/i.test(a)&&/webkit|safari|khtml/i.test(a),iphone:/iphone/i.test(a),ipod:/ipod/i.test(a),iphone4:/iphone.*OS 4/i.test(a),ipod4:/ipod.*OS 4/i.test(a),ipad:/ipad/i.test(a),ios:+(a.match(/.+(?:ipod|ipad|iphone.*os) ([\d.]+)_/i)||[0,0])[1],android:/android/i.test(a),bada:/bada/i.test(a),opera_mini:/opera mini/i.test(a),uc_mini:/mobile safari.*ucbrowser/i.test(a),mobile:/iphone|ipod|ipad|opera mini|opera mobi|iemobile/i.test(a),msie_mobile:/iemobile/i.test(a),msie_edge:/edge/i.test(a)&&!/opera/i.test(a),safari_mobile:/iphone|ipod|ipad/i.test(a),opera_mobile:/opera mini|opera mobi/i.test(a),mac:/mac/i.test(a),mi:/miuibrowser/i.test(a)};s.desktop=(s.opera||s.msie||s.mozilla||s.chrome||s.safari)&&!s.mobile,s.wkwebview=function(){if(!s.ios)return!1;if(window.webkit&&window.webkit.messageHandlers)return!0;var e=/constructor/i.test(window.HTMLElement),t=!!window.indexedDB;if(-1===a.indexOf("safari")||-1===a.indexOf("version")||navigator.standalone){if(!t&&e||!window.statusbar.visible);else if(!e||t)return!0}else;return!1}();var l={1:1,2:1,3:1,4:1,5:1},u="ontouchstart"in window,c=function(e){if("WebKitCSSMatrix"in e&&"m11"in new e.WebKitCSSMatrix)return!0;if("MSCSSMatrix"in e&&"m11"in new e.MSCSSMatrix)return!0;if("CSSMatrix"in e&&"m11"in new e.CSSMatrix)return!0;try{var t=o("div"),n=r(t,"transform");return!!n&&(t.style[n]="translate3d(1px,1px,1px)",t.style[n]&&"none"!=t.style[n])}catch(e){return!1}}(window);t.default=s,t._ua=a,t.mobPlatforms=l,t.isTouch=u,t.has3d=c,Object.assign(window,{browser:s,_ua:a,mobPlatforms:l,isTouch:u,has3d:c})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.log=function(e){var t=e.action,n=Date.now(),i=(0,o.getNetworkType)(),r=a.default.isLongPollingEnabled();return{error:function(e,n){statlogsValueEvent("mvk_mail_send_error",0,t,e,n,r,i)},mark:function(e){statlogsValueEvent("mvk_mail_send_time",Date.now()-n,t,e,r,i)}}},t.logQueueSize=function(e){statlogsValueEvent("mvk_mail_send_queue_size",e,(0,o.getNetworkType)())};var i,o=n(14),r=n(329),a=(i=r)&&i.__esModule?i:{default:i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(21)),o=r(n(357));function r(e){return e&&e.__esModule?e:{default:e}}var a=window,s=a.addClass,l=a.removeClass,u=a.getCh,c=a.removeEvent,d=a.addEvent,f=a.getStyle,p=a.setStyle;Object.assign(o.default,{open:function(e,t){t&&(e=e.cloneNode(!0),document.body.appendChild(e),e.appendedToBody=!0);e.classList.add(_.open);var n=e.$(A.scroll);if(function(e){if(window.MutationObserver&&!m){var t=document.body;h=t.style.overflow,m=!0,t.style.overflow="hidden",(v=new MutationObserver(function(){t.contains(e)||b()})).observe(document.body,{attributes:!0,childList:!0,subtree:!0})}}(e),n){if(y(e,n),e.onResizeHandler=function(){y(e,n)},d(window,"resize",e.onResizeHandler),!window.MutationObserver)return;e.scrollContentObserver=new MutationObserver(e.onResizeHandler),e.scrollContentObserver.observe(n,{childList:!0,subtree:!0})}},close:w}),t.default=o.default,o.default._onOverlayClick=g,o.default._onTouchMove=function(){};var _={popup:"Popup",open:"Popup_open",hasScroll:"Popup_hasScroll",scrollView:"ScrollView"},A={open:"."+_.open,popup:"."+_.popup,scroll:".Popup__scroll",header:".Popup__header",footer:".Popup__footer"},m=!1,h=null,v=null;function g(e,t,n){var o=e.closest(A.popup);t&&i.default.handle(t,{$popup:o}),n&&w(o)}function y(e,t){var n=e.$(A.header),i=e.$(A.footer);parseInt(f(t,"padding-top")),parseInt(f(t,"padding-bottom"));t.scrollHeight-6>t.offsetHeight?(s(e,_.hasScroll),s(t,_.scrollView)):(l(e,_.hasScroll),l(t,_.scrollView),t.scrollTop=0);var o=u(),r=0,a=0;n&&(r=n.offsetHeight),i&&(a=i.offsetHeight);var c=Math.min(o-r-a-100,420);p(t,"max-height",c+"px")}function w(e){e.classList.contains(_.popup)||(e=e.closest(A.popup)),e||(e=$(A.open)),e.classList.remove(_.open),e.appendedToBody&&document.body.removeChild(e),c(window,"resize",e.onResizeHandler),e.scrollContentObserver&&e.scrollContentObserver.disconnect(),$(A.open)||b()}function b(){window.MutationObserver&&m&&(document.body.style.overflow=h,v.disconnect(),m=!1)}},function(e,t,n){"use strict";var i=n(322),o=need("nav");window.PinnedMsg={onHideClick:befall(),getByMsgId:function(e){return(0,i.$)(r.pinnedMsg(e))}};var r={pinnedMsg:function(e){return'.pinnedMsg[data-msg-id="'+e+'"]'}};function a(e,t){o.go(t,e,{force:!0})}PinnedMsg._onClick=a,PinnedMsg._onHideClick=PinnedMsg.onHideClick},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Typing_isEmpty=t.Typing_renderNames=void 0;var i=u(['\n    <div class="','">\n      ','\n      <div class="typing__names">',"</div>\n      ","\n    </div>\n  "],['\n    <div class="','">\n      ','\n      <div class="typing__names">',"</div>\n      ","\n    </div>\n  "]),o=u(['\n    <div class="typing__dotsWrap">\n      <div class="typing__dots">...</div>\n    </div>\n  '],['\n    <div class="typing__dotsWrap">\n      <div class="typing__dots">...</div>\n    </div>\n  ']),r=l(n(77)),a=l(n(210)),s=(l(n(131)),l(n(282)));n(255);function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function c(e){return Array.isArray(e)?0===e.length:!e}function d(e){return"audio"===e.text?function(e,t){var n=window.lang;if(!Array.isArray(e))return e?n.mobile_mail_recaudio_1_short:"";var i=e,o=t,r="";if(1===o&&i.length>=1){var a=i[0];r=(r=n.mobile_mail_recaudio_1).replace("{name}",a)}else if(2===o&&i.length>=2){var s=i[0],l=i[1];r=(r=(r=n.mobile_mail_recaudio_2).replace("{name1}",s)).replace("{name2}",l)}else if(o>1&&i.length>=1){var u=i[0];r=(r=(r=n.mobile_mail_recaudio_many).replace("{name}",u)).replace("{count}",o-1)}return r}(e.typing,e.typingCount):"mixed"===e.text?function(e,t){var n=window.lang;if(!Array.isArray(e))return"";var i=e,o=t,r="";if(1===o&&i.length>=1)r="";else if(2===o&&i.length>=2){var a=i[0],s=i[1];r=(r=(r=n.mobile_mail_mixtyping_2).replace("{name1}",a)).replace("{name2}",s)}else if(o>1&&i.length>=1){var l=i[0];r=(r=(r=n.mobile_mail_mixtyping_many).replace("{name}",l)).replace("{count}",o-1)}return r}(e.typing,e.typingCount):function(e,t){var n=window.lang;if(!Array.isArray(e))return e?n.mobile_mail_typing_1_short:"";var i=e,o=t,r="";if(1===o&&i.length>=1){var a=i[0];r=(r=n.mobile_mail_typing_1).replace("{name}",a)}else if(2===o&&i.length>=2){var s=i[0],l=i[1];r=(r=(r=n.mobile_mail_typing_2).replace("{name1}",s)).replace("{name2}",l)}else if(o>1&&i.length>=1){var u=i[0];r=(r=(r=n.mobile_mail_typing_many).replace("{name}",u)).replace("{count}",o-1)}return r}(e.typing,e.typingCount)}t.default=function(e){var t=e.dimmed,n=e.animation,l=!!e.compact,u=e.typing,f=(e.typingCount,r.default.class("typing",{dimmed:t,id:e.id,empty:c(u),animation:n})),p=d(e),_=void 0,A=void 0;"audio"===n?(_=(0,s.default)({class:a.default.class("typing__loading",{audio:!0,compact:l})}),A=""):"dots"===n?(_=(0,s.default)({class:a.default.class("typing__loading",{audio:!1,compact:l})}),A=""):"simple-dots"===n&&(_="",A=r.default.html(o));return r.default.html(i,f,_,p,A)},t.Typing_renderNames=d,t.Typing_isEmpty=c},function(e,t,n){"use strict";var i,o=n(322),r=n(231),a=(i=r)&&i.__esModule?i:{default:i};function s(){(0,o.$)(".messenger__dialog").innerHTML=""}Object.assign(a.default,{open:function(e){var t=(0,o.$)(".messenger__dialog"),n=(0,a.default)(e);t.innerHTML=n},close:s,_onDialogClose:s})},function(e,t,n){"use strict";var i=window,o=i.nav,r=i.attr,a=i.ajax,s=function(){var e="_locked",t={1:"SEND_EMAIL",2:"CALL_PHONE",6:"OPEN_GROUP_APP"};return{processButton:function(n,i,s,l,u){var c=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(n.classList.contains(e))return!1;var d=!0;return t[i]&&(d=!1),n.classList.add(e),a.post("/groups",{_ajax:1,act:"proxy_cta_button",action:i,resource:s,group_id:l,hash:u},{onDone:function(){if(n.classList.remove(e),c)c();else if(d){var t=r(n,"href");o.go(t)}}}),!d}}}();window.GroupActionButton=s},function(e,t,n){"use strict";var i=window.each,o={tt:!1,handlers:[],show:function(){o.shown||(o.tt=Array.prototype.slice.call(arguments))},hide:function(){o.tt&&(o.tt=!1)},addHandler:function(e){e&&o.handlers.push(e)},removeHandler:function(e){e?i(o.handlers,function(t){if(e===this)return o.handlers.splice(t,1),!1}):o.handlers=[]},onClose:function(){i(o.handlers,function(){this()})},clear:function(){o.tt&&(o.hide(),o.onClose(),o.removeHandler())},closeByTap:function(e){if(!o.tt||!e.target)return!1;var t=e.target;do{for(var n=0;n<o.tt.length;n++)if(t===o.tt[n])return!1}while(t=t.parentNode);return o.hide(),o.onClose(),!0}};window.tooltip=o},function(e,t,n){"use strict";var i,o=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{!i&&s.return&&s.return()}finally{if(o)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r=n(68),a=(i=r)&&i.__esModule?i:{default:i};var s=window,l=s.registeredEvents,u=s.removeEvent,c=["touchstart","touchend","touchmove","touchcancel"];a.default.onIframeReady(function(e){e.is_api&&l.forEach(function(e){var t=o(e,3),n=t[0],i=t[1],r=t[2];c.indexOf(i)>=0&&u(n,i,r)})})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.emojiRegex=function(){return/(?:\uD83C\uDFF4)(?:(?:\uDB40\uDC67)(?:\uDB40\uDC62)(?:(?:\uDB40\uDC65)(?:\uDB40\uDC6E)(?:\uDB40\uDC67)|(?:\uDB40\uDC77)(?:\uDB40\uDC6C)(?:\uDB40\uDC73)|(?:\uDB40\uDC73)(?:\uDB40\uDC63)(?:\uDB40\uDC74))(?:\uDB40\uDC7F)|\u200D\u2620\uFE0F?)|(?:\uD83D\uDC69)\u200D(?:\uD83D\uDC69)\u200D(?:(?:\uD83D\uDC66)\u200D(?:\uD83D\uDC66)|(?:\uD83D\uDC67)\u200D(?:\uD83D[\uDC66\uDC67]))|(?:\uD83D\uDC68)(?:\u200D(?:\u2764\uFE0F?\u200D(?:(?:\uD83D\uDC8B)\u200D)?(?:\uD83D\uDC68)|(?:\uD83D[\uDC68\uDC69])\u200D(?:(?:\uD83D\uDC66)\u200D(?:\uD83D\uDC66)|(?:\uD83D\uDC67)\u200D(?:\uD83D[\uDC66\uDC67]))|(?:\uD83D\uDC66)\u200D(?:\uD83D\uDC66)|(?:\uD83D\uDC67)\u200D(?:\uD83D[\uDC66\uDC67])|(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDB0-\uDDB3]))|(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDB0-\uDDB3]))|(?:\uD83D\uDC69)\u200D(?:\u2764\uFE0F?\u200D(?:(?:\uD83D\uDC8B)\u200D(?:\uD83D[\uDC68\uDC69])|(?:\uD83D[\uDC68\uDC69]))|(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDB0-\uDDB3]))|(?:\uD83D\uDC69)\u200D(?:\uD83D\uDC66)\u200D(?:\uD83D\uDC66)|(?:(?:\uD83D\uDC41)\uFE0F?\u200D(?:\uD83D\uDDE8)|(?:\uD83D\uDC69)(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]|(?:\uD83D\uDC68)(?:(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]|\u200D[\u2695\u2696\u2708])|(?:(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)\uFE0F?|(?:\uD83D\uDC6F|\uD83E[\uDD3C\uDDDE\uDDDF]))\u200D[\u2640\u2642]|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDD6-\uDDDD])(?:(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|\u200D[\u2640\u2642])|(?:\uD83D\uDC69)\u200D[\u2695\u2696\u2708])\uFE0F?|(?:\uD83D\uDC69)\u200D(?:\uD83D\uDC67)\u200D(?:\uD83D[\uDC66\uDC67])|(?:\uD83D\uDC69)\u200D(?:\uD83D\uDC69)\u200D(?:\uD83D[\uDC66\uDC67])|(?:\uD83D\uDC68)(?:\u200D(?:(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83D[\uDC66\uDC67])|(?:\uD83D[\uDC66\uDC67]))|(?:\uD83C[\uDFFB-\uDFFF]))|(?:\uD83C\uDFF3)\uFE0F?\u200D(?:\uD83C\uDF08)|(?:\uD83D\uDC69)\u200D(?:\uD83D\uDC67)|(?:\uD83D\uDC69)(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDB0-\uDDB3])|(?:\uD83D\uDC69)\u200D(?:\uD83D\uDC66)|(?:\uD83C\uDDF6)(?:\uD83C\uDDE6)|(?:\uD83C\uDDFD)(?:\uD83C\uDDF0)|(?:\uD83C\uDDF4)(?:\uD83C\uDDF2)|(?:\uD83D\uDC69)(?:\uD83C[\uDFFB-\uDFFF])|(?:\uD83C\uDDED)(?:\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA])|(?:\uD83C\uDDEC)(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE])|(?:\uD83C\uDDEA)(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA])|(?:\uD83C\uDDE8)(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF])|(?:\uD83C\uDDF2)(?:\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF])|(?:\uD83C\uDDF3)(?:\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF])|(?:\uD83C\uDDFC)(?:\uD83C[\uDDEB\uDDF8])|(?:\uD83C\uDDFA)(?:\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF])|(?:\uD83C\uDDF0)(?:\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF])|(?:\uD83C\uDDEF)(?:\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5])|(?:\uD83C\uDDF8)(?:\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF])|(?:\uD83C\uDDEE)(?:\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9])|(?:\uD83C\uDDFF)(?:\uD83C[\uDDE6\uDDF2\uDDFC])|(?:\uD83C\uDDEB)(?:\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7])|(?:\uD83C\uDDF5)(?:\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE])|(?:\uD83C\uDDE9)(?:\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF])|(?:\uD83C\uDDF9)(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF])|(?:\uD83C\uDDE7)(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF])|[#\*0-9]\uFE0F?\u20E3|(?:\uD83C\uDDF1)(?:\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE])|(?:\uD83C\uDDE6)(?:\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF])|(?:\uD83C\uDDF7)(?:\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC])|(?:\uD83C\uDDFB)(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA])|(?:\uD83C\uDDFE)(?:\uD83C[\uDDEA\uDDF9])|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u270A-\u270D]|\uD83C[\uDF85\uDFC2\uDFC7]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC70\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDCAA\uDD74\uDD7A\uDD90\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC]|\uD83E[\uDD18-\uDD1C\uDD1E\uDD1F\uDD30-\uDD36\uDDB5\uDDB6\uDDD1-\uDDD5])(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF93\uDFA0-\uDFCA\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDD7A\uDD95\uDD96\uDDA4\uDDFB-\uDE4F\uDE80-\uDEC5\uDECC\uDED0-\uDED2\uDEEB\uDEEC\uDEF4-\uDEF9]|\uD83E[\uDD10-\uDD3A\uDD3C-\uDD3E\uDD40-\uDD45\uDD47-\uDD70\uDD73-\uDD76\uDD7A\uDD7C-\uDDA2\uDDB0-\uDDB9\uDDC0-\uDDC2\uDDD0-\uDDFF])|(?:[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEF9]|\uD83E[\uDD10-\uDD3A\uDD3C-\uDD3E\uDD40-\uDD45\uDD47-\uDD70\uDD73-\uDD76\uDD7A\uDD7C-\uDDA2\uDDB0-\uDDB9\uDDC0-\uDDC2\uDDD0-\uDDFF])\uFE0F?|(?:[\u261D\u26F9\u270A-\u270D]|\uD83C[\uDF85\uDFC2-\uDFC4\uDFC7\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66-\uDC69\uDC6E\uDC70-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDCAA\uDD74\uDD75\uDD7A\uDD90\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD18-\uDD1C\uDD1E\uDD1F\uDD26\uDD30-\uDD39\uDD3D\uDD3E\uDDB5\uDDB6\uDDB8\uDDB9\uDDD1-\uDDDD])/g},t.EMOJI_SECTIONS={1:["😄","😁","😊","😃","🤣","😆","😉","😜","😋","🤗","😍","😎","😒","😏","🙂","🙃","😔","😢","😭","😩","😨","😐","😌","🤤","😇","😰","🤧","😲","🤢","😳","😷","😂","❤","💋","😚","😕","😯","😦","😵","🙄","🤔","😠","😡","😝","😴","😘","😗","😙","😟","🙁","☹","😬","😶","🤐","😫","☺","😀","😥","😛","😖","😤","😣","😧","😑","😅","😮","😞","😓","😱","🤓","🤑","😪","🤒","🤕","🤥","🤠","😈","👿","👽","👻","😸","😹","😼","😽","😾","😿","😻","🙀","😺","🙈","🙉","🙊","💩","💀","👹","👺"],2:["🌱","🌲","🌳","🌴","🌷","🌸","🍅","🍆","🍇","🍈","🍉","🍊","🍋","🍌","🍍","🍎","🍏","🍐","🍑","🐀","🐁","🐂","🐃","🐄","🐅","🐆","🐇","🐈","🐉","🐊","🐋","🐌","🐍","🐎","🐏","🐐","🐑","🐒","🐓","🐔","🐕","🐖","🐗","🐘","🐙","🐚","🐛","🐜","🐝","🐞","🐟","🐠","🐡","🐢","🐣","🐤","🐥","🐦","🐧","🐨","🐪","🐫","🐬","🐭","🐮","🐯","🐰","🐲","🐳","🐴","🐵","🐶","🐷","🐸","🐹","🐺","🐻","🐼","🐽","🐾","🌰","🌵","🌹","🌺","🌻","🌼","🌽","🌾","🌿","🍀","🍁","🍂","🍃","🍄","💦","💧","🦉","🦍","🦏","🦋","🦊","🦈","🦅","🦆","🦇","🦎","🦐","🦑","🥀","🦌"],3:["👍🏻","👎🏻","☝🏻","✌🏻","👌🏻","🖕🏻","🤘🏻","👏🏻","👊🏻","💪🏻","✋🏻","🖐🏻","🖖🏻","🙏🏻","🙌🏻","✊🏻","👆🏻","👇🏻","👈🏻","👉🏻","👋🏻","👐🏻","🤞🏻","🤝","🤙🏻","🤛🏻","🤜🏻","👀","👂🏻","👃🏻","✍🏻","👅","👫","👬","👭","💏","💑","👯","👪","👰","👦","👧","👨","👩","👱","👮","👲","👳","💂","👴","👵","👶","👷","👸","👼","🙇","🤰🏻","💅","💄","👄","💃","🎎","🎅","🚶","👱‍♀️","👮‍♀️","👷‍♀️","🕵‍♀️","🙇‍♀️","🙋‍♂️","🙋","💁‍♂️","💁","🙅‍♂️","🙅","🙆‍♂️","🙆","🙎‍♂️","🙎","💆‍♂️","💆","💇‍♂️","💇","🤷🏻‍♂️","🤷🏻‍♀️","🤦🏻‍♂️","🤦‍♀️","🙍‍♂️","🚶‍♀️","🤳🏻","🏃‍♀️","👯‍♂️","🏌‍♀️","🐱","🤡","🕺","👳‍♀️","💂‍♀️","🤵","🤴","🤹‍♂️","🤹‍♀️","👨‍⚖️","👩‍⚖️","👨‍✈️","👩‍✈️","👨‍🚒️","👩‍🚒️","👨‍🎤️","👩‍🎤️","👨‍🎓️","👩‍🎓️","👨‍🏫️","👩‍🏫️","👨‍🌾️","👩‍🌾️","👨‍🍳️","👩‍🍳️","👨‍🔧️","👩‍🔧️","👨‍🏭️","👩‍🏭️","👨‍💼️","👩‍💼️","👨‍🔬️","👩‍🔬️","👨‍💻️","👩‍💻️","👨‍🎨️","👩‍🎨️","👨‍🚀️","👩‍🚀️","👨‍⚕️","👩‍⚕️"],4:["🍒","🍓","🍔","🍕","🍖","🍗","🍚","🍛","🍜","🍝","🍞","🍟","🍠","🍡","🍢","🍣","🍤","🍥","🍦","🍧","🍨","🍩","🍪","🍫","🍬","🍭","🍮","🍯","🍰","🍱","🍲","🍳","🍴","🍵","🍶","🍷","🍸","🍹","🍺","🍻","🍼","🥙","🥝","🥜","🥘","🥗","🥖","🥓","🥐","🥂","🥑","🥃","🥕","🥔","🥒","🥞","🥚","🥛"],5:["⚽","⚾","🎯","🎱","🎽","🎾","🎿","🏀","🏁","🏂","🏃","🏄","🏆","🏇","🏈","🏉","🏊","👟","🚣","🚴","🚵","⛳","⛪","🤽🏻‍♂️","🤽🏻‍♀️","🤾🏻‍♂️","🤼‍♂️","🤸🏻‍♂️","🏋‍♀️","⛹‍♀️","🏄‍♀️","🏊‍♀️","🚵‍♀️","🚴‍♀️","🤺","🛴","🛶","🥊","🥋","🥅","🥁"],6:["🚅","🚆","🚇","🚈","🚊","🚌","🚍","🚎","🚏","🚐","🚑","🚒","🚓","🚔","🚕","🚖","🚗","🚘","🚙","🚚","🚛","🚜","🚝","🚞","🚟","🚠","🚡","🚤","🚧","🚨","⛵","🚀","🚁","🚂","🚃","🚄","⛽","✈","🛵","🏜"],7:["⏰","⏳","☎","☕","♻","⚡","✂","✉","✏","✒","🀄","🃏","🌂","🌟","🎀","🎁","🎂","🎃","🎄","🎈","🎉","🎊","🎋","🎌","🎍","🎏","🎐","🎒","🎓","🎣","🎤","🎧","🎨","🎩","🎪","🎫","🎬","🎭","🎰","🎲","🎳","🎴","🎷","🎸","🎹","🎺","🎻","👑","👒","👓","👔","👕","👖","👗","👘","👙","👚","👛","👠","👜","👝","👞","👡","👢","👣","👾","💈","💉","💊","💌","💍","💎","💐","💒","💡","💣","💥","💰","💳","💴","💵","💶","💷","💸","💺","💻","💼","💽","💾","💿","📄","📅","📇","📈","📉","📊","📋","📌","📍","📎","📐","📑","📒","📓","📔","📕","📖","📗","📘","📙","📚","📜","📝","📟","📠","📡","📢","📦","📭","📮","📯","📰","📱","📷","📹","📺","📻","📼","🔆","🔎","🔑","🔔","🔖","🔦","🔧","🔨","🔩","🔪","🔫","🔬","🔭","🔮","🔱","🗿","🚪","🚬","🚽","🚿","🛀","🥄","🥇","🥈","🥉","🛒"],8:["💓","💔","💕","💖","💗","💘","💙","💚","💛","💜","💝","💞","💟","💬","💭","🔞","⚠","⛔","🐩","🆘","🌚","🖤","💨","🔥","☀","☁","⛄","❄","⛅","✨","🌍","🌛","🌝","🌞","☄","🌈","🌖","⚕"],9:["🇨🇳","🇩🇪","🇪🇸","🇫🇷","🇬🇧","🇮🇹","🇯🇵","🇰🇷","🇷🇺","🇺🇸","🇺🇦","🇰🇿","🇧🇾","🇦🇺","🇦🇹","🇧🇪","🇧🇷","🇻🇳","🇭🇰","🇩🇰","🇮🇱","🇮🇳","🇮🇩","🇮🇪","🇨🇦","🇨🇴","🇲🇴","🇲🇾","🇲🇽","🇳🇱","🇳🇿","🇳🇴","🇦🇪","🇵🇱","🇵🇹","🇵🇷","🇸🇦","🇸🇬","🇹🇷","🇵🇭","🇫🇮","🇨🇱","🇨🇭","🇸🇪","🇿🇦","🏳‍🌈️","🇦🇷","🇨🇷","🇪🇬","🇭🇷","🇮🇷","🇲🇦","🇳🇬","🇵🇦","🇵🇪","🇷🇸","🇸🇳","🏴󠁧󠁢󠁥󠁮󠁧󠁿","🇺🇾","🇮🇸","🇹🇳"]},t.EMOJI_PREFIXED_REPLACES={e29da4:/(\s|^)([0OО]:\))([\s\.,]|$)/g,f09f9887:/(\s|^)(;-\)+)([\s\.,]|$)/g,f09f9889:/(\s|^)([XХxх]-?D)([\s\.,]|$)/g,f09f9886:/(\s|^)(B-\))([\s\.,]|$)/g,f09f988e:/(\s|^)(3-\))([\s\.,]|$)/g,f09f988c:/(\s|^)(&gt;\()([\s\.,]|$)/g,f09f98a0:/(\s|^)(;[oоOО])([\s\.,]|$)/g,f09f98b0:/(\s|^)(8\|)([\s\.,]|$)/g,f09f98b3:/(\s|^)(8-?[oоOО])([\s\.,]|$)/g,f09f98b2:/(\s|^)(8-\))([\s\.,]|$)/g,f09f988d:/(\s|^)(:[XХ])([\s\.,]|$)/g,f09f98b7:/(\s|^)(:[oоOО])([\s\.,]|$)/g,f09f98a8:/(\s|^)(&lt;3)([\s\.,]|$)/g},t.EMOJI_REPLACES={f09f988a:/(:-\))([\s\.,]|$)/g,f09f9883:/(:-D)([\s\.,]|$)/g,f09f989c:/(;-[PР])([\s\.,]|$)/g,f09f988b:/(:-[pр])([\s\.,]|$)/g,f09f9892:/(:-\()([\s\.,]|$)/g,e298ba:/(:-?\])([\s\.,]|$)/g,f09f988f:/(;-\])([\s\.,]|$)/g,f09f9894:/(3-?\()([\s\.,]|$)/g,f09f98a2:/(:&#039;\()([\s\.,]|$)/g,f09f98ad:/(:_\()([\s\.,]|$)/g,f09f98a9:/(:\(\()([\s\.,]|$)/g,f09f9890:/(:\|)([\s\.,]|$)/g,f09f98a1:/(&gt;\(\()([\s\.,]|$)/g,f09f989a:/(:-\*)([\s\.,]|$)/g,f09f9888:/(\}:\))([\s\.,]|$)/g,f09f918d:/(:like:)([\s\.,]|$)/g,f09f918e:/(:dislike:)([\s\.,]|$)/g,e2989d:/(:up:)([\s\.,]|$)/g,e29c8c:/(:v:)([\s\.,]|$)/g,f09f918c:/(:ok:|:ок:)([\s\.,]|$)/g},t.skinToneModifierRegex=/\uFE0F?\uD83C[\uDFFB-\uDFFF]/},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){if(!("fetch"in window))return function(){};var e=["standalone","fullscreen","minimal-ui"],t="#f8f9fa",n=128,o=48,r=32,a=navigator.vendor&&-1!==navigator.vendor.indexOf("Apple");function s(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=l(e);if((i.drawImage(e,0,0),!n)&&255==i.getImageData(0,0,1,1).data[3])return null;return i.globalCompositeOperation="destination-over",i.fillStyle=t,i.fillRect(0,0,e.width,e.height),i.canvas.toDataURL()}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{width:1,height:1},t=e.width,n=e.height,i=document.createElement("canvas");return i.width=t,i.height=n,i.getContext("2d")}return function(){if(a){var u=document.head.querySelector('link[rel="manifest"]'),c=u?u.href:"",d=function(e){for(var t=function(t){var n=e[t];try{return new URL("",n),{v:function(e){return new URL(e,n).toString()}}}catch(e){}},n=0;n<e.length;++n){var o=t(n);if("object"===(void 0===o?"undefined":i(o)))return o.v}return function(e){return e}}([c,window.location]);Promise.resolve().then(function(){if(!c)throw'can\'t find <link rel="manifest" href=".." />\'';var e={};return"use-credentials"===c.crossOrigin&&(e.credentials="include"),window.fetch(c,e)}).then(function(e){return e.json()}).then(function(i){return function(i,a){var u=i.icons||[];u.sort(function(e,t){return parseInt(t.sizes,10)-parseInt(e.sizes,10)});var c,d,f,p,_=u.map(function(e){var t={rel:"apple-touch-icon",href:a(e.src),sizes:e.sizes};return function(e,t){var n=document.createElement(e);for(var i in t)n.setAttribute(i,t[i]);return n}("link",t)}),A=i.display,m=-1!==e.indexOf(A);function h(e,a,s){var u=e.width,c=e.height,d=window.devicePixelRatio,f=l({width:u*d,height:c*d});if(f.scale(d,d),f.fillStyle=i.background_color||t,f.fillRect(0,0,u,c),f.translate(u/2,(c-r)/2),s){var p=s.width/d,_=s.height/d;_>n&&(p/=_/n,_=n),p>=o&&_>=o&&(f.drawImage(s,p/-2,_/-2,p,_),f.translate(0,_/2+r))}var A=document.createElement("link");return A.setAttribute("rel","apple-touch-startup-image"),A.setAttribute("media","(orientation: "+a+")"),A.setAttribute("href",f.canvas.toDataURL()),A}c=i.background_color||t,d=function(e){var t=l();return t.fillStyle=e,t.fillRect(0,0,1,1),t.getImageData(0,0,1,1).data}(c).map(function(e){var t=e/255;return t<.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}),f=.2126*d[0]+.7152*d[1]+.0722*d[2],Math.abs(1.05/(f+.05)),i.name||i.short_name||document.title,navigator.standalone||(p=m)&&(!0===p&&(p="yes"),function(e,t){var n=document.createElement(e);for(var i in t)n.setAttribute(i,t[i]);document.head.appendChild(n)}("meta",{name:"apple-mobile-web-app-capable",content:p}));var v=new Set;function g(e){var t=h(window.screen,"portrait",e),n=h({width:window.screen.height,height:window.screen.width},"landscape",e);v.forEach(function(e){return e.remove()}),document.head.appendChild(t),document.head.appendChild(n),v.add(t),v.add(n)}if(g(null),_.length){var y=_[0],w=new Image;w.crossOrigin="anonymous",w.onload=function(){if(g(w),i.background_color){var e=s(w,i.background_color);null!==e&&(y.href=e,_.slice(1).forEach(function(e){var t=new Image;t.crossOrigin="anonymous",t.onload=function(){var n=s(t,i.background_color,!0);e.href=n},t.src=e.href}))}},w.src=y.href}}(i,d)}).catch(function(e){return console.warn("pwacompat.js error",e)})}}}();t.default=o},function(e,t,n){"use strict";window.closePostSuggest=function(e,t){return re(geByClass1("post_suggest")),ajax.post("wall.php",{_ajax:1,act:"close_suggest_post",suggest_id:e.getAttribute("data-suggest-id")}),cancelEvent(t)}},function(e,t,n){"use strict";var i=n(207),o=n(183),r=n(1),a=l(n(215)),s=l(n(117));function l(e){return e&&e.__esModule?e:{default:e}}var u=o.HOUR/2,c=o.MINUTE;window.PushNotifier={sw_client:window.sw_client,server_key:"BPrntRk2W1_ISFwlgY-vz9tQDg9i1oSQ3-N8xyjdbNAbIOdZIGFdh5FlO7zn730UwU9Sayoec-Fpqq4JZFTyv60",server_url:"push_notifier",init:function(){var e=this;return this.canBeEnabled().then(function(t){t&&vk.id&&(page.onChange(function(){return e.updateHeadClass()}),e.listenPermission(),Promise.resolve(e.updateSubscription())),Promise.resolve(!1)})},listenPermission:function(){var e=this;navigator.permissions&&navigator.permissions.query&&navigator.permissions.query({name:"notifications"}).then(function(t){t.onchange=function(){e.updateSubscription().then(function(){geByClass1("settingsNotifyPush")&&nav.reload(),e.updateHeadClass()})}})},updateHeadClass:function(){var e=this;this.canBeEnabled().then(function(t){if(t){var n=e.getPermission();document.head&&(removeClass(document.head,"push_notifier_"+o.PUSH_NOTIFIER_PERMISSION_GRANTED),removeClass(document.head,"push_notifier_"+o.PUSH_NOTIFIER_PERMISSION_DENIED),removeClass(document.head,"push_notifier_"+o.PUSH_NOTIFIER_PERMISSION_DEFAULT),n&&addClass(document.head,"push_notifier_"+n),addClass(document.head,"push_notifier_supported"))}})},canBeEnabled:function(){var e=this;return new Promise(function(t){if(!e.isSupported())return t(!1);t(e.isNativeAppInstalled().then(function(e){return!e}))})},isSupported:function(){return"PushManager"in window&&"Notification"in window&&SWClient.isSupported()&&(a.default.chrome||a.default.mozilla)},isNativeAppInstalled:function(){var e=(new Date).getTime(),t=(0,r.lsGet)("push_notifier_related_apps_ts"),n=(0,r.lsGet)("push_notifier_related_apps");return new Promise(function(i){null!==n&&t&&e-t<u?i(!!n):"getInstalledRelatedApps"in navigator?navigator.getInstalledRelatedApps().then(function(t){var n=!1,o=!0,a=!1,s=void 0;try{for(var l,u=t[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){if("com.vkontakte.android"===l.value.id){n=!0;break}}}catch(e){a=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw s}}(0,r.lsSet)("push_notifier_related_apps_ts",e),(0,r.lsSet)("push_notifier_related_apps",n),i(n)}).catch(function(){i(!1)}):i(!1)})},updatePermission:function(){var e=this.getPermission();if(e!==o.PUSH_NOTIFIER_PERMISSION_GRANTED){var t=this.loadEndpoint();if(t)return this.unsubscribe(t).then(function(){return e})}return Promise.resolve(e)},subscribe:function(e){var t=this;return this.connect().then(function(e){return e.pushManager.getSubscription()}).then(function(e){return e||t.sw_client.registration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:(0,i.urlBase64ToUint8Array)(t.server_key)})}).then(function(n){return new Promise(function(i,o){if(e||t.needUpdateSubscription(n)){var r=n.getKey("p256dh"),a=n.getKey("auth");s.default.post(t.server_url,{act:"a_subscribe",endpoint:n.endpoint,key:r?btoa(String.fromCharCode.apply(null,new Uint8Array(n.getKey("p256dh")))):null,token:a?btoa(String.fromCharCode.apply(null,new Uint8Array(n.getKey("auth")))):null},{onDone:function(e){e?(t.saveEndpoint(n.endpoint),i()):o()}})}else i()})})},needUpdateSubscription:function(e){var t=(new Date).getTime(),n=this.loadEndpoint(),i=(0,r.lsGet)("push_notifier_subscribed_ts"+vk.id),o=!1;return(n!=e.endpoint||!i||t-i>c)&&((0,r.lsSet)("push_notifier_subscribed_ts"+vk.id,t),o=!0),o},updateSubscription:function(){var e=this;return this.updatePermission().then(function(t){return t===o.PUSH_NOTIFIER_PERMISSION_GRANTED&&e.subscribe()})},connect:function(){return this.sw_client=this.sw_client||new SWClient,this.sw_client.getRegistration()},unsubscribe:function(e){var t=this;return new Promise(function(n,i){s.default.post(t.server_url,{act:"a_unsubscribe",endpoint:e},{onDone:function(e){e?(t.saveEndpoint(!1),n()):i()}})})},requestPermission:function(){var e=this.getPermission();return e==o.PUSH_NOTIFIER_PERMISSION_DEFAULT?new Promise(function(e,t){var n=Notification.requestPermission(function(t){e(t)});n&&n.then(e,t)}):Promise.resolve(e)},getPermission:function(){return Notification.permission},loadEndpoint:function(){return(0,r.lsGet)("push_notifier_endpoint"+vk.id)||!1},saveEndpoint:function(e){(0,r.lsSet)("push_notifier_endpoint"+vk.id,e||!1)},action:function(e,t){var n=this;return this.connect().then(function(){return n.sw_client.action(e,t)})}},PushNotifier.updateHeadClass()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=t.StickersSettings={autoplay:0,setAutoplay:function(e){this.autoplay=e},getAutoplay:function(){return i.autoplay}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o,r,a=(i=['\n    <div class="','">\n      <div class="mailDialog__overlay" ','></div>\n      <div class="mailDialog__wrap">\n        <div class="mailDialog__content">\n          <div class="mailDialog__close" ','></div>\n          <div class="mailDialog__body">','</div>\n          <div class="mailDialog__footer">\n            <div class="mailDialog__button" ',">",'</div>\n            <div class="mailDialog__button mailDialog__button_secondary" ',">","</div>\n          </div>\n        </div>\n      </div>\n    </div>\n  "],o=['\n    <div class="','">\n      <div class="mailDialog__overlay" ','></div>\n      <div class="mailDialog__wrap">\n        <div class="mailDialog__content">\n          <div class="mailDialog__close" ','></div>\n          <div class="mailDialog__body">','</div>\n          <div class="mailDialog__footer">\n            <div class="mailDialog__button" ',">",'</div>\n            <div class="mailDialog__button mailDialog__button_secondary" ',">","</div>\n          </div>\n        </div>\n      </div>\n    </div>\n  "],Object.freeze(Object.defineProperties(i,{raw:{value:Object.freeze(o)}}))),s=n(77),l=(r=s)&&r.__esModule?r:{default:r};t.default=function(e){var t=e.onClose||l.default.onClick("MailDialog._onDialogClose"),n=l.default.class(e.class,"mailDialog",{});return l.default.html(a,n,t,t,e.body,e.onConfirm,e.confirmText,t,e.cancelText)}},function(e,t,n){"use strict";var i=need("Voting");function o(e){a(e.$voting,e.url)}function r(e,t){a(t.$voting,e)}function a(e,t){var n=setTimeout(function(){i.setLoading(e)},140);ajax.post(t,{_ajax:1},{onDone:function(e,t){clearTimeout(n),i.setHtml(e,t)}})}window.uVoting={},uVoting._onSubmit=o,uVoting._onRevoteClick=r},function(e,t,n){"use strict";var i=n(124),o=n(302),r=n(230);window.Stickers=i.Stickers,window.StickersAnimation=o.StickersAnimation,window.StickersSettings=r.StickersSettings},function(e,t,n){"use strict";var i={uiLastId:0,uiState:{},mail:{}},o={newId:function(){return i.uiLastId++},newState:function(e){var t=o.newId();return i.uiState[t]=e,t},getState:function(e){return i.uiState[e]||(i.uiState[e]={})},injectStore:function(e){i.uiLastId=0,i.uiState={},i.mail={};var t=e.mail,n=t.cur,o=t.rolls,r=t.reached;t.msgs,t.queue;isArray(e.mail.msgs)&&(e.mail.msgs={}),isArray(e.mail.replies)&&(e.mail.replies={}),o&&isArray(o.peer)&&(o.peer={}),o&&isArray(o.search.peers)&&(o.search.peers={}),o&&isArray(o.search.msgs)&&(o.search.msgs={}),r&&isArray(r.search.peers)&&(r.search.peers={}),r&&isArray(r.search.msgs)&&(r.search.msgs={}),r&&isArray(r.peer.before)&&(r.peer.before={}),r&&isArray(r.peer.after)&&(r.peer.after={}),i.uiState=e.uiState,i.uiLastId=e.uiLastId,i.mail=e.mail,i.mail.queue={},n&&(n.msgSelected={},n.msgRemoved={},n.msgAttached={},n.msgReply={},n.keyboards={},n.typings={},n.localOutMsgIds=[]),"notificationsCount"in i||(i.notificationsCount=e.notificationsCount)},injectMail:function(e){var t=i.mail,n=e;isObject(n.msgs)&&Object.keys(n.msgs).forEach(function(e){var i=n.msgs[e],o=t.msgs[e];o&&(o.textShort&&!i.textShort&&(i.textShort=o.textShort),o.textFull&&!i.textFull&&(i.textFull=o.textFull))}),isObject(n.msgs)&&Object.assign(t.msgs,n.msgs),isObject(n.peers)&&Object.assign(t.peers,n.peers),isObject(n.members)&&Object.assign(t.members,n.members),isObject(n.replies)&&Object.assign(t.replies,n.replies),t.page=n.page,n.mrs&&(t.cur.countMR=n.mrs.count,t.rolls.mrs=n.mrs.rolls,t.reached.mrs=n.mrs.reached,t.scraps.mrs=n.mrs.rolls,Object.keys(n.msgs).forEach(function(e){var i=n.msgs[e],o=i.peerId;t.rolls.peer[o]=[i.id],t.reached.peer.after[o]=!0}),t.mrs=n.mrs)}};window.storeMethods=o,window.store=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MailHat_page=t.MailHat_convo=t.MailHat_main=t.MailHat__icon=t.MailHat__Title=t.MailHat=void 0;var i=n(135);n(266),t.MailHat=i.MailHat,t.MailHat__Title=i.MailHat__Title,t.MailHat__icon=i.MailHat__icon,t.MailHat_main=i.MailHat_main,t.MailHat_convo=i.MailHat_convo,t.MailHat_page=i.MailHat_page,window.MailHat_main=i.MailHat_main,window.MailHat_convo=i.MailHat_convo},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=window,o=i.isObject,r=i.extend,a=i.ge,s=i.geByClass1,l=i.val,u=i.addClass,c=i.addEvent,d=i.removeEvent,f=i.setStyle,p=i.cancelEvent,_=i.vkNow,A=i.getW,m=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o(n)||(n={items:n}),this.opts=r({slideClassName:"",onStartChange:!1,onChange:!1,pointsWrap:!1,slideContFn:!1,shownSlidesNum:1},n),this.wrap=a(t),this.parseItems(n.items),this.init()}return e.prototype.parseItems=function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n];"string"==typeof i&&(i={className:i}),i=r({html:"",className:"",pos:t.length},i),t.push(i)}this.items=t},e.prototype.init=function(){if(u("landings_slider_wrap",this.wrap),c(this.wrap,"touchstart mousedown",this.touchStart.bind(this)),this.opts.pointsWrap){var e="";for(var t in this.items)e+='<div class="landings_slider_point"></div>';u("landings_slider_points",this.opts.pointsWrap),l(this.opts.pointsWrap,e)}this.changeSlide(0)},e.prototype.getTouchX=function(e){return e.targetTouches&&e.targetTouches.length>0?e.targetTouches[0].pageX:e.pageX},e.prototype.getTouchY=function(e){return e.targetTouches&&e.targetTouches.length>0?e.touches[0].pageY:e.pageY},e.prototype.touchStart=function(e){var t=this.getTouchX(e),n=this.getTouchY(e),i=this,o=!1,r=!1,a=_(),s=0,l=this.getTouchX(e),u=A(this.wrap);function m(e){if(!r)if(!o&&Math.abs(i.getTouchY(e)-n)>20)r=!0;else{i.lock&&(o=!0,t=i.getTouchX(e),a=_(),i.changeSlide(i.newPos),p(e),i.lock=0,clearTimeout(i.changeTimeout));var c=i.getTouchX(e),d=t-c;(Math.abs(d)>20||o)&&(p(e),o||(t=i.getTouchX(e),d=0,o=!0),s=d,l=c,d=-(100+d/u*100),d-=100*i.opts.shownSlidesNum-100,f(i.helper,"transform","translateX("+d+"%)"))}}function h(e){if(d(bodyNode,"mousemove touchmove",m),d(bodyNode,"mouseup touchend touchcancel",h),!i.lock)if(i.lock=1,Math.abs(s)>50){var n=s<0?"prev":"next",o=Math.abs(l-t)/(a/_());o+=.2*o;var r=100*i.opts.shownSlidesNum;r="next"==n?100+r:r-100,f(i.helper,{transition:"transform "+o+"ms",transform:"translateX(-"+r+"%)"});var u=i.items.length-1,c="prev"==n?i.pos-1:i.pos+1;c<0?c=u:c>u&&(c=0),i.opts.onStartChange&&i.opts.onStartChange(c,n),i.newPos=c,i.changeTimeout=setTimeout(function(){i.lock=0,i.changeSlide(c)},o)}else f(i.helper,{transition:"transform 200ms",transform:"translateX(-"+100*i.opts.shownSlidesNum+"%)"}),setTimeout(function(){i.lock=0},200)}d(bodyNode,"mousemove touchmove",m),d(bodyNode,"mouseup touchend touchcancel",h),c(bodyNode,"mousemove touchmove",m),c(bodyNode,"mouseup touchend touchcancel",h)},e.prototype.makeItem=function(e){var t=this.pos==e.pos?"_active_slide ":"",n=this.opts.slideContFn?this.opts.slideContFn(e):e.html;return'<div class="landings_slider_item '+t+e.className+" "+this.opts.slideClassName+'">'+n+"</div>"},e.prototype.getSlidesHtml=function(e){for(var t=this.opts.shownSlidesNum,n=this.items.length-1,i="",o=e,r=0;r<t;r++)--o<0&&(o=n),i=this.makeItem(this.items[o])+i;i+=this.makeItem(this.items[e]),o=e;for(var a=0;a<t;a++)++o>n&&(o=0),i+=this.makeItem(this.items[o]);return i},e.prototype.changeSlide=function(e){if(this.pos=Math.max(0,Math.min(e,this.items.length-1)),this.replaceHtml(this.getSlidesHtml(this.pos)),this.opts.onChange&&this.opts.onChange(this.pos),this.opts.pointsWrap){var t=a(this.opts.pointsWrap);removeClass("selected",s("selected",t)),u("selected",t.children[this.pos])}},e.prototype.replaceHtml=function(e){l(this.wrap,'<div class="landings_slider_helper">'+e+"</div>"),this.helper=s("landings_slider_helper",this.wrap),f(this.helper,"transform","translateX(-"+100*this.opts.shownSlidesNum+"%)")},e.prototype.toSlide=function(e,t){this.lock=1;var n=this.makeItem(this.items[this.pos]),i=this.makeItem(this.items[e]);e>this.pos?n+=i:n=i+n,this.replaceHtml(n),t||(t=e>this.pos?"next":"prev");var o="next"==t?0:-100;f(this.helper,"transform","translateX("+o+"%)"),this.opts.onStartChange&&this.opts.onStartChange(e,t);var r=this;clearTimeout(this.toSlideTimer),this.toSlideTimer=setTimeout(function(){o="next"==t?-100:0,f(r.helper,{transition:"transform 200ms",transform:"translateX("+o+"%)"}),r.toSlideTimer=setTimeout(function(){r.lock=0,r.changeSlide(e)},200)},10)},e}();t.default=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{!i&&s.return&&s.return()}finally{if(o)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.initPhotoCarousel=function(e,t){var n=domQuery1("[data-sizes]",e),r=JSON.parse(domData(n,"sizes")),a=(domData(n,"media-links")||"").split(",");if(r.length<=1||domData(e,"carousel-inited"))return;if(domData(e,"carousel-inited",1),t.mobile){var s=function(e,t){var n=geByClass1("article_photo_carousel__controls",t),r=geByClass1("article_photo_carousel__counter",t),a=domData(r,"counter-lang")||getLang("global_article_carousel_counter"),s=getSize(geByClass1("article_figure_content",t)),l=domPN(geByTag1("img",t)),u=0,c=void 0,d=0,f=void 0,p=void 0,_=0,A=!1,m=!1,h=!1;n.addEventListener("touchstart",function(e){p=e.touches[0].pageX,f=e.touches[0].pageY});var v=!1,g=void 0;return n.addEventListener("touchmove",function(n){if(m||!(Math.abs(n.touches[0].pageY-f)>5||A)){if(!h&&(d=n.touches[0].pageX-p,!(Math.abs(d)<10)||v)){m||window.addEventListener("touchmove",g=function(e){return cancelEvent(e)},{passive:!1}),m=!0,v=!0;var r=Math.min(e.length-1,Math.max(0,u+(d<0?1:-1))),a=0===r&&0===u,y=r===e.length-1&&u===e.length-1;if(_!==r)if(_=r,re(c),a||y)c=!1;else{var w=(0,o.getAppropriateImage)(e[r],s[0],!0),b=i(w,1)[0];c=ce("div",{innerHTML:'<img src="'+b+'">'}),setStyle(domFC(c),{"max-width":s[0],"max-height":s[1],width:"initial"}),setStyle(c,{transform:"scale(1.05)",opacity:0}),domInsertBefore(c,domPN(geByTag1("img",t)))}var D=Math.abs(d),C=0;C=a||y?.2*d:d,setStyle(l,{transform:"translateX("+C+"px)"}),c&&setStyle(c,{transform:"scale("+Math.max(1,1.05-5e-4*D)+")",opacity:Math.min(1,.01*D)})}}else A=!0}),n.addEventListener("touchend",function(){v=!1,A=!1,h=!0,m=!1,g&&window.removeEventListener("touchmove",g);var n=d<0,f=Math.abs(d)<50||!c;if(!f){for(var p=u=_;p<Math.min(u+3,e.length);p++){var y=(0,o.getAppropriateImage)(e[p],s[0],!0),w=i(y,1)[0];(0,o.preloadImage)(w)}domData(t,"photo-carousel-index",u)}r.innerHTML=a.replace("{counter}",u+1).replace("{total}",e.length),addClass(l,"with_transition"),addClass(c,"with_transition"),setTimeout(function(){f?(setStyle(l,{transform:"translateX(0px)",opacity:1}),setStyle(c,{transform:"scale(1.05)",opacity:0})):(setStyle(l,{transform:"translateX("+(n?"-500px":"500px")+")"}),setStyle(c,{transform:"scale(1)",opacity:1}))}),setTimeout(function(){h=!1,_=!1,removeClass(l,"with_transition"),removeClass(c,"with_transition"),f?re(c):(re(l),l=c),c=!1},150)}),function(n){var c=(0,o.getAppropriateImage)(e[n],s[0],!0),d=i(c,1)[0],f=geByTag1("img",t);f.src=d,u=_=n,domData(t,"photo-carousel-index",u),l=domPN(f),r.innerHTML=a.replace("{counter}",u+1).replace("{total}",e.length)}}(r,e);return s}var l=function(e,t,n,r){var a=0,s=geByClass1("article_photo_carousel__controls",t),l=geByClass1("article_photo_carousel__counter",t),u=domData(l,"counter-lang")||getLang("global_article_carousel_counter"),c=getSize(geByClass1("article_figure_content",t)),d=domPN(geByTag1("img",t)),f=geByClass1("article_photo_carousel__left",t),p=geByClass1("article_photo_carousel__right",t);function _(s){a+=s,a=Math.min(e.length-1,Math.max(0,a));var _=(0,o.getAppropriateImage)(e[a],c[0],!0),A=i(_,1),m=A[0],h="";if(n.moderDeletePhoto){var v=r[a];h='<a href="'+v+'" target="_blank" class="flat_button article_photo_moder_open">Открыть</a>'}var g=s<0?"fading_in_left":"fading_in_right",y=se('<div class="'+g+'"><img src="'+m+'">'+h+"</div>");setStyle(domFC(y),{"max-width":c[0],"max-height":Math.ceil(c[1])+1,width:"initial"}),domInsertAfter(y,domPN(geByTag1("img",t)));var w=d;setTimeout(function(){removeClass(y,"fading_in_left"),removeClass(y,"fading_in_right"),addClass(w,"fading_out")}),setTimeout(function(){re(w)},150);for(var b=a;b<Math.min(a+3,e.length);b++){var D=(0,o.getAppropriateImage)(e[b],c[0],!0),C=i(D,1),E=C[0];(0,o.preloadImage)(E)}d=y,l.innerHTML=u.replace("{counter}",a+1).replace("{total}",e.length),toggle(f,a>0),toggle(p,a<e.length-1),domData(t,"photo-carousel-index",a)}var A=void 0;function m(e){clearTimeout(A),toggleClass(s,"article_photo_carousel__mouse_idle",e)}var h=browser.msie&&intval(browser.version)<=11;return p.addEventListener("click",function(e){return _(1),h||t.dispatchEvent(new Event("mousemove")),cancelEvent(e)}),f.addEventListener("click",function(e){return _(-1),h||t.dispatchEvent(new Event("mousemove")),cancelEvent(e)}),t.addEventListener("mousemove",function(){m(!1),addClass(s,"article_photo_carousel__mouse_over"),clearTimeout(A),A=setTimeout(function(){m(!0)},1e3)}),t.addEventListener("mouseleave",function(){clearTimeout(A),removeClass(s,"article_photo_carousel__mouse_over"),removeClass(s,"article_photo_carousel__mouse_idle")}),_}(r,e,t,a);data(e,"changePhotoFunction",l)};var o=n(43)},function(e,t,n){(function(e){var i=void 0!==e&&e||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;function r(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new r(o.call(setTimeout,i,arguments),clearTimeout)},t.setInterval=function(){return new r(o.call(setInterval,i,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(i,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n(254),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(100))},function(e,t,n){"use strict";var i=r(n(335)),o=r(n(329));function r(e){return e&&e.__esModule?e:{default:e}}window.isNewLongpoll?window.im=o.default:window.im=i.default},function(e,t,n){"use strict";var i=n(183);function o(e){PushNotifier.canBeEnabled().then(function(t){var n=!!e.$control&&geByTag1("input",e.$control);if(n){if(t){var o=PushNotifier.getPermission();return o===i.PUSH_NOTIFIER_PERMISSION_DENIED?(n.checked=!1,void addClass("Popup_open",geByClass1("pageAllowPushPopup"))):o!==i.PUSH_NOTIFIER_PERMISSION_GRANTED&&e.checked?void(o===i.PUSH_NOTIFIER_PERMISSION_DEFAULT&&PushNotifier.requestPermission().then(function(t){t===i.PUSH_NOTIFIER_PERMISSION_GRANTED?PushNotifier.subscribe(!0).then(function(){return r(e)}):n.checked=!1})):PushNotifier.subscribe(!0).then(function(){return r(e)})}n.checked=!1}})}function r(e){var t=ce("input",{type:"submit"},{display:"none"});e.$control.form.appendChild(t),ajax.click(t),e.$control.form.removeChild(t)}window.SettingsNotifyPush={},SettingsNotifyPush._onSwitch=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(210),r=(i=o)&&i.__esModule?i:{default:i};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{class:"SnackbarItem",inner:[{class:"SnackbarItem__table",inner:[e.text?{class:r.default.class("SnackbarItem__cell",{text:!0}),inner:{class:"SnackbarItem__text",inner:Wd.wrap(e.text)}}:null,e.action?{class:r.default.class("SnackbarItem__cell",{action:!0}),inner:{class:"SnackbarItem__action",href:e.action.url,onclick:e.action.onclick,inner:Wd.wrap(e.action.text),attrs:e.action.attrs}}:null]}]}}},function(e,t,n){"use strict";var i=n(322),o=l(n(77)),r=l(n(72)),a=n(324),s=l(a);function l(e){return e&&e.__esModule?e:{default:e}}var u=need("Voting");Object.assign(s.default,{class:"msg",onClick:(0,r.default)("msgId"),onRestoreClick:(0,r.default)("msgId"),onReplyClick:(0,r.default)("link","msgId"),onForward:(0,r.default)("msgId"),getElem:function(e){return(0,i.$)(".msg_id_"+e)},remove:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]?(0,i.$$)(".msg_id_"+e).forEach(function(e){return e.remove()}):_(e,!1)},spam:function(e){_(e,!0)},restore:function(e){(0,i.$$)(".msg_id_"+e).forEach(function(e){e.classList.remove("msg_removed"),e.classList.remove("msg_spam")})},unselectAll:function(){(0,i.$$)(".msg_selected").forEach(function(e){return e.classList.remove("msg_selected")})},getReplyHTML:function(e){var t=(0,i.$)(".msg_id_"+e+" .msg__replyLink");if(!t)return"";return t.innerHTML},toggleImportant:function(e,t){[].concat(e).forEach(function(e){var n=(0,i.$)(".msg_id_"+e);n&&n.classList.toggle("msg_important",t)})},markAsRead:function(e){(0,i.$$)(".msg_id_"+e).forEach(function(e){return e.classList.remove("msg_unread")})},getId:function(e){var t=o.default.parseClass(c.msg,e.className);return Number(t.id)},getTextHtml:function(e){return e.$(d.text).innerHTML}}),s.default._onClick=A,s.default._onTouchStart=m,s.default._onRestoreClick=p,s.default._onActionClick=h,s.default._onReplyClick=g;var c={msg:"msg"},d={text:".msg__text"},f=!1;function p(e,t){e.stopPropagation(),t=parseInt(t,10),s.default.onRestoreClick(t)}function _(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=(0,a.Msg_renderRestoreInner)(e);(0,i.$$)(".msg_id_"+e).forEach(function(e){e.$(".msg__restore").innerHTML=n,e.classList.remove("msg_selected"),e.classList.add("msg_removed"),e.classList.toggle("msg_spam",t)})}function A(e,t,n){for(var i=e.target;i!==t;){if("A"===i.tagName||"BUTTON"===i.tagName||i.getAttribute("onclick")||i.classList.contains("im_msg_audiomsg")||i.classList.contains("articleSnippet__block")||i.classList.contains("MailButton")||i.closest("."+u.cls))return;i=i.parentElement}f?f=!1:v()||t.classList.contains("msg_removed")||t.classList.contains("msg_spam")||store.mail.cur.editing||(t.classList.toggle("msg_selected"),s.default.onClick(n))}function m(){v()&&(f=!0)}function h(e,t,n){switch(t){case"forward":s.default.onForward(n)}}function v(){return window.getSelection().toString().length>0}function g(e,t,n){e.preventDefault(),s.default.onReplyClick(t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onConfirmDelete=void 0;var i,o,r=(i=["\n    ","\n    ","\n  "],o=["\n    ","\n    ","\n  "],Object.freeze(Object.defineProperties(i,{raw:{value:Object.freeze(o)}})));t.open=function(e){l.default.open({body:function(e){var t=e.isEditing,n=e.canDeleteForAll,i=void 0,o=void 0;if(t)i=lang.mobile_mail_dialog_msg_delete_for_all;else{var s=Object.keys(store.mail.cur.msgSelected).length;i=langNumeric(s,lang.mobile_mail_dialog_msg_delete_N)}if(!t&&n){var l=lang.mobile_mail_delete_for_all,u=function(){if("boolean"!=typeof d){var e=!!lsGet("delete_message_for_all_checked");d=e}return d}()?"checked":"";o='\n      <div class="MsgDeleteDialog__checkbox">\n        <label class="MsgDeleteDialog__checkboxIn">\n          <input type="checkbox" class="'+c+'" '+u+'>\n          <span class="MsgDeleteDialog__checkboxLabel">'+l+"</span>\n        </label>\n      </div>\n    "}return a.default.html(r,i,o)}(e),confirmText:lang.mobile_mail_delete_popup_delete,cancelText:lang.mobile_mail_delete_popup_cancel,onConfirm:a.default.onClick("MsgDeleteDialog.onConfirmDelete"),onClose:a.default.onClick("MsgDeleteDialog.close")})},t.close=function(){var e=$("."+c);e&&(d=e.checked,lsSet("delete_message_for_all_checked",d));l.default.close()},t.isDeleteMessagesForAll=function(){var e=$("."+c);return!!e&&e.checked};var a=u(n(77)),s=u(n(72)),l=u(n(212));function u(e){return e&&e.__esModule?e:{default:e}}var c="MsgDeleteDialog__checkboxInput",d=null;t.onConfirmDelete=(0,s.default)()},function(e,t,n){"use strict";var i,o=n(215),r=(i=o)&&i.__esModule?i:{default:i};var a=window,s=a.isUndefined,l=a.getX,u=a.getY,c=a.vkNow,d=a.clog,f=a.cancelEvent,p=a.getW,_=a.setStyle,A=a.getH,m=a.scrollTop,h=a.getCh,v=a.preventEvent,g=a.extend,y=a.hasClass,w=a.gpeByClass,b=a.attr,D=a.toggleClass,C=a.geByClass1,E=a.removeClass,S=a.addClass,k=a.geByClass,M=a.addEvent,T=a.onBodyResize,x=a.removeEvent,I=window.thover;window.Scroller=function(e,t){var n,i,o,a,P,B=t&&t.ignoreMouseWheel,F=t&&t.noAutoScroll,L=!s(document.ontouchmove),O=!0,N=!1,R=!1,j=!1,H=!1,V=0,$=0,U=!1,z=0,q=!1,W=!1,Y=!1,G=!1;function X(e){var t=e.touches,n=l(i),o=u(i);return{x:((t&&t[0]?t[0].pageX:e.pageX)||0)-n,y:((t&&t[0]?t[0].pageY:e.pageY)||0)-o}}function Q(e){U||(U=[]),U.push([c(),e]),U=U.slice(-20)}function K(){U=!1}function J(){if(!U||U.length<2)return[0,0,0];for(var e=c(),t=!1,n=U.pop(),i=U.length-1;i>=0&&!((o=e-U[i][0])>150);i--)t=U[i];if(!t||!n)return[0,0,0];var o,r=n[1].x-t[1].x,a=n[1].y-t[1].y,s=Math.sqrt(r*r+a*a);return(o=n[0]-t[0])?[s/o,r/o,a/o]:[0,0,0]}function Z(e){"touchstart"==e.type?O=!e.touches||1==e.touches.length:"touchmove"==e.type?O=!1:"click"==e.type&&(O||(f(e),O=!0))}function ee(e){if(!(window.isNewMail&&e.target.closest(".stickers_panel")&&e.target.closest(".messenger")||G&&e.touches&&e.touches.length>1)){if(K(),R){if($<=1)return}else if(p(i)-p(o)>=0)return;j=X(e),Q(H=j),Y=!0,_.animate(o)}}function te(e){if(j&&(G||Y)){I&&I.cancel(e);var t=X(e);if(Q(H=t),Y){var n=j.x-t.x,r=j.y-t.y;if(Math.abs(n)>=Math.abs(r)&&(f(e),G=!0),Y=!1,G){var a=u(i),s=A(i),l=m(),c=h();!F&&(a-7<l?m(a-7):a+s+7>l+c&&m(a+s+7-c))}}if(G)if(f(e),R){var d=p(i);n=j.x-t.x,(V<=0&&n<0||V>=$-1&&n>0)&&(n/=3);var v=-V-n/d,g=N?100*v+"%":v*d;_.transform(o,{translate:[g,0]})}else{var y=p(i)-p(o);n=j.x-t.x,v=z-n,y>0&&(y=0),re(g=v<y?y-(y-v)/3:v>0?0+(v-0)/3:z-n),_.transform(o,{translate:[g,0]})}}}function ne(e){if(j&&G){if(f(e),R){var t=4.7*J()[1],n=j.x-H.x,r=p(i),a=Math.abs(n)>=r/2;(V>0&&(a&&n<0||t>1)||V<$-1&&(a&&n>0||t<-1))&&(V+=n>0?1:-1);var s=-V,l=N?100*s+"%":s*r;j=!1,K(),ae(),_.animate(o,"transform",{duration:200,func:"ease"}),_.transform(o,{translate:[l,0]})}else{var u=function(){if(!U)return!1;var e=J(),t=e[0],n=e[1];if(K(),!t)return!1;var i=t/4.7,o=n*i-4.7*i*i/2;return d("dx",o*=140,"t",i*=530),!(t<.1||!o)&&{dx:o,t:i}}(),c=p(i)-p(o);n=j.x-H.x,s=z-n,u&&(s+=u.dx),c>0&&(c=0),z=s<c?c:s>0?0:s;var A={duration:200,func:"ease"};u&&(A={duration:u.t,func:"cubic-bezier(0, 1, 1, 1)"}),re(z),_.animate(o,"transform",A),_.transform(o,{translate:[z,0]})}G=!1}}function ie(e){if(!(B||window.isNewMail&&e.target.closest(".stickers_panel")&&e.target.closest(".messenger"))){if(v(e),R){if($<=1)return}else if((n=p(i)-p(o))>=0)return;var t=(e.detail?e.detail:e.wheelDelta)>0?3:-3;if(!1===q&&(q=0),q+=t,!R){var n=p(i)-p(o),r=z-q;if(n>0&&(n=0),r<n)var a=n-(n-r)/3;else a=r>0?0+(r-0)/3:z-q;re(a),_.transform(o,{translate:[a,0]})}clearTimeout(W),W=setTimeout(function(){if(R){(V>0&&q<0||V<$-1&&q>0)&&(V+=q>0?1:-1);var e=-V,t=p(i),n=N?100*e+"%":e*t;ae(),_.animate(o,"transform",{duration:200,func:"ease"}),_.transform(o,{translate:[n,0]})}else{var r=p(i)-p(o);e=z-q,r>0&&(r=0),e<r?z=r:e>0?z=0:z-=q,re(n),_.animate(o,"transform",{duration:200,func:"ease"}),_.transform(o,{translate:[z,0]})}q=!1},200)}}function oe(e){if(R){var t=V;if(e&&e.target){var n=y("sp_ppt",e.target)?e.target:w("sp_ppt",e.target),r=+b(n,"data-i");V=r<0?0:r>$-1?$-1:r}j=!1,K(),G=!1;var a=p(i),s=-V,l=N?100*s+"%":s*a;ae(),t!=V&&_.animate(o,"transform",{duration:200,func:"ease"}),_.transform(o,{translate:[l,0]})}}function re(e){if(!R){e=e||z;var t=p(i)-p(o);D("sw_left",i,e<0),D("sw_right",i,e>t)}}function ae(){if(R){var e=C("sp_ppt_sel",n);e&&e===P[V]||(E("sp_ppt_sel",e),S("sp_ppt_sel",P[V]))}}g(this,{init:function(){i=C("scroller_wrap",n),o=C("scroller_cont",i),R?(a=C("sp_pages_pts",n),P=k("sp_ppt",a),$=(k("scroller_page",o)||[]).length,V=0,ae()):re(z=0),U=!1,_.transform(o,{translate:[0,0]}),L?(M(i,"touchstart touchmove click",Z),M(i,"touchstart",ee),M(i,"touchmove",te),M(i,"touchend touchcancel",ne)):(M(i,"mousewheel",ie),M(a,"click",oe)),N||T(oe)},destroy:function(){L?(x(i,"touchstart touchmove click",Z),x(i,"touchstart",ee),x(i,"touchmove",te),x(i,"touchend touchcancel",ne)):(x(i,"mousewheel",ie),x(a,"click",oe)),N||T("__clear",oe)},onShow:function(){R?ae():re(z)},canClick:function(){return O}}),n=e,(t=t||{}).byPage?(R=!0,N=!r.default.android):(R=!1,N=!1,this.showElem=function(e){if(!R){var t=l(e)-l(i),n=t+z,r=n+p(e),a=p(i),s=!1;n<0?s=0-t+20:r>a&&(s=a-p(e)-t-20);var u=p(i)-p(o);u>0&&(u=0),s<u?s=u:s>0&&(s=0),d(t,z,n,r,0,a,s),!1!==s&&(re(z=s),_.animate(o,"transform",{duration:200,func:"ease"}),_.transform(o,{translate:[z,0]}))}})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isContactPeer=function(e){return e>19e8&&e<=2e9}},function(e,t,n){"use strict";var i=n(1),o=a(n(346)),r=a(n(117));function a(e){return e&&e.__esModule?e:{default:e}}window.uCloseProfileSwitcher={},uCloseProfileSwitcher._onConfirmClick=l;var s=null;function l(e,t){var n=t.checked;o.default.clear();var a={is_closed:n?"1":"0",_ajax:1};r.default.post(e,a,{onDone:function(){o.default.reload();var e=window.cur;s=(0,i.scrollTop)(),e.destroy.push(u)}})}function u(){(0,i.scrollTop)(s),requestAnimationFrame(function(){(0,i.scrollTop)(s),requestAnimationFrame(function(){(0,i.scrollTop)(s)})})}},function(e,t,n){"use strict";n(78),n(74),n(26)},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=function(e){m&&y();g(e)},t.preventDocumentScroll=g,t.restoreDocumentScroll=function(){if(!m)return;m=!1,y(),1===h.length&&(v.layoutOffset=null,j(),document.body.style.height="");v.layoutElement=null,h.pop(),v=h.length?h[h.length-1]:null,v&&j();removeEvent(window,"focusin",B),removeEvent(window,"focusout",F),removeEvent(document,"touchmove",I,{capture:!0}),removeEvent(document,"touchmove",P,{capture:!1}),removeEvent(window,"resize",k),removeEvent(window,"orientationchange",M),removeEvent(window,"resize",T),removeEvent(window,"scroll",x)},t.cleanDocumentViews=y,t.allowScrolling=w,t.setScrollView=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(browser.iphone||browser.ipod||browser.ipad))return;if(!1===t.override&&e.__ScrollView)return;if(!0!==t.standalone){if(!m)return;e.__ScrollView||v.scrollViews.push(e)}e.__ScrollView={allowX:!1!==t.allowX,allowY:!1!==t.allowY,overscrollX:!1!==t.overscrollX,overscrollY:!1!==t.overscrollY,standalone:!0===t.standalone},v&&(browser.wkwebview||(!1!==t.topBanner&&(e.__ScrollView.topBanner=t.topBanner||{hide:30,show:60}),addEvent(e,"scroll",E)),addEvent(e,"scroll",S));addEvent(e,"touchstart",b),addEvent(e,"touchmove",w),addEvent(e,"touchend",D)},t.cleanScrollView=C,t.hideTopBanner=O,t.showTopBanner=N;var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(149)),o=n(322);var r=".layout",a=!0,s=void 0,l=void 0,u=void 0,c=!1,d="closed",f=!1,p=void 0,_=void 0,A=void 0,m=!1,h=[],v=void 0;function g(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(browser.iphone||browser.ipod||browser.ipad)&&(!0!==e.stack&&m||(v={initialized:!1,scrollViews:[]},h.push(v),e.layoutElement&&e.layoutElement.nodeType?v.layoutElement=e.layoutElement:v.layoutElement=(0,o.$)(e.layoutElement||r)),!1===e.topBanner?v.topBanner=!1:v.topBanner=!0,m||(m=!0,addEvent(window,"focusin",B),addEvent(window,"focusout",F),addEvent(document,"touchmove",I,{capture:!0}),addEvent(document,"touchmove",P,{capture:!1}),addEvent(window,"resize",k),browser.wkwebview||(addEvent(window,"orientationchange",M),requestAnimationFrame(function(){R()?M(null,!0):(k(),v.topBanner?u||requestAnimationFrame(N):requestAnimationFrame(O))}))))}function y(){v.scrollViews.forEach(function(e){return C(e)}),v.scrollViews=[]}function w(e){var t=e.currentTarget.__ScrollView;if("prevented"!==t.state){if(!("start"!==t.state||t.allowX&&t.allowY)){var n=Math.abs(t.startX-e.changedTouches[0].clientX),i=Math.abs(t.startY-e.changedTouches[0].clientY);if(!t.allowX&&n>i)return void(t.state="prevented");if(!t.allowY&&i>n)return void(t.state="prevented")}if("allowed"!==t.state&&(t.state="allowed"),a=!1,!t.overscrollX){var o=e.currentTarget.scrollLeft,r=t.startX-e.changedTouches[0].clientX;(o<=0&&r<=0||o>=t.maxX&&r>=0)&&(a=!0,t.standalone&&e.preventDefault())}if(!t.overscrollY){var s=e.currentTarget.scrollTop,l=t.startY-e.changedTouches[0].clientY;(s<=0&&l<=0||s>=t.maxY&&l>=0)&&(a=!0,t.standalone&&e.preventDefault())}}}function b(e){var t=e.currentTarget,n=t.__ScrollView;n.state="start",n.startX=e.changedTouches[0].clientX,n.startY=e.changedTouches[0].clientY,n.maxX=n.overscrollX?null:t.scrollWidth-t.clientWidth,n.maxY=n.overscrollY?null:t.scrollHeight-t.clientHeight}function D(e){e.currentTarget.__ScrollView.state=""}function C(e){e.__ScrollView=null,removeEvent(e,"touchstart",b),removeEvent(e,"touchmove",w),removeEvent(e,"touchend",D),removeEvent(e,"scroll",E),removeEvent(e,"scroll",S)}function E(e){if("closed"!==d||R())return c=!1,void(p&&clearTimeout(p));c=!0;var t=e.target.__ScrollView.topBanner;v.topBanner&&t?L(e.target,t.show,t.hide):L(e.target,1/0,0),p&&clearTimeout(p),p=setTimeout(function(){c=!1,k()},100)}function S(e){var t,n,o,r;"closed"!==d&&(t=e.target,n=t.scrollTop,o=t.offsetHeight,(r=t.scrollHeight-(n+o))<-20&&!f?(f=!0,i.adjustBottom()):r>10&&f&&(f=!1))}function k(){if(!c)if(A)A=!1;else if(!R()){window.pageYOffset;"closed"===d&&(browser.wkwebview||(s=document.documentElement.offsetHeight,l=innerHeight,u=s===l,v.layoutHeight!==s&&(v.layoutHeight=s,document.body.style.height=s+"px"),"show"===_?(_=null,requestAnimationFrame(N)):"hide"===_&&(_=null,requestAnimationFrame(O))))}}function M(e,t){browser.ipad?v.topBanner||setTimeout(function(){O()},400):90===Math.abs(window.orientation)?(addEvent(window,"resize",T),document.body.style.height="",v.layoutHeight=null,t?setTimeout(function(){window.scrollTo(0,-300),T()}):setTimeout(function(){window.scrollTo(0,-300)},400)):(removeEvent(window,"resize",T),v.layoutOffset=null,j(),v.topBanner||setTimeout(function(){O()},400))}function T(){if("closed"===d){var e=document.body.offsetHeight,t=e-innerHeight;v.layoutOffset=t,j(),window.scrollTo(0,e)}}function x(){pageYOffset&&(d="opened",removeEvent(window,"scroll",x))}function I(e){a=!0}function P(e){a&&e.preventDefault()}function B(e){d="opening",f=!1,addEvent(window,"scroll",x),i.onOpen()}function F(e){removeEvent(window,"scroll",x),setTimeout(function(){"closed"===d&&(scrollTo(0,0),k())}),d="closed",f=!1,i.onClose()}function L(e,t,n){var i=e.scrollTop;i<=-t&&(u||_)?(_="show",window.scrollTo(0,-10)):i>=n&&(!u||_)&&(_="hide",window.scrollTo(0,10))}function O(){window.scrollTo(0,300)}function N(){window.scrollTo(0,-300)}function R(){return 90===Math.abs(window.orientation)&&!browser.ipad}function j(){var e=v.layoutOffset;v.layoutElement.style.top=e?e+"px":""}},function(e,t,n){"use strict";var i=10;window.CreatePost={setMaxAttach:function(e){i=e},checkAttaches:function(){CreatePost.toggleEnableAttaches(mediaUpload.getAttachesCount()<i)},toggleEnableAttaches:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];geByClass("cp_attach_btn","feed_add_form").forEach(function(t){t.classList.toggle("cp_disabled_btn",!e)}),["photo","video","audio","doc","poll"].forEach(function(t){Unfold.toggleItemEnabled(Unfold.getByName("attaches"),t,e)})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uTyping_getNames=t.uTyping_getPeerTyping=void 0;var i,o=n(112);(i=o)&&i.__esModule;t.default=function(){},t.uTyping_getPeerTyping=function(e){var t=store.mail.cur.typings[e];if(!t)return null;return t.mixed||t.audio||t.text},t.uTyping_getNames=function(e){if(!e)return[];for(var t=store.mail.members,n=e.users,i=n.length,o=[],r=0;r<i;r++){var a=t[n[r]].name;o.push(a)}return o}},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var i,o,r,a,s,l=1,u={},c=!1,d=e.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(e);f=f&&f.setTimeout?f:e,"[object process]"==={}.toString.call(e.process)?i=function(e){t.nextTick(function(){_(e)})}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((r=new MessageChannel).port1.onmessage=function(e){_(e.data)},i=function(e){r.port2.postMessage(e)}):d&&"onreadystatechange"in d.createElement("script")?(o=d.documentElement,i=function(e){var t=d.createElement("script");t.onreadystatechange=function(){_(e),t.onreadystatechange=null,o.removeChild(t),t=null},o.appendChild(t)}):i=function(e){setTimeout(_,0,e)}:(a="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&_(+t.data.slice(a.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),i=function(t){e.postMessage(a+t,"*")}),f.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var o={callback:e,args:t};return u[l]=o,i(l),l++},f.clearImmediate=p}function p(e){delete u[e]}function _(e){if(c)setTimeout(_,0,e);else{var t=u[e];if(t){c=!0;try{!function(e){var t=e.callback,i=e.args;switch(i.length){case 0:t();break;case 1:t(i[0]);break;case 2:t(i[0],i[1]);break;case 3:t(i[0],i[1],i[2]);break;default:t.apply(n,i)}}(t)}finally{p(e),c=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(100),n(6))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.emojiToHTML=void 0,t.isJS=function(){return!0},t.log=function(){var e;(e=console).log.apply(e,arguments)},t.mergeObjects=function(e,t){return Object.assign(e,t)};var i=n(0);t.emojiToHTML=i.emojiToHTML},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.random=function(){try{if(window.crypto){var e=new Int32Array(1);return crypto.getRandomValues(e),Math.abs(e.reduce(function(e,t){return e+t}))}}catch(e){}return intval(rand(0,i).toFixed(0))};t.MAX_SAFE_INTEGER=9007199254740991;var i=t.MAX_INTERGER=2147483647},function(e,t,n){"use strict";var i,o=n(68);((i=o)&&i.__esModule?i:{default:i}).default.onPostMessage(function(e){"putPixel"!==e&&"addCard"!==e&&window.scrollTop(0)})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(243),r=(i=o)&&i.__esModule?i:{default:i};n(290),t.default=r.default,window.SnackbarItem=r.default},function(e,t,n){"use strict";var i=window,o=i.ge,r=i.getXY,a=i.getCh,s=i.qs2obj,l=i.getSize,u=i.addClass,c=i.scrollTo,d=i.scrollGetY,f=i.removeClass;function p(e){(e=o(e))&&(u(e,"profileEdit_selected"),setTimeout(function(){u(e,"profileEdit_animated"),setTimeout(function(){f(e,"profileEdit_selected"),f(e,"profileEdit_animated")},1e3)},1500))}function _(e){(e=o(e))&&setTimeout(function(){var t=r(e)[1],n=l("mhead")[1],i=d(),o=a();t<n+i||t>i+o?setTimeout(function(){c(0,t-n),p(e)},0):p(e)},0)}window.ProfileEditor={init:function(){var e=(s(nav.params)||{}).hl;e&&_(geByClass1("_"+e))},highlightRow:p,scrollHighlightRow:_}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(210),r=(i=o)&&i.__esModule?i:{default:i};t.default=function(e){var t=e.style||[],n=e.class||e.mix,i=e.prefix,o=function(e){return{class:"TextInput__native",tag:"input",type:e.type,name:e.name,value:e.value,placeholder:e.placeholder,autocapitalize:!1===e.autocapitalize?"off":null,autocomplete:!1===e.autocomplete?"off":null,oninput:e.on_change,onkeydown:[e.on_key_down,"event"],maxlength:e.maxlength}}(e);return{class:[r.default.class("TextInput",{style_stretch:t.stretch,prefixed:!!i,hidden:"hidden"===e.type,error:t.error}),n],tag:"label",inner:i?[{class:r.default.class("TextInput__prefix",{rightPadding:i.with_right_padding,gray:i.gray}),inner:i.text},{class:"TextInput__nativeWrap",inner:o}]:o}}},function(e,t,n){"use strict";n(171)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(340),r=(i=o)&&i.__esModule?i:{default:i};t.default=r.default,window.OwnerRow=r.default},function(e,t,n){"use strict";Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),i=n.length>>>0;if(0===i)return!1;var o,r,a=0|t,s=Math.max(a>=0?a:i-Math.abs(a),0);for(;s<i;){if((o=n[s])===(r=e)||"number"==typeof o&&"number"==typeof r&&isNaN(o)&&isNaN(r))return!0;s++}return!1}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=u(["\n    ","\n    ","\n  "],["\n    ","\n    ","\n  "]),o=u(['\n    <div class="msg__newMsgsDivider">\n      <span class="msg__newMsgDividerText">',"</span>\n    </div>\n  "],['\n    <div class="msg__newMsgsDivider">\n      <span class="msg__newMsgDividerText">',"</span>\n    </div>\n  "]),r=l(n(77)),a=(l(n(34)),n(356)),s=l(a);function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}t.default=function(e){var t=e.msgId,n=e.withDivider?(p=window.lang,r.default.html(o,p.mobile_mail_new_msgs)):"",l=store.mail,u=l.msgs[t],c=l.members[u.authorId],d=u.peerId,f=l.peers[d];var p;f&&(f.isIncomingMR||f.isRejectedMR)&&(n="");var _=void 0;if(u.isService)_=(0,s.default)({id:t,text:u.textFull,service:!0,unread:u.isUnread});else{var A=(0,a.Msg__authorName)(c,d,l.cur.userId);_=(0,s.default)({id:t,text:u.textFull,important:u.isImportant,unread:u.isUnread,authorPhoto:c.avatar,authorName:A,authorUrl:c.url,date:u.date,removed:l.cur.msgRemoved[t],admin:u.adminName?{name:u.adminName,url:u.adminUrl}:null,edited:u.edited,channel:f.isChannel&&f.ownerId!==l.cur.viewerId})}return r.default.html(i,n,_)}},function(e,t,n){"use strict";var i=window,o=i.gpeByClass,r=i.hasClass,a=i.addClass,s=i.removeClass,l=i.geByClass1,u=i.setStyle,c=i.tooltip,d=i.ajax;window.Fave={showActionsTT:function(e,t){cancelEvent(t);var n=o("FaveArticles__row",e);if(r(n,"wi_actions_opened"))Fave.hideActionsTT();else{var i=l("wi_actions_wrap",n),s=l("FaveArticles__row_actions",n);u(i,"top",e.offsetTop+e.offsetHeight+"px"),a(n,"wi_actions_opened"),c.addHandler(Fave.hideActionsTT),c.show(i,s)}},hideActionsTT:function(){s("wi_actions_opened",l("wi_actions_opened")),c.hide()},removeArticle:function(e,t,n){Fave.hideActionsTT();var i=o("FaveArticles__row",e);a(i,"removed"),d.post("fave.php",{act:"defave_article",link:t,hash:n},{onFail:function(){return s(i,"removed")}})},restoreArticle:function(e,t,n){var i=o("FaveArticles__row",e);s(i,"removed"),d.post("fave.php",{act:"enfave_article",link:t,hash:n},{onFail:function(){return a(i,"removed")}})}}},function(e,t,n){"use strict";var i=n(322),o=l(n(77)),r=l(n(72)),a=l(n(268)),s=n(135);function l(e){return e&&e.__esModule?e:{default:e}}function u(e){(0,i.$$)(".mailHat").forEach(function(t){var n=o.default.parseClass("mailHat",t.getAttribute("class"));t.setAttribute("class",o.default.class("mailHat",Object.assign({},n,e)))})}Object.assign(s.MailHat_main,{onUnreadClick:(0,r.default)(),onBurgerClick:(0,r.default)(),onCancelForwardTap:(0,r.default)(),setFolder:function(e){(0,i.$$)(".mailHat__folder").forEach(function(t){a.default.setActive(t,e)})},setUnreadCount:function(e){(0,i.$$)(".mailHat_type_main").forEach(function(t){var n=t.$(".mailHat__unread"),i=t.$(".mailHat__unreadCount");n.classList.toggle("mailHat__unread_hasUnread",e>0),i.outerHTML=(0,s.MailHat__unreadCount)(e)})},setImportantCount:function(e){(0,i.$$)(".mailHat__folder").forEach(function(t){a.default.setCount(t,"important",e)})},setForwarding:function(e){(0,i.$$)(".mailHat_type_main").forEach(function(t){return t.classList.toggle("mailHat_forwarding",e)})},setModifiers:u}),Object.assign(s.MailHat_convo,{onBackTap:(0,r.default)(),onCancelEditingTap:(0,r.default)(),setOnline:function(e,t){var n=(0,s.MailHat_getOnlineText)(e,t);(0,i.$$)(".mailHat__convoDetailsText").forEach(function(e){return e.innerText=n})},setMobile:function(e){(0,i.$$)(".mailHat__convo").forEach(function(t){return t.classList.toggle("mailHat__convo_mobile",e)})},setHasPinnedMsg:function(e){(0,i.$$)(".mailHat_type_convo").forEach(function(t){return t.classList.toggle("mailHat_hasPinnedMsg",e)})},setModifiers:u})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(253);Object.defineProperty(t,"uTyping_getPeerTyping",{enumerable:!0,get:function(){return i.uTyping_getPeerTyping}}),Object.defineProperty(t,"uTyping_getNames",{enumerable:!0,get:function(){return i.uTyping_getNames}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(15),r=(i=o)&&i.__esModule?i:{default:i};n(281),t.default=r.default,window.Unfold=r.default},function(e,t,n){"use strict";"document"in window.self&&("classList"in document.createElement("_")&&(!document.createElementNS||"classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))||function(e){if("Element"in e){var t=e.Element.prototype,n=Object,i=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")},o=Array.prototype.indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1},r=function(e,t){this.name=e,this.code=DOMException[e],this.message=t},a=function(e,t){if(""===t)throw new r("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new r("INVALID_CHARACTER_ERR","String contains an invalid character");return o.call(e,t)},s=function(e){for(var t=i.call(e.getAttribute("class")||""),n=t?t.split(/\s+/):[],o=0,r=n.length;o<r;o++)this.push(n[o]);this._updateClassName=function(){e.setAttribute("class",this.toString())}},l=s.prototype=[],u=function(){return new s(this)};if(r.prototype=Error.prototype,l.item=function(e){return this[e]||null},l.contains=function(e){return-1!==a(this,e+="")},l.add=function(){var e,t=arguments,n=0,i=t.length,o=!1;do{e=t[n]+"",-1===a(this,e)&&(this.push(e),o=!0)}while(++n<i);o&&this._updateClassName()},l.remove=function(){var e,t,n=arguments,i=0,o=n.length,r=!1;do{for(e=n[i]+"",t=a(this,e);-1!==t;)this.splice(t,1),r=!0,t=a(this,e)}while(++i<o);r&&this._updateClassName()},l.toggle=function(e,t){e+="";var n=this.contains(e),i=n?!0!==t&&"remove":!1!==t&&"add";return i&&this[i](e),!0===t||!1===t?t:!n},l.toString=function(){return this.join(" ")},n.defineProperty){var c={get:u,enumerable:!0,configurable:!0};try{n.defineProperty(t,"classList",c)}catch(e){void 0!==e.number&&-2146823252!==e.number||(c.enumerable=!1,n.defineProperty(t,"classList",c))}}else n.prototype.__defineGetter__&&t.__defineGetter__("classList",u)}}(window.self),function(){var e=document.createElement("_");if(e.classList.add("c1","c2"),!e.classList.contains("c2")){var t=function(e){var t=DOMTokenList.prototype[e];DOMTokenList.prototype[e]=function(e){var n,i=arguments.length;for(n=0;n<i;n++)e=arguments[n],t.call(this,e)}};t("add"),t("remove")}if(e.classList.toggle("c3",!1),e.classList.contains("c3")){var n=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(e,t){return 1 in arguments&&!this.contains(e)==!t?t:n.call(this,e)}}e=null}())},function(e,t,n){"use strict";var i=n(322),o=u(n(326)),r=u(n(210)),a=u(n(72)),s=n(215),l=u(n(355));function u(e){return e&&e.__esModule?e:{default:e}}var c=window,d=c.lsGet,f=c.ge,p=c.addClass,_=c.removeClass,A=c.each,m=c.geByClass,h=c.hide,v=c.show,g=c.val,y=c.geByClass1,w=c.gpeByClass,b=c.attr,D=c.addEvent,C=c.cancelEvent,E=c.hasClass,S=c.getX,k=c.geByTag1,M=c.htsc,T=c.stripTags,x=c.toggleClass,I=c.lsSet,P=(c.append,c.HTMLAudioElement),B=window.ajax,F=window.nav,L=window.audio,O=function(){if(!P)return{init:function(){},initAudio:function(){}};var e="1"==d("audio_time_left"),t="",n="",u="",c=null,N=0,R={},j=!1,H=[];function V(e){if(e){v("lm_player");var t=f("lm_audio");t&&(g(y("ai_artist",t),e.artist),g(y("ai_title",t),e.title),b(y("ai_play",t),"style",e.cover_style));var n=geBySel('.audio_item[data-id="'+e.id+'"]');n&&A(n,function(e,t){J(t,0),Z(t,0),K(t,ie(0,L.duration())),ee(t,L.volume()),p("ai_current",t)})}else h("lm_player")}function $(e,t){_("ai_playing","lm_audio");var n=geBySel('.audio_item[data-id="'+e+'"]');n&&(A(n,function(e,n){K(n,ne(t)),_("ai_playing",n),_("ai_current",n)}),N=0,R[e]&&delete R[e])}function U(e,t,n){var i=geBySel('.audio_item[data-id="'+e+'"]');i&&(A(i,function(e,i){var o=t/n;t<=.01&&n<=1&&(o=0),q||Z(i,o),K(i,O.getFormatedTime(t,n))}),t>1&&(R[e]=1))}function z(e){var t=w("audios_list","audio"+e),n=m("audio_item",t),i=[],o=!1;A(n,function(t,n){if(!(n=te(n)))return!0;i.push(n),n.id==e&&(o=!0)}),L.playlist(i,{q:b(t,"data-query")}),o&&L.play(e)}L.onPlay(function(e){p("ai_playing","lm_audio");var t=geBySel('.audio_item[data-id="'+e+'"]');if(!t)return;A(t,function(e,t){p("ai_playing",t),p("ai_current",t)}),O.playback(e,!1,j),j=!1,H.push(e)}),L.onPause(function(e){_("ai_playing","lm_audio");var t=geBySel('.audio_item[data-id="'+e+'"]');if(!t)return;A(t,function(e,t){_("ai_playing",t),p("ai_current",t)}),O.playback(e,!0)}),L.onSelect(V),L.onDeselect($),L.onProgress(function(e,t,n){var i=geBySel('.audio_item[data-id="'+e+'"]');L.playing()?(A(i,function(e,t){p("ai_playing",t)}),p("ai_playing","lm_audio")):(A(i,function(e,t){_("ai_playing",t)}),_("ai_playing","lm_audio")),i&&A(i,function(e,i){J(i,t/n),p("ai_current",i)})}),L.onPositionChanged(U),L.onVolumeChanged(function(e,t){var n=geBySel('.audio_item[data-id="'+e+'"]');n&&A(n,function(e,n){ee(n,t)})}),L.onEnded(function(e){var t=geBySel('.audio_item[data-id="'+e+'"]');t&&(A(t,function(e,t){Z(t,1)}),j=!0)}),L.onNotFoundError(z),L.onEmptyPlaylistError(z);var q=null,W=null,Y=!1,G=!1;function X(e){if(q){var t=w("audio_item",q),n=Q(q,e);e&&C(e);var i=geBySel('.audio_item[data-id="'+b(t,"data-id")+'"]');A(i,function(e,t){Y&&Z(t,n),G&&(ee(t,n),L.volume(n))}),W=n}}function Q(e,t){var n=w("Slider__scroll",e),i=E("touch",window.bodyNode)?10:8,o=(t.pageX||t.touches&&t.touches[0]&&t.touches[0].pageX||0)-(n?e.getBoundingClientRect().left:S(e))-i/2,r=e.offsetWidth-i;return r?Math.max(0,Math.min(o/r,1)):0}function K(e,t){if(e){var n=y("ai_dur",e);g(n,t)}}function J(e,t){if(e){var n=y("aic_progress_wrap",e);y("aic_load_line",n).style.width=100*Math.max(0,Math.min(t,1))+"%"}}function Z(e,t){if(e){var n=y("aic_progress_wrap",e),i=y("aic_progress_line",n);y("aic_slider",i);i.style.width=100*t+"%"}}function ee(e,t){if(e){var n=y("aic_volume_wrap",e),i=y("aic_progress_line",n);y("aic_slider",i);i.style.width=100*t+"%"}}function te(e){if(!(e=f(e))||!b(e,"data-id"))return!1;if(E("ai_deleted",e))return!1;var t=b(e,"data-id"),n=g(k("input",e)),i=b(y("ai_dur",e),"data-dur"),o=g(y("ai_artist",e)),r=g(y("ai_title",e)),a=g(y("ai_subtitle",e)),s=!!y("ai_add",e),l=!!y("ai_del",e),u=b(y("ai_play",e),"style"),c=!!y("audio_item_disabled",e),d=!!y("ai_explicit",e),p={};return A((b(e,"class")||[]).split(" "),function(e,t){"audio_item_"===t.slice(0,"audio_item_".length)&&(p[t.slice("audio_item_".length)]=!0)}),{id:t,src:n,dur:i,artist:M(T(o)),title:M(T(r)),can_add:s,can_del:l,cover_style:u,is_disabled:c,mix:p,subtitle:a,is_explicit:d}}function ne(e){var t,n,i,o=e<0;return t=(n=(e=Math.round(o?-e:e))%60)<10?"0"+n:n,t=(i=(e=Math.floor(e/60))%60)+":"+t,(e=Math.floor(e/60))>0&&(i<10&&(t="0"+t),t=e+":"+t),o&&(t="-"+t),t}function ie(t,n){return ne(e&&n?t-n:t)}function oe(e){var t=window.cur;t.deletedAudios||(t.deletedAudios={}),t.deletedAudios[e]=!0}function re(e){var t=window.cur;t.deletedAudios&&delete t.deletedAudios[e]}function ae(e,t){t?function(e){var t=window.cur;t.addedAudios||(t.addedAudios={}),t.addedAudios[e]=!0}(e):function(e){var t=window.cur;t.addedAudios&&delete t.addedAudios[e]}(e);var n=geBySel('.audio_item[data-id="'+e+'"]');A(n,function(e,n){x("ai_added",n,t),g(y("ai_add",n),t?lang.global_delete_audio:lang.global_add_to_audio)});var i=geBySel1('body > [id="ai_menu_'+e+'"]'),o=y("ai_add",i);g(o,t?lang.global_delete_audio:lang.global_add_to_audio),ActionMenu.update()}function se(e,t){t?oe(e):re(e);var n=geBySel('.audio_item[data-id="'+e+'"]');A(n,function(e,n){x("ai_deleted",n,t),g(y("ai_del",n),t?lang.global_add_to_audio:lang.global_delete_audio)});var i=geBySel1('body > [id="ai_menu_'+e+'"]'),o=y("ai_del",i);g(o,t?lang.global_add_to_audio:lang.global_delete_audio),ActionMenu.update()}function le(){var e=L.getCurrentId(),t=f("audio"+e),n=!1;e&&(n=w("audios_list",t)||w("mcont",t)),A(m("_AudioPlayStatus"),function(e,t){x("playing",t,!1)}),n&&A(m("_AudioPlayStatus",n),function(e,t){x("playing",t,L.playing())})}function ue(e,t,n){if(window.isArticleWebView)return Article.audioPlay(L.getCurrentId(),L.playlist()),C(e),!1;var i=window.lang;if(L.support){var o=f("audio"+t);if(o&&E("ai_deleted",o)&&!E("ai_current",o))return!0;n&&t!=L.getCurrentId()?z(t):L.operate(t),le()}else alert(i.mobile_audio_player_not_support);return C(e),!1}return D(document,s.isTouch?"touchend touchcancel":"mouseup",function(e){if(!q)return;var t=w("audio_item",q),n=Q(q,e)||W;e&&C(e);var i=geBySel('.audio_item[data-id="'+b(t,"data-id")+'"]');A(i,function(e,i){Y&&(Z(i,n),L.position(n,!0)),G&&ee(t,n)}),q=W=null,Y=G=!1}),D(document,s.isTouch?"touchmove":"mousemove",X),{init:function(e){t=e.add_hash||"",n=e.del_hash||"",u=e.res_hash||""},initAudio:function(){A(m("ai_current"),function(e,t){$((t=te(t)).id,t.dur)});var e=L.getCurrentId(),t=geBySel('.audio_item[data-id="'+e+'"]'),n=L.loaded(),i=L.position(),o=L.duration();L.playing()?(A(t,function(e,t){p("ai_playing",t)}),p("ai_playing","lm_audio")):(A(t,function(e,t){_("ai_playing",t)}),_("ai_playing","lm_audio")),V(L.getCurrent()),A(t,function(e,t){J(t,n/o)}),U(L.getCurrentId(),i,o),setTimeout(function(){le()},1)},getDOMFromAudio:function(e,t,n){if(!e)return"";var i=M(e.id),a=M(e.src),u=+e.dur,c=e.artist,d=e.title,f=e.subtitle,p=e.is_explicit,_=e.can_add,A=e.can_del,m=d?'<span class="divider"> &ndash; </span>':"",h=s.isTouch?"ontouchstart":"onmousedown",v="",g="",y=e.cover_style||"",w=e.is_disabled||"",b=r.default.class("audio_item",e.mix)||"audio_item";if(w)return'<div class="audio_item audio_item_disabled"></div>';if(function(e){var t=window.cur;return!!t.deletedAudios&&t.deletedAudios[e]}(i)){if(n)return"";v+=" ai_deleted"}(function(e){var t=window.cur;return!!t.addedAudios&&t.addedAudios[e]})(i)&&(v+=" ai_added"),A?(v+=" ai_has_btn",g='<div class="ai_del wia_item" onclick="audioplayer.del(\''+i+"', event);\">"+lang.global_delete_audio+"</div>"):_&&(v+=" ai_has_btn",g='<div class="ai_add wia_item" onclick="audioplayer.add(\''+i+"', false, event);\">"+lang.global_add_to_audio+"</div>"),i==L.getCurrentId()&&(L.playing()&&(v+=" ai_playing"),v+=" ai_current");var D="";return g?D='<div class="ai_menu_wrap"><i class="i_pointer"></i><a href="#" class="ai_menu_toggle_button" onclick="ActionMenu.toggleMenu(event, this);"></a><div class="ai_menu wi_actions" id="ai_menu_'+i+'">'+g+"</div></div>":v+=" ai_no_menu",'<div id="audio'+i+'" data-id="'+i+'" class="'+v+" "+b+'" onclick="audioplayer.playPause(event, \''+i+"'"+(t?", true":"")+');"><div class="ai_info"><div class="ai_play" style="'+y+'"><i class="i_play"></i></div>'+D+'<div class="ai_body"><div class="ai_dur" data-dur="'+u+'" onclick="audioplayer.switchTimeFormat(this, event);">'+ne(u)+'</div><div class="ai_label"><span class="ai_title">'+d+(f?" "+o.default.html({tag:"span",class:"ai_subtitle",inner:f}):"")+(p?(0,l.default)({class:"ai_explicit",icon:"audio_explicitSmall"}):"")+"</span>"+m+'<span class="ai_artist">'+c+'</span></div><input type="hidden" value="'+a+'"></div></div><div class="ai_controls"><table class="row_table"><tr><td class="aic_progress_wrap"><div class="aic_line" '+h+'="audioplayer.setPosition(this, event);" onclick="cancelEvent(event);"><div class="aic_ln aic_back_line" onclick="cancelEvent(event);"></div><div class="aic_ln aic_load_line" onclick="cancelEvent(event);"></div><div class="aic_ln aic_pl_wrap" onclick="cancelEvent(event);"><div class="aic_ln aic_progress_line" onclick="cancelEvent(event);"><div class="aic_slider" onclick="cancelEvent(event);"></div></div></div></div></td><td class="aic_volume_wrap"><div class="aic_line" '+h+'="audioplayer.setVolume(this, event);" onclick="cancelEvent(event);"><div class="aic_ln aic_back_line" onclick="cancelEvent(event);"></div><div class="aic_ln aic_pl_wrap" onclick="cancelEvent(event);"><div class="aic_ln aic_progress_line" onclick="cancelEvent(event);"><div class="aic_slider" onclick="cancelEvent(event);"></div></div></div></div></td></tr></table></div></div>'},add:function(e,i,o){var r=f("audio"+e);if(!E("ai_ajax",r)){var a=E("ai_added",r);ae(e,!a),p("ai_ajax",r),O.onAdd(),B.post("/audio",{_ajax:1,act:a?"delete":"add",audio:a?b(r,"data-deleteid"):e,hash:a?n:t,access_key:i},{redirectToLoginPage:!0,onDone:function(t){_("ai_ajax",r),t?b(r,"data-deleteid",t):ae(e,a)},onFail:function(){switch(_("ai_ajax",r),ae(e,a),Array.prototype.slice.call(arguments).shift()){case 2:F.go("/audio?act=add&audio="+e+"&hash="+t+"&access_key="+i)}}}),o&&C(o)}},del:function(e,t){var i=f("audio"+e);if(i){var o=E("ai_deleted",i);se(e,!o),o?re(e):oe(e),O.onDel(),B.post("/audio",{_ajax:1,act:o?"restore":"delete",audio:e,hash:o?u:n},{redirectToLoginPage:!0,onDone:function(t){t||se(e,o)},onFail:function(){switch(se(e,o),Array.prototype.slice.call(arguments).shift()){case 2:F.go("/audio?act="+(o?"restore":"delete")+"&audio="+e+"&hash="+(o?u:n))}}}),t&&C(t)}},playPause:ue,getFormatedTime:ie,switchTimeFormat:function(t,n){var i=w("audio_item",t);return!(E("ai_current",i)&&!E("ai_select",i))||(I("audio_time_left",(e=!e)?"1":"0"),K(f("audio"+L.getCurrentId()),ie(L.position(),L.duration())),n&&C(n),!1)},setPosition:function(e,t){q||(q=e,Y=!0,X(t))},setVolume:function(e,t){q||(q=e,G=!0,X(t))},playback:function(e,n,i){if(clearTimeout(c),!n&&e&&e!=N){c=setTimeout(function n(){if(R[e]){var o={_ajax:1,act:"playback",audio:e,hash:t,state:document.hidden?"background":"app",end_stream_reason:"unknown"},r=H.lastIndexOf(e);i&&(o.auto=1),r&&(o.prev=H[r-1]),B.post("/audio",o,{onDone:function(){N=e}})}else c=setTimeout(n,1e4)},1e4)}},openPlayer:function(e,t){var n=F.path,i=F.params,o=n+(i?"?"+i:"")+"#player";return F.al_go(o,null,{local:!0,target:e,nav:{push:o,path:n,params:i,hash:"#player"},no_push:t})},getCurrentElem:function(){return(0,i.$)(".ai_current")},playFirst:function(e,t){e&&C(e);var n=L.getCurrent(),i=w("_audioPlaylist",t),o=!!n&&n.id;if(!o||!y("ai_current",i)){var r=(i||f("mcont")).$(".audio_item[data-id]");o=r&&r.getAttribute("data-id")}o&&ue(e,o)},hasArticleWebViewClientAudioSupport:function(){return window.clientWebviewAudioSupport},onAdd:(0,a.default)(),onDel:(0,a.default)()}}();window.audioplayer=O},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(138),r=(i=o)&&i.__esModule?i:{default:i};n(136),t.default=r.default,window.uCurConvoTyping=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(326),r=(i=o)&&i.__esModule?i:{default:i};var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=Stories.getStore(),this.data=t,this.raw_id=t.raw_id,this.can_remove=t.can_remove,this.can_report=t.can_report,this.can_bookmark=t.can_bookmark,this.is_bookmarked=t.is_bookmarked,this.is_narrative=!!t.narrative}return e.prototype.needMenu=function(){return this.can_remove||this.can_report},e.prototype.render=function(){var e=window.lang;return r.default.html({class:"StoryMenu",inner:[{class:"StoryMenu__trigger",onclick:"Stories.showMenu();",inner:{class:"Story__icon Story__icon_menu"}},{class:"StoryMenu__container",inner:[this.can_bookmark?{class:"StoryMenu__row",inner:{class:"StoryMenu__button",onclick:"Stories.toggleBookmark(this);",inner:this.is_bookmarked?e.mobile_stories_menu_bookmarked_title:e.mobile_stories_menu_bookmark_title}}:null,this.can_remove?{class:"StoryMenu__row",inner:{class:"StoryMenu__button",onclick:"Stories.removeCurrentStory();",inner:this.is_narrative?e.mobile_stories_menu_remove_narrative_title:e.mobile_stories_menu_remove_title}}:null,this.can_report?{class:"StoryMenu__row",inner:{class:"StoryMenu__button",onclick:'Stories.reportCurrentStory("'+this.raw_id+'");',inner:e.mobile_stories_menu_report_title}}:null]}]})},e}();t.default=a},function(e,t,n){"use strict";var i=window,o=i.cancelEvent,r=i.gpeByClass,a=i.geByClass1,s=i.getY,l=i.getX,u=i.getW,c=i.addClass,d=i.hasClass,f=i.append,p=i.tooltip,_=i.addEvent,A=i.removeClass,m=i.removeEvent,h=i.before,v=i.remove,g=i.clone,y=i.setStyle,w=i.each,b=i.getStyle,D=function(){var e="ai_menu_opened",t=void 0,n=void 0,i=!1;function D(e){for(var t=!1;e;){var n=b(e,"overflow-y");if(("scroll"===n||"auto"===n)&&e.offsetHeight<e.scrollHeight){t=!0;break}e=e.parentElement}return{cursor:e,isOverflowYContainer:t}}function C(e){for(var t=!1;e;){var n=b(e,"overflow-x"),i=d(e,"Slider__scroll");if("scroll"===n||"auto"===n||i){t=!0;break}e=e.parentElement}return{cursor:e,isOverflowXContainer:t}}function E(){if(t&&n){var e=a("i_pointer",t);D(e).isOverflowYContainer?y(n,"top",e.getBoundingClientRect().top):y(n,"top",s(e)),C(e).isOverflowXContainer?y(n,"left",function(e){return e.getBoundingClientRect().left}(e)-u(n)):y(n,"left",l(e)-u(n))}}function S(e){e&&"A"===e.target.tagName&&requestAnimationFrame(function(){E()})}function k(o){!function(e){t=r("ai_menu_wrap",e),n=a("ai_menu",t)}(o),c(e,t),f(n,document.body),i=M,p.addHandler(i),p.show(t,n),_(window,"resize",E),_(n,"click",S);var s=a("i_pointer",t),l=D(s);l.isOverflowYContainer&&_(l.cursor,"scroll",E);var u=C(s);u.isOverflowXContainer&&_(u.cursor,"scroll",E),E()}function M(){A(e,t),f(n,t),p.removeHandler(i),p.hide(),m(window,"resize",E),m(n,"click",E);var o=a("i_pointer",t),r=D(o);r.isOverflowYContainer&&m(r.cursor,"scroll",E);var s=C(o);s.isOverflowXContainer&&m(s.cursor,"scroll",E)}return{closeMenu:M,toggleMenu:function(n,i){o(n),d(e,t)?M():k(i)},update:function(){!function(){if(n){var e=geByClass("wia_item",n);e&&w(e,function(e,t){var n=g(t);h(n,t),v(t),c("unhover",n),setTimeout(function(){A("unhover",n)},100)})}}(),E()}}}();window.ActionMenu=D},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(326)),o=r(n(210));function r(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.class||e.mix;return i.default.html({class:[t,o.default.class("Loading",{white:e.white,large:e.large})],inner:{class:"Loading__items",inner:[{class:"Loading__item Loading__item_0"},{class:"Loading__item Loading__item_1"},{class:"Loading__item Loading__item_2"}]}})}},function(e,t,n){"use strict";var i=n(95),o=window,r=o.preventEvent,a=o.onDOMReady,s=o.lsCheck,l=o.geByClass1,u=o.qs2obj,c=o.geByTag1,d=o.gpeByTag,f=o.addEvent,p=o.onBodyResize,_=o.removeEvent,A=o.hide,m=o.each,h=o.show,v=o.vkNow,g=o.gpeByClass,y=o.attr,w=o.val,b=o.escapeRE,D=o.hasClass,C=o.lsGet,E=o.isEmpty,S=o.lsSet,k=o.geByClass,M=o.setStyle,T=window.ajax,x=(window.page,window.post),I=window.Scroller,P=window.Stickers;window.StickersHints=function(){var e,t,n,o,B,F,L,O,N=864e5,R=300,j=30,H=64,V=8,$=4,U=!0,z=0,q={D83DDE0A:[0,":-)"],D83DDE03:[1,":-D"],D83DDE09:[2,";-)"],D83DDE06:[3,"xD"],D83DDE1C:[4,";-P"],D83DDE0B:[5,":-p"],D83DDE0D:[6,"8-)"],D83DDE0E:[7,"B-)"],D83DDE12:[8,":-("],D83DDE0F:[9,";-]"],D83DDE14:[10,"3("],D83DDE22:[11,":'("],D83DDE2D:[12,":_("],D83DDE29:[13,":(("],D83DDE28:[14,":o"],D83DDE10:[15,":|"],D83DDE0C:[16,"3-)"],D83DDE20:[17,">("],D83DDE21:[18,">(("],D83DDE07:[19,"O:)"],D83DDE30:[20,";o"],D83DDE33:[21,"8|"],D83DDE32:[22,"8o"],D83DDE37:[23,":X"],D83DDE1A:[24,":-*"],D83DDE08:[25,"}:)"],2764:[26,"<3"],D83DDC4D:[27,":like:"],D83DDC4E:[28,":dislike:"],"261D":[29,":up:"],"270C":[30,":v:"],D83DDC4C:[31,":ok:"]};function W(){var t=window.cur;if((o=c("textarea",d("form",l("cp_sticker_btn"))))&&!o.initialized){var i=function(t){var n=o.value.length;e=n-z>1,z=n,Y(),U&&(!function(){Z()&&v()-ee()>N*(2+Math.random())&&G();e=function(e){e*=1e3,Z()&&e>ee()&&G()},T.post("/attachments",{_ajax:1,act:"stickers_hints_change_date"},{onDone:e});var e}(),U=!1)};o.initialized=!0,F=l("stickersHints"),B=l("stickersHints__content"),f(o,"focus",Y),f(o,"input",i),f(document,"click",X),p(Q),p(ne),t.destroy.push(function(){F=null,B=null,_(o=null,"focus",Y),_(o,"input",i),_(document,"click",X),p("__clear",Q),p("__clear",ne),n&&n.destroy(),z=0}),document.activeElement===o&&Y()}}function Y(){if(o){t&&clearTimeout(t);var r,a=function(t){if(t.length>j)return"";m(q,function(e,n){var i=new RegExp("(\\s|^)("+b(n[1])+(")"==n[1][n[1].length-1]?"+":"")+")([\\s\\.,]|$)","g");t=t.replace(i,function(t,n,i,o){return(n||"")+function(e){for(var t=Math.round(e.length/4),n="",i=0;t--;)n+=String.fromCharCode(parseInt(e.substr(i,4),16)),i+=4;return n}(e)+(o||"")})}),0===t.indexOf(O)&&(t=t.replace(O,""));t=t.toLowerCase().replace(/^(\s+)|([\.!\?]+)$/g,"").replace("ё","е"),e&&(t=t.replace(/\s+$/,""));return t=(0,i.emojiRemoveSkinToneModifiers)(t)}(o.value);r=function(e){var i=a&&e[a];i?t=setTimeout(function(){var e=i.userStickers||[],t=i.promotedStickers||[];if(e.length>0||t.length>0){var o=[];m(e,function(e,t){o.push(K({stickerId:t,query:a,isPromoted:!1}))}),m(t,function(e,t){o.push(K({stickerId:t,query:a,isPromoted:!0}))}),B.innerHTML=o.join(""),h(F),Q(),ne(),(n=new I(F)).init()}},R):(n&&n.destroy(),A(F))},L?r(L):Z()?(L=C("stickers_keywords").keywords,r(L)):J(function(e){L=e,te(e),r(e)})}}function G(){J(function(e){L=e,te(e),Y()})}function X(e){var t=e.target;t===o||g(t,"stickersHints")||A(F)}function Q(){y(B,"style","")}function K(e){var t=e.isPromoted,n=t?"":"onclick=\"return StickersHints.onStickerThumbClick(event, this, {{stickerId}}, '{{stickerReferrer}}');\"",i=l("sticker_thumb",l("stickers_list")),o=t?'href="/attachments?'+["act=stickers_store","target="+y(F,"data-target"),"sticker_id={{stickerId}}","from=inline","sticker_referrer={{stickerReferrer}}"].join("&")+'"':'href="'+(y(i,"href")||y(i,"data-href")).replace(/media=[\w\d]+/,"media=sticker{{stickerId}}")+'"',r=P.getStickerUrl(e.stickerId,D("x2",window.bodyNode)?256:128);return('<div class="sticker_item sticker{{stickerId}} {{promotedClass}}">        <a class="sticker_thumb thumb_item" '+o+" "+n+'>          <img class="th_img" src="{{stickerUrl}}" />        </a>      </div>').replace(/{{stickerId}}/g,e.stickerId).replace(/{{stickerUrl}}/g,r).replace("{{promotedClass}}",t?"sticker_item_promoted":"").replace("{{stickerReferrer}}","suggestion_"+e.query)}function J(e){T.post("/attachments",{_ajax:1,act:"stickers_hints_keywords"},{onDone:function(t){e(function(e){var t={};return m(e,function(e,n){var i=n.user_stickers,o=n.promoted_stickers;m(n.words,function(e,n){t[n]={userStickers:i,promotedStickers:o}})}),t}(t))}})}function Z(){return Boolean(C("stickers_keywords"))}function ee(){return C("stickers_keywords").time}function te(e){!e||E(e)?S("stickers_keywords"):S("stickers_keywords",{keywords:e,time:v()})}function ne(){var e=l("stickersHints__callout");if(e){var t=e.offsetWidth-$,n=t/H,i=n%1;i<.3?n=Math.floor(n)-.5:i>.7&&(n=Math.ceil(n)-.5);var o=Math.round(t/n-V);m(k("sticker_item",e),function(e,t){var n=l("sticker_thumb",t),i=l("th_img",t);M(t,"width",o),M(t,"height",o),M(n,"width",o),M(n,"height",o),M(i,"height",o)})}}return a(function(){s()&&!l("vk_stickers_hints_support_no")&&(x.onStickersInit(function(){W()}),l("stickersHints")&&W())}),T.onRedirect(function(e){u(e.split("?")[1]).invalidate_stickers_hints&&G()}),x.onReplyClick(function(e){var t=window.cur;O=e,setTimeout(Y,10),t.destroy.push(function(){O=""})}),{actualizeVisibility:Y,init:W,onStickerThumbClick:function(e,t,n,i){window.isNewMail&&r(e);var a=g("sticker_item",t),s=l("th_img",a);return y(a,"style",""),y(t,"style",""),y(s,"style",""),A(F),o.value="",x.sendSticker(t,n,!0,i)},onCheckboxLabelClick:function(e,t){setTimeout(function(){!function(e,t,n){var i={_ajax:1,act:"stickers_hints_enabled",value:e,hash:t};T.post("/attachments",i,{onDone:n})}(w(c("input",e.parentElement))?1:0,t,G)},0)},onCheckboxAutoAnimationLabelClick:function(e,t){setTimeout(function(){!function(e,t,n){var i={_ajax:1,act:"stickers_auto_animation_enabled",value:e,hash:t};T.post("/attachments",i,{onDone:n})}(w(c("input",e.parentElement))?1:0,t,G)},0)}}}()},function(e,t,n){"use strict";var i=window,o=i.Friends,r=i.Groups,a=i.hasClass,s=i.geByClass1,l=i.getLang;window.SubscribeBtn={onClick:function(e,t,n,i,h,v){try{var g=v+u,y=v+f,w=v+c,b=v+d,D=a(e,g),C=D?i:n,E=l(D?_:p),S=!D,k=s(y,e),M=function(e){var t=intval(domData(e,"block-id"));if(!t){var n=domCA(e,m);t=intval(domData(n,"block-id"))||null}return t}(e),T=domData(e,"from")||null;k&&(toggleClass(w,k,S),toggleClass(b,k,!S)),attr(e,"aria-label",escapeAttr(E)),toggleClass(g,e,S),h===A?function(e,t,n,i){(n?r.leave:r.enter).call(r,e,t,i)}(t,C,D):function(e,t,n,i,r){(n?o.decline:o.accept).call(o,e,t,i,r)}(t,C,D,T,M)}catch(e){console.trace(e)}return!1}};var u="_unsubscribe",c="Icon_unsubscribe",d="Icon_subscribe",f="Icon",p="mobile_groups_you_are_in_public",_="mobile_groups_public_subscribe",A="group",m=".feedAssistance"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},o={_onCloseClick:function(e){e.stopPropagation(),e.preventDefault(),remove(geByClass1(o.class.btn))},class:{btn:"FloatBtn"}};o.class=i({},o.class,{open:o.class.btn+"_open"}),t.default=o},function(e,t,n){"use strict";var i=s(n(210)),o=n(1),r=s(n(346)),a=s(n(209));function s(e){return e&&e.__esModule?e:{default:e}}var l={onTemplateInput:function(e,t,n,o){var r=$("."+n),a=o-t.value.length;r.textContent=a,r.className=i.default.class(n,{error:a<=0})},onButtonClick:function(e,t,n){var i=$(".MailTemplatePage__TextTextarea"),o=i.value;i.value=o.slice(0,i.selectionStart)+n+o.slice(i.selectionEnd)},onSave:function(e,t,n,i,s){var l=$(".MailTemplatePage__NameInput .TextInput__native"),u=$(".MailTemplatePage__TextTextarea");a.default.setLoading(t,!0),(0,o.ajaxRequest)("/mail",{act:"save_template",name:l.value,text:u.value,hash:i,id:n},function(e){if(e){if(e.error){var i=$(".MailTemplatePage__ErrorRow"),o=$(".MailTemplatePage__ErrorText");return a.default.setLoading(t,!1),i.hidden=!1,void(o.textContent=e.message)}if(store.mail.cur){var l=store.mail.cur.templates,u=n?l.findIndex(function(e){return e.id===n}):-1;-1!==u?l.splice(u,1,e.result):l.push(e.result)}r.default.go(s)}},function(){a.default.setLoading(t,!1)})},onSubmit:function(e){e.preventDefault()}};window.MailTemplatePage=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(142),r=(i=o)&&i.__esModule?i:{default:i};t.default=r.default,window.uBell=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AverageAlgorithm=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clear()}return e.prototype.push=function(e){this._count++,this._accum+=e},e.prototype.get=function(){return this._accum/this._count},e.prototype.clear=function(){this._count=0,this._accum=0},e}()},function(e,t,n){"use strict";var i=n(215),o=s(i),r=s(n(293)),a=s(n(15));function s(e){return e&&e.__esModule?e:{default:e}}Object.assign(a.default,{onOpen:befall.kind("unfoldName"),getByName:function(e){return $(u.unfoldByName(e))},setActive:function(e,t){var n=void 0,i=void 0;1===arguments.length?e=(i=e).closest(u.unfold):i=e.$(u.itemByName(itemElemOrName));if((n=e.$(u.itemActive))&&i){n.classList.remove(l.itemActive),i.classList.add(l.itemActive);var o=e.$(u.triggerText),r=i.$(u.itemText);o.innerText=r.textContent.trim()}},setCount:function(e,t,n){var i=e.$(u.itemCountByName(t));r.default.setValue(i,n)},setTitle:function(e,t,n){e.$(u.itemByName(t)).$(u.itemText).innerText=n},toggleItemEnabled:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=e.$(u.itemByName(t));i&&i.classList.toggle(l.itemDisabled,!n)}}),a.default._onTriggerMouseDown=d,a.default._onTriggerClick=c;var l={itemActive:"Unfold__item_active",itemDisabled:"Unfold__item_disabled",open:"Unfold_open"},u={unfold:".Unfold",unfoldByName:function(e){return'.Unfold[data-name="'+e+'"]'},itemActive:"."+l.itemActive,itemByName:function(e){return".Unfold__item_name_"+e},itemCountByName:function(e){return u.itemByName(e)+" .Unfold__itemCount"},item:".Unfold__item",itemDisabled:"."+l.itemDisabled,triggerText:".Unfold__triggerText",itemText:".Unfold__itemText",popup:".Unfold__popup"};function c(e){preventEvent(e)}function d(e){var t=e.closest(u.unfold),n=i.isTouch?"touchend":"mousedown",r=i.isTouch?"touchend":"mouseup",s=!i.isTouch&&window.innerWidth<882,c=t.getAttribute("data-name"),d=!1;function f(){t.classList.remove(l.open),document.removeEventListener("keydown",_),document.removeEventListener("touchmove",p),document.removeEventListener(n,m,!0),document.removeEventListener(r,A,!0)}function p(e){e.target.closest(u.popup)||f(),d=!0}function _(e){27===e.keyCode&&f()}function A(){document.addEventListener(n,m,!0)}function m(e){if(d)d=!1;else{var t=e.target.closest(u.itemDisabled);if(!t){var n=e.target.closest(u.item+"[href]");if(n)return void(o.default.safari&&o.default.safari_mobile&&o.default.version<9?setTimeout(f,500):(cancelEvent(e),nav.onBeforeGo(function(){f()}),nav.go(n)));if(n=e.target.closest(u.item+"[onmousedown]"))return void setTimeout(f);if(n=e.target.closest("label"+u.item))return void setTimeout(f);if(n=e.target.closest("input[onchange]"))return void(o.default.safari&&o.default.safari_mobile&&o.default.version<9?setTimeout(f,500):setTimeout(f))}(i.isTouch||s||t)&&(e.preventDefault(),e.stopImmediatePropagation()),(s||!i.isTouch&&t)&&document.addEventListener("click",h,!0),t||f()}}function h(e){e.preventDefault(),e.stopImmediatePropagation(),document.removeEventListener("click",h,!0)}c&&a.default.onOpen(c)(),t.classList.add(l.open),document.addEventListener("keydown",_),document.addEventListener("touchmove",p),o.default.msie_mobile?document.addEventListener(r,A,!0):document.addEventListener(n,m,!0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(274),r=(i=o)&&i.__esModule?i:{default:i};t.default=r.default,window.Loading=r.default},function(e,t,n){"use strict";var i,o=n(322),r=n(215),a=(i=r)&&i.__esModule?i:{default:i};var s=need("page"),l=need("onDOMReady");window.Slider={scrollToElem:function(e){var t=e.closest(u.scroll);t.scrollLeft=e.offsetLeft-t.offsetWidth/2+e.offsetWidth/2}},Slider._onWheel=c,(a.default.ios||a.default.msie_edge)&&(l(f),s.onChange(f),window.MutationObserver&&l(function(){if(document.body){var e=new MutationObserver(d);e.observe(document.body,{subtree:!0,childList:!0})}}));var u={slider:".Slider",scroll:".Slider__scroll"};function c(e,t){var n=e.deltaX,i=e.deltaY;Math.abs(n)>Math.abs(i)&&(e.preventDefault(),t.scrollLeft+=n)}function d(e){e.forEach(function(e){e.addedNodes.forEach(function(e){e.nodeType===Node.ELEMENT_NODE&&e.$$(u.slider).forEach(p)})})}function f(){(0,o.$$)(u.slider).forEach(p)}function p(e){var t=getComputedStyle(e),n=Number(t.paddingTop.replace("px","")),i=Number(t.paddingBottom.replace("px",""));e.style.overflow="hidden",e.style.height=e.offsetHeight-n-i+"px",e.$(u.scroll).style.paddingBottom="20px"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(326),r=(i=o)&&i.__esModule?i:{default:i};t.default=function(e){var t=!(!e.tags||!e.tags.length)&&e.tags;return{class:"Owner__tags",inner:t?[{class:"Owner__tags_icon Icon Icon_tagLabel"},t.map(function(e){return{class:"Owner__tag",inner:r.default.wrap(e.name)}})]:null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StoryAuthor=t.ERROR_CLASS=t.VIDEO_MUTED_CLASS=void 0;var i=s(n(326)),o=n(215),r=s(n(299)),a=s(n(120));function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=window.setStyle,c=t.VIDEO_MUTED_CLASS="StoryAuthor_videoMuted";t.ERROR_CLASS="StoryAuthor_error",t.StoryAuthor=function(){function e(t,n){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=Stories.getStore(),this.data=n,this.state={authorIndex:t};var a=this.getCurrentStoryIndex();this.setCurrentStoryIndex(a),this.story=new r.default(this.data.items[a],this.data.author,t,a),this.authorStoriesHTML=i.default.html(this.story.render()),this.progressItemElems=null,Stories.onRender(function(){o.updateStory()})}return e.prototype.getCurrentStory=function(){if(this.story)return this.story},e.prototype.destroy=function(){this.story&&this.story.destroy()},e.prototype.update=function(){var e=this.data.index;this.destroy(),this.story=new r.default(this.data.items[e],this.data.author,this.state.authorIndex,e),this.authorStoriesHTML=i.default.html(this.story.render())},e.prototype.updateHeader=function(){this.authorElems=Stories.getAuthorElems(),this.authorElem=this.authorElems[this.state.authorIndex],this.progressItemElems=Array.from(geByClass("StoryAuthor__progressItem",this.authorElem)),this.drawFilledProgressItems()},e.prototype.updateStory=function(){var e=this;this.authorElems=Stories.getAuthorElems(),this.authorElem=this.authorElems[this.state.authorIndex];var t=geByClass1("Story__body",this.authorElem);this.story.update(t),this.story.onVideoData(function(n){n.authorIndex,n.storyIndex;var i=e.story.getDuration(),o=e.story.getType(),r=e.store.isStopped;if(e.countdown=new a.default(i,{tick:13,onTick:function(t){var n=(100-Math.min(t/i*100,100))/100;e.drawCurrentProgress(n)},onEnd:function(){"video"!==o&&(e.drawCurrentProgress(100),Stories.nextStory(),removeClass(e.authorElem,"StoryAuthor_paused"))},onPause:function(){e.story.pause(),addClass(e.authorElem,"StoryAuthor_paused")},onStart:function(){e.story.play(),removeClass(e.authorElem,"StoryAuthor_videoHold"),removeClass(e.authorElem,"StoryAuthor_paused")}}),"photo"!==o&&"broken"!==o||r){if("video"===o){var s=e.story.getVideoState(),l=e.story.getVideo();addClass(t,"Story__body_video"),4!==s||r||l.paused||e.countdown.start()}}else e.countdown.start()}),this.story.onVideoEndedEvent(function(){e.drawCurrentProgress(100),Stories.nextStory()}),this.story.onVideoPauseEvent(function(){e.countdown&&e.countdown.pause()}),this.story.onVideoBuffering(function(){e.countdown&&e.countdown.pause()}),this.story.onVideoPlayEvent(function(){e.countdown&&!e.store.isStopped&&e.countdown.start()}),this.story.onAutoPlay(function(){var t=window.lang,n=e.story.getVideo();Stories.pauseAudio();var i=geByClass1("Story__body",e.authorElem),o=Stories.isGoodBrowser();n.play(),n.paused&&!o?e.story.renderError(e.authorElem,i,t.mobile_stories_inline_video_error):!e.countdown||e.store.isStopped||n.paused?o&&n.paused&&addClass(e.authorElem,"StoryAuthor_videoHold"):e.countdown.start(),n.muted&&addClass(e.authorElem,c)}),this.story.onDestroy(function(){e.countdown&&(e.countdown.stop(),e.countdown=null)})},e.prototype.getCountDown=function(){if(this.countdown)return this.countdown},e.prototype.getFirstUnreadStoryIndex=function(){var e=this.data.items.findIndex(function(e){return!0===e.unread});return-1!==e?e:0},e.prototype.getCurrentStoryIndex=function(){if(!this.data.index){var e=this.getFirstUnreadStoryIndex();this.setCurrentStoryIndex(e)}return this.data.index},e.prototype.drawCurrentProgress=function(e){if(this.progressItemElems){var t=this.progressItemElems[this.data.index];u.transform(geByClass1("StoryAuthor__progressItemCurrent",t),[e,1])}},e.prototype.drawFilledProgressItems=function(){var e=this.data.index;if(this.progressItemElems)for(each(this.progressItemElems,function(e,t){removeClass(t,"StoryAuthor__progressItem_filled")});e>=0;)addClass(this.progressItemElems[--e],"StoryAuthor__progressItem_filled")},e.prototype.setCurrentStoryIndex=function(e){this.data.index=e,this.drawFilledProgressItems()},e.prototype.renderEmpty=function(){var e=this.story.getPreview(),t=Stories.getWidth();return i.default.html({class:"StoryAuthor StoryAuthor_empty",style:"width: "+t+"px;",attrs:{"data-src":e}})},e.prototype.render=function(){var e,t,n,r=window.lang,a=Stories.getWidth(),s=o.isTouch?"ontouchstart":"onmousedown",u=o.isTouch?"ontouchend":"onmouseup";return i.default.html({class:"StoryAuthor StoryAuthor_inited",style:"width: "+a+"px;",inner:[{class:"StoryAuthor__header",inner:{class:"StoryAuthor__progress",inner:this.data.items.map(function(){return{class:"StoryAuthor__progressItem",inner:{class:"StoryAuthor__progressItemBar",inner:{class:"StoryAuthor__progressItemCurrent"}}}})}},(e={class:"StoryAuthor__muted"},l(e,s,"Stories.unMute(this, event);"),l(e,"inner",[{class:"Story__icon Story__icon_unmute"},{class:"StoryAuthor__muted_text",inner:r.mobile_stories_unmute}]),e),(t={class:"StoryAuthor__next"},l(t,s,"Stories.onTouchStart(event);"),l(t,u,"Stories.onTouchEnd(event);"),l(t,"ontouchcancel","Stories.onTouchEnd(event);"),t),(n={class:"StoryAuthor__prev"},l(n,s,"Stories.pauseStory(true);"),l(n,u,"Stories.playStory(true);"),l(n,"onclick","Stories.prevStory(); "),n),{class:"StoryAuthor__body",inner:this.authorStoriesHTML}]})},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MAIL_CHAT_UPDATE_TYPE_MESSAGE_REQUEST_CHANGED=t.MAIL_CHAT_UPDATE_TYPE_KEYBOARD_CHANGED=t.MAIL_CHAT_UPDATE_TYPE_BANNER_CHANGED=t.MAIL_CHAT_UPDATE_TYPE_ADMIN_KICKED=t.MAIL_CHAT_UPDATE_TYPE_USER_KICKED=t.MAIL_CHAT_UPDATE_TYPE_USER_LEFT=t.MAIL_CHAT_UPDATE_TYPE_USER_JOINED=t.MAIL_CHAT_UPDATE_TYPE_PINNED=t.MAIL_CHAT_UPDATE_TYPE_FLAGS_CHANGED=t.MAIL_CHAT_UPDATE_TYPE_ADMIN_GRANTED=t.MAIL_CHAT_UPDATE_TYPE_AVATAR_CHANGED=t.MAIL_CHAT_UPDATE_TYPE_TITLE_CHANGED=t.FOLDER_HAS_BANNER=t.FOLDER_UNRESPOND=t.FOLDER_IMPORTANT=t.FLAG_HAS_REPLY=t.FLAG_STEALTH=t.FLAG_MEDIA=t.FLAG_DELETED=t.FLAG_SPAM=t.FLAG_FRIENDS=t.FLAG_CHAT=t.FLAG_IMPORTANT=t.FLAG_OUTBOUND=t.FLAG_UNREAD=t.AUDIO_START=t.REPLACE_MESSAGE=t.EDIT_MESSAGE=t.DELETE_DIALOG=t.RESEND=t.FAILED_MESSAGE=t.CHANGE_TAB=t.CHANGE_PEER=t.MUTEX=t.RESET_PEER=t.TRANSITION=t.REFRESH_LP_KEY=t.RESYNC=t.SET_DIRECTORIES=t.REPLACE_DIRECTORIES=t.RESET_DIRECTORIES=t.EMPTY=t.NOTIFY_SETTINGS_CHANGED=t.UNREAD_COUNT=t.VIDEO_CALL=t.RECORDING_AUDIO=t.TYPING=t.CONVERSATION_UPDATED=t.CHAT_CHANGED=t.GOT_OFFLINE=t.GOT_ONLINE=t.READ_OUTBOUND=t.READ_INBOUND=t.ADD_MESSAGE=t.RESET_FLAGS=t.REPLACE_FLAGS=t.SET_FLAGS=t.DELETE=void 0;var i=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{!i&&s.return&&s.return()}finally{if(o)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.deleteEvent=function(e){var t=i(e,2)[1];return{type:r,localId:t}},t.replaceFlagsEvent=function(e){var t=i(e,4),n=t[1],o=t[2],r=t[3];return{type:s,messageId:n,mask:o,peerId:r}},t.setFlagsEvent=function(e){var t=i(e,4),n=t[1],o=t[2],r=t[3];return{type:a,messageId:n,flags:o,peerId:r}},t.resetFlagsEvent=function(e){var t=i(e,4),n=t[1],o=t[2],r=t[3];return{type:l,messageId:n,flags:o,peerId:r}},t.addMessageEvent=R,t.editMessageEvent=function(e){var t=R(e);return t.type=L,t},t.replaceMessageEvent=function(e){var t=R(e);return t.type=O,t},t.editMessageLocallyEvent=function(e){return extend({},e,{type:L})},t.readInboundEvent=function(e){var t=i(e,4),n=t[1],o=t[2],r=t[3];return{type:c,peerId:n,upToId:o,unread:r}},t.readOutboundEvent=function(e){var t=i(e,4),n=t[1],o=t[2],r=t[3];return{type:d,peerId:n,upToId:o,unread:r}},t.gotOnlineEvent=function(e){var t=i(e,4),n=t[1],o=t[2],r=t[3];return{type:f,userId:-n,platform:o,lastSeenTs:r}},t.gotOfflineEvent=function(e){var t=i(e,4),n=t[1],o=t[2],r=t[3];return{type:p,userId:-n,reason:o,lastSeenTs:r}},t.resetDirectoriesEvent=function(e){var t=i(e,4),n=t[1],o=t[2],r=t[3],a=void 0!==r&&r;return{type:b,peerId:n,mask:o,local:a}},t.replaceDirectoriesEvent=function(e){var t=i(e,3),n=t[1],o=t[2];return{type:D,peerId:n,mask:o}},t.setDirectoriesEvent=function(e){var t=i(e,4),n=t[1],o=t[2],r=t[3],a=void 0!==r&&r;return{type:C,peerId:n,mask:o,local:a}},t.deleteDialogEvent=function(e){var t=i(e,3),n=t[1],o=t[2];return{type:F,peerId:n,localId:o}},t.chatChangedEvent=function(e){var t=i(e,3),n=t[1],o=t[2];return{type:_,chatId:n,self:o}},t.chatUpdatedEvent=function(e){var t=i(e,4),n=t[1],o=t[2],r=t[3];return{type:A,peerId:o,updateType:n,updateArg:r}},t.typingEvent=function(e){var t=i(e,5),n=t[1],o=t[2],r=t[3],a=t[4];return{type:m,peerId:n,userIds:o,totalCount:r,ts:a}},t.recordingAudioEvent=function(e){var t=i(e,5),n=t[1],o=t[2],r=t[3],a=t[4];return{type:h,peerId:n,userIds:o,totalCount:r,ts:a}},t.videoCallEvent=function(e){var t=i(e,3),n=t[1],o=t[2];return{type:v,userId:n,callId:o}},t.unreadCountEvent=function(e){var t=i(e,4),n=t[1],o=t[2],r=t[3];return{type:g,count:n,countNotMuted:o,showOnlyNotMuted:r}},t.notifySettingsChangedEvent=function(e){var t=i(e,2)[1],n=void 0===t?{}:t;return{type:y,peerId:n.peer_id,sound:n.sound,disabledUntil:n.disabled_until}},t.refreshMessageEvent=function(e){var t=i(e,2)[1],n=void 0===t?{}:t,o=R([!1,n.id,n.flags,n.peer_id,n.date,n.message,extend(n.kludges,{title:n.title||""}),{},n.random_id,n.chat_local_id,n.update_time]);return o.type=L,o},t.audioStartEvent=function(e){var t=i(e,2)[1],n=void 0===t?{}:t;return{type:N,uuid:n.uuid,deviceName:n.device_name||""}},t.emptyEvent=function(e){return{type:w,params:e}},t.transitionEvent=function(e){return{type:k,state:e}},t.resyncEvent=function(){return{type:E}},t.refreshLpKeyEvent=function(e){var t=i(e,3),n=t[1],o=t[2];return{type:S,key:n,url:o}},t.resetPeer=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{type:M,cancelSearch:e,removeActivePeer:t}},t.changePeer=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";return{type:x,peerId:e,msgid:t,forward:n,cancelSearch:i,entryPoint:o}},t.changeTab=function(e){return{type:I,tab:e}},t.failedMessage=function(e,t,n){return{type:P,message:t,peer:e,error:n}},t.mutexEvent=function(e){var t=i(e,6),n=(t[0],t[1]),o=t[2],r=t[3],a=t[4],s=t[5];return{type:T,free:!!intval(n)||intval(a)===vk.id,resource:o,peerId:intval(r),who:intval(a),name:s}},t.resendEvent=function(e,t){return{type:B,message:t,peerId:e}};var o=n(63),r=t.DELETE="event_delete",a=t.SET_FLAGS="event_set_flags",s=t.REPLACE_FLAGS="event_replace_flags",l=t.RESET_FLAGS="event_reset_flags",u=t.ADD_MESSAGE="event_add_message",c=t.READ_INBOUND="event_read_inbound",d=t.READ_OUTBOUND="event_read_outbound",f=t.GOT_ONLINE="event_got_online",p=t.GOT_OFFLINE="event_got_offline",_=t.CHAT_CHANGED="event_chat_changed",A=t.CONVERSATION_UPDATED="event_chat_updated",m=t.TYPING="event_typing",h=t.RECORDING_AUDIO="event_recoding_audio",v=t.VIDEO_CALL="event_video_call",g=t.UNREAD_COUNT="event_unread_count",y=t.NOTIFY_SETTINGS_CHANGED="event_notify_settings_changed",w=t.EMPTY="event_empty",b=t.RESET_DIRECTORIES="event_reset_directories",D=t.REPLACE_DIRECTORIES="event_replace_directories",C=t.SET_DIRECTORIES="event_set_directories",E=t.RESYNC="event_resync",S=t.REFRESH_LP_KEY="event_refresh_lp_key",k=t.TRANSITION="transition_event",M=t.RESET_PEER="reset_peer",T=t.MUTEX="mutex",x=t.CHANGE_PEER="change_peer",I=t.CHANGE_TAB="event_change_tab",P=t.FAILED_MESSAGE="event_failed_message",B=t.RESEND="event_resend",F=t.DELETE_DIALOG="event_delete_dialog",L=t.EDIT_MESSAGE="event_edit_message",O=t.REPLACE_MESSAGE="event_replace_message",N=t.AUDIO_START="event_audio_start";t.FLAG_UNREAD=1,t.FLAG_OUTBOUND=2,t.FLAG_IMPORTANT=8,t.FLAG_CHAT=16,t.FLAG_FRIENDS=32,t.FLAG_SPAM=64,t.FLAG_DELETED=128,t.FLAG_MEDIA=512,t.FLAG_STEALTH=65536,t.FLAG_HAS_REPLY=1<<21,t.FOLDER_IMPORTANT=1,t.FOLDER_UNRESPOND=2,t.FOLDER_HAS_BANNER=8,t.MAIL_CHAT_UPDATE_TYPE_TITLE_CHANGED=1,t.MAIL_CHAT_UPDATE_TYPE_AVATAR_CHANGED=2,t.MAIL_CHAT_UPDATE_TYPE_ADMIN_GRANTED=3,t.MAIL_CHAT_UPDATE_TYPE_FLAGS_CHANGED=4,t.MAIL_CHAT_UPDATE_TYPE_PINNED=5,t.MAIL_CHAT_UPDATE_TYPE_USER_JOINED=6,t.MAIL_CHAT_UPDATE_TYPE_USER_LEFT=7,t.MAIL_CHAT_UPDATE_TYPE_USER_KICKED=8,t.MAIL_CHAT_UPDATE_TYPE_ADMIN_KICKED=9,t.MAIL_CHAT_UPDATE_TYPE_BANNER_CHANGED=10,t.MAIL_CHAT_UPDATE_TYPE_KEYBOARD_CHANGED=11,t.MAIL_CHAT_UPDATE_TYPE_MESSAGE_REQUEST_CHANGED=12;function R(e){var t=i(e,11),n=t[1],r=t[2],a=t[3],s=t[4],l=t[5],c=t[6],d=t[7],f=t[8],p=t[9],_=t[10],A=extend(c,d||void 0);return{type:u,messageId:intval(n),flags:intval(r),peerId:intval(a),date:intval(s),attaches:(0,o.convertKludgesToAttaches)(A,n),subject:c.title||"",text:l,kludges:A,randomId:intval(f),userId:(0,o.isChatPeer)(a)?intval(A.from):intval(a),update_time:_,chat_local_id:p}}},function(e,t,n){"use strict";s(n(72));var i=n(73),o=n(1),r=(s(n(313)),n(139)),a=s(r);function s(e){return e&&e.__esModule?e:{default:e}}Object.assign(a.default,{updateClass:p,clearSystemMessage2:function(){remove(geByClass1("service_msg_box"))},onSystemMessageClick:function(){e=store.mail,t=e.cur,e.peers[t.peerId].systemMessageCode=null,p("peer"),_();var e,t},resetPrevScraps:function(){l={folder:[],search:[],peer:[]}},redrawPeer:function(){f("peer",store.mail.scraps.peer),$$(".mailScrap_peer").forEach(function(e){return e.className=(0,r.MailScrap_class)("peer")}),$$(".mailScrap__empty_peer").forEach(function(e){return e.innerHTML=(0,r.MailScrap_EmptyInner)("peer")})},redrawFolder:function(e){var t=store.mail,n=t.cur,i=t.scraps;n.folder;f("folder",i.folder,e),$$(".mailScrap_folder").forEach(function(e){return e.className=(0,r.MailScrap_class)("folder")}),$$(".mailScrap__empty_folder").forEach(function(e){return e.innerHTML=(0,r.MailScrap_EmptyInner)("folder")})},redrawSearch:function(){$$(".mailScrap__items_search").forEach(function(e){return e.innerHTML=(0,r.MailScrap_ItemsInner)("search")}),$$(".mailScrap_search").forEach(function(e){return e.className=(0,r.MailScrap_class)("search")}),$$(".mailScrap__empty_search").forEach(function(e){return e.innerHTML=(0,r.MailScrap_EmptyInner)("search")})},redrawMRs:function(e){f("mrs",store.mail.scraps.mrs,e),$$(".mailScrap_mrs").forEach(function(e){return e.className=(0,r.MailScrap_class)("mrs")}),$$(".mailScrap__empty_mrs").forEach(function(e){return e.innerHTML=(0,r.MailScrap_EmptyInner)("mrs")})},redrawSystemMessage:_,folderSetItems:function(e){$$(".mailScrap__items_folder").forEach(function(t){return t.innerHTML=d(e,!0)}),$$(".mailScrap_folder").forEach(function(e){return e.className=(0,r.MailScrap_class)("folder")}),$$(".mailScrap__empty_folder").forEach(function(e){return e.innerHTML=(0,r.MailScrap_EmptyInner)("folder")})},folderAddItems:function(e){$$(".mailScrap__items_folder").forEach(function(t){return t.insertAdjacentHTML("beforeend",d(e))})},folderCutItems:function(e){$$(".mailScrap_folder .mailScrap__items").forEach(function(t){var n=[].slice.call(t.children);n.slice(e).forEach(function(e){return t.removeChild(e)})})},peerAddItemsBefore:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];p("peer"),e=e.filter(unique).filter(function(e){return!$(".msg_id_"+e)});var n=i.Messenger.getConvoBody();n.scrollHeight,n.scrollTop,n.offsetHeight;window._preventedCheckTop=!0,setTimeout(function(){return window._preventedCheckTop=!1});var o='\n    <div class="load_before load_before_closed">\n      '+c(e,t)+"\n    </div>\n  ";return $$(".mailScrap__items_peer").forEach(function(e){return e.insertAdjacentHTML("afterbegin",o)}),void uMessenger.expandPeerBefore()},peerAddItemsAfter:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e=e.filter(unique).filter(function(e){return!$(".msg_id_"+e)}),$$(".mailScrap__items_peer").forEach(function(n){n.insertAdjacentHTML("beforeend",c(e,t))}),p("peer"),(0,o.resizePosters)()},peerReplaceItems:function(e){e.forEach(function(t){var n=$(".msg_id_"+t);n&&(n.outerHTML=c(e,!0))}),(0,o.resizePosters)()},peerSetItems:function(e){e=e.filter(unique),$$(".mailScrap__items_peer").forEach(function(t){return t.innerHTML=c(e)})},peerGoToBottom:function(){var e=i.Messenger.getConvoBody();e.scrollTop=e.scrollHeight},removeDivider:u,checkDivider:function(){var e=last($(".mailScrap__items_peer").children);e&&e.classList.contains("msg__newMsgsDivider")&&u()}}),uVK.onReady(function(){if(store.mail&&store.mail.scraps){var e=store.mail.scraps;l.folder=e.folder.slice(),l.search=e.search.slice(),l.peer=e.peer.slice()}});var l={folder:[],search:[],peer:[]};function u(){remove($(".msg__newMsgsDivider"))}function c(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e=e.filter(unique);var n=store.mail,i=n.cur,o=n.msgs,a=!!$(".msg__newMsgsDivider"),s=void 0;return e.map(function(e,n){var l=o[e];return n>0&&!a&&!t&&!s.isUnread&&l.isUnread&&l.authorId!==i.viewerId?(s=l,a=!0,(0,r.MailScrap_Item)("peer",e,!0)):(s=l,(0,r.MailScrap_Item)("peer",e))}).join("")}function d(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(e=e.filter(unique)).map(function(e){return $(".mailScrap__items_folder .convo_id_"+e)&&!t?"":(0,r.MailScrap_Item)("folder",e)}).join("")}function f(e,t,n){!function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=[];i||(e.innerHTML="",i=[]);if(0===n.length)return void(e.innerHTML="");n.forEach(function(n,o){var r=i.indexOf(n);-1===r?(i.splice(o,0,n),domInsert(e,t(n),o)):r!==o&&(i.splice(r,1),i.splice(o,0,n),before(e.children[r],e.children[o]))}),i.forEach(function(t,i){-1===n.indexOf(t)&&o.push(e.children[i])}),o.forEach(remove)}($(".mailScrap__items_"+e),function(t){return(0,r.MailScrap_Item)(e,t)},t,n)}function p(e){$$(".mailScrap_"+e).forEach(function(t){return t.className=(0,r.MailScrap_class)(e)})}function _(){$$(".mailScrap__systemMessage").forEach(function(e){e.innerHTML=(0,r.MailScrap_SystemMessageInner)()})}},function(e,t,n){"use strict";var i=n(322),o=s(n(326)),r=s(n(75)),a=s(n(306));function s(e){return e&&e.__esModule?e:{default:e}}var l=need("Slider");window.VotingForm={},VotingForm._onInit=m,VotingForm._onAddOptionClick=A,VotingForm._onExpireChange=v,VotingForm._onOptionRemoveClick=g,VotingForm._onTitleKeyDown=p,VotingForm._onOptionKeyDown=_,mediaUpload.onComplete(b),mediaUpload.onStart(D),mediaUpload.onError(C);var u={uploading:"VotingForm_uploading",withExpire:"VotingForm_withExpire",maxOptions:"VotingForm_maxOptions"},c={form:".VotingForm",maxOptions:".VotingForm_maxOptions",option:".VotingForm__option",options:".VotingForm__options",upload:".VotingForm__upload",bcg:".VotingForm__bcg",bcgRadioChecked:".VotingForm__bcgRadio:checked"},d=13,f=8;function p(e){e.keyCode===d&&e.preventDefault()}function _(e){if(p(e),e.keyCode===d){if(!(0,i.$)(c.maxOptions))if((0,i.$)(".VotingForm__option:last-child input")===document.activeElement)return h(),void(0,i.$)(".VotingForm__option:last-child input").focus();if(document.activeElement){var t=document.activeElement.closest(".VotingForm__option"),n=t.nextElementSibling&&t.nextElementSibling.$("input");n&&(n.focus(),n.selectionStart=n.value.length,n.selectionEnd=n.value.length)}}else if(e.keyCode===f){if(1===$$(".VotingForm__option").length)return;var o=e.target;o.value||setTimeout(function(){var e=o.closest(".VotingForm__option"),t=e.previousElementSibling;if(e.outerHTML="",w(),t){var n=t.$("input");n.focus(),n.selectionStart=n.value.length,n.selectionEnd=n.value.length}})}}function A(){h(),(0,i.$)(".VotingForm__option:last-child input").focus()}function m(){var e=(0,i.$)(c.bcgRadioChecked).closest(c.bcg);l.scrollToElem(e)}function h(){var e=(0,i.$)(c.options),t=(0,a.default)({});e.insertAdjacentHTML("beforeend",o.default.html(t)),y(),w()}function v(e){var t=e.$control,n=e.checked;t.closest(c.form).classList.toggle(u.withExpire,n)}function g(e){e.closest(c.option).outerHTML="",y(),w()}function y(){Array.from($$('.VotingForm__option[data-created="0"] input')).forEach(function(e,t){e.setAttribute("name","answers["+t+"]")})}function w(){var e=(0,i.$)(c.form),t=Number(e.getAttribute("data-max-options")),n=$$(c.option).length;e.classList.toggle(u.maxOptions,n===t)}function b(e){var t=(0,i.$)(c.form);if(t){var n=(0,i.$)(c.upload),a=(t.getAttribute("data-upload-html"),o.default.html((0,r.default)("poll_background_id",{id:"photo_"+e.photo_id,type:"photo",photo:e.src,color:e.color,checked:!0})));n.insertAdjacentHTML("beforebegin",a),E()}}function D(){var e=(0,i.$)(c.upload);e&&e.classList.add(u.uploading)}function C(e){var t=(0,i.$)(c.form);if(t){var n=t.getAttribute("data-upload-error-msg");E(),alert(n)}}function E(){var e=(0,i.$)(c.form);(0,i.$)(c.upload).outerHTML=e.getAttribute("data-upload-html")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Convo__online=void 0;var i,o,r=(i=['\n    <div class="','" ',">\n      ","\n      ",'\n      <a class="convo__body" href="','">\n        <div class="convo__row convo__row_title">\n          <div class="convo__title">','</div>\n          <div class="convo__row_right">\n            ','\n            <div class="convo__date">','</div>\n          </div>\n        </div>\n        <div class="convo__row convo__row_text">\n          <div class="convo__typing">','</div>\n          <div class="convo__text">','</div>\n          <div class="convo__row_right">\n            ','\n            <div class="convo__unreadOut"></div>\n          </div>\n        </div>\n      </a>\n    </div>\n  '],o=['\n    <div class="','" ',">\n      ","\n      ",'\n      <a class="convo__body" href="','">\n        <div class="convo__row convo__row_title">\n          <div class="convo__title">','</div>\n          <div class="convo__row_right">\n            ','\n            <div class="convo__date">','</div>\n          </div>\n        </div>\n        <div class="convo__row convo__row_text">\n          <div class="convo__typing">','</div>\n          <div class="convo__text">','</div>\n          <div class="convo__row_right">\n            ','\n            <div class="convo__unreadOut"></div>\n          </div>\n        </div>\n      </a>\n    </div>\n  '],Object.freeze(Object.defineProperties(i,{raw:{value:Object.freeze(o)}}))),a=f(n(77)),s=f(n(131)),l=f(n(293)),u=f(n(355)),c=f(n(34)),d=f(n(112));function f(e){return e&&e.__esModule?e:{default:e}}function p(e){return"mobile"===e?(0,u.default)({mix:a.default.class("convo__online",{mobile:!0}),icon:"phone"}):"desktop"===e?(0,s.default)({mix:a.default.class("convo__online",{desktop:!0})}):(0,s.default)({mix:"convo__online"})}t.default=function(e){var t=e.more,n="",i="",o=0,s=!1,f="";t&&(n=t.text,i=t.date,o=t.unreadCount,s=t.muted,f=t.typing?(0,d.default)(t.typing):"");var _=a.default.class("clickable","convo",{id:e.id,short:!t,last:e.isLast,typing:!!f,important:e.important,unread:e.isLast&&o>0,unreadOut:e.isLast&&o<0}),A=(0,c.default)({mix:"convo__avatar",photos:e.photos,url:e.profileUrl}),m=e.isLast?(0,l.default)({mix:"convo__unread",value:o,gray:s}):"",h=p(e.online),v=(0,u.default)({mix:"convo__star",icon:"star",blue:!0}),g=e.url,y=a.default.onClick("Convo._onClick","event",g);return a.default.html(r,_,y,h,A,e.url,e.title,v,i,f,n,m)},t.Convo__online=p},function(e,t,n){"use strict";var i=window,o=i.remove,r=i.append;window.Snackbar={init:function(e){var t=Wd.elem(SnackbarItem(e));(function(e){var t=document.body;r(e,t),setTimeout(function(){e.classList.add(a.added)},100)})(t),setTimeout(function(){!function(e){e.classList.add(a.removed),setTimeout(function(){o(e)},300)}(t)},5e3)}};var a={added:"SnackbarItem_added",removed:"SnackbarItem_removed"}},function(e,t,n){"use strict";var i=n(322),o=l(n(72)),r=l(n(215)),a=l(n(39)),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(149));function l(e){return e&&e.__esModule?e:{default:e}}function u(e){requestAnimationFrame(function(){var t=e.value;f(e.value),a.default.onChange(t)})}function c(){s.onOpen("top")}function d(e){var t=e.closest(".mailFilter").$(".mailFilter__input"),n=document.activeElement===t;(r.default.ios?setTimeout:requestAnimationFrame)(function(){f(""),t.value="",n&&t.focus(),a.default.onClear(),a.default.onChange("")})}function f(e){(0,i.$$)(".mailFilter").forEach(function(t){return t.classList.toggle("mailFilter_hasQuery",!!e)})}Object.assign(a.default,{onChange:(0,o.default)("query"),onClear:(0,o.default)(),setQuery:function(e){var t=(0,i.$)(".mailFilter__input");t&&t.value!==e&&(t.value=e,a.default.onChange(e),f(e))}}),a.default._onInput=u,a.default._onClearMouseDown=d,a.default._onFocus=c},function(e,t,n){"use strict";var i,o=n(215),r=(i=o)&&i.__esModule?i:{default:i};var a=window,s=a.page,l=a.nav,u=a.menu,c=a.zlayer,d=window,f=d.onDOMReady,p=d.onBodyScroll,_=d.onBodyResize,A=window,m=A.geByClass1,h=A.addClass,v=A.removeClass,g=(A.getW,A.getH),y="groupCover-vk_animationYes",w="groupCover-vk_animationStep",b=function(){return{vk:m("vk"),basis:m("basis"),header:m("basis__header"),headerTitle:m("mh_header",m("basis__header")),cover:m("groupCover"),coverImage:m("groupCover__image"),coverDimmer:m("groupCover__dimmer")}},D=!1,C=void 0,E=void 0,S=void 0,k=void 0,M=void 0;function T(){D||(C=b()).cover&&(D=!0,h(C.vk,y),E=!r.default.chrome||Number(r.default.version.split(".")[0])>50,S="fixed"===getStyle(C.header,"position"),k=g(C.header),M=g(C.cover),p(P),_(B),P(),window.cur.destroy.push(I),l.onBeforeGo(x))}function x(e){(e||u.opened())&&(v(C.vk,w),v(C.vk,y)),p("__clear",P),_("__clear",B),l.onBeforeGo.off(x),D=!1}function I(){x(!0)}function P(){var e=scrollTop();if(S)if(e<0)setStyle(C.header,"top",-e),h(C.vk,w),setStyle(C.coverDimmer,"opacity",0),setStyle(C.coverImage,"top",0);else{var t=Math.min(1,e/(M-k));setStyle(C.header,"top",0),setStyle(C.headerTitle,"display","block"),t<=.9?(h(C.vk,w),E&&setStyle(C.coverImage,"top",.5*e),setStyle(C.coverDimmer,"opacity",t/.9),setStyle(C.headerTitle,"opacity",0)):(setStyle(C.headerTitle,"opacity",1),v(C.vk,w))}else Math.min(1,e/M)<1?(h(C.vk,w),setStyle(C.coverDimmer,"opacity",0),E&&setStyle(C.coverImage,"top",.5*e),setStyle(C.headerTitle,"display","none")):v(C.vk,w)}function B(){I(),T()}f(function(){(r.default.chrome||r.default.safari&&r.default.ios>=9)&&(T(),s.onChange(T),c.onClose(function(){setTimeout(T,0)}))})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(28),r=(i=o)&&i.__esModule?i:{default:i};n(70),t.default=r.default,Object.assign(window,{Oval:r.default,Oval_isHidden:o.Oval_isHidden})},function(e,t,n){"use strict";var i=window,o=i.removeClass,r=i.addClass,a=i.geByClass1,s={obj:null,highlight:!1,start:function(e){e.touches&&1==e.touches.length&&(s.clear(),s.end(e),s.obj=this||null,s.obj&&(s.highlight=!0,r("hover",s.obj)))},cancel:function(e){s.obj&&(s.highlight=!1,s.end(e))},end:function(){s.obj&&(o("hover",s.obj),s.highlight&&(s.clear(),r("active",s.obj)),s.obj=null,s.highlight=!1)},clear:function(){o("active",a("active","vk_wrap"))}};window.thover=s},function(e,t,n){"use strict";var i,o=n(322),r=n(210),a=(i=r)&&i.__esModule?i:{default:i};window.AudioSerp={setView:function(e){return u("view",e)},setTab:function(e){return u("tab",e)},toggleTabs:function(e){(0,o.$)(l.serp).classList.toggle(s.noTabs,!e)},setFoundHtml:function(e){(0,o.$)(l.found).outerHTML=e},getFoundHtml:function(){return(0,o.$)(l.found).outerHTML}};var s={serpMod:function(e){return"AudioSerp_"+e},noTabs:"AudioSerp_noTabs"},l={serp:".AudioSerp",found:".AudioSerp__found"};function u(e,t){var n=(0,o.$)(l.serp);a.default.setMod(n,s.serpMod(e),t)}},function(e,t,n){"use strict";var i=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{!i&&s.return&&s.return()}finally{if(o)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},r=u(n(323)),a=u(n(99)),s=u(n(262)),l=u(n(326));function u(e){return e&&e.__esModule?e:{default:e}}function c(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var d=window.Popup,f=window.ActionMenu,p=window.attr,_=window.val,A=window.ajax,m=window.replace,h=window.scrollTop,v=window.ceFromString,g=window.Btn;window.Bookmarks={hideTagsList:M,showTagsList:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e&&e.stopPropagation();var n=E(y.tagsListPopup),i=F();if(n.classList.remove("BookmarksPopup__hideCorner"),t){var o=t.closest(y.bookmarkItem),a=p(o,"id"),s=L(a);i=i.filter(function(e){return s.includes(e.id)}),n.classList.add("BookmarksPopup__hideCorner")}var u=qs2obj(nav.params),c=Object.keys(i).reduce(function(e,t){var n=i[t];return e.push((0,r.default)({tag:n,current_id:parseInt(u.tag)})),e},[]),d=l.default.html(c);return _(n.$(".Popup__scrollContent"),d),!1},hideDeletePopup:T,showDeletePopup:function(e){var t=E(y.tagsDeletePopup),n=p(e,"data-id"),i=p(e,"data-hash"),o=p(e,"data-name");return N(t,{id:n,hash:i}),_(t.$("["+w.deleteName+"]"),htsc(o)),!1},submitDeleteTag:function(){var e=R($(y.tagsDeletePopup)),t=e.id,n=e.hash;A.post("/bookmarks",{_ajax:1,act:"tag_delete",id:t,hash:n},{onDone:function(e){C(e),T()}})},hideCreatePopup:x,showCreatePopup:function(e){var t=E(y.tagsCreatePopup),n=p(e,"data-hash");N(t,{hash:n});var i=$("[name="+w.createName+"]",t),o=$(y.tagsSubmitButton,t),r=_(i).trim();return g.setDisabled(o,!r),!1},submitCreateTag:function(){var e=$(y.tagsCreatePopup),t=$(y.tagsSettings),n=R(e).hash,o=_(e.$("[name="+w.createName+"]")),r=+!!$(y.tagsSettings);A.post("/bookmarks",{_ajax:1,act:"tag_edit",tag:o,hash:n,id:0,from_settings:r},{onDone:function(e,n){if(r){var o=[];Array.from(t.$$('[name="tag"][type="checkbox"]:checked')||[]).forEach(function(e){o.push(e.value)}),_(t,e),o.forEach(function(e){var n=t.$('[name="tag"][type="checkbox"][value="'+e+'"]');n&&(n.checked=!0)})}else C(e);!function(e){var t=B(),n=i(e,2),o=n[0],r=n[1];t&&t.tags&&t.tags.push({id:o,name:r,order:0})}(n),x()}})},hideEditPopup:I,showEditPopup:function(e){var t=E(y.tagsEditPopup),n=p(e,"data-id"),i=p(e,"data-hash"),o=p(e,"data-name")||"",r=t.$("[name="+w.editName+"]");_(r,o),N(t,{id:n,hash:i,name:o});var a=$(y.tagsSubmitButton,t),s=_(r).trim();return g.setDisabled(a,!s),!1},submitEditTag:function(){var e=$(y.tagsEditPopup),t=R(e),n=t.id,i=t.hash,o=_(e.$("[name="+w.editName+"]"));A.post("/bookmarks",{_ajax:1,act:"tag_edit",tag:o,hash:i,id:n},{onDone:function(e){C(e),I()}})},hideSettingsPopup:P,showSettingsPopup:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=void 0,i=void 0,o=void 0,r=p(e,"data-item_id"),a=p(e,"data-item_oid"),s=p(e,"data-item_type"),u=p(e,"data-hash"),c=p(e,"data-raw");t.wrap||(n=E(y.tagsSettingsPopup),i=n.$(y.tagsSettings),o=L(c),_(i,l.default.html({class:"Bookmarks__tagsSettingsLoading"})),N(n,{id:r,oid:a,type:s,hash:u,itemRaw:c}));return A.post("/bookmarks",{_ajax:1,act:"tag_settings",hash:u,item_id:r,item_oid:a,item_type:s,wrap:t.wrap?1:0},{onDone:function(e){if(t.wrap){var l=document.body,d=v(e);append(d,l),E(d),N(d,{id:r,oid:a,type:s,hash:u,itemRaw:c,needRemove:!0})}else _(i,e),o.forEach(function(e){var t=n.$('[name="tag"][type="checkbox"][value="'+e+'"]');t&&(t.checked=!0)})}}),!1},submitSettingsTags:function(){var e=$(y.tagsSettingsPopup),t=R(e),n=t.id,i=t.oid,o=t.type,r=t.hash,s=t.itemRaw,u=[];Array.from(e.$$('[name="tag"][type="checkbox"]:checked')||[]).forEach(function(e){u.push(e.value)});var c=u.join(",");A.post("/bookmarks",{_ajax:1,act:"tag_set",hash:r,item_id:n,item_oid:i,item_type:o,tag_ids:c},{onDone:function(e){P();var t=$("#"+s);if(t){var n=$(".BookmarkListItem__tags, .BookmarksItem__tag",t);if(n)_(n,e);else if(n=$(".Owner__tags",t)){var i=F(),o=u.map(function(e){return parseInt(e,10)}),r=i.filter(function(e){return o.includes(e.id)}),c=l.default.html((0,a.default)({tags:r}));_(n.parentNode,c)}V(s,u,""),cur&&cur.search_bookmarks&&cur.search_bookmarks.redraw()}}})},closeAll:function(){M(),T(),x(),I(),P()},initStore:O,pushItemsToStore:function(e){var t=B();t&&(t.items=o({},t.items,e))},pushItemToStore:V,removeFromBookmarkLink:function(e){var t=p(e,"data-item_id"),n=p(e,"data-item_oid"),i=p(e,"data-item_type"),o=p(e,"data-hash"),r=p(e,"data-raw"),a=$("#"+r);return f.closeMenu(),addClass(a,b.removed),A.post("/bookmarks",{_ajax:1,act:"bookmark_remove",hash:o,item_id:t,item_oid:n,item_type:i},{onDone:function(e){H(r,[b.removed]),cur&&cur.search_bookmarks&&cur.search_bookmarks.redraw()}}),!1},addToBookmarkLink:function(e){var t=p(e,"data-item_id"),n=p(e,"data-item_oid"),i=p(e,"data-item_type"),o=p(e,"data-hash"),r=p(e,"data-raw"),a=$("#"+r);return f.closeMenu(),removeClass(a,b.removed),A.post("/bookmarks",{_ajax:1,act:"bookmark_add",hash:o,item_id:t,item_oid:n,item_type:i},{onDone:function(){var e=j(r),t=e.indexOf(b.removed);-1!==t&&e.splice(t,1),H(r,e),cur&&cur.search_bookmarks&&cur.search_bookmarks.redraw()}}),!1},showSuccessSnack:function(e){var t=window.lang;Snackbar.init({text:t.mobile_bookmarks_snackbar_added,action:{url:"/bookmarks",text:t.mobile_bookmarks_snackbar_edit_tags,onclick:"return Bookmarks.showSettingsPopup(this, { wrap: true });",attrs:Object.keys(e).reduce(function(t,n){var i=e[n];return t["data-"+n]=i,t},{})}})},keyupCreateInput:function(e,t){var n=gpeByClass("BookmarksPopup",t),i=$(y.tagsSubmitButton,n),o=_(t).trim();g.setDisabled(i,!o)},openSavedTab:function(e,t){var n=$(".mm_counter",t),i=getCookie(D.lastTab);i&&!n&&(e&&e.preventDefault(),nav.go("/bookmarks?type="+i))},openLikesFeed:function(e){var t=$(".mm_new",e);remove(t)},getStoreItemDataById:U,getTagsByItemId:z,renderSearchItem:function(e,t,n,i,o){var r="";if(!i||isEmpty(i))r=n;else{var u=z(e),d=j(e);i=JSON.parse(i),u&&(t=u.reduce(function(e,t){return[].concat(c(e),[t.id])},[]),i.subtitle=(0,a.default)({tags:u})),d&&(i.mix=[].concat(c(d))),i.title=l.default.wrap(o.highlight(i.title)),r=l.default.html((0,s.default)(i))}return V(e,t,n),r}};var y={tagsListPopup:".BookmarksPopup__filter",tagsDeletePopup:".BookmarksPopup__delete",tagsCreatePopup:".BookmarksPopup__create",tagsEditPopup:".BookmarksPopup__edit",tagsSettingsPopup:".BookmarksPopup__settings",tagsSettings:".Bookmarks__tagsSettings",tagsListContainer:".BookmarkListItem__tags",tagsListWrap:".BookmarksTags",tagsListItem:".BookmarksTags__item",tagsListItemMore:".BookmarksTags__item_more",tagsContainer:".basisDefault",tagsSubmitButton:".BookmarksPopup__buttonSubmit",bookmarkItem:".BookmarksItem"},w={deleteName:"data-deletetagname",createName:"createtagname",editName:"edittagname"},b={removed:"BookmarksItem_removed"},D={lastTab:"remixblt"};function C(e){var t=h(),n=$(y.tagsContainer),i=v(e);m(i,n),h(t)}function E(e){var t=void 0;f.closeMenu(),t="string"==typeof e?$(e):e;var n="popup"+Date.now();return p(t,"data-popupid",n),d.open(t),t}function S(e){return p(e,"data-popupid")}function k(e){var t=void 0;if(t=!("string"==typeof e)?e:$(e)){d.close(t);var n=R(t),i=n&&n.needRemove;!function(e){var t=S(e);delete B().popup[t]}(t),i&&remove(t)}return!1}function M(){return k(y.tagsListPopup)}function T(){return k(y.tagsDeletePopup)}function x(){var e=$(y.tagsCreatePopup);if(e){var t=e.$("[name="+w.createName+"]");_(t,"")}return k(y.tagsCreatePopup)}function I(){var e=$(y.tagsEditPopup);if(e){var t=e.$("[name="+w.editName+"]");_(t,"")}return k(y.tagsEditPopup)}function P(){return k(y.tagsSettingsPopup)}function B(){return window.store.bookmarks||O(),window.store.bookmarks}function F(){var e=B();return e.tags?e.tags:{}}function L(e){var t=B();return t.items[e]?t.items[e][3]:[]}function O(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};window.store.bookmarks=o({},e,{popup:{}})}function N(e,t){var n=S(e);B().popup[n]=t}function R(e){var t=S(e);return B().popup[t]}function j(e){var t=B();return t&&t.items&&t.items[e]&&t.items[e][5]}function H(e,t){var n=B();n&&n.items&&n.items[e]&&(n.items[e][5]?n.items[e][5]=[].concat(c(n.items[e][5]),c(t)):n.items[e][5]=[].concat(c(t)))}function V(e,t,n,i){var o=B();o&&o.items&&(t=t.map(function(e){return parseInt(e,10)}),o.items[e]?(o.items[e][3]=t,o.items[e][4]=i):o.items[e]=["",n,e,t,i])}function U(e){var t=B();return t&&t.items&&t.items[e]}function z(e){var t=U(e),n=F();if(t&&n){var i=t[3]||[];return n.filter(function(e){return i.includes(e.id)})}return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};t._getLayer=d;var o=l(n(326)),r=l(n(357)),a=l(n(210)),s=n(1);function l(e){return e&&e.__esModule?e:{default:e}}var u={openPopup:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(cancelEvent(e),function(e){cur.loadedGifs||(cur.loadedGifs={});return!cur.loadedGifs[e.raw]}(n)&&n.needConfirm){var a=function(e){return(0,s.ceFromString)(o.default.html((0,r.default)({scrollable:!0,header:{title:getLang("mobile_wall_gif_size_warning_popup_title")},content:[getLang("mobile_wall_gif_size_warning").replace("{size}",e.size),{class:"Popup__buttons",inner:[c(getLang("mobile_continue"),"regular",'Gif.confirm(this, "'+e.raw+'")'),c(getLang("mobile_cancel"),"secondary","Popup.close(this)")]}]})))}(n,t.getAttribute("data-media"));return domInsertBefore(a,t),void r.default.open(a,!0)}var l=i({},nav.getQuery(),{z:"doc"+n.raw+"/"+n.hash}),u=nav.path+(0,s.obj2qs)(l)+nav.hash;nav.go(u,null,{push_only:!0,replace:!0,nav_init:!1,nav_incr:!0}),photo.zopen(null,null,n.raw,"",{no_push:!1,isDoc:!0,hash:n.hash})},init:function(e){zlayer.create(d()),zlayer.open()},close:function(){var e=i({},nav.getQuery());delete e.z;var t=nav.path+(0,s.obj2qs)(e)+nav.hash;nav.go(t,null,{push_only:!1,nav_incr:!0})},confirm:function(e,t){cur.loadedGifs[t]=!0,r.default.close(e),(0,s.geBySel1)('[data-media="'+t+'"]').click()}};function c(e,t,n){return{class:["Popup__button",a.default.class("Btn",{theme:t||"regular"})],tag:"button",inner:e,onclick:n}}function d(){return'\n    <div id="z_photoview">\n      <div class="zpv_siblings">\n        <div id="zpv_left" class="zpv_thumb_item">\n          <img class="zpv_img" alt="">\n        </div>\n        <div id="zpv_right" class="zpv_thumb_item">\n          <img class="zpv_img" alt="">\n        </div>\n      </div>\n      <div class="zpv_body">\n        <div id="zpv_center" class="zpv_thumb_item">\n          <img class="zpv_img" alt="">\n        </div>\n      </div>\n      <div class="zpv_close_msg_wrap">\n        <div class="zpv_close_msg"> '+lang.mobile_zphoto_move_to_close+'</div>\n      </div>\n      <div class="zpv_controls">\n        <div class="mhead zpv_header">\n          <a class="zpv_close_btn" onclick="return photoview.closePhoto(event);"><i class="zpv_close_icon"></i></a>\n          <div class="hb_wrap"><h1 id="zpv_summary" class="hb_btn mh_header"></h1></div>\n        </div>\n      </div>\n      <div class="zpv_tags"></div>\n      <div class="zpva zpv_crop"><div class="zpv_crop_box"></div><div class="zpv_crop_loading"></div></div>\n    </div>\'\n  '}window.Gif=u,t.default=u},function(e,t,n){"use strict";var i=window,o=i.onDOMReady,r=i.page,a=i.geByClass1,s=i.setStyle;function l(){var e=a("basisStory__media");if(e){var t=window.innerHeight-97;s(e,"height",t),setTimeout(function(){s(e,"max-height",800)})}}o(l),r.onChange(l)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=u(n(326)),o=u(n(118)),r=u(n(72)),a=u(n(272)),s=n(215),l=n(285);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=function(){function e(t,n,i,o){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=Stories.getStore(),this.state={authorIndex:i,storyIndex:o},this.date=t.date,this.preview=t.preview_url,this.type=t.type,this.photo_url=t.photo_url,this.video_url=t.video_url,this.first_frame=t.first_frame,this.videoSupport=!!window.HTMLVideoElement,this.views=t.views,this.answers=t.answers,this.link=t.link,this.unread=t.unread,this.raw_id=t.raw_id,this.is_expired=t.is_expired,this.is_ads=t.is_ads,this.can_comment=t.can_comment,this.can_share=t.can_share,this.can_remove=t.can_remove,this.can_report=!t.can_manage,this.name=n.name,this.avatar=n.photo,this.href=n.href,this.prometheus=n.verify.includes("page_top_author"),this.verified=n.verify.includes("page_verified"),this.authorIcon=this.prometheus||this.verified,this.content=null,this.paused=!0,this.stats=t.stats,this.narrative=t.narrative,this.isNarrativeSlide=this.narrative&&!this.narrative.is_cover,this.isNarrativeMetaStory=!!t.isNarrativeMetaStory,this.isOpenNarrativeFromFeed=!!t.isOpenNarrativeFromFeed,this.onAutoPlay=(0,r.default)(),this.onDestroy=(0,r.default)(),this.onVideoBuffering=(0,r.default)(),this.onVideoData=(0,r.default)(),this.onVideoPlayEvent=(0,r.default)(),this.onVideoPauseEvent=(0,r.default)(),this.onVideoEndedEvent=(0,r.default)(),this.reply=t.reply_to,this.reply){var s=this.reply.list;this.reply=extend(this.reply,{onclick:'Stories.openReplies("'+s+'");'})}this.duration=8e3,this.views&&(this.viewsText=this.views),this.answers&&(this.answersText=this.answers.count),this.bookmark_add_hash=t.bookmark_add_hash,this.is_bookmarked=t.is_bookmarked,this.narrative&&(this.bookmark_add_hash=this.narrative.bookmark_hash,this.is_bookmarked=this.narrative.is_bookmarked),this.StoryMenu=new a.default(extend(t,{can_report:this.can_report,can_bookmark:!!this.bookmark_add_hash,is_bookmarked:this.is_bookmarked})),this.needMenu=this.StoryMenu.needMenu(),this.storyMenuHTML=this.StoryMenu.render()}return e.prototype.update=function(e){var t=Stories.getCurrentStoryIndex(),n=Stories.getCurrentAuthorIndex();this.state.authorIndex===n&&this.state.storyIndex===t?(this.loadContent(e),Stories.setHistory(this.raw_id)):(this.destroy(),val(e,""))},e.prototype.getDuration=function(){return this.duration},e.prototype.getPreview=function(){return this.preview},e.prototype.hasLink=function(){return!!this.link},e.prototype.getLinkUrl=function(){var e=this.link.url,t=Stories.getFrom(!1);return o.default.make(e,{from:t})},e.prototype.loadContent=function(e){var t=window.lang;if(this.is_expired){Stories.hideLoading();var n={class:"Story__content_expired",inner:i.default.wrap(t.mobile_stories_error_expired)};val(e,i.default.html(n)),Stories.restoreAudio()}else if("photo"===this.type){this.isNarrativeMetaStory||Stories.showLoading(),this.img=new Image,this.onLoadImgBind=this.onLoadImg.bind(this),this.onLoadStory=this.onLoadStory.bind(this),addEvent(this.img,"load",this.onLoadImgBind),addEvent(this.img,"load",this.onLoadStory),this.img.src=this.photo_url;var o={style:"background-image: url("+this.photo_url+")",class:"Story__content_image"};this.narrative&&this.narrative.is_cover?(val(e,i.default.html(this.renderNarrativeCover())),this._createNarrativeCoverTooltip()):this.isNarrativeMetaStory?(val(e,""),e&&e.parentNode.insertAdjacentHTML("beforeend",i.default.html(this.renderNarrativeMetaStory())),addEvent(geByClass1("NarrativeMeta__recommendations"),"scroll wheel touchmove",this.handleRecommendationsScroll.bind(this))):val(e,i.default.html(o)),Stories.restoreAudio()}else if("video"===this.type)if(this.videoSupport&&Stories.isAutoplaySupport())Stories.showLoading(),this.video=ce("video",{src:this.video_url,className:"Story__content_video"}),attr(this.video,"autoplay","autoplay"),attr(this.video,"playsinline","playsinline"),attr(this.video,"webkit-playsinline","webkit-playsinline"),attr(this.video,"muted","muted"),this.onCanPlayBind=this.onCanPlay.bind(this),this.onVideoWaitingBind=this.onVideoBuffer.bind(this),this.onVideoLoadedDataBind=this.onVideoLoadedData.bind(this),this.onVideoPlayBind=this.onVideoPlay.bind(this),this.onVideoPauseBind=this.onVideoPause.bind(this),this.onVideoEndedBind=this.onVideoEnded.bind(this),this.onLoadStory=this.onLoadStory.bind(this),addEvent(this.video,"ended",this.onVideoEndedBind),addEvent(this.video,"play",this.onVideoPlayBind),addEvent(this.video,"pause",this.onVideoPauseBind),addEvent(this.video,"canplaythrough",this.onCanPlayBind),addEvent(this.video,"waiting",this.onVideoWaitingBind),addEvent(this.video,"loadedmetadata",this.onVideoLoadedDataBind),addEvent(this.video,"canplaythrough",this.onLoadStory),append(this.video,e),Stories.pauseAudio();else{var r=Stories.getAuthorElems()[this.state.authorIndex];this.renderError(r,e,t.mobile_stories_inline_video_error)}this.markSeen()},e.prototype._showNarrativeCoverTooltip=function(){Stories.openNarrative(this.narrative.owner_id+"/narrative"+this.narrative.raw_id,{source:"narrative_story",isOpenNarrativeFromFeed:!0})},e.prototype._createNarrativeCoverTooltip=function(){var e=geByClass1("NarrativeCover__image");addEvent(e,"click",this._showNarrativeCoverTooltip.bind(this))},e.prototype.onLoadStory=function(){if(this._loadingStartTime){var e=Date.now()-this._loadingStartTime;Stories._sendViewerStartTime(this.raw_id,e),this._loadingStartTime=0}},e.prototype.markSeen=function(){this.store.readedStories[this.raw_id]=!0,this.store.authors[this.state.authorIndex].items[this.state.storyIndex].unread=!1},e.prototype.pause=function(){this.paused||(this.paused=!0,this.video&&this.video.pause())},e.prototype.play=function(){this.paused&&(this.paused=!1,this.video&&this.video.play())},e.prototype.onVideoEnded=function(){this.onVideoEndedEvent()},e.prototype.onVideoPlay=function(){this.onVideoPlayEvent()},e.prototype.onVideoPause=function(){this.onVideoPauseEvent()},e.prototype.onLoadImg=function(){Stories.hideLoading(),this.onVideoData({paused:this.paused,authorIndex:this.state.authorIndex,storyIndex:this.state.storyIndex})},e.prototype.onVideoBuffer=function(){this.onVideoBuffering()},e.prototype.onVideoLoadedData=function(){if(0===this.video.duration){this.duration=16e3}else this.duration=1e3*this.video.duration+100;this.onVideoData({paused:this.paused,authorIndex:this.state.authorIndex,storyIndex:this.state.storyIndex})},e.prototype.onCanPlay=function(){Stories.hideLoading(),this.onAutoPlay({paused:this.paused,authorIndex:this.state.authorIndex,storyIndex:this.state.storyIndex}),this.store.isStopped&&this.video.pause()},e.prototype.getType=function(){return this.type},e.prototype.getVideoState=function(){return this.video?this.video.readyState:0},e.prototype.getVideo=function(){if(this.video)return this.video},e.prototype.renderError=function(e,t,n){var o=this,r={class:"Story__content_expired",inner:i.default.wrap(n)};val(t,i.default.html(r)),Stories.hideLoading(),this.type="broken",addClass(e,l.ERROR_CLASS),requestAnimationFrame(function(){o.onVideoData({paused:o.paused,authorIndex:o.state.authorIndex,storyIndex:o.state.storyIndex})})},e.prototype.render=function(){var e,t,n=window,o=n.lang,r=n.winToUtf,a=s.isTouch?"ontouchstart":"onmousedown",l=s.isTouch?"ontouchend":"onmouseup";return this._onLoadingStart(),i.default.html({class:"Story",inner:[{class:"Story__header",inner:[this.reply?{class:"Story__reply",inner:this.reply.is_deleted||this.reply.is_private?{class:"Story__replyDeleted",inner:{class:"Story__replyDeletedContainer",inner:[{class:Bem.class("Story__icon",{deleted:this.reply.is_deleted,private:this.reply.is_private})},{class:"Story__replyDeletedTitle",inner:this.reply.is_deleted?o.mobile_stories_reply_deleted_title:o.mobile_stories_reply_private_title}]}}:{class:"Story__replyPreview",onclick:this.reply.onclick,style:"background-image: url("+this.reply.photo_url+")",inner:{class:"Story__replyTitle",inner:r(this.reply.name)}}}:null,{class:"Story__table",inner:[{class:"Story__cell Story__cell_header",inner:{class:"Story__table Story__link al_empty",href:this.href,"data-skiponclick":1,inner:[this.isNarrativeSlide?null:{class:"Story__cell Story__cell_avatar",inner:{class:"Story__avatar",src:this.avatar,tag:"img"}},{class:"Story__cell Story__cell_title",inner:[{class:"Story__title",inner:[{class:"Story__name",inner:this.isNarrativeSlide?r(this.narrative.title):r(this.name)},this.authorIcon?{class:"Story__verified",inner:{class:Bem.class("Story__icon",{verified:this.verified,prometheus:this.prometheus})}}:null]},this.isNarrativeSlide?{class:"Story__date",inner:this.name+" · "+o.global_type_narrative}:{class:"Story__date",inner:this.is_ads?o.mobile_stories_is_promo_title:this.date}]}]}},{class:"Story__cell Story__cell_close",onclick:"return Stories.clickClose();",inner:{class:"Story__close",inner:{class:"Story__icon Story__icon_close"}}}]}]},{class:"Story__footer",inner:this.isNarrativeMetaStory||this.is_expired?null:{class:"Story__table",inner:[this.isNarrativeSlide?null:{class:Bem.class("Story__cell",{empty:!!this.link&&!this.answers&&!this.views,hidden:!this.answers&&!this.views&&!this.link,stats:!0}),inner:this.answers||this.views?{class:"Story__stats",inner:[this.answers?{class:"Story__replies Story__cell",onclick:'Stories.showViews("'+this.raw_id+'")',inner:[{class:"Story__cell",inner:{class:"Story__icon Story__icon_replies Story__repliesIcon"}},{class:"Story__cell Story__repliesText",inner:this.link?this.answers.count:this.answersText}]}:null,this.views?{class:"Story__views Story__cell",onclick:'Stories.showViews("'+this.raw_id+'")',inner:[{class:"Story__cell",inner:{class:"Story__icon Story__icon_views Story__viewsIcon"}},{class:"Story__cell Story__viewsText",inner:this.link?this.views:this.viewsText}]}:null]}:null},this.link?{class:"Story__cell Story__cell_moreLink",inner:{class:"Story__moreLink",inner:[{class:"Story__moreLinkText",inner:r(this.link.text)},{class:"Story__icon Story__icon_topArrow"}],href:this.getLinkUrl(),onclick:"Stories.openCustomButton(event, this); return;","data-skiponclick":1}}:this.can_comment?{class:"Story__cell Story__cell_comment",inner:{class:"Story__commentButton",inner:{class:"Story__commentButtonText",inner:o.mobile_stories_comment_placeholder},onclick:"Stories.showComment();"}}:null,this.can_share?{class:"Story__cell Story__cell_share",inner:{class:"Story__share",onclick:'Stories.share("'+(this.narrative?this.narrative.raw_id:this.raw_id)+'", '+!!this.narrative+");",inner:{class:"Story__icon Story__icon_share","data-skiponclick":1}}}:null,this.needMenu?{class:"Story__cell Story__cell_menu",inner:i.default.wrap(this.storyMenuHTML)}:null]}},this.can_comment?{class:"Story__comment",inner:[(e={class:"Story__commentOverlay"},c(e,a,"cancelEvent(event);"),c(e,l,"cancelEvent(event);"),c(e,"ontouchmove","cancelEvent(event);"),e),{class:"Story__commentPopout",ontouchmove:"cancelEvent(event);",onmousedown:"event.stopPropagation();",ontouchend:"event.stopPropagation();",inner:[{class:"Story__commentHeader",inner:this.isNarrativeSlide?o.mobile_stories_comment_narrative_title:o.mobile_stories_comment_title},{class:"Story__commentBody",inner:{class:"Story__commentTextarea",tag:"textarea",placeholder:o.mobile_stories_comment_textarea,oninput:"Stories.onInputComment(this);"}},{class:"Story__commentFooter",inner:[{class:"Story__commentSend",onclick:"Stories.sendComment();",inner:o.mobile_stories_comment_ok},{class:"Story__commentCancel",inner:o.mobile_stories_comment_cancel,onclick:"Stories.hideComment();"}]}]}]}:null,(t={class:"Story__overlay"},c(t,a,"cancelEvent(event);"),c(t,l,"cancelEvent(event); Stories.hideMenu();"),c(t,"ontouchmove","cancelEvent(event);"),t),{class:"Story__body",style:"background-image: url("+this.preview+")"}]})},e.prototype._onLoadingStart=function(){this._loadingStartTime=new Date},e.prototype.renderNarrativeCover=function(){var e=this.photo_url||this.first_frame,t=this.narrative.views?" · "+this.narrative.views:"";return{class:"NarrativeCover",inner:[{style:"background-image: url("+e+")",class:"NarrativeCover__image"},{class:"NarrativeCover__views",inner:[{tag:"span",class:"NarrativeCover__label",inner:""+lang.global_type_narrative},{tag:"span",inner:""+t}]},{class:"NarrativeCover__title",innerHTML:""+this.narrative.title},{class:"NarrativeCover__author",inner:""+this.narrative.owner_name}]}},e.prototype.renderNarrativeMetaStory=function(){var e=this.store.list+"_recommendations",t=window.store.stories[e]&&window.store.stories[e].authors,n=Math.max(document.documentElement.clientHeight,window.innerHeight||0),i=[];return this.store.list.match(/narrative-?\d+_\d+$/)&&t&&(this.coverItems=t.map(function(e){return e.narrative_cover}),this.coverCount=this.coverItems?this.coverItems.length:0,this.coverRowsCount=Math.ceil(this.coverCount/3),this.elemOffset=0,1===this.coverRowsCount?this.elemOffset=26.4:this.coverRowsCount>1&&(this.elemOffset=26.4*1.5),this.scrollOffset=n/100*this.elemOffset+53,this.coverItems.forEach(function(n){var o={tag:"span",class:"NarrativePreview",style:"background-image: url("+n.preview_url+")",onclick:'Stories.openNarrative("'+n.raw_id+"/"+e+'", { narrativeId: '+n.narrative.id+", source: 'narrative_recommendations' })",inner:[{class:"NarrativePreview__inner",style:"background-image: url("+n.photo_url+")",inner:[{tag:"a",href:t[0].author.href,class:"NarrativePreview__author",style:"background-image: url("+t[0].author.photo+")"},{tag:"span",class:"NarrativePreview__title",innerHTML:n.narrative.title}]}]};i.push(o)})),{class:"NarrativeMeta",inner:[{class:"NarrativeMeta__buttons",style:"padding-bottom: "+this.elemOffset+"vh",inner:[{class:"NarrativeMeta__button",onclick:"Stories.narrativeReply();",inner:[{class:"NarrativeMeta__circle NarrativeMeta__circle_replay"},{class:"NarrativeMeta__text",inner:lang.mobile_narratives_repeat_bottom}]},this.isOpenNarrativeFromFeed?{class:"NarrativeMeta__button",onclick:"Stories.narrativeGoToStories();",inner:[{class:"NarrativeMeta__circle NarrativeMeta__circle_back"},{class:"NarrativeMeta__text",inner:lang.mobile_narratives_back_bottom}]}:null]},i.length?{class:"NarrativeMeta__recommendations",inner:[{class:"NarrativeMeta__recommendations-inner",inner:[{class:"NarrativeMeta__recommendations-title",inner:lang.mobile_narratives_more_bottom,style:"margin-top: calc(100vh - "+this.elemOffset+"vh - 70px - 53px)"},{class:"NarrativeMeta__recommendations-items",inner:i}]}]}:null]}},e.prototype.handleRecommendationsScroll=function(){event.stopPropagation&&event.stopPropagation(),event.stopImmediatePropagation&&event.stopImmediatePropagation();var e=geByClass1("NarrativeMeta__recommendations"),t=geByClass1("NarrativeMeta__recommendations-inner"),n=Math.min(t.scrollTop/(this.scrollOffset/100),70)/100;setStyle(e,{backgroundColor:"rgba(0, 0, 0, "+n+")"}),t.scrollTop?(addClass(e,"scroll"),Stories.pauseStory()):(Stories.playStory(),removeClass(e,"scroll"))},e.prototype.pauseAudio=function(){window.Stories.pauseAudio()},e.prototype.destroy=function(){this.img&&removeEvent(this.video,"load",this.onLoadImgBind),this.video&&(removeEvent(this.video,"ended",this.onVideoEndedBind),removeEvent(this.video,"play",this.onVideoPlayBind),removeEvent(this.video,"pause",this.onVideoPauseBind),removeEvent(this.video,"canplaythrough",this.onCanPlayBind),removeEvent(this.video,"waiting",this.onVideoWaitingBind),removeEvent(this.video,"loadedmetadata",this.onVideoLoadedDataBind),this.video.src="",this.video.load()),this.onDestroy(),this.onAutoPlay.off(),this.onDestroy.off(),this.onVideoBuffering.off(),this.onVideoData.off(),this.onVideoPlayEvent.off(),this.onVideoPauseEvent.off(),this.onVideoEndedEvent.off()},e}();t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Icon_wd=void 0;var i=r(n(77)),o=r(n(131));function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t.default=function(e){var t,n=e.icon,r=e.class||e.mix;return(0,o.default)({mix:i.default.class(r,"Icon",(t={},a(t,n,!0),a(t,"active",e.active),a(t,"blue",e.blue),a(t,"bluer",e.bluer),a(t,"dark",e.dark),a(t,"selected",e.selected),a(t,"small",e.small),a(t,"white",e.white),t)),url:e.url,attrs:e.attrs})},t.Icon_wd=function(e){var t,n=e.icon;return{class:[e.class,Bem.class("Icon",(t={},a(t,n,!0),a(t,"active",e.active),a(t,"blue",e.blue),a(t,"bluer",e.bluer),a(t,"dark",e.dark),a(t,"selected",e.selected),a(t,"small",e.small),a(t,"white",e.white),t))],href:e.url,attrs:e.attrs}}},function(e,t,n){"use strict";var i=n(17),o=n(166),r=null;function a(e){for(var t=geByClass("audio-msg-track--wave-wrapper",e),n=0,i=0;i<t.length;i++){try{n=parseInt(window.getComputedStyle(t[i],null).getPropertyValue("width"))}catch(e){n=parseInt(t[i].currentStyle.width)}if(n>0)break}return n}function s(e,t){t=Math.round(t),e.length!=t&&(e=(0,o.fastResample)(e,t));for(var n="",i=0,r=0;r<e.length;r++)0==(i=Math.floor(10*e[r]*.95))&&(i=.5),n+="M"+(3*r+1)+","+(10-i)+"v"+2*i+"Z";return'<svg class="audio-msg-track--wave" width="'+3*e.length+'px"><path d="'+n+'"></path></svg>'}function l(){for(var e=geByClass("audio-msg-track"),t=0;t<e.length;t++){var n=attr(e[t],"data-wave");hasClass(e[t],"audio-msg-player")&&t>0&&(n=attr(e[t-1],"data-wave"));var i=a(e[t]);if(n&&i){n=n.split(",");for(var o=geByClass("audio-msg-track--wave",e[t]),r=s(n,i/3),l=0;l<o.length;l++){var u=ce("div",{innerHTML:r}).firstChild;o[l].parentNode.replaceChild(u,o[l])}}}}function u(){return r||(r=new i.VoiceMessagePlayer),r}addEvent(window,"orientationchange",function(){return setTimeout(l,500)}),window.mail&&window.mail.onMessagesRepainted&&(onDOMReady(l),window.mail.onMessagesRepainted(l)),window.AudioMessagePlayer={loaded:!0,togglePlay:function(e,t){var n=u(),i=n.attachTo(e);!0===i?n.play():i.then(function(){n.play()})},detachPlayer:function(e){u().detach(e)},pauseGlobalMedia:function(){i.VoiceMessagePlayer.pauseGlobalMedia()},resumeGlobalMedia:function(){i.VoiceMessagePlayer.resumeGlobalMedia()},redrawWaves:l,getWave:s};try{stManager.done("voice_message_player.js")}catch(e){}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=t.StickersAnimation=function(){var e=!1,t=!1,n={},o={},r={},a=void 0,s={};function l(e){if(window.isMVK){var t=document.createElement("script");t.onload=function(){e()},t.src="/js/cmodules/web/bodymovin.js",document.head.appendChild(t)}else stManager.add([jsc("web/bodymovin.js")],function(){e()})}function u(e){var t=f(e),n=1;if(t){hasClass(e,"animation_play")||(hide(geByClass1("sticker_img",e)),addClass(e,"animation_play")),t.play();var i=attr(e,"data-loop-count");i=parseInt(i),isNaN(i)&&(i=3),-1!==i&&(!t._cbs.loopComplete||t._cbs.loopComplete&&0===t._cbs.loopComplete.length)&&t.addEventListener("loopComplete",function o(r){var a=!0;i>=++n&&(a=!1),a&&(d(e,!1),""!==t._cbs.loopComplete&&t.removeEventListener("loopComplete",o),t.stop())})}}function c(e){var t=attr(e,"data-uid");return t||(t=attr(e,"data-uid",Math.random().toString(32).substr(2))),t}function d(e,t){s[c(e)]=t}function f(e){var t=attr(e,"data-uniq-id");if(!geByClass1("svg_sticker_animation",e))return!1;var n=o[t];return n||!1}function p(e,t){var i=f(e);if(i)"function"==typeof t&&t(i);else{var r=attr(e,"data-uniq-id");if(!s[c(e)]){d(e,!0);var a=attr(e,"data-animation-path"),l=attr(e,"data-sticker-id"),u=!1;if(l&&(u=n[l]?_(e):a&&_(e)),u){var p={container:e,renderer:"svg",loop:!0,autoplay:!1,name:r,rendererSettings:{scaleMode:"noScale",progressiveLoad:!0,hideOnTransparent:!0,className:"svg_sticker_animation"}};n[l]?p.animationData=n[l]:p.path=a;var A=geByClass1("svg_sticker_animation",e);if(A&&re(A),i=bodymovin.loadAnimation(p),!n[l])return void i.addEventListener("data_ready",function(){n[l]=i.animationData,o[r]=i,"function"==typeof t&&t(i)})}"function"==typeof t&&(o[r]=i,"function"==typeof t&&t(i))}}}return{checkSettingsAndLoadInWeb:function(e){if(StickersSettings.getAutoplay()){var t=ge("fc_msg"+e),n=geByClass1("sticker_animation",t);i.loadAndPlaySticker(n)}},checkSettingsAndLoad:function(e,t,n){StickersSettings.getAutoplay()&&(n?i.loadStickerInMvkIMAndPlay(e,t):(e.textFull||e.text).indexOf("sticker_animation",0)&&i.loadStickerInMvkIMAndPlay(e.id,t))},loadStickerInMvkIMAndPlay:function(e,t){var n="_msg"+e;t&&(n="msg_id_"+e);var o=geByClass1("sticker_animation",geByClass1(n));i.loadAndPlayStickerWithTimer(o,500)},loadAutoplayAnimationStickers:function(n){if("undefined"!=typeof bodymovin){if(n){if(t)return;t=!0}if(!e){e=!0;var o=geByClass("sticker_animation_autoplay");o&&each(o,function(e,t){p(t,function(){u(t)})}),e=!1}}else l(function(){i.loadAutoplayAnimationStickers()})},loadAndPlaySticker:function(e){if(e)return"undefined"==typeof bodymovin?(l(function(){i.loadAndPlaySticker(e)}),""):void requestAnimationFrame(function(){p(e,function(){u(e)})})},loadAndPlayStickerWithTimer:function(e,t){if(e&&!r[e]){t||(t=1e3);var n=ge(e);hasClass(n,"sticker_animation_disabled_timer")||(r[e]=setTimeout(function(){!n&&(n=ge(e),hasClass(n,"sticker_animation_disabled_timer"))||(i.loadAndPlaySticker(n),clearTimeout(r[e]),r[e]=!1)},t))}},reloadStickers:function(){o={}},touchStartSticker:function(e){window.oncontextmenu||(window.oncontextmenu=function(e){return e.preventDefault(),e.stopPropagation(),window.oncontextmenu=null,!1}),a=setTimeout(function(){i.loadAndPlaySticker(e)},500)},touchEndSticker:function(){a&&clearTimeout(a)}};function _(e){var t=e.getBoundingClientRect().top,n=e.getBoundingClientRect().bottom;return t<window.innerHeight&&n>=0&&isVisible(e)}}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(315),r=(i=o)&&i.__esModule?i:{default:i};t.default=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uMailWrite_TemplatesContent=function(e){var t=e.length;if(!t)return i.default.html(u());return i.default.html(e.map(function(e,n){return c(e,n,t)}))},t.uMailWrite_TemplatesEmpty=u,t.uMailWrite_TemplatesLoading=function(){return Loading({mix:"uMailWrite__templatesLoading"})},t.uMailWrite_TemplatesRow=c,t.prepareTemplateText=d;var i=l(n(326)),o=l(n(77)),r=n(0),a=l(n(268)),s=l(n(209));function l(e){return e&&e.__esModule?e:{default:e}}function u(){var e="/mail?act=template&from="+store.mail.cur.peerId+store.mail.cur.communityParam,t=o.default.onClick("uMailWrite.loadTemplatePage","event","this",e);return{class:"uMailWrite__templatesEmpty",inner:[{class:"uMailWrite__templatesEmptyInfo",inner:lang.mobile_mail_templates_empty_info},(0,s.default)({type:"button",theme:"small",attrs:t,inner:lang.mobile_mail_templates_empty_button})]}}function c(e,t,n){var s=t>0&&t===n-1,l=store.mail.cur.communityParam,u=store.mail.cur.peerId,c=e.name,f=e.text;return c=(0,r.emojiToHTML)(c),f=d(f,!0),{class:"uMailWrite__templatesRow _touched",inner:[{class:"uMailWrite__templatesRowContent",attrs:o.default.onClick("uMailWrite.onTemplateClick","event","this",e.id),inner:[{class:"uMailWrite__templatesRowName",inner:i.default.html(c)},{class:"uMailWrite__templatesRowText",inner:i.default.html(f)}]},{class:"uMailWrite__templatesRowMore",inner:[i.default.wrap((0,a.default)({mix:"",icon:"more",position:s?"bottomRight":"topRight",items:[{text:lang.mobile_mail_templates_action_edit,name:"edit",url:"/mail?act=template&id="+e.id+l+"&from="+u},{text:lang.mobile_mail_templates_action_delete,name:"delete",attrs:o.default.onMouseDown("uMailWrite._onDeleteTemplate",e.id)}]}))]}]}}function d(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=store.mail.members,i=store.mail.cur,o=n[i.peerId],a=n[i.userId],s=n[i.groupId],l=o.name.replace(o.firstName,"").trim(),u=a.name.replace(a.firstName,"").trim();if((e=(e=(e=(e=(e=(e=(e=(e=e.replace(/<br>/g,"\n")).replace(/&lt;br&gt;/g,"\n")).replace(/\t/g,"\n")).replace(/{user name}/g,o.firstName)).replace(/{user surname}/g,l)).replace(/{admin name}/g,a.firstName)).replace(/{admin surname}/g,u)).replace(/{community}/g,s.name)).match(/{greeting}/g)){var c=(new Date).getHours(),d=void 0;d=c>=3&&c<12?lang.mobile_mail_templates_greeting_morning:c>=12&&c<17?lang.mobile_mail_templates_greeting_afternoon:c>=17&&c<=23?lang.mobile_mail_templates_greeting_evening:lang.mobile_mail_templates_greeting_night,e=e.replace(/{greeting}/g,d)}return t&&(e=(0,r.emojiToHTML)(e)),e}},function(e,t,n){"use strict";var i=n(322);window.PostAttachVideoLink={},PostAttachVideoLink._onInit=l,PostAttachVideoLink._onPlayClick=c,PostAttachVideoLink._onReplayClick=c,PostAttachVideoLink._onSoundClick=u,PostAttachVideoLink._onVideoClick=d,PostAttachVideoLink._onVideoPlay=function(e){return f(e.target,"play")},PostAttachVideoLink._onVideoPause=function(e){return f(e.target,"pause")},PostAttachVideoLink._onVideoEnded=function(e){return f(e.target,"end")};var o={muted:"PostAttachVideoLink_muted",state:function(e){return"PostAttachVideoLink_state_"+e}},r={attach:".PostAttachVideoLink",video:".PostAttachVideoLink__video"},a=window.MutationObserver,s=null;function l(){a&&!s&&(s=new a(p)).observe(document.body,{childList:!0,subtree:!0})}function u(e){var t=e.closest(r.attach),n=$(r.video,t);n.muted=!n.muted,t.classList.toggle(o.muted,n.muted)}function c(e){var t=e.closest(r.attach);$(r.video,t).play()}function d(e){e.paused||e.pause()}function f(e,t){var n=e.closest(r.attach);n.classList.remove(o.state("play")),n.classList.remove(o.state("pause")),n.classList.remove(o.state("end")),n.classList.add(o.state(t))}function p(e){e.forEach(function(e){e.removedNodes.forEach(function(e){e.nodeType===HTMLElement.ELEMENT_NODE&&(0,i.$$)(r.video,e).forEach(function(e){e.src="",e.load()})})}),$(r.video)||(s.disconnect(),s=null)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(326)),o=a(n(355)),r=a(n(19));function a(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){return{class:"VotingForm__option","data-created":e.is_created?"1":"0",inner:[(0,r.default)({class:"VotingForm__optionInput",name:e.name,value:e.value,on_key_down:"VotingForm._onOptionKeyDown"}),{class:"VotingForm__optionRemove",onclick:["VotingForm._onOptionRemoveClick","this"],inner:i.default.wrap((0,o.default)({icon:"close16"}))}]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=window,o=i.intval,r=i.domData,a=i.isEmpty,s=i.isArray,l=i.setStyle,u=i.ce,c=[],d=void 0,f=!1,p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.init=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(f=n.mobile||n.isWebView,t&&e.ads&&!a(e.ads)&&!(e.has_more||s(e.ads)&&0==e.ads.length)){var i=u("ins");addClass(i,"mrg-tag"),addClass(i,"article_adsblock"),n.mobile&&addClass(i,"article_adsblock_mobile"),l(i,{display:"block","text-decoration":"none"});var o="";for(var c in n.deviceInfo)n.deviceInfo.hasOwnProperty(c)&&(o+="&"+c+"="+n.deviceInfo[c]);for(var d in e.ads.data["ad-query"]=e.ads.data["ad-query"].replace("%device_info%",o),e.ads.data)e.ads.data.hasOwnProperty(d)&&r(i,d,""+e.ads.data[d]);t.appendChild(i),window.MRGtag||(window.MRGtag=[]);var p=n.isWebView?{iframeMode:!0}:{},A=e.ads.eventsHash;if(_(e,n,"requested",A),p.onNoAds=function(){_(e,n,"no_ads",A)},p.onAdsLoaded=function(){_(e,n,"ads_loaded",A)},p.onAdsClosed=function(){_(e,n,"ads_closed",A)},p.onAdsSuccess=function(){_(e,n,"ads_success",A)},p.onAdsClicked=function(){_(e,n,"ads_clicked",A)},p.onScriptError=function(){_(e,n,"script_error",A)},window.MRGtagOnAdsImpression=function(){_(e,n,"ads_impression",A)},window.MRGtag.push(p),!window.mailRuSdsScriptLoaded){var m=document.createElement("script");m.setAttribute("src",e.ads.script),m.setAttribute("async","true"),document.head.appendChild(m),window.mailRuSdsScriptLoaded=!0}}},e.wasShown=function(){return!1},e}();function _(e,t,n,i){c.push(n+"/"+e.owner_id+"_"+e.id+"/"+i),clearTimeout(d),d=setTimeout(function(){var e=f?"article.php":"al_articles.php";ajax.post(e,{act:"ads_event",events:c.join(","),is_web_view:o(t.isWebView)}),c=[]},200)}t.default=p},function(e,t,n){"use strict";var i=n(1),o=window,r=o.se,a=o.qs2obj,s=o.obj2qs,l=o.scrollTop,u=o.remove,c=o.each,d=o.geByClass,f=o.geByClass1,p=o.addClass,_=o.removeClass,A=o.after,m=o.ce,h=o.val,v=o.append,g=o.evalJs,y=o.extend,w=o.scrollToHash,b=o.onBodyResize,D=o.onBodyScroll,C=o.hasClass,E=o.escapeAttr,S=(o.before,window.thover),k={onChange:r(),onRestore:r(),fast_load:!1,need_hard_go:!1,getHash:function(e){if("#player"==e.hash)return!1;var t=a(e.params);return delete t.z,e.path+s(t)},getAlias:function(e){if(!e)return!1;var t=(e||"").split("?"),n=t[0],i=a(t[1]);return i.from&&delete i.offset,delete i.from,delete i.z,n+s(i)},set:function(e,t,n,o){window.isNewMail&&toggleClass("vk__page_mail",bodyNode,"/mail"===e);var r=window.zlayer,a=window.cur,s=window.nav,D=window.menu,C=window.audioplayer;n=n||{};var E=l(),M=null;if(r.opened()&&(E=r._st),n.force||(M=u("m"),c(d("_cntr",M),function(){u(this)}),u(f("_cntrs",M))),!n.after&&!k.fast_load){var T=k.getHash(s);k.save(T,{html:null,st:E,page:M,state:k.stash(),cur:window.cur},!0)}if(n.before||k.clear(),(n.before||!n.before&&!n.after)&&(window.lm_qsearch_counter?window.lm_qsearch_counter++:window.lm_qsearch_counter=1),n.before){k.fast_load=!0,o&&o.target&&p("__al_target",o.target);var x=M.cloneNode(!0);o&&o.target&&_("__al_target",o.target);var I=f("__al_target",x);_("__al_target",I),n.beforeAppend&&n.beforeAppend(x,I),A(x,"l"),a.toggleHeaderSearch&&a.toggleHeaderSearch(!1),n.afterAppend&&n.afterAppend(x),D&&D.clear_hover(),D&&D.closeSearch(),D&&D.enabled(!0)}else{if(o&&o.zProcess&&o.zProcess(0,!0)&&delete o.zProcess,o&&s.set(o),k.need_hard_go)return s.hard_go(s.cur,null,{replace:!0});if(!n.force){t.title&&(document.title=t.title);var P=t.page;if(P||(P=m("div",{className:"layout__basis",id:"m"}),h(P,t.html)),D.opened()){var B=m("div",{id:"m_helper",onclick:D.close});v(B,P)}A(P,"l")}k.fast_load=!1,S.clear(),t.lm&&D.refresh(t.lm),t.bc&&(window.bodyNode.className=t.bc),r.opened(),o&&o.zProcess?o.zProcess(0,!1)&&delete o.zProcess:r.close(),n.force||(t.js&&g(t.js),t.state&&k.stash(t.state),t.cur&&y(window.cur,t.cur),k.save(e,t));var F=o?o.nav&&o.nav.hash:s.hash;t.st||!F?l(t.st||0,10):n.no_scroll&&!n.force?l(E,10):w(),C&&C.initAudio(),AudioMessagePlayer&&AudioMessagePlayer.redrawWaves()}var L=window.Tabs;b(L.actualizeShowMoreVisibility),L.actualizeShowMoreVisibility(),(0,i.resizePosters)(),k.onChange(!0,o&&o.nav&&o.nav.push)},save:function(e,t,n){if(e){var i=window.nav,o=n?i.page_get(e):{};o&&i.page_set(e,y(o,t),k.getAlias(e))}},restore:function(e){var t=window.nav,n=t.page_get(e);return n||(n=t.page_get(k.getAlias(e))),!!n&&(k.onRestore(!0),n)},stash:function(e){var t=window.cur;return window.cur&&t.stash&&t.stash(e)||!1},clear:function(){var e=window.cur,t=window.zlayer,n=window.menu,i=window.tooltip;D("__clear"),b("__clear"),n&&n.initEvents(),t.isReady&&t.initEvents(),i&&i.clear(),window.cur&&e.destroy&&c(e.destroy,function(){this()}),window.cur={destroy:[]}},setMhead:function(e,t,n,i){var o=f("mhead",e),r=f("mhb_logo",o),a=f("mh_header",e),s=!1,l=window.nav;if(n){!0===n?s=l.path+(l.params?"?"+l.params:""):n&&(s=n),t||(t=h(a)||"&nbsp;");var u=f("mhb_back",e),c="",d=C("mh_nobr",u)?" mh_nobr":"",p=i?' onclick="'+i+'"':"";if(c="/"==s?'<div class="hb_wrap mhb_back'+d+'"'+p+'><h1 class="hb_btn mh_header">'+t+"</h1></div>":'\n        <div class="header__center hb_wrap mhb_back '+d+'">\n          <a class="header__back al_back" href="'+E(s)+'" accesskey="0" '+p+'></a>\n          <h1 class="header__title hb_btn mh_header mhi_back">'+t+"</h1>\n        </div>\n      ",o&&r){var _=f("mhb_notify",e);h(o,(window.al&&window.al.menu?'<a href="/" class="hb_wrap mhb_home" accesskey="*" onclick="return menu.toggle(event);"><div class="hb_btn mhi_home">&nbsp;</div></a>':'<a href="/" class="hb_wrap mhb_home mhb_vkhome" accesskey="*"><div class="hb_btn mhi_home mhi_vkhome">&nbsp;</div></a>')+'<div id="header_msgs" class="hb_wrap mhb_notify'+(!_||C("mhb_no_notify",_)?" mhb_no_notify":"")+'">'+h(_)+"</div>"+c)}else u&&(u.outerHTML=c)}else t&&h(a,t)}};window.page=k},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(86),r=(i=o)&&i.__esModule?i:{default:i};n(317),t.default=r.default,window.ScrollView=r.default},function(e,t,n){"use strict";var i=n(322);window.AudioSpecialForYou={selector:".AudioSpecialForYou",setPlaying:function(e){var t=(0,i.$)(o.special);t&&t.classList.toggle(r.playing,e)}};var o={special:AudioSpecialForYou.selector},r={playing:"AudioSpecialForYou_playing"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(327),r=(i=o)&&i.__esModule?i:{default:i};n(42),t.default=r.default,window.Bell=r.default},function(e,t,n){"use strict";var i=n(322),o=s(n(326)),r=s(n(118)),a=s(n(72));function s(e){return e&&e.__esModule?e:{default:e}}need("Btn");window.Voting={cls:"Voting",setLoading:_,setHtml:function(e,t){d(e).forEach(function(e){e.outerHTML=t}),d(e).forEach(function(e){e.classList.add(u.beforeAnimation)}),setTimeout(function(){d(e).forEach(function(e){e.classList.remove(u.beforeAnimation),Voting.onHtmlUpdate(e)})},30)},onHtmlUpdate:(0,a.default)("$voting")},Voting._onSubmit=A,Voting._onSingleAnswerClick=p,Voting._onCheckboxClick=f,Voting._onRevoteClick=m;var l="_Voting_singleAnswerAction",u={loading:"Voting_loading",beforeAnimation:"Voting_beforeAnimation",hasCheckedOptions:"Voting_hasCheckedOptions"},c={voting:".Voting",votingById:function(e){return'.Voting[data-id="'+e+'"]'},optionControl:".Voting__optionControl",submit:".Voting__submit"};function d(e){return(0,i.$$)(c.votingById(e))}function f(e){var t=e.closest(c.voting),n=Array.from((0,i.$$)(c.optionControl)).some(function(e){return e.checked});t.classList.toggle(u.hasCheckedOptions,n)}function p(e){var t=e.name,n=e.value,i=e.closest("form"),o=i.getAttribute("action");i[l]=r.default.make(o,function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t,n))}function _(e){e.classList.add(u.loading)}function A(e,t,n){var i;if(e.preventDefault(),t[l])i=t[l],_(t);else{var r=Array.from(t.$$("input:checked"));if(0===r.length)return;var a=r[0].name,s=r.map(function(e){return e.value}).join(","),u=t.getAttribute("action"),d=u.includes("?")?"&":"?";t.$(c.submit);_(t),i=""+u+d+a+"="+s+"&is_board="+t.$('input[name="is_board"]').value}o.default.handle(n,{$voting:t,url:i})}function m(e,t){var n=e.closest(c.voting);o.default.handle(t,{$voting:n})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(289),r=(i=o)&&i.__esModule?i:{default:i};n(36),t.default=r.default,window.Convo=r.default,window.Convo__online=o.Convo__online},,function(e,t,n){"use strict";function i(e,t){function n(e){var t=["Webkit","Moz","O","ms"],n=document.createElement("div");if(void 0!==n.style[e])return!0;for(var i in e=e.charAt(0).toUpperCase()+e.slice(1),t)if(void 0!==n.style[t[i]+e])return!0;return!1}function i(e,t){new RegExp("(\\s|^)"+t+"(\\s|$)").test(e.className)||(e.className+=" "+t)}function o(e,t){e.className=e.className.replace(new RegExp("(\\s+|^)"+t+"(\\s+|$)","g")," ").replace(/^\s+|\s+$/g,"")}function a(e,t){0>e?e=0:e>v-1&&(e=v-1);for(var n=C.dots.length-1;n>=0;n--)o(C.dots[n],M.activeDot);return i(C.dots[e],M.activeDot),S=e,s(-e*C.width,void 0===t?k.speed:t),p(),k.onSlideChange&&k.onSlideChange(e),e}function s(e,t){var n=t?t+"ms":"";y.style.webkitTransitionDuration=y.style.MozTransitionDuration=y.style.msTransitionDuration=y.style.OTransitionDuration=y.style.transitionDuration=n,u(e)}function l(e,t){if(D&&clearInterval(D),t){var n=+new Date,i=C.left;D=setInterval(function(){function o(e,t){return(t-e)*s+e}var r,a,s=(+new Date-n)/t,l=[0,.7,1,1];return s>=1?(u(e),void clearInterval(D)):(r=e-i,a=o(o(o(l[0],l[1]),o(l[1],l[2])),o(o(l[1],l[2]),o(l[2],l[3]))),void u(Math.floor(a*r+i)))},15)}else u(e)}function u(e){y.style.webkitTransform="translate("+e+"px,0) translateZ(0)",y.style.msTransform=y.style.MozTransform=y.style.OTransform=y.style.transform="translateX("+e+"px)",C.left=e}function c(e){y.style.left=e+"px",C.left=e}function d(){var e=S+1;return e>v-1&&(e=0),a(e)}function f(){b=!0,p()}function p(){b&&(w&&clearTimeout(w),w=setTimeout(function(){d()},k.slideshowInterval))}function _(){w&&clearTimeout(w)}function A(){b=!1,w&&clearTimeout(w)}function m(){C.width=e.offsetWidth,y.style.width=C.width*v+"px";for(var t=0;v>t;t++)C.slides[t].style.width=C.width+"px";s(-S*C.width)}function h(e,t,n,i){t&&(e.addEventListener?e.addEventListener(t,n,!!i):e.attachEvent("on"+t,n))}var v,g,y,w,b,D,C={slides:[],dots:[],left:0},E=200,S=0,k={speed:300,touchSpeed:300,slideshow:!1,slideshowInterval:4e3,stopSlideshowAfterInteraction:!1,startSlide:0,mouseDrag:!0,disableIfOneSlide:!0,cssPrefix:"peppermint-",dots:!1,dotsPrepend:!1,dotsContainer:void 0,slidesContainer:void 0,onSlideChange:void 0,onSetup:void 0};t&&function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}(k,t);var M={inactive:k.cssPrefix+"inactive",active:k.cssPrefix+"active",mouse:k.cssPrefix+"mouse",drag:k.cssPrefix+"drag",slides:k.cssPrefix+"slides",dots:k.cssPrefix+"dots",activeDot:k.cssPrefix+"active-dot",mouseClicked:k.cssPrefix+"mouse-clicked"},T={transforms:n("transform"),transitions:n("transition")};return function(){var t=k.slidesContainer||e,n=k.dotsContainer||e;if(!(k.disableIfOneSlide&&t.children.length<=1)){(!T.transforms||window.opera)&&(u=c),(!T.transitions||window.opera)&&(s=l),i(y=k.slidesContainer||document.createElement("div"),M.slides);for(var d=0,p=t.children.length;p>d;d++){var w=t.children[d],b=document.createElement("li");C.slides.push(w),b.setAttribute("tabindex","0"),b.setAttribute("role","button"),b.innerHTML="<span></span>",function(t,n){h(n,"click",function(){a(t),k.stopSlideshowAfterInteraction&&A()}),h(n,"keyup",function(e){13==e.keyCode&&(a(t),k.stopSlideshowAfterInteraction&&A())}),h(n,"mouseup",function(){i(n,M.mouseClicked)}),h(n,"blur",function(){o(n,M.mouseClicked)},!0),h(w,"focus",w.onfocusin=function(){e.scrollLeft=0,setTimeout(function(){e.scrollLeft=0},0),a(t)},!0)}(d,b),C.dots.push(b)}for(v=C.slides.length,100/v,i(e,M.active),o(e,M.inactive),k.mouseDrag&&i(e,M.mouse),C.width=e.offsetWidth,y.style.width=C.width*v+"px",d=0;v>d;d++)C.slides[d].style.width=C.width+"px",y.appendChild(C.slides[d]);if(k.slidesContainer||e.appendChild(y),k.dots&&v>1){for(i(g=document.createElement("ul"),M.dots),d=0,p=C.dots.length;p>d;d++)g.appendChild(C.dots[d]);k.dotsPrepend?n.insertBefore(g,n.firstChild):n.appendChild(g)}h(window,"resize",m),h(window,"orientationchange",m),setTimeout(function(){a(k.startSlide,0)},0),k.slideshow&&f(),r(y,{mouse:k.mouseDrag,start:function(){i(e,M.drag)},move:function(e,t,n){_(),n.x=n.x/(!S&&n.x>0||S==v-1&&n.x<0?Math.abs(n.x)/C.width*2+1:1),s(n.x-C.width*S)},end:function(t,n,i){if(i.x){var r=Math.abs(i.x)/C.width,s=Math.floor(r)+(r-Math.floor(r)>.25?1:0);s+=i.time<E+E*s/1.8&&Math.abs(i.x)-s*C.width>(s?-C.width/9:20)?1:0,i.x<0?a(S+s,k.touchSpeed):a(S-s,k.touchSpeed),k.stopSlideshowAfterInteraction&&A()}o(e,M.drag)}}),setTimeout(function(){k.onSetup&&k.onSetup(v)},0)}}(),{slideTo:function(e,t){return a(parseInt(e,10),t)},next:d,prev:function(){var e=S-1;return 0>e&&(e=v-1),a(e)},start:f,stop:A,pause:_,getCurrentPos:function(){return S},getSlidesNumber:function(){return v},recalcWidth:m}}var o;function r(e,t){function n(e,t,n,o){return t?(e.addEventListener?e.addEventListener(t,n,!!o):e.attachEvent("on"+t,n),{remove:function(){i(e,t,n,o)}}):void 0}function i(e,t,n,i){t&&(e.removeEventListener?e.removeEventListener(t,n,!!i):e.detachEvent("on"+t,n))}function o(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function r(e){if((m={x:(f?e.clientX:e.touches[0].clientX)-A.x,y:(f?e.clientY:e.touches[0].clientY)-A.y,time:Number(new Date)-A.time}).time-v[v.length-1].time){for(var t=0;t<v.length-1&&m.time-v[t].time>80;t++);h={x:(m.x-v[t].x)/(m.time-v[t].time),y:(m.y-v[t].y)/(m.time-v[t].time)},v.length>=5&&v.shift(),v.push({x:m.x,y:m.y,time:m.time})}}function a(e,t){y=!0,D[f=t](e)||(n(document,b[f][1],s),n(document,b[f][2],l),n(document,b[f][3],l),c.preventDefault&&f&&o(e),A={x:f?e.clientX:e.touches[0].clientX,y:f?e.clientY:e.touches[0].clientY,time:Number(new Date)},d=void 0,m={x:0,y:0,time:0},h={x:0,y:0},v=[{x:0,y:0,time:0}],c.start(e,A))}function s(e){!c.preventScroll&&d||D[f](e)||(r(e),(Math.abs(m.x)>c.clickTolerance||Math.abs(m.y)>c.clickTolerance)&&(y=!1),void 0===d&&3!==f&&(d=Math.abs(m.x)<Math.abs(m.y)&&!c.preventScroll)||(c.preventDefault&&o(e),c.move(e,A,m,h)))}function l(e){f&&r(e),!y&&e.target&&e.target.blur&&e.target.blur(),i(document,b[f][1],s),i(document,b[f][2],l),i(document,b[f][3],l),c.end(e,A,m,h)}var u=function(){},c={preventDefault:!0,clickTolerance:0,preventScroll:!1,mouse:!0,start:u,move:u,end:u,click:u};t&&function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}(c,t);var d,f,p=!!window.navigator.pointerEnabled,_=!!window.navigator.msPointerEnabled,A={},m={},h={},v=[],g=[],y=!0,w=p?1:_?2:0,b=[["touchstart","touchmove","touchend","touchcancel"],["pointerdown","pointermove","pointerup","pointercancel"],["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerCancel"],["mousedown","mousemove","mouseup",!1]],D=[function(e){return e.touches&&e.touches.length>1||e.scale&&1!==e.scale},function(e){return!e.isPrimary||e.buttons&&1!==e.buttons||!c.mouse&&"touch"!==e.pointerType&&"pen"!==e.pointerType},function(e){return!e.isPrimary||e.buttons&&1!==e.buttons||!c.mouse&&e.pointerType!==e.MSPOINTER_TYPE_TOUCH&&e.pointerType!==e.MSPOINTER_TYPE_PEN},function(e){return e.buttons&&1!==e.buttons}];return g.push(n(e,b[w][0],function(e){a(e,w)})),g.push(n(e,"dragstart",o)),c.mouse&&!w&&g.push(n(e,b[3][0],function(e){a(e,3)})),g.push(n(e,"click",function(e){y?c.click(e):o(e)})),{getClicksAllowed:function(){return y},kill:function(){for(var e=g.length-1;e>=0;e--)g[e].remove()}}}Object.defineProperty(t,"__esModule",{value:!0}),window.jQuery&&((o=window.jQuery).fn.Peppermint=function(e){return this.each(function(){o(this).data("Peppermint",i(this,e))}),this}),window.Peppermint=i,window.EventBurrito=r,t.default=i},function(e,t,n){"use strict";var i=window.geByClass1,o={show:function(e,t){window.grecaptcha?grecaptcha.reset():(window.recaptchaCallback=function(){o.onCallback(e)},document.body.appendChild(ce("script",{type:"text/javascript",src:"https://www.google.com/recaptcha/api.js?onload=recaptchaCallback&render=explicit&hl="+t})))},onResponse:function(e){ge("field_recaptcha").value=e,ge("recaptcha_form").submit()},onCallback:function(e){if(grecaptcha&&e){var t=i("recaptcha_box"),n=i("recaptcha",t);n&&(val(n,""),grecaptcha.render(n,{sitekey:e,callback:o.onResponse}))}}};window.ReCaptcha=o},function(e,t,n){"use strict";var i,o=n(322),r=n(215),a=(i=r)&&i.__esModule?i:{default:i},s=n(251);(a.default.ios||a.default.ipad)&&window.MutationObserver&&document.addEventListener("DOMContentLoaded",c);var l={scrollView:".ScrollView"},u="_scrollViewHealed";function c(){(d(),document.body)&&new MutationObserver(d).observe(document.body,{childList:!0,subtree:!0})}function d(){(0,o.$$)(l.scrollView).forEach(f)}function f(e){var t=function(){return function(e){0===e.scrollTop?e.scrollTop+=1:e.scrollTop+e.offsetHeight===e.scrollHeight&&(e.scrollTop-=1)}(e)};if(t(),!e[u]){e[u]=!0,(0,s.setScrollView)(e,{override:!1});var n=getComputedStyle(e),i=parseInt(n.paddingTop,10),o=parseInt(n.paddingBottom,10);e.style.paddingTop=i+1+"px",e.style.paddingBottom=o+1+"px",t();var r=void 0;e.addEventListener("scroll",function(){r&&clearTimeout(r),r=setTimeout(t,50)})}}},function(e,t,n){"use strict";var i=window,o=i.ajax,r=i.obj2qs,a=function(){var e="/club",t="enter",n="leave",i=null;function a(t,n,i,a,s,l){var u=e+n+r({act:t,hash:i,id:n,from:a});o.post(u,{_ajax:1},{onDone:s,onFail:l})}return{enter:function(e,n,o){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:i;a(t,e,n,o,r,s)},leave:function(e,t,o){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:i;a(n,e,t,o,r,s)}}}();window.Groups=a},function(e,t,n){"use strict";var i=window,o=i.getY,r=i.getCh,a=i.onDOMReady,s=i.onBodyScroll,l=window.page,u=window.ajax,c=window.Pad,d=window.Btn;window.LoadMore={setUrl:m,destroy:h},LoadMore._strategy={replace:{onFail:S,onSuccess:function(e){var t=e.response;_.outerHTML=t,h()}},padsExtend:{onFail:S,onSuccess:function(e){var t=e.response,n=t.pads,i=t.nextPageUrl;Object.keys(n).forEach(function(e){var t=n[e];c.addContent(e,t)}),i?m(i):h()}}},LoadMore._onButtonClick=v,a(g),l.onChange(g);var f={loadMore:".LoadMore",button:".LoadMore__button"},p="_loadMore_loading",_=null,A=null;function m(e){A.setAttribute("href",e)}function h(e){_.remove(),_=null,A=null,w()}function v(){E()||b()}function g(){if(_=$(f.loadMore)){var e=window.cur;A=_.$(f.button),y(0),s(y),e.destroy.push(w)}}function y(e){if(_&&!E()){var t=o(_),n=r();t-(e+n)<2*n&&b()}}function w(){s("__clear",y)}function b(){C(!0);var e=A.getAttribute("href");u.post(e,{_ajax:1},{onDone:function(e){return D(e,!0)},onFail:function(e){return D(e,!1)}})}function D(e,t){C(!1);var n=t?"data-success-handler":"data-fail-handler";n=_.getAttribute(n),Wd.handle(n,{$loadMore:_,response:e}),_=null,A=null,w(),g()}function C(e){A&&(d.setLoading(A,e),_[p]=e)}function E(){return _&&_[p]}function S(e){console.error("LoadMore: failed to load more",e)}},function(e,t,n){"use strict";var i=window,o=i.preventEvent,r=i.stopEvent,a=i.gpeByClass,s=i.toggleClass,l=i.removeClass,u=i.addEvent,c=i.removeEvent,d="dropdown_open",f={_onTogglerClick:function(e,t){o(e),r(e);var n=a("dropdown",t);if(s(n,d),!1!==n.isFirstClick){n.isFirstClick=!1;var i=function(){l(n,d)};u(window,"click",i),window.cur.destroy.push(function(){c(window,"click",i),n.isFirstClick=!0})}}};window.Dropdown=f},,function(e,t,n){"use strict";function i(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:document).querySelector(e)}function o(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:document).querySelectorAll(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.$=i,t.$$=o,window.$=i,window.$$=o,function(){HTMLElement.prototype.$=HTMLElement.prototype.querySelector,HTMLElement.prototype.$$=HTMLElement.prototype.querySelectorAll;try{SVGElement.prototype.$=SVGElement.prototype.querySelector,SVGElement.prototype.$$=SVGElement.prototype.querySelectorAll}catch(e){}}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(27),r=(i=o)&&i.__esModule?i:{default:i};t.default=r.default,window.BookmarksFilterListItem=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Msg__replyLink=t.Msg__replyAttach=t.Msg__authorName=t.Msg__reply=t.Msg_renderRestoreInner=void 0;var i=v(['\n    <div class="','" '," ",">\n      ","\n    </div>\n  "],['\n    <div class="','" '," ",">\n      ","\n    </div>\n  "]),o=v(["\n    ",'\n    <div class="msg__content">\n      <div class="msg__head">\n        <a class="msg__author" href="','">','</a>\n        <div class="msg__date">',"</div>\n        ","\n        ","\n        ","\n        ","\n      </div>\n      ",'\n      <div class="msg__text">\n        ','\n      </div>\n    </div>\n    <div class="msg__restore">\n      ',"\n    </div>\n  "],["\n    ",'\n    <div class="msg__content">\n      <div class="msg__head">\n        <a class="msg__author" href="','">','</a>\n        <div class="msg__date">',"</div>\n        ","\n        ","\n        ","\n        ","\n      </div>\n      ",'\n      <div class="msg__text">\n        ','\n      </div>\n    </div>\n    <div class="msg__restore">\n      ',"\n    </div>\n  "]),r=v(['\n    <div class="msg__actions">\n      ',"\n    </div>\n  "],['\n    <div class="msg__actions">\n      ',"\n    </div>\n  "]),a=v(['\n    <div class="msg__admin">\n      (<a class="msg__adminLink" href="','">',"</a>)\n    </div>\n  "],['\n    <div class="msg__admin">\n      (<a class="msg__adminLink" href="','">',"</a>)\n    </div>\n  "]),s=v(['\n    <span class="msg__edited">\n      <span class="msg__editedMiddot">&middot;</span>',"\n    </span>\n  "],['\n    <span class="msg__edited">\n      <span class="msg__editedMiddot">&middot;</span>',"\n    </span>\n  "]),l=v(['\n    <span class="msg__restoreText msg__restoreText_remove">\n      ','\n    </span>\n    <span class="msg__restoreText msg__restoreText_spam">\n      ','\n    </span>\n    <span class="msg__restoreText msg__restoreLink" ',">\n      ","\n    </span>\n  "],['\n    <span class="msg__restoreText msg__restoreText_remove">\n      ','\n    </span>\n    <span class="msg__restoreText msg__restoreText_spam">\n      ','\n    </span>\n    <span class="msg__restoreText msg__restoreLink" ',">\n      ","\n    </span>\n  "]),u=v(['\n    <div class="msg__reply">\n      ','\n      <div class="msg__replyInner">\n        <div class="msg__replyHead">\n          <div class="msg__replyHeadRow">\n            <div class="msg__replyName">','</div>\n            <div class="msg__replyDate">','</div>\n          </div>\n        </div>\n        <div class="msg__replyBody">\n          ',"\n        </div>\n      </div>\n    </div>\n  "],['\n    <div class="msg__reply">\n      ','\n      <div class="msg__replyInner">\n        <div class="msg__replyHead">\n          <div class="msg__replyHeadRow">\n            <div class="msg__replyName">','</div>\n            <div class="msg__replyDate">','</div>\n          </div>\n        </div>\n        <div class="msg__replyBody">\n          ',"\n        </div>\n      </div>\n    </div>\n  "]),c=v(['\n    <div class="msg__replyAttach">',"</div>\n  "],['\n    <div class="msg__replyAttach">',"</div>\n  "]),d=v(['\n    <a href="','" class="msg__replyLink" ',">\n      ","\n    </a>\n  "],['\n    <a href="','" class="msg__replyLink" ',">\n      ","\n    </a>\n  "]),f=h(n(77)),p=h(n(355)),_=h(n(34)),A=h(n(163)),m=n(255);function h(e){return e&&e.__esModule?e:{default:e}}function v(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function g(e){var t=window.lang,n=f.default.onClick("Msg._onRestoreClick","event",e);return f.default.html(l,t.mobile_msg_mail_message_deleted,t.mobile_msg_mail_message_marked_as_spam,n,t.mobile_restore)}function y(e){var t=window.lang,n=void 0,i=Object.keys(e.attaches),o=i.length;if(o>1)n=langNumeric(o,t.mobile_mail_attachments);else if(1===o){var r=i[0],a=e.attaches[r];if(1===a)switch(r){case"poll":n=t.mobile_mail_added_poll;break;case"article":n=t.global_article;break;case"photo":n=t.mobile_mail_added_photo;break;case"video":n=t.mobile_mail_added_video;break;case"audio":n=t.mobile_mail_added_audio;break;case"audio_playlist":n=t.mobile_mail_added_audio_playlist;break;case"money_transfer":n=t.mobile_mail_added_money_transfer;break;case"podcast":n=t.mobile_mail_added_podcast;break;case"money_request":n=t.mobile_mail_added_money_request;break;case"vkpay":n=t.mobile_mail_added_vkpay;break;case"story":n=t.mobile_mail_added_story;break;case"graffiti":n=t.mobile_mail_added_graffiti;break;case"audiomsg":n=t.mobile_mail_added_audiomsg;break;case"doc":n=t.mobile_mail_added_doc;break;case"geo":n=t.mobile_mail_added_geo;break;case"wall":n=t.mobile_mail_added_wall;break;case"wall_reply":n=t.mobile_mail_added_wall_reply;break;case"gift":n=t.mobile_mail_added_gift;break;case"link":n=t.mobile_mail_added_link;break;case"sticker":n=t.mobile_mail_added_sticker;break;case"market":n=t.mobile_mail_added_market_item;break;case"call":n=t.mail_added_call}else if(a>1)switch(r){case"photo":n=langNumeric(a,t.mobile_mail_added_photos);break;case"video":n=langNumeric(a,t.mobile_mail_added_videos);break;case"audio":n=langNumeric(a,t.mobile_mail_added_audios);break;case"doc":n=langNumeric(a,t.mobile_mail_added_docs)}}return!n&&e.forwards&&(n=e.hasReply?langNumeric(e.forwards,t.mobile_mail_messages):langNumeric(e.forwards,t.mobile_mail_N_forwards)),n?f.default.html(c,n):""}t.default=function(e){if("for_all"===e.removed)return"";var t=e.id,n=e.removed,l=e.service,u=function(e){if(e.service)return e.text;var t=(0,_.default)({mix:"msg__avatar",url:e.authorUrl,photos:[e.authorPhoto],size:40}),n=(0,p.default)({mix:"msg__check",icon:"check"}),i=(0,p.default)({mix:"msg__star",icon:"star",blue:!0}),l=e.admin?(y=e.admin,f.default.html(a,y.url,y.name)):"",u=e.removed?g(e.id):"",c=e.edited?(v=window.lang,f.default.html(s,v.mobile_mail_edited_short)):"",d=e.channel?(m=e.id,h=(0,A.default)({class:"msg__actionForward",onClick:f.default.onClick("Msg._onActionClick","event","forward",m)}),f.default.html(r,h)):"";var m,h;var v;var y;return f.default.html(o,t,e.authorUrl,e.authorName,e.date,c,l,n,i,d,e.text,u)}(e),c=f.default.class("msg",{id:t,service:l,unread:e.unread,important:e.important,removed:!!n,spam:"spam"===n}),d="",m="";l||(d=f.default.onClick("Msg._onClick","event","this",t),m=f.default.onTouchStart("Msg._onTouchStart"));return f.default.html(i,c,d,m,u)},t.Msg_renderRestoreInner=g,t.Msg__reply=function(e,t,n){var i=e.body?function(e){return e=(e=(e=e.replace(/<br>/g,"\n")).replace(/\[((id|club)\d+)\|@(\S+?)]/g,"@$3")).replace(/\[((id|club)\d+)\|(.+?)]/g,"$3"),e=(0,m.emojiToHTML)(e)}(e.body):y(e),o="";(e.attaches.photo||e.attaches.video||e.attaches.doc)&&(o=n?'<div class="msg__replyPreview"\n        style="background-image: url('+n+')"></div>':e.attaches.doc?'<div class="msg__replyPreview msg__replyPreview_icon">\n        <div class="msg__replyPreviewDoc"></div>\n      </div>':'<div class="msg__replyPreview msg__replyPreview_empty"></div>');return f.default.html(u,o,t,e.date,i)},t.Msg__authorName=function(e,t,n){var i="";i=t>2e9?e.name:t>-2e9&&t<0?e.id===n?e.firstName:e.name:e.firstName;return i},t.Msg__replyAttach=y,t.Msg__replyLink=function(e,t,n,i){var o=f.default.onClick("Msg._onReplyClick","event",n,i);return f.default.html(d,t,o,e)}},function(e,t,n){"use strict";var i=window,o=i.preventEvent,r=i.toggleClass,a=i.attr,s=i.gpeByClass,l=i.geByClass1,u=i.ajax,c=i.val,d=i.ge,f=i.addClass,p=i.removeClass,_=i.geBySel1,A=function(){var e="_audioSnippet",t="audio_item",n="audioPlaylist__add_added",i="data-follow_text",A="data-unfollow_text",m="_audioPlaylistsPage__item",h="audioPlaylistsPage__item_removed";return{playPause:function(n,i){o(n);var u=s(e,i),c=l(t,u);audioplayer.playPause(n,a(c,"data-id")),r("audioSnippet__playpause_paused",i)},followPlaylist:function(e,t){o(e);var s=l(m+a(t,"data-playlist_owner_id")+"_"+a(t,"data-playlist_id"));hasClass(n,t)?(t.innerText=a(t,i),f(h,s)):(t.innerText=a(t,A),p(h,s)),function(e){u.post("/audio",{_ajax:1,act:"follow_playlist",playlist_owner_id:a(e,"data-playlist_owner_id"),playlist_id:a(e,"data-playlist_id"),hash:a(e,"data-hash")},{redirectToLoginPage:!0})}(t),r(n,t)},tplSearchBlockItem:function(e){return'<div class="audioPlaylists__item">\n              <a href="'+e.href+'" class="audioPlaylists__itemLink al_playlist">\n                <span class="audioPlaylists__itemCover" style="'+e.thumb_style+'">'+e.grid_covers+'</span>\n                <span class="audioPlaylists__itemTitle">'+e.title+'</span>\n                <span class="audioPlaylists__itemAuthor">'+e.author_name+'</span>\n                <span class="audioPlaylists__itemStats">'+e.short_stats+"</span>\n              </a>\n            </div>"},tplSearchBlock:function(e,t,n,i){return e?'<div class="audioPlaylists">\n                <div class="audioPlaylists__header">\n                  <div class="audioPlaylists__cell">\n                    <div class="audioPlaylists__title">'+n+'</div>\n                  </div>\n                  <div class="audioPlaylists__cell">'+i+'</div>\n                </div>\n                <div class="audioPlaylists__body _preventMenuOpen">\n                  <div class="audioPlaylists__items">\n                    '+e+"\n                  </div>\n                </div>\n              </div>":""},tplSearchListItem:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n='<div class="audioPlaylistsPage__cell audioPlaylistsPage__cell_actions">\n                <div class="audioPlaylistsPage__menu ai_menu_wrap">\n                  <a href="#" class="ai_menu_toggle_button" onclick="ActionMenu.toggleMenu(event, this);"></a>\n                  <i class="i_pointer"></i>\n                  <div class="ai_menu wi_actions">\n                    '+e.follow_link+"\n                    "+e.publish_link+"\n                  </div>\n                </div>\n             </div>\n             "+e.actions;return t&&(n='<div class="audioPlaylistsPage__cell audioPlaylistsPage__cell_actions">\n                   <div class="audioPlaylistsPage__menu ai_menu_wrap">\n                     <a href="#" class="ai_menu_toggle_button"></a>\n                   </div>\n                 </div>'),'<div class="audioPlaylistsPage__item _audioPlaylistsPage__item'+e.owner_id+"_"+e.id+'">\n              <div class="audioPlaylistsPage__cell audioPlaylistsPage__cell_link">\n                <a href="'+e.href+'" class="audioPlaylistsPage__itemLink">\n                  <span class="audioPlaylistsPage__container">\n                    <span class="audioPlaylistsPage__cell audioPlaylistsPage__cell_cover">\n                      <span class="audioPlaylistsPage__cover" style="'+e.thumb_style+'">'+e.grid_covers+'</span>\n                    </span>\n                    <span class="audioPlaylistsPage__cell audioPlaylistsPage__cell_desc">\n                      <span class="audioPlaylistsPage__title">'+e.title+'</span>\n                      <span class="audioPlaylistsPage__author">'+e.author_name+'</span>\n                      <span class="audioPlaylistsPage__stats">'+e.short_stats+"</span>\n                    </span>\n                  </span>\n                </a>\n              </div>\n              "+n+"\n            </div>"},tplSearchListNull:function(e){return'<div class="audioPlaylistsPage__notFound">\n              '+e+"\n            </div>"},tplPlaylistsPage:function(e){return'<div class="audioPlaylistsPage">\n              <div class="audioPage__search">\n                '+(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"")+'\n              </div>\n              <div class="audioPlaylistsPage__list _si_container" id="au_search_playlist_items">\n                '+e+"\n              </div>\n            </div>"},tplPlayerSearch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=window.lang,i=(escapeAttr(e),n.mobile_audio_search_btn,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return'<div class="audioPage__search">\n              <div class="hp_block">\n                '+e+'\n                <div class="qsearch">\n                  <table class="row_table">\n                    <tr>\n                      <td class="row_table_main_column">\n                        <div class="qs_field_wrap">\n                          <div class="iwrap">\n                            <input id="au_search_field" type="text" class="textfield qs_textfield" name="q" placeholder="'+n.mobile_audio_search_placeholder_simple+'">\n                          </div>\n                        </div>\n                      </td>\n                      <td class="row_table_last_column">\n                        '+t+"\n                      </td>\n                    </tr>\n                  </table>\n                </div>\n              </div>\n            </div>"});return t?i():function(e,t,n){return'<form action="/audio" class="qsearch" onsubmit="return cur.au_search.go(event);">'+e(t,n)+"</form>"}(i)},copyValue:function(e,t){var n=c(e),i=d(t+"_field");c(i,n),cur&&cur[t]&&cur[t].go();var o=_(".audioPage__tabs .tab_item_cur");o&&r("tab_item_cur_noactive",o,n)}}}();window.AudioPlaylist=A},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(21),r=(i=o)&&i.__esModule?i:{default:i};t.default=r.default,window.Wd=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(326)),o=a(n(210)),r=a(n(355));function a(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=window.lang,n=e.count;return i.default.html({class:[o.default.class("Bell",{empty:!n}),"al_menu"],href:e.url,onclick:e.onclick,"aria-label":t.mobile_notifications_title,"data-header":t.mobile_notifications_title,"data-skiponclick":1,inner:[i.default.html((0,r.default)({mix:"Bell__icon",icon:"bell"})),{class:"Bell__counter",inner:n}]})}},function(e,t,n){"use strict";function i(e,t){return new Promise(function(n){setTimeout(n.bind(null,t),1e3*e)})}Object.defineProperty(t,"__esModule",{value:!0}),t.pause=i,t.retryFn=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=0;return function r(){for(var a=arguments.length,s=Array(a),l=0;l<a;l++)s[l]=arguments[l];return Promise.resolve().then(function(){return e.apply(void 0,s)}).catch(function(e){if(++o<=t){var a="function"==typeof n?n(o):0;return 0===a?r.apply(void 0,s):i(a).then(function(){return r.apply(void 0,s)})}throw e})}},t.debouncedPromise=function(e,t,n){var i=void 0,o=void 0;return function(){for(var r=arguments.length,a=Array(r),s=0;s<r;s++)a[s]=arguments[s];return new Promise(function(e,r){var s=n&&!i;clearTimeout(i),o&&o.reject("debounce"),i=setTimeout(function(){i=null,o=null,n||e(a)},t),s?e(a):n&&r("debounce"),o={resolve:e,reject:r}}).then(function(t){return e.apply(void 0,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t))})}},t.abortablePause=function(e,t){var n=void 0,i=new Promise(function(i){n=i,setTimeout(i.bind(null,t),1e3*e)});return{pause:function(){return i},abort:function(){n(t)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(1),r=n(72),a=(i=r)&&i.__esModule?i:{default:i},s=n(202),l=n(10),u=n(341),c=n(286);var d=window.clog,f={onNewMsg:(0,a.default)("{ peerId, msgId, authorId, text, date, hasAttachments, flags, isService }"),onEditMsg:(0,a.default)("{ peerId, msgId, authorId, text, date, hasAttachments, flags }"),onMsgReadByMe:(0,a.default)("msgId","dialogId"),onMsgReadByOther:(0,a.default)("msgId","dialogId"),onOnlineChange:(0,a.default)("{ userId, isOnline, onlinePlatform, lastActionTime }"),onTyping:(0,a.default)("dialogId","authorId"),onMultiTyping:(0,a.default)("peerId","userIds","totalCount"),onRecordingAudio:(0,a.default)("peerId","userIds","totalCount"),onMsgImportantRemove:(0,a.default)("msgId"),onMsgImportantAdd:(0,a.default)("msgId"),onMsgRequestChange:(0,a.default)("peerId","type"),onMsgRemove:(0,a.default)("msgId"),onMsgRestore:(0,a.default)("msgId"),onPeerKeyboard:(0,a.default)("peerId"),onPeerBanner:(0,a.default)("peerId"),onPeerConvert:(0,a.default)("peerId","convertId"),onDialogImportant:(0,a.default)("peerId","isImportant"),onDialogRemove:(0,a.default)("peerId"),onUnreadCount:(0,a.default)("count"),onResync:(0,a.default)(),_onLpEvents:(0,a.default)("Array<Object>"),init:function(e){f._lpConnect&&(f._onLpEvents.off(),f._lpConnect.stopConnection(),f._lpQueue=null,f._lpConnect=null),f._lpConfig=e},isLongPollingEnabled:function(){return!(!f._lpConnect||f._lpConnect.isStopped())},on:function(){d("[longpoll] start"),f._lpConnect?f._lpConnect.reinitConnection():f._createLongpoll(f._lpConfig)},off:function(){d("[longpoll] stop"),f._lpConnect&&f._lpConnect.stopConnection()},pause:function(){d("[longpoll] pause"),f._lpQueue&&f._lpQueue.pause()},resume:function(){d("[longpoll] resume"),f._lpQueue&&f._lpQueue.resume()},_createLongpoll:function(e){if(!f._lpConnect){var t=(0,l.createLongpollEventsQueue)(e.ts,function(e){f._onLpEvents(e)}),n=(0,s.createLongpollConnect)(e,{onEvents:function(e,n,i){i.forEach(function(i){t.onLp(e,n,[i])})},onHistoryLost:function(){d("[longpoll] ts expired")},onKeyExpired:function(e){return d("[longpoll] key expired"),(0,u.post)("/mail",{act:"get_key",user_id:e.id})},onLpBroken:function(){d("[longpoll] broken, reload"),window.location.reload()}});f._lpQueue=t,f._lpConnect=n,f._onLpEvents(function(e){try{e.forEach(f._onEvent)}catch(e){console.error(e)}})}},_onEvent:function(e){var t,n,i,r=e.type;switch(r){case c.REPLACE_FLAGS:var a=e.flags,s=e.messageId;e.peerId;a&c.FLAG_IMPORTANT?f.onMsgImportantAdd(s):f.onMsgImportantRemove(s),a&c.FLAG_DELETED||a&c.FLAG_SPAM?f.onMsgRemove(s):f.onMsgRestore(s);break;case c.SET_FLAGS:var l=e.flags,u=e.messageId,d=e.peerId;l&c.FLAG_IMPORTANT&&f.onMsgImportantAdd(u),(l&c.FLAG_DELETED||l&c.FLAG_SPAM)&&f.onMsgRemove(u,d);break;case c.RESET_FLAGS:var _=e.flags,A=e.messageId;e.peerId;_&c.FLAG_IMPORTANT&&f.onMsgImportantRemove(A),(_&c.FLAG_DELETED||_&c.FLAG_SPAM)&&f.onMsgRestore(A);break;case c.ADD_MESSAGE:case c.EDIT_MESSAGE:case c.REPLACE_MESSAGE:var m=e.messageId,h=e.peerId,v=e.randomId,g=e.text,y=e.flags,w=e.attaches,b=e.kludges,D=e.date,C=function(e){return Object.keys(e).some(function(e){return-1!==e.indexOf("attach")})||e.fwd||e.emoji||e.geo}(b),E=(t=new Date(1e3*D),n=t.getHours(),i=t.getMinutes(),n+":"+(i<10?"0":"")+i),S=(0,o.toInt)(b.from_admin)||null,k=((0,o.toInt)(nav.getQuery("community")),function(e,t,n){var i=(0,o.toInt)(e.from_admin)||null,r=(0,o.toInt)(nav.getQuery("community"));if(i&&r)return r;if(t&c.FLAG_OUTBOUND)return window.vk.id;return(0,o.toInt)(e.from)||n}(b,y,h)),M=!!b.source_act,T=r===c.EDIT_MESSAGE||r===c.REPLACE_MESSAGE,x=!!(y&c.FLAG_STEALTH),I=b.keyboard,P=function(e,t){t&c.FLAG_HAS_REPLY&&p(e)}(b,y),B=(p(b),{});w.forEach(function(e){if("mail"!==e.type){var t=e.kind||e.type;B[t]=(B[t]||0)+1}});var F={peerId:h,msgId:m,authorId:k,text:g,date:E,hasAttachments:C,flags:y,adminId:S,randomId:v,isService:T?void 0:M,edited:!!T||void 0,replaced:r===c.REPLACE_MESSAGE,keyboard:I,isStealth:x,hasReply:P};T?f.onEditMsg(F):f.onNewMsg(F);break;case c.READ_INBOUND:case c.READ_OUTBOUND:var L=e.peerId,O=e.upToId;e.unread;r===c.READ_INBOUND?f.onMsgReadByMe(O,L):f.onMsgReadByOther(O,L);break;case c.GOT_ONLINE:case c.GOT_OFFLINE:var N=e.userId,R=e.platform,j=(e.reason,e.lastSeenTs),H="mobile";R&&6!==R&&7!==R||(H="desktop"),f.onOnlineChange({userId:N,isOnline:r===c.GOT_ONLINE,onlinePlatform:H,lastActionTime:j});break;case c.RESET_DIRECTORIES:case c.SET_DIRECTORIES:var V=e.mask,$=e.peerId;e.local;V&c.FOLDER_IMPORTANT&&f.onDialogImportant($,r===c.SET_DIRECTORIES);break;case c.REPLACE_DIRECTORIES:var U=e.mask,z=e.peerId;e.local;f.onDialogImportant(z,!!(U&c.FOLDER_IMPORTANT));break;case c.DELETE_DIALOG:var q=e.peerId;f.onDialogRemove(q);break;case c.CONVERSATION_UPDATED:var W=e.peerId,Y=e.updateType,G=e.updateArg;if(11===Y&&f.onPeerKeyboard(W),10===Y&&f.onPeerBanner(W),13===Y&&f.onPeerConvert(G,W),12===Y){var X="";switch(G){case 3:X="created";break;case 2:X="rejected";break;case 1:X="accepted";break;case 0:X="canceled"}f.onMsgRequestChange(W,X)}break;case c.TYPING:var Q=e.peerId,K=e.userIds,J=e.totalCount;e.ts;f.onMultiTyping(Q,K,J);break;case c.RECORDING_AUDIO:var Z=e.peerId,ee=e.userIds,te=e.totalCount;e.ts;f.onRecordingAudio(Z,ee,te);break;case c.VIDEO_CALL:break;case c.UNREAD_COUNT:var ne=e.count,ie=e.countNotMuted,oe=e.showOnlyNotMuted;f.onUnreadCount(oe?ie:ne);break;case c.NOTIFY_SETTINGS_CHANGED:break;case c.RESYNC:f.onResync()}}};function p(e){return+e.fwd_count||0}t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(355),r=(i=o)&&i.__esModule?i:{default:i};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=e?e.mix:"";return(0,r.default)({mix:t+" Spinner",icon:"spinner"})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{!i&&s.return&&s.return()}finally{if(o)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=n(65),r=n(43),a=n(239);var s=window,l=s.geByTag,u=s.geByTag1,c=s.each,d=s.removeClass,f=s.intval,p=s.toggleClass,_=s.domData,A=s.domQuery1,m=s.getW,h=s.getXY,v=s.getH,g=s.geByClass,y=s.ge,w={},b=void 0,D=function(){function e(t,n,i){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._article=t,this._options=n,this._readTO=null,this._scrollStatEvent=!1,this._els={view:y("article_view_"+t.raw_id)},window.cur&&cur.destroy&&cur.destroy.push(function(){o.deinit()}),window.cur&&cur.destroy.push(function(){o.deinit()}),window.addEventListener("VKWebAppEvent",function(e){if(e&&e.detail&&void 0!==e.detail.index){var t=e.detail.index;if(b){var n=w[_(b,"id")];n&&n(t)}}}),i&&this.ready()}return e.prototype.getEl=function(){return this._els.view},e.prototype.getArticle=function(){return this._article},e.prototype.getScrollNode=function(){return this._options.getScrollNode?this._options.getScrollNode():window},e.prototype._getScrollTop=function(){return this._options.getScrollTop?this._options.getScrollTop():window.scrollNode?window.scrollNode.scrollTop:window.document.documentElement.scrollTop},e.prototype.deinit=function(){this._scrollEvent&&(this.getScrollNode().removeEventListener("scroll",this._scrollEvent),this._scrollEvent=!1),this._scrollStatEvent&&(this.getScrollNode().removeEventListener("scroll",this._scrollStatEvent),this._scrollStatEvent=!1),clearTimeout(this._readTO)},e.prototype._onViewScroll=function(){var e=this,t=this._options.mobile?scrollGetY():window.scrollNode.scrollTop,n=window.innerHeight;c(l("figure",this._els.view),function(i,o){var r=f(_(o,"done"));if(!r){var a=v(o),s=h(o)[1],l=f(_(o,"type")),u=101==l?-200:100,c=s<=t+n-u&&t+u<=s+a;(r=e._onObjectView(c,l,o))&&_(o,"done",1)}})},e.prototype._initObjects=function(){var e=this;this._initedObjects=this._initedObjects||{},c(g("_article_unmute_button",this._els.view),function(t,n){e._initedObjects[t]||(e._initedObjects[t]=!0,n.addEventListener("click",function(){var e=n.parentNode,t=u("video",e);t.muted=!t.muted,p(e,"article_object_unmuted",!t.muted)}))});var t={};c(l("figure",this._els.view),function(n,i){if(!e._initedObjects[n]&&(e._initedObjects[n]=!0,parseInt(_(i,"type"))==r.ParagraphType.ObjectPhoto)){var o=(0,a.initPhotoCarousel)(i,e._options),s=e._initPhoto(i);void 0!==s&&(t[s]=o)}})},e.prototype._initPhoto=function(e){var t=this;geByClass1("article_figure_content",e).addEventListener("click",function(){var n=A("[data-sizes]",e),i=JSON.parse(_(n,"sizes")),o=f(_(e,"photo-carousel-index"));t._options.onImageOpen&&t._options.onImageOpen.call(t,i,e,o)})},e.prototype._initStats=function(){if(this._statsInited)this._scrollStatEvent&&this._scrollStatEvent();else{this._statsInited=!0;var e=Date.now(),t=-1,n=void 0,i=[];this._scrollStatEvent&&this.getScrollNode().removeEventListener("scroll",this._scrollStatEvent),clearTimeout(this._readTO);var o=this;this.getScrollNode().addEventListener("scroll",this._scrollStatEvent=function(){var e=o.getCurrentScrollRatio();if(!(e<0)){var s=1;e>=.95?s=4:e>.66?s=3:e>.33&&(s=2),function(e){if(o._isReady&&(o._article.has_more&&(e=Math.min(e,1)),!(t>=e))){for(var s=t+1;s<=e;s++)i.push(s);if(t=e,clearTimeout(n),n=setTimeout(a,300),3==e&&o._article.ttr){var l=o._article.ttr-r();l>0&&(o._readTO=setTimeout(function(){if(!document.hidden){var e=o.getCurrentScrollRatio();if(!(e<0||e>1.3)){var n=4==t;i=[t=4],a(n)}}},1e3*l))}}}(s),4!=s||o._article.has_more||(o.getScrollNode().removeEventListener("scroll",o._scrollStatEvent),o._scrollStatEvent=!1)}},{passive:!0}),this._scrollStatEvent&&this._scrollStatEvent()}function r(){return Math.round((Date.now()-e)/1e3)}function a(e){if(i.length){var t=o._article,n=o._options,a={act:"stats",scroll:i.join(","),spent:r(),hash:t.access_hash,article_owner_id:t.owner_id,article_id:t.id,is_web_view:n.isWebView?1:0,post_id:n.sourcePostId,ref:window.cur?window.cur.module:"",is_widget:n.isWidget,is_delayed_scroll_4:f(e),track_code:n.trackCode};ajax.post(n.mobile?"article.php":"al_articles.php",a),i=[]}}},e.prototype._initGoogleAnalytics=function(){var e=this._options.googleAnalyticsId;if(e)if(window.dataLayer=window.dataLayer||[],window.gtag)gtag("config",e,{page_location:window.location.href});else{var t=document.createElement("script");t.setAttribute("src","https://www.googletagmanager.com/gtag/js?id="+e),t.setAttribute("async","true"),document.head.appendChild(t),window.gtag=function(){dataLayer.push(arguments)},gtag("js",new Date),gtag("config",e)}},e.prototype._onObjectView=function(e,t,n){var a=!1;switch(t){case r.ParagraphType.ObjectPhoto:if(e){var s=u("img",n),l=m(s)||this._options.width,c=_(s,"baseurl");if(c)c=(0,o.imageProxyURL)(c,{size:l}),(0,r.preloadImage)(c,function(){d(s,"article_object_photo__image_blur"),s.src=c});else{var f=A("[data-sizes]",n),p=JSON.parse(_(f,"sizes"));p.forEach(function(e,t){if(!(t>3)){var n=(0,r.getAppropriateImage)(p[t],l,!0),o=i(n,1)[0];(0,r.preloadImage)(o,function(){0==t&&(d(s,"article_object_photo__image_blur"),s.src=o)})}})}a=!0}break;case r.ParagraphType.ObjectGIF:if(!this._options.mobile){var h=u("video",n);if(h)if(e){if(h.hasAttribute("autoplay")){var v=h.play();v&&v.catch(function(){})}}else h.pause();else a=!0}}return a},e.prototype.getCurrentScrollRatio=function(){var e=v(this._els.view),t=h(this._els.view)[1]-h(this.getScrollNode().firstElementChild)[1];return(this._getScrollTop()+window.innerHeight-t)/e},e.prototype.getScreenVisibilityRatio=function(){var e=v(this._els.view),t=h(this._els.view)[1]-h(this.getScrollNode().firstElementChild)[1],n=this._getScrollTop(),i=window.innerHeight,o=t,r=t+e,a=n,s=n+i;if(a>r||o>s)return 0;var l=Math.max(o,a);return(Math.min(r,s)-l)/i},e.prototype.update=function(){this._initObjects(),this._initStats(),this._options.onScroll&&this._options.onScroll.call(this,this.getCurrentScrollRatio())},e.prototype.ready=function(){var e=this;this._isReady=!0,this._initObjects(),this._initStats(),this._initGoogleAnalytics();var t=(0,r.getUrlParam)("anchor");(t&&setTimeout(function(){e._options.isWebView||e.scrollToAnchor(t);var n=e.getScrollNode();n.click&&n.click(),n.focus()},10),!this._options.mobile&&window.AudioPlaylist)&&(this._article.audios_list&&this._article.audios_list.length>0&&new AudioPlaylist(AudioPlaylist.TYPE_TEMP,this._article.owner_id,"article_"+this._article.id).mergeWith({list:this._article.audios_list}));this.getScrollNode().addEventListener("scroll",this._scrollEvent=function(){e._onViewScroll(),e._options.onScroll&&e._options.onScroll.call(e,e.getCurrentScrollRatio())}),setTimeout(function(){e._scrollEvent()},this._options.objectsInitDelay||0)},e.prototype.scrollToAnchor=function(e){e=e||(0,r.getUrlParam)("anchor");var t=this.getScrollNode(),n=this._options;e&&function(){var i=document.getElementById(e);if(i){"scrollRestoration"in history&&(history.scrollRestoration="manual");var o=n.isWebView?0:25,r=i.parentNode.parentNode.offsetTop-o;window.setTimeout(function(){browser.msie&&!t.scrollTo?t.scrollTop=r:t.scrollTo(0,r)},0)}}()},e}();t.default=D},function(e,t,n){"use strict";!function(e){e.console||(e.console={});for(var t,n,i=e.console,o=function(){},r=["memory"],a="assert,clear,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profiles,profileEnd,show,table,time,timeEnd,timeline,timelineEnd,timeStamp,trace,warn".split(",");t=r.pop();)i[t]||(i[t]={});for(;n=a.pop();)i[n]||(i[n]=o)}("undefined"==typeof window?void 0:window)},function(e,t,n){"use strict";window.FeedBlocks={hideReason:function e(t,n){if(e.progress)return!1;e.progress=!0;var i="block_"+t,o=ge(i);cur.feedBlocksHTML&&delete cur.feedBlocksHTML[i],ajax.post("feed.php",{act:"block_hide_reason",block_id:t,reason:0|n,hash:attr(o,"data-hash"),pos:attr(o,"data-pos"),ref:attr(o,"data-ref")},{onDone:function(t){e.progress=!1,t?val(o,t):hide(o),e.progress=!1},onFail:function(){e.progress=!1}})},restore:function(e){var t="block_"+e,n=ge(t);cur.feedBlocksHTML&&cur.feedBlocksHTML[t]&&val(t,cur.feedBlocksHTML[t]),ajax.post("feed.php",{act:"block_restore",block_id:e,hash:attr(n,"data-hash"),pos:attr(n,"data-pos"),ref:attr(n,"data-ref")})},hide:function e(t,n){if(e.progress)return!1;e.progress=!0,post.wallActionsHide();var i="block_"+t,o=ge(i);return ajax.post("feed.php",{act:"block_hide",block_id:t,hash:attr(o,"data-hash"),pos:attr(o,"data-pos"),ref:attr(o,"data-ref")},{onDone:function(t){post.wallActionsHide(),cur.feedBlocksHTML||(cur.feedBlocksHTML={}),cur.feedBlocksHTML[i]=val(o),val(o,t),e.progress=!1},onFail:function(){e.progress=!1}}),!1}}},function(e,t,n){"use strict";var i=window,o=i.onDOMReady,r=i.onBodyResize,a=i.geByClass1,s=i.removeClass,l=i.addClass,u=i.gpeByClass,c=i.hasClass,d=i.toggleClass,f=window,p=f.clearCookie,_=f.setCookie;!function(){function e(){if(a("tabs_block_hideable")){var e=a("tabs_block");a("tabs_list").offsetHeight>a("tabs_list_more").offsetHeight?s("tabs_block_without_show_more",e):l("tabs_block_without_show_more",e)}}o(e),r(e),window.Tabs={actualizeShowMoreVisibility:e,toggle:function(e){var t=u("tabs_block",e);c("tabs_block_opened",t)?p("remixm_tabs_expanded"):_("remixm_tabs_expanded",1),d("tabs_block_opened",t)}}}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{!i&&s.return&&s.return()}finally{if(o)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r=n(72),a=(i=r)&&i.__esModule?i:{default:i};var s=window,l=s.getNotify,u=s.setNotify,c=s.setDocumentDomain,d=s.ce,f=s.onDOMReady,p=s.append,_=s.clog,A=s.extend,m=s.parseJSON,h=s.intval,v=s.each,g=window.ajax,y=window.nav,w=window.menu,b=window.mail,D=function(){var e=null,t={},n=1,i=null,r=!1,s=!1;function C(){n<64&&(n*=2)}function E(e,t){var n=window.al;if(!1===e&&(e=l()+(t||1)),u(e),window.al&&window.al.menu){var i=new Array(n.menu.length);i[2]=e,w.refreshCounters(i)}}function S(e){return Object.keys(e).some(function(e){return-1!==e.indexOf("attach")})||e.fwd||e.emoji||e.geo}function k(e,t,n){var i=toInt(e.from_admin)||null,o=toInt(y.getQuery("community"));return i&&o?o:2&t?window.vk.id:toInt(e.from)||n}function M(){return Number(y.getQuery("offset"))>0}function T(e){try{return JSON.parse(e)}catch(e){return null}}return{onNewMsg:(0,a.default)("{ peerId, msgId, authorId, text, date, hasAttachments, flags, isService }"),onEditMsg:(0,a.default)("{ peerId, msgId, authorId, text, date, hasAttachments, flags }"),onMsgReadByMe:(0,a.default)("msgId","dialogId"),onMsgReadByOther:(0,a.default)("msgId","dialogId"),onOnlineChange:(0,a.default)("{ userId, isOnline, onlinePlatform, lastActionTime }"),onTyping:(0,a.default)("dialogId","authorId"),onMultiTyping:(0,a.default)("peerId","userIds","totalCount"),onMsgImportantRemove:(0,a.default)("msgId"),onMsgImportantAdd:(0,a.default)("msgId"),onMsgRemove:(0,a.default)("msgId"),onMsgRestore:(0,a.default)("msgId"),onPeerKeyboard:(0,a.default)("peerId"),onPeerBanner:(0,a.default)("peerId"),onDialogImportant:(0,a.default)("peerId","isImportant"),onUnreadCount:(0,a.default)("count"),onResync:(0,a.default)(),isLongPollingEnabled:function(){return!!r},init:function(t){e||(c(),e=d("iframe",{src:t.frameUrl},{display:"none"}),f(function(){p(e,window.bodyNode),!0})),D.refreshParams(t),setTimeout(D.check,1e3)},on:function(){_("[longpoll] start"),r=!0,setTimeout(D.check,1e3)},off:function(){_("[longpoll] pause"),r=!1},refreshParams:function(e){A(t,e||{}),A(D,t)},getKey:function(){if(i)try{i.abort()}catch(e){}i=g.post("/mail",{_ajax:1,act:"im_get_key",community:y.getQuery("community")},{onDone:function(e){/[0-9a-f]{40}/i.test(e)?(D.refreshParams({key:e}),D.check()):_("[longpoll] invalid key")},onFail:function(e){setTimeout(D.getKey,1e3*n),_("[longpoll] from getKey delaying getKey for "+n+"secs"),C()}})},check:function(){if(r&&!s)if(D.makeRequest)try{D.makeRequest(function(e,t){if(s=!1,r)if(window.vk.__debug)D.checked(m(t))&&(D.check(),n=1);else try{D.checked(m(t))&&(D.check(),n=1)}catch(e){try{_("[longpoll] error",e.message||"no message",e.type||"no type",e.stack||"no stack")}catch(e){}setTimeout(D.check,1e3*n),C()}},function(){s=!1,setTimeout(D.check,1e3*n),C()}),s=!0}catch(e){_("[longpoll] makeRequest failed")}else setTimeout(D.check,1e3)},checked:function(e){var i,r,a,s=e.failed;if(1==s||t.ts>=e.ts+256){if(D.refreshParams({ts:e.ts}),s)return!0}else{if(2==s)return _("[longpoll] delaying getKey for "+n+"secs"),setTimeout(D.getKey,1e3*n),C(),!1;if(s)return void _("[longpoll]",e)}if(D.refreshParams({ts:e.ts}),e.updates){var l=[],u=!1;for(var c in e.updates){if(116==e.updates[c][0])var d=e.updates[c][1],f=[e.updates[c][0],d.id,d.flags,d.peer_id,d.date,d.title||"",d.message,d.kludges,d.random_id];else f=e.updates[c];var p=h(f[0]),m=h(f[1]),w=h(f[2]),x=h(f[3]);if(1===w){if(10===p){b.updateImportantDialog(m,!1);continue}if(12===p){b.updateImportantDialog(m,!0);continue}}if(8&w){if(2===p){if(window.isNewMail){D.onMsgImportantAdd(m);continue}b.updateImportantMessages(x,m,1);continue}if(3===p){if(window.isNewMail){D.onMsgImportantRemove(m);continue}b.updateImportantMessages(x,m,-1);continue}}if(51!=p)if(61!=p)if(62!=p)if(8!=p)if(9!=p)if(6!=p&&7!=p)if(80!=p||!m||y.getQuery("community"))if(52!=p){if(x)if(4!=p&&5!=p&&116!=p)if(0!=p)if(2!=p);else{if(128&w){if(window.isNewMail){D.onMsgRemove(m);continue}b.markAsDeleted(x,m)}window.isNewMail&&64&w&&D.onMsgRemove(m)}else{if(window.isNewMail){D.onMsgRemove(m);continue}b.markAsDeleted(m)}else{var I=5==p||116==p;if(window.isNewMail){var P=o(f,9),B=P[1],F=P[3],L=P[4],O=P[6],N=P[7],R=void 0===N?{}:N,j=P[8],H=S(R),V=(i=void 0,void 0,void 0,i=new Date(1e3*L),r=i.getHours(),a=i.getMinutes(),r+":"+(a<10?"0":"")+a),$=toInt(R.from_admin)||null,U=(toInt(y.getQuery("community")),k(R,w,F)),z=!!R.source_act,q=R.keyboard?T(R.keyboard):null;if(I){var W={peerId:F,msgId:B,authorId:U,text:O,date:V,hasAttachments:H,flags:w,adminId:$,randomId:j};116==p?W.refreshed=1:W.edited=Math.floor(Date.now()/1e3),D.onEditMsg(W)}else D.onNewMsg({peerId:F,msgId:B,authorId:U,text:O,date:V,hasAttachments:H,flags:w,adminId:$,randomId:j,isService:z,keyboard:q});continue}var Y=window.vk,G=2&w?Y.id:f[7]&&f[7].from||x,X=f[7]&&f[7].source_act;u||(u=!!need("PinnedMsg").getByMsgId(m));var Q=f[7].from_admin||X||u?null:b.getMsgHTML(m,w,x,f[4],f[5],f[6],f[7],116!=p?I:"");if(Q&&(I?b.replaceMessage(x,m,G,Q):M()||b.addMessage(x,m,G,Q),2&w||y.getQuery("community")||E(!1,1)),"chat_kick_user"===X&&f[7].source_mid==Y.id){var K=f[3];b.unpinMessage(K)}Q&&"chat_pin_message"!==X&&"chat_unpin_message"!==X||l.push({peer:x,msg_id:m,from_id:G,source_act:X,edited:I})}}else{var J=o(f,3),Z=J[1],ee=J[2];if(!window.isNewMail)continue;11==Z&&D.onPeerKeyboard(ee),10==Z&&D.onPeerBanner(ee)}else E(m);else{if(window.isNewMail){var te=f[1],ne=f[2];6===p?D.onMsgReadByMe(ne,te):D.onMsgReadByOther(ne,te);continue}b.markPeerAsRead(m,w,7==p)}else{if(window.isNewMail){D.onOnlineChange({userId:-m,isOnline:!1,lastActionTime:x});continue}b.updateOnline(-m,0)}else{if(window.isNewMail){D.onOnlineChange({userId:-m,isOnline:!0,onlinePlatform:7===(w||7)?"desktop":"mobile"});continue}b.updateOnline(-m,w||7)}else{if(window.isNewMail){var ie=2e9+w,oe=m;D.onTyping(ie,oe);continue}b.typing(2e9+w,m)}else{if(window.isNewMail){var re=m,ae=m;D.onTyping(re,ae);continue}b.typing(m)}}if(l.length){var se=[];v(l,function(e,t){se.push(t.msg_id)});var le={_ajax:1,act:"get_messages",msgs:se.join(","),community:y.getQuery("community")};u&&(le.force_pinned=1),g.post("/mail",le,{onDone:function(e,t){var n=window.cur,i=M();v(l,function(t,n){var o=e[n.msg_id],r=n.peer;o.text&&!i&&(n.edited?b.replaceMessage(n.peer,n.msg_id,n.from_id,o.text):b.addMessage(n.peer,n.msg_id,n.from_id,o.text)),o.unpin&&b.unpinMessage(r),o.pinned&&b.pinMessage(r,o.pinned)}),t&&(t.play_animation_msg_id&&StickersAnimation?StickersAnimation.loadStickerInMvkIMAndPlay(t.play_animation_msg_id):(A(n,t),b.updateStickers()))}})}}return!0}}}();t.default=D},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.QuadAlgorithm=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clear()}return e.prototype.push=function(e){this._count++,this._accum+=e,this._accum_q+=e*e},e.prototype.get=function(){return 1==this._count?this._accum:Math.sqrt((this._accum_q-this._accum*this._accum/this._count)/this._count)},e.prototype.clear=function(){this._count=0,this._accum=0,this._accum_q=0},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=function(){if(!window.addEventListener)return;(function(){if(!i.default.isSupported())return;navigator.serviceWorker.addEventListener("message",function(e){var t=e.data;t&&t.action&&"update-ready"===t.action&&(hasUpdate=!0)})})(),window.addEventListener("beforeinstallprompt",function(e){e.preventDefault()}),window.addEventListener("appinstalled",function(){statlogsValueEvent("pwa_installed_event",1)}),"complete"===document.readyState?A():window.addEventListener&&window.addEventListener("load",function(){A()}),function(){if(!0!==navigator.standalone)return;var e=history.pushState,t=history.replaceState;history.pushState=function(t,n,i){e.call(this,t,n,i),c=location.pathname+location.search+location.hash,u()},history.replaceState=function(e,n,i){t.call(this,e,n,i),c=location.pathname+location.search+location.hash,u()},window.addEventListener("popstate",function(){c=location.pathname+location.search+location.hash,u()})}(),e=p(),t=function(){e?(0,a.setCookie)(f,1,30):(0,a.clearCookie)(f)},t(),window.addEventListener("focus",t);var e,t},t.isStandalone=p,t.isOfflineCapable=_;var i=s(n(41)),o=s(n(227)),r=n(1),a=n(50);function s(e){return e&&e.__esModule?e:{default:e}}var l=new i.default;window.sw_client=l,window.SWClient=i.default,n(229);var u=(0,r.debounce)(function(){if(!c)return;navigator.standalone&&_()&&navigator.serviceWorker.controller.postMessage({action:"set-last-page",data:{lastPage:c}})},1e3),c=void 0,d=void 0,f="remixmpwa";function p(){return!0===navigator.standalone||window.matchMedia&&matchMedia("(display-mode: standalone)").matches}function _(){return void 0===d&&(d=!(!i.default.isSupported()||!navigator.serviceWorker.controller)),d}function A(){l.register().then(function(e){navigator.standalone&&_()&&navigator.serviceWorker.controller.postMessage({action:"set-user-id",data:{userId:vk.id}}),!navigator.standalone&&vk.pwa_hash&&_()&&navigator.serviceWorker.controller.postMessage({action:"set-pwa-hash",data:{hash:vk.pwa_hash}}),u()},function(e){if(e!==i.default.SW_NOT_AVAILABLE_ERROR)throw e}),i.default.isSupported()&&navigator.serviceWorker.getRegistration().then(function(e){!function(e){if(!_())return;e.active&&e.installing&&e.installing.postMessage({action:"activate"})}(e)}),(0,o.default)()}},function(e,t,n){"use strict";var i,o=n(326),r=(i=o)&&i.__esModule?i:{default:i};window.SettingsRow_select={},SettingsRow_select._onChange=s;var a={row:".settingsRow",description:".settingsRow__description"};function s(e,t){!function(e){var t=e.$select,n=e.label;t.closest(a.row).$(a.description).textContent=n}(t),r.default.handle(e,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(210),r=(i=o)&&i.__esModule?i:{default:i};function a(e){var t,n=[],i=Object.keys(e),o=i.length;for(t=0;t<o;t++){var r=i[t],a=e[r];n.push(r+": "+a+";")}return n.join(" ")}t.default=function(e){var t=e.bcg,n=t.type;return{class:r.default.class("VotingBcg",{type:n}),style:"photo"===n?function(e){return a({"background-color":e.color})}(t):"gradient"===n?function(e){var t,n=[],i=e.points.length;for(t=0;t<i;t++){var o=e.points[t];n.push(o.color+" "+o.percent+"%")}var r=e.angle-90;return n=n.join(", "),a({background:"linear-gradient("+r+"deg, "+n+")"})}(t):"tile"===n?function(e){var t=e.image,n=e.width,i=e.height;return a({"background-image":"url('"+t+"')","background-position":"top center","background-size":n+"px "+i+"px"})}(t):null,inner:"photo"===n?function(e){var t=e.bcg,n=t.photo,i=t.color;return{class:"VotingBcg__photoBox",style:a({height:e.photoHeight+"px"}),inner:[{class:"VotingBcg__photoImage",style:a({"background-image":"url('"+n+"')"})},{class:"VotingBcg__photoGradient",style:a({background:"linear-gradient(to bottom, rgba(255, 255, 255, 0), "+i+")"})}]}}(e):null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(210),r=(i=o)&&i.__esModule?i:{default:i};t.default=function(e){var t=e.img?e.img:"",n=!!e.url&&e.url,i=e.title?e.title:"",o=e.subtitle?e.subtitle:"",a=e.verified?e.verified:"",s=e.mix?e.mix:"",l=e.online?e.online:"",u=!!e.actions&&e.actions;return{attrs:!!e.attrs&&e.attrs,class:[r.default.class("OwnerRow",{actions:!!u}),s],inner:[{class:"OwnerRow__content",href:n,inner:[{class:"OwnerRow__left",inner:{style:t?"background-image: url('"+t+"')":null,class:"OwnerRow__img",inner:l?{class:r.default.class("OwnerRow__online",l)}:null}},{class:"OwnerRow__right",inner:[{class:r.default.class("OwnerRow__header",{verified:a}),inner:[{class:"OwnerRow__title",inner:i},a?{class:"OwnerRow__verified"}:null]},{class:"OwnerRow__subtitle",inner:o}]}]},u?{class:"OwnerRow__actions",inner:u}:null]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.post=function(e,t,n){t&&(t.im_v=o);return new Promise(function(o,r){i.post(e,t,{timeout:n,onDone:function(){o.apply(null,[[].concat(Array.prototype.slice.call(arguments))])},onFail:function(){return r.apply(null,arguments),!0}})})},t.plainget=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r(e,t,n).request},t.plaingetCancelable=r;var i=window.ajax,o=2;function r(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=void 0;return o=window.XDomainRequest?new XDomainRequest:i._getreq(),{request:new Promise(function(i,r){var a=void 0,s=Date.now(),l=n.timeout||60,u=ajx2q(t);if(window.XDomainRequest)o.open("get",e+"?"+u),o.ontimeout=function(e){r([e,{}])},o.onerror=function(e){r([e,{}])},o.onload=function(){i([o.responseText,{}])},setTimeout(function(){o.send()},0);else{o.onreadystatechange=function(){4==o.readyState&&(clearInterval(a),o.status>=200&&o.status<300?i([o.responseText,o]):r([o.responseText,o]))};try{o.open("GET",e+"?"+u,!0)}catch(e){return r([e,o])}o.send()}a=setInterval(function(){Date.now()-s>1e3*l&&(r(["",{}]),clearInterval(a))},1e3)}),cancel:function(){o.abort()}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={}},function(e,t,n){"use strict";n(110);var i=n(1);n(210),n(72),n(326);var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(337));n(50);var r,a=n(215);(r=a)&&r.__esModule;n(178),n(117),n(181),n(145),n(294),n(308),n(346),n(82),n(176),n(122),n(222),n(30),n(350),n(246),n(241),n(13),n(66),n(111),n(123),n(208),n(25),n(270),n(148),n(186),n(24),n(334),n(23),n(297),n(265),n(233),n(116),n(234),n(131),n(282),n(164),n(355),n(293),n(268),n(34),n(347),n(309),n(83),n(160),n(209),n(19),n(44),n(5),n(126),n(319),n(283),n(52),n(129),n(121),n(261),n(258),n(262),n(311),n(112),n(128),n(54),n(312),n(132),n(199),n(109),n(45),n(140),n(93),n(48),n(295),n(310),n(37),n(305),n(89),n(318),n(179),n(46),n(320),n(292),n(80),n(87),n(64),n(107),n(273),n(192),n(125),n(276),n(316),n(221),n(204),n(298),n(249),n(187),n(101),n(275),n(218),n(333),n(4),n(338),n(8),n(32),n(3),n(242),n(130),n(196),n(60),n(259),n(147),n(67),n(108),n(158),n(57),n(58),n(173),n(252),n(38),n(174),n(35),n(150),n(228),n(279),n(170),n(198),n(119),n(325),n(194),n(232),n(296),n(323),n(99),n(94),o.init();var s=window,l=s.onDOMReady,u=s.clog;(0,i.addEvent)(window,"scroll touchmove",function(){(0,i.onBodyScroll)(!0)}),(0,i.addEvent)(window,"error",function(e){u(e.lineno+": "+e.message)}),window.cur={destroy:[]},window.lang={};var c=window,d=c.thover,f=c.ajax;function p(){if((0,i.lsGet)("custom_opts"))return(0,i.addClass)("_copts","vk_wrap");var e=(0,i.ce)("div",{innerHTML:'<input id="copts_test_radio" type="radio" checked="checked"><div id="copts_test_label"></div>'});(0,i.append)(e,"vk_utils");var t=(0,i.ge)("copts_test_label");t&&Math.abs(t.offsetWidth-5)<1&&((0,i.addClass)("_copts","vk_wrap"),(0,i.lsSet)("custom_opts",1)),(0,i.remove)(e)}(0,i.addEvent)(document,"touchmove touchcancel",d.cancel),(0,i.addEvent)(document,"touchend",d.end);var _=window.page;f._init(),f.enabled=!!f._req,f.enabled&&(l(function(){(0,i.remove)("app_go_frame"),f.prepare_nav(),f.prepare_click(),h&&h.init(),v&&v.initAudio(),(0,i.addClass)("_js","vk_wrap")}),_.clear()),l(i.resizePosters),(0,i.addEvent)(window,"resize",i.resizePosters),(0,i.addEvent)(document,"touchstart",function(e){var t=(0,i.checkTouchHover)(e.target);d.clear(),t&&d.start.call(t,e)}),(0,i.addEvent)(document,"click",function(e){var t=window.al;if(window.al&&t.ver){var n=(0,i.gpeByClass)("al_after",e.target);if(n){var o=(0,i.attr)(n,"data-target"),r=!!o&&(0,i.geByClass1)(o,n);if(r&&!m.go_after(r,e)||!m.go_after(n,e))return}var a=(0,i.checkNav)(e.target,{allow_post_away:!0});a&&(m.go(a,e)||(0,i.cancelEvent)(e))}}),(0,i.addEvent)(document,"submit",function(e){var t=e.target;(0,i.hasClass)("vk_js_yes",geByTag1("html"))&&!(0,i.hasClass)("opera_mini_yes",geByTag1("body"))&&(0,i.hasClass)("qsearch",t)&&(0,i.gpeByClass)("audioPage",t)&&(geBySel1('[type="submit"]',t).click(),(0,i.cancelEvent)(e))}),(0,i.addEvent)(document,a.isTouch?"touchstart":"mousedown",function(e){g.closeByTap(e)}),l(p),(0,i.sgFix)();var A=window,m=A.nav,h=A.menu,v=A.audioplayer,g=A.tooltip,y=A.zlayer;l(function(){var e=window.vk;e&&!e.id&&(0,i.lsCheck)()&&localStorage.clear()}),window.optionsTest=p,y.isReady=!0;try{n(301)}catch(e){console.error("Catched error: ",e)}window.isNewMail&&(n(16),n(313),n(356),n(235),n(113),n(212),n(175),n(184),n(9),n(163),n(352),n(201),n(106),n(271),n(33),n(73))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(326),r=(i=o)&&i.__esModule?i:{default:i};var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=window.lang;this.store=Stories.getStore(),this.viewers=this.store.viewers[t]||[],this.viewersState=this.store.viewersState[t],this.replies=this.store.replies[t]||[];var i=this.viewersState,o=i.count,r=i.repliesCountText,a=i.authorCountText;this.raw_id=t,this.count=o,this.countText=langNumeric(this.count,n.mobile_stories_views_title),this.repliesCountText=r,this.repliesAuthorCountText=a,this.viewers.length&&this.replies.length?this.title=n.mobile_stories_views_title_replies_and_views:this.viewers.length?this.title=this.countText:this.replies.length&&(this.title=n.mobile_stories_views_title_replies)}return e.prototype.render=function(){var e=this,t=window.winToUtf;return r.default.html({class:Bem.class("Views",{short:!(this.viewers.length||!this.replies.length)}),inner:[{class:"Views__overlay",onclick:"Stories.hideViews();"},{class:"Views__header",inner:[{class:"Views__table",inner:[{class:"Views__cell",inner:{class:"Views__title",inner:this.title}}]},{class:"Views__close",onclick:"Stories.hideViews();"}]},{class:"Views__body ScrollView",onscroll:'Stories.onScrollViews(this, "'+this.raw_id+'")',ontouchmove:"event.stopPropagation();",inner:[this.replies.length?{class:"Views__replies",inner:[{class:"Views__table Views__repliesHeader",inner:[{class:"Views__cell Views__repliesCount",inner:this.repliesCountText},this.repliesAuthorCountText?{class:"Views__cell Views__repliesAuthorCount",inner:this.repliesAuthorCountText}:null]},{class:"Views__repliesBody",onscroll:'Stories.onRepliesScroll(event, "'+this.raw_id+'")',inner:{class:"Views__repliesScroll",inner:this.replies.map(function(n){return{class:"Views__reply "+(n.has_new?"Views__reply_new":""),onclick:'Stories.openReplies("'+n.owner_id+"/"+n.list+'", "'+e.raw_id+'");',inner:[{class:"Views__replyAvatarWrap",inner:{class:"Views__replyAvatar",src:n.avatar,tag:"img"}},{class:"Views__replyName",inner:n.name?t(n.name):lang.mobile_stories_reply_you}]}})}}]}:null,{class:"Views__viewers",inner:[this.viewers.length&&this.replies.length?{class:"Views__viewersHeader",inner:this.countText}:null,{class:"Views__viewersBody",inner:this.viewers.map(function(e){return{class:"Views__viewer",href:e.href,inner:{class:"Views__table",inner:[{class:"Views__cell Views__cell_avatar",inner:{class:"Views__avatar",src:e.photo,tag:"img"}},{class:"Views__cell Views__cell_name",inner:{class:"Views__name",inner:e.name}}]}}})}]},this.viewersState.nextFrom?{class:"Views__viewersLoader",onclick:'Stories.loadViews("'+this.raw_id+'")'}:null]}]})},e}();t.default=a},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(322),o=s(n(72)),r=s(n(215)),a=(s(n(297)),n(337));function s(e){return e&&e.__esModule?e:{default:e}}var l=window,u=l.se,c=l.ce,d=l.attr,f=l.append,p=l.ge,_=l.each,A=l.addEvent,m=l.removeEvent,h=l.remove,v=l.unlockButton,g=l.setDocumentDomain,y=l.lockButton,w=l.checkNav,b=l.cancelEvent,D=l.checkEvent,C=l.getHref,E=l.extend,S=l.stopEvent,k=l.tag,M=l.gpeByTag,T=l.obj2qs,x=l.scrollToHash,I=l.addClass,P=l.hasClass,B=l.qs2obj,F=l.copy,L=l.isVkWebView,O=l.onDOMReady,N=l.statlogsValueEvent,R=window.ajax,j=function(){var e=!(!window.history||!history.pushState),t=null,n=u(function(){return t}),s=[],l=7,O=!1,H=30;function V(e){var t;if(t=/^(https?:)\/\/([^:\/]+)?(?::(\d+))?\/?(.*)$/i.exec(e)){if(t[1]!=location.protocol)return!1;if(t[2]&&t[2]!=location.hostname)return!1;if(t[3]&&t[3]!=location.port)return!1;e=t[4]}return e}function $(e,t,n){return!!D(t)||(!(!n||!n.push_only)||(n&&n.replace?location.replace(e):e&&(location.href=C(e)),!0))}function U(e,t,n){var i=window.al;b(t);var o=C(e);if(window.al&&i.ver){if(n&&n.push_only)return!0;if(R.nav(o,n))return document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),!0}$(o,t,n)}function z(t,n,i){var o,r;if(t&&t.href&&t.getAttribute&&t.getAttribute("data-change-location-with-post-away")){r=t.href;var a={};return(o=Q(t)).post_id&&(a.post=o.post_id,o.ad_data&&(a.post_ad_data=o.ad_data),o.post_click_cc_key&&(a.cc_key=o.post_click_cc_key),r="/away.php?to="+encodeURIComponent(r)+"&"+T(a).substr(1)),$(r,n,i),!1}if(j.onBeforeGo(t,n,i))return!1;if(i=E({no_push:!1,push_only:!1,replace:!1},i),D(n))return!S(n);if(!t)return!0;e&&(i.no_push||i.need_restore)&&(O=!1);var s=t,l="",u="",w="";function C(e){return"a"===k(e)?e:M("a",e)}!t.href&&t.getAttribute&&(s=t.getAttribute("data-href"));var L=n&&C(n.target)||t&&t.tagName&&C(t);if(("input"==k(t)||"button"==k(t))&&("submit"==t.type||"image"==t.type)&&t.form){if(t.disabled)return!0;var N=t.form,R={},H=N.action||"",z=!1;if(_(N,function(e,n){return!(n.name&&!n.disabled)||("radio"===n.type&&!n.checked||("checkbox"===n.type&&!n.checked||("button"===n.type||("submit"===n.type&&n!==t||("image"===n.type&&n!==t||("file"===n.type?(z=!0,!1):void(R[n.name]=n.value)))))))}),"image"==t.type&&(R[t.name]=t.value,R[t.name+".x"]=1,R[t.name+".y"]=1),z||"multipart/form-data"==d(N,"enctype"))return function(e){var t=c("iframe");d(t,"id","upload_iframe"),d(t,"name","upload_iframe"),d(t,"width","0"),d(t,"height","0"),d(t,"border","0"),d(t,"style","width:0;height:0;border:none;position:absolute;left:-1000px;"),f(t,e.parentNode),window.frames.upload_iframe.name="upload_iframe",t=p("upload_iframe");var n=!1;return _(e,function(e,t){if("submit"===t.type)return n=t,!1}),A(t,"load",function e(){m(t,"load",e),setTimeout(function(){h(t),v(n)},2e3)}),g(),d(e,"target","upload_iframe"),d(e,"method","post"),d(e,"enctype","multipart/form-data"),d(e,"encoding","multipart/form-data"),f(c("input",{type:"hidden",id:"__extra",name:"__extra",value:1}),e),e.submit(),y(n),setTimeout(function(){h("__extra")},0),!1}(N);if(!(s=V(H)))return!0;N.method&&"get"!=N.method?i.params=R:s=s.split("?",1).shift()+T(R)}if("string"!=typeof s){if(!s)return!0;"/"!==(l=s.pathname).substr(0,1)&&(l="/"+l),u=s.search.substr(1),w=s.hash,s=l+s.search+w}else{var W=s.split("#"),G=W.shift();w=W.length?"#"+W.join("#"):"",l=(G=G.split("?")).shift(),u=G.join("?"),!w&&!u||l||(l=j.path,G||(u=j.params),s=l+(u?"?"+u:"")+w)}var X=B(u);function K(e,t,n){var i=n&&X[t];return!(!e||i)&&(X[t]=e,!0)}if(K((o=Q(L,!!X._post_click_type)).post_id,"_post",!0),K(o.post_click_type,"_post_click_type",!0),X._post_click_type&&(K(o.post_click_mention_id,"_post_click_mention_id",!0),K(o.post_click_cc_key,"_post_click_cc_key",!0),K(o.post_click_url,"_post_click_url",!0),K(o.ad_data,"_post_ad_data",!0)&&K(o.ad_block_unique_id,"_post_ad_block_unique_id")),window.isNewMail&&j.onBeforeGo4(l,X))return!1;if(0!==location.pathname.indexOf("/app")&&0===l.indexOf("/app")&&X&&X.act&&"app_r"===X.act)return!!n||($(t,n,i),!1);if(u=T(X).substr(1),n&&s.split("#").shift()==j.cur.split("#").shift()&&w&&!i.force&&(x(w),i.push_only=!0),i.no_push&&j.cur==s&&!i.force)return!1;if(i.push_only)return Y(E(i,{nav:{push:s,path:l,params:u,hash:w}})),!1;if(I("active",i.link||t),P("al_back_history",t)&&j.tryBack())return!1;if(P("al_back",t)){var J=X.act;window.isNewMail&&"/mail"===location.pathname&&!J||"show"===J&&!geByClass1("messenger")?i.need_restore=!1:i.need_restore=!0}var Z=function(e){var t=window.cur,n=window.menu,i=B(e.nav.params),o=B(j.params);if((o.z||i.z)&&o.z!=i.z){if(j.path==e.nav.path){var r=F(i),a=F(o);if(delete r.z,delete a.z,r=T(r),a=T(a),r==a)return q(i.z,!1,e),Y(e),n.close(null,!0),!1}e.zProcess=function(t,n){q(i.z,t,E({},e,{no_push:!0}),n)}}if(e.onPreNav=function(){e.zProcess&&(e.zProcess(),delete e.zProcess)},!e.ignore_cur_process&&t.processNav&&t.processNav(e))return Y(e),n.close(null,!0),!1;return U(e.nav.push,null,e),!1}(E(i,t.tagName?{target:t}:{},{nav:{push:s,path:l,params:u,hash:w}}));return Z||b(n),Z}function q(e,t,n,i){var o,r=window.photo,a=window.zlayer;if(e){if(o=/^photo(-?\d+_\d+)(?:\/([a-z0-9_-]+(\/rev)?)?)?$/i.exec(e)){if(!0===i)return!1;var s=o[1]||"",l=o[2]||"";return r.zopen(!1,null,s,l,{no_push:(n||{}).no_push}),a&&!1!==t&&void 0!==t&&(a._st=t),!0}if(o=/^story(-?\d+_\d+)(\/?([a-z0-9_-]+))?$/i.exec(e)){var u=window.Stories;if(!0===i)return!1;var c=o[1]+(o[2]?o[2]:"");return u.close({isPopState:!0,storyRaw:c}),!0}if(o=/^\/?narrative(-?\d+)_(\d+)(\/?([a-z0-9_-]+))?$/i.exec(e)){var d=window.Stories;return!0!==i&&(d.init(o[1]+"/narrative"+o[1]+"_"+o[2],{source:"narrative_link"}),!0)}if(o=/^\/?doc(-?\d+)_(\d+)(\/?([a-z0-9_-]+))?$/i.exec(e))return!0!==i&&(r.zopen(null,null,o[1]+"_"+o[2],"",{no_push:(n||{}).no_push,isDoc:!0,hash:o[4]}),a&&!1!==t&&void 0!==t&&(a._st=t),!0)}return!1!==i&&(a&&a.close(),Stories&&Stories.close({isPopState:!0,closeAll:!0}),!0)}function W(n,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(e)n="/"==n.substr(0,1)?n:"/"+n,window.isNewMail?i.replace?history.replaceState(o,null,n):history.pushState(o,null,n):i.replace?history.replaceState(null,null,n):history.pushState(null,null,n);else{var r="/"==n.substr(0,1)?n:"/"+n,a="#"+r,s=location.pathname+location.search+a;p("base").href=r,i.replace?location.replace(s):(t=a,location.href=s)}}function Y(t){if(!t.no_push&&j.cur!=t.nav.push){if((0,a.isOfflineCapable)()&&!1===navigator.onLine)return $(t.nav.push,null,t);try{window.isNewMail?W(t.nav.push,t,t.historyState):W(t.nav.push,t),e&&!t.no_push&&(t.nav_init||t.nav_incr)?(t.nav_init&&(O=0),t.nav_incr&&!1!==O&&O++,O>H&&(O=!1)):O=!1}catch(e){return $(t.nav.push,null,t)}}j.cur=t.nav.push,j.path=t.nav.path,j.params=t.nav.params,j.hash=t.nav.hash,0!==j.path.indexOf("/")&&(j.path="/"+j.path)}if(e)A(window,"popstate",function(e){if(window.isNewMail&&j.onPopState())return preventEvent(e),void S(e);z(location,null,{no_push:!0,need_restore:!0})});else{var G=location.hash||"";"#/"==G.substr(0,2)&&$(G.substr(1),null,{replace:!0});var X=function(e){(e=(e||"").substr(1))&&"/"==e.substr(0,1)||(e=location),z(e,null,{no_push:!0,need_restore:!0})};"onhashchange"in window?A(window,"hashchange",function(){X(location.hash||"")}):(!function e(){var i=location.hash||"";t!==i&&(t=i,n(!0)),setTimeout(e,100)}(),n(function(e){X(e)}))}function Q(e,t){var n={};if(!!(!e||!e.getAttribute))return n;var i=e.getAttribute("data-post-id");i&&(n.post_id=i);var o=e.getAttribute("data-post-click-type");o&&(n.post_click_type=o);var r=e.getAttribute("mention_id");r&&(n.post_click_mention_id=r);var a=e.getAttribute("data-post-click-cc-key");a&&(n.post_click_cc_key=a);var s=[e.getAttribute("href"),e.getAttribute("data-href")];if(_(s,function(e,t){if(t&&"#"!==t)return n.post_click_url=t,!1}),!!o||t){var l=gpeByClass("_ads_block_data_w",e),u=(l=l||gpeByClass("_ads_promoted_post_data_w",e))&&l.getAttribute("data-ad"),c=l&&l.getAttribute("data-ad-block-uid");u&&(n.ad_data=u),c&&(n.ad_block_unique_id=c)}return n}var K=(location.pathname||"").replace(/^\/+/,"/"),J=location.search||"",Z=location.hash||"";return{onBeforeGo:(0,o.default)(),onBeforeGo2:(0,o.default)("path","queryObject","fullUrl","opts"),onBeforeGo4:(0,o.default)("path","queryObject"),onPopState:(0,o.default)(),go:z,al_go:U,app_go:function(e,t,n){if(!n)return!0;if(D(t))return!0;h("app_go_frame");var i=C(e),o=c("iframe",{id:"app_go_frame",src:n,onload:function(){h("app_go_frame"),i&&j.hard_go(i)}},{display:"none"});return window.bodyNode.appendChild(o),!1},hard_go:$,go_after:function(e,t){var n=window.al;return!window.al||!n.ver||!!w(t.target,{skip_onclick:!0,skip_clicable:!0})||!1!==e&&(j.go(e,t)||b(t),!1)},page_set:function(e,t,n){for(var i=s.length-1;i>=0;--i)if(s[i].h==e||s[i].a==e)return void(s[i]={h:e,d:t,a:n});s.push({h:e,d:t,a:n}),s.length>l&&s.shift()},page_get:function(e){for(var t=s.length-1;t>=0;--t)if(s[t].h==e||s[t].a==e)return(s=s.slice(0,t+1))[t].d;return!1},set:Y,checkUrl:V,tryHistoryBack:function(){var e=O;return e&&history.go(-e),O=!1,!!e},zInit:function(){var e=B(j.params);e.z&&q(e.z)},getPostParams:Q,cur:K+J+Z,path:K,params:J.substr(1),hash:Z,clear:function(){return s=[]},getQuery:function(e){var t=B(j.params);return e?t[e]||null:t},getNotifierScrollTop:function(){var e=s.find(function(e){return"/settings?act=notifier"===e.h});return e?e.d.st:null},reload:function(){return j.go(j.cur)},tryBack:function(){var e=s.slice(-2)[0];return!!e&&(j.go(e.h,null,{need_restore:!0}),!0)},openInNativeApp:function(e,t,n){var i=this;if(this._openAppInProgress)return!1;b(t);var o={android:"https://vk.cc/android",iphone:"https://vk.cc/iphone"},a="vk://vk.com"+j.cur,s=r.default.mi?1500:300;r.default.safari&&(s=r.default.ios>10?0:1100);var l=Date.now(),u=setTimeout(function(){i._openAppInProgress=!1,Date.now()-l>s+200||!document.hasFocus()||(n&&n.href?j.hard_go(n.href):j.hard_go(o[e]))},s);if(A(window,"blur",function e(){clearTimeout(u),i._openAppInProgress=!1,m(window,"blur",e)}),r.default.ios){A(window,"focus",function e(){window.menu&&window.menu.close(),m(window,"focus",e)})}else window.menu&&window.menu.close();return this._openAppInProgress=!0,j.hard_go(a),N("mvk_open_in_native_link",1,e),!1},initOpenInNativeAppBtn:function(){if(!L()){var e=geByClass1("mmi_open_in_app");e&&I("supported",e)}},getPageJs:function(){var e=(0,i.$)("#page_script");return e?e.innerText:s.length&&s[s.length-1].d.js||""},onMenuItemClick:function(e){if("/wall"===j.cur.substr(0,5)&&"add"===j.getQuery("act")){var t=(0,i.$)("#feed_add_form"),n=B(t.action.split("?")[1]);post.saveDraft(null,n.hash)}N("mvk_navigation_pages","click","left_menu",e,getW("vk_wrap")>=882?"full_version":"mobile")}}}();O(function(){j.initOpenInNativeAppBtn()}),window.nav=j,t.default=j},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(357),r=(i=o)&&i.__esModule?i:{default:i};n(217),t.default=r.default,window.Popup=r.default},,function(e,t,n){"use strict";"function"!=typeof Object.assign&&(Object.assign=function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),i=1;i<arguments.length;i++){var o=arguments[i];if(null!=o)for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(n[r]=o[r])}return n})},function(e,t,n){"use strict";n(322);var i=n(215),o=window,r=o.each,a=o.geByClass,s=o.attr,l=o.replaceClass,u=o.ge,c=o.val,d=o.addClass,f=o.toggleClass,p=o.removeClass,_=o.ce,A=o.se,m=o.addEvent,h=o.removeEvent,v=o.extend,g=(o.qs2obj,o.vkNow),y=o.geByClass1,w=o.setStyle,b=o.remove,D=o.intval,C=o.isArray,E=o.hasClass,S=o.after,k=o.cdf,M=o.stripTags,T=o.getHref,x=o.indexOf,I=o.htsc,P=o.replaceEntities,B=o.escapeAttr,F=o.replace,L=o.scrollTop,O=o.before,N=o.alLoadingFix,R=window.ajax,j=window.mediaUpload,H=window.nav,V=window,$=V.Dialog,U=V.Dialogs,z=function(){var e={},t={},n=null,o=!1,x={},I={},P={},V=null;function G(){if(n){var t=[],i=!1;if(r(a("_unread"),function(){var e=+s(this,"data-id");e&&t.push(e),i=z.getPeerByMsg(e),l("_unread","_read",this)}),i){var o=u("messages"+i);o&&e[i]&&(e[i].messages=c(o))}t.length&&z.sendMarkAsRead(n,t)}}function X(e,t){t?(d("lvi",e),f("mlvi",e,!!i.mobPlatforms[t])):(p("lvi",e),p("mlvi",e))}function Q(e){(0,e.updater)(document.body),r(e.caches,function(t,n){var i=n.storage,o=n.getter,r=function(e,t){var n,i=t.split("."),o=i.length,r=e;for(n=0;n<o;n++)if(!(r=r[i[n]]))return null;return r}(i,o);if(r){var a="string"==typeof r;a&&(r=_("div",{innerHTML:r})),e.updater(r),function(e,t,n){var i,o,r=t.split("."),a=r.length-1,s=e;for(o=0;o<a;o++)s=s[i=r[o]]||(s[i]={});s[r[a]]=n}(i,o,a?r.innerHTML:r)}})}return H.onBeforeGo(function(e,t,n){if(H.getQuery("community")&&(!n||!n.ignore_cur_process)&&"/mail"===("string"==typeof e?e:s(e,"href")||s(e,"data-href")))return H.go(e,t,{ignore_cur_process:!0}),!0}),H.onBeforeGo(function(){if(H.getQuery("community"))var e=R.post("/",{_ajax:1,act:"ping"},{onDone:function(){try{var t=JSON.parse(e.response),n=t&&t[1]&&t[1][2];z.actualizeMessagesCornerCounter(n)}catch(e){}}})}),{wrapLinks:Y,wrapMention:W,onShowDialogFromCache:A(),onShowWritePageFromCache:A(),onShowDialogsPageFromCache:A(),onMessagesRepainted:A(),init:function(t,r){var a=window.im;window.cur.destroy.push(function(){AudioMessagePlayer.detachPlayer()}),r&&(cur.ref=r.ref,cur.refSource=r.ref_source),t&&(n=t,r&&(z.saveDialog(r,t),e[t])),o||(o=!0,m(document,i.isTouch?"touchstart":"mousedown",G)),setTimeout(function(){a.on()})},unpinMessage:function(t){Q({caches:[{storage:e,getter:t+".write_form"}],updater:function(e){e.$$(".cm_unpin").forEach(hide),e.$$(".head_actions_wrap").forEach(function(e){return e.classList.remove("head_actions_has_pinned")}),e.$$(".pinnedMsg_peer_"+t).forEach(function(e){return e.classList.add("pinnedMsg_hidden")})}})},pinMessage:function(t,n){Q({caches:[{storage:e,getter:t+".write_form"}],updater:function(e){e.$$(".cm_unpin").forEach(show),e.$$(".head_actions_wrap").forEach(function(e){return e.classList.add("head_actions_has_pinned")}),$$(".pinnedMsg_peer_"+t).forEach(function(e){return e.outerHTML=n})}})},clear:function(){H.clear();var r=window.im;e={},t={},x={},n=null,h(document,i.isTouch?"touchstart":"mousedown",G),o=!1,r.off()},send:function(e,t){if(j&&!j.checkUploading())return!1;var n=R.click(e,v({clear:!0,save:!0},$),{lock:!0,url_params:{ref_source:cur.refSource,ref:cur.ref}});return cur.ref=void 0,cur.refSource=void 0,n},save:function(t){r(t,function(t,n){e[t]&&n.last_msg==e[t].last_msg&&delete n.messages,z.saveDialog(n,t)})},saveDialog:function(t,n){e[n]||(e[n]={});var i=e[n];v(i,t),i.msgs&&r(i.msgs,function(e,t){x[t]=n})},getPeerByMsg:function(e){return x[e]||!1},cacheDialogsPage:function(){H.getQuery("community")&&H.getQuery("tab")||(t.page=c("m"),H.getQuery().act?t.link=q("/mail"):t.link=H.cur)},keyup:function(e,t,n){var i=V||"",o=e.value||"";i.length==o.length&&i==o||(z.myTyping(t,n),V=o)},myTyping:function(e,t){if(!(e<=-2e9)){var n=g();P[e]&&n-P[e]<5e3||(P[e]=n,R.post("/mail",{_ajax:1,act:"typing",peer:e,hash:t,community:H.getQuery("community")}))}},typing:function(e,t){t=t||e;e>2e9?(I[e]||(I[e]={}),I[e][t]=g()):I[e]=g(),z.updateTyping(e)},updateTyping:function(e){var t=function(e,t){return e.getAttribute&&e.getAttribute(t)},n=window.lang,i=u("dialog_near"+e),o=y("di_current_peer",i),a=y("di_typing",i);if(i){var s=[],l=g();if(e>2e9)r(I[e]||{},function(e,n){t(a,"data-u"+e)&&n&&l-n<6e3&&s.push(e)});else{var f=I[e];t(a,"data-u"+e)&&f&&l-f<6e3&&s.push(e)}if(s.length){if(1==s.length){var _=s[0],A=t(a,"data-u"+_),m=t(a,"data-s"+_);c(a,'<i class="i_typing"></i>'+(n.mobile_mail_typing[m]||"").replace("{user}",A))}else{r(s,function(e,n){s[e]=t(a,"data-u"+n)});var h=s.pop();c(a,'<i class="i_typing"></i>'+(n.mobile_mail_multi_typing||"").replace("{users}",s.join(", ")).replace("{last_user}",h))}o.offsetWidth&&w(a,"minWidth",o.offsetWidth),d("di_typing_now",i),setTimeout(function(){d("di_typing_animated",i)},10),setTimeout(function(){z.updateTyping(e)},2e3)}else c(a,""),w(a,"minWidth",0),p("di_typing_animated",i),p("di_typing_now",i)}},updateOnline:function(t,n){var i=u("messages"+t);if(i&&b(y("di_activity",i)),r(a("_lv"+t,"mcont"),function(e,t){X(t,n)}),e[t]){if(e[t].write_form){var o=_("div",{innerHTML:e[t].write_form});r(a("_lv"+t,o),function(e,t){X(t,n)}),e[t].write_form=c(o)}if(e[t].messages){o=_("div",{innerHTML:e[t].messages});b(y("di_activity",o)),e[t].messages=c(o)}}},updateImportantMessages:function(n,i,o){Q({caches:[{storage:t,getter:"page"},{storage:H.page_get(q("/mail")),getter:"html"}],updater:function(e){var t=y("dialogs_filter_button_important",e);if(t){var n=D(c(t))+o;c(t,n),f("dialogs_filter_without_important",y("dialogs_filter",e),0===n)}}}),Q({caches:[{storage:e,getter:n+".messages"}],updater:function(e){var t=y("_msg"+i,e);t&&f("msg_item_important",t,1===o)}})},updateImportantDialog:function(e,n){H.getQuery("community")&&Q({caches:[{storage:t,getter:"page"},{storage:H.page_get(q("/mail")),getter:"html"}],updater:function(t){var i=y("_peer"+e,t);i&&f("dialog_item_important",i,n)}})},sendMarkAsRead:function(t,n){C(n)||(n=[n]);var i=e[t];i&&i.hash&&R.post("/mail",{_ajax:1,act:"mark_read",peer:t,msgs:n.join(","),hash:i.hash,community:H.getQuery("community")},{onDone:function(e){e&&r(n,function(e,n){z.markAsRead(t,n)})}})},markAsRead:function(t,n){window.im;var i=u("messages"+t);if(i){var o=y("_msg"+n,i);E("_read",o)||p("mi_unread",o);var r=e[t];if(r&&r.messages){var a=_("div",{innerHTML:r.messages});o=y("_msg"+n,a);E("_read",o)||p("mi_unread",o),r.messages=c(a)}}},markPeerAsRead:function(n,i,o){var l=u("messages"+n);if(l&&(r(a("msg_item",l),function(){if(!o==!E("_unread",this))return!0;+s(this,"data-id")<=i&&!E("_read",this)&&p("mi_unread",this)}),(m=e[n])&&m.messages)){var d=_("div",{innerHTML:m.messages});r(a("msg_item",d),function(){if(!o==!E("_unread",this))return!0;+s(this,"data-id")<=i&&!E("_read",this)&&p("mi_unread",this)}),m.messages=c(d)}var f=u("dialogs"),A=o?"di_unread_outbox":"di_unread_inbox";if(f)(m=y("_peer"+n,f))&&E(A,m)&&(p(A,m),b(y("di_unread_cnt",m)));else if(t.page){var m;d=_("div",{innerHTML:t.page});(m=y("_peer"+n,d))&&E(A,m)&&(p(A,m),b(y("di_unread_cnt",m))),t.page=c(d)}Q({caches:[{storage:H.page_get(q("/mail")),getter:"html"}],updater:function(e){var t=y("_peer"+n,e);t&&E(A,t)&&(p(A,t),b(y("di_unread_cnt",t)))}})},markAsDeleted:function(t,n){var i=u("messages"+t);if(i){b(y("_msg"+n,i));var o=e[t];if(o&&o.messages){var r=_("div",{innerHTML:o.messages});b(y("_msg"+n,r)),o.messages=c(r)}}R.click(q(H.path),v({no_scroll:!0},U))},addMessage:function(t,n,i,o){if(H.clear(),t<2e9?delete I[t]:I[t]&&delete I[t][i],z.updateTyping(t),!0!==o){if(t&&n&&(x[n]=t),!y("_msg"+n)){var r=e[t];if(r&&r.messages){r.msgs&&r.msgs.push(n);var a=_("div",{innerHTML:r.messages});(l=y("di_activity",a))?(S(k(o),l),r.messages=c(a)):r.messages=o+r.messages,(s=u("messages"+t))&&(c(s,r.messages),z.onMessagesRepainted(!0))}else{var s,l;if(s=u("messages"+t))(l=y("di_activity",s))?S(k(o),l):c(s,o+c(s))}}}else if(u("dialogs")&&"/mail"==H.path){var d=H.getQuery();d.act||d.offset||d.q||R.click(q(H.path),v({no_scroll:!0},U))}},replaceMessage:function(t,n,i,o){var r=u("messages"+t),a=e[t];if(a&&a.messages){var s=_("div",{innerHTML:a.messages}),l=y("_msg"+n,s);l&&(l.outerHTML=o),a.messages=c(s),c(r,a.messages)}else y("_msg"+n).outerHTML=o},getMsgHTML:function(t,n,i,o,r,a,l,d){var f=window,p=f.vk,_=f.lang,A=2&n?p.id:l&&l.from||i;if(!A)return!1;if(!u("messages"+i))return!0;if(l.attach1||l.fwd||l.geo||l.emoji)return!1;if(l.source_act)return!1;if(!e[i]||!e[i].hash)return!1;var m="_u"+A,h=y(m,"mcont","a"),v=M(s(h,"data-name")||c(h)||""),g=T(h),w=y(m,"mcont","img"),b=w&&w.src||"";if(!v||!g||!b)return!1;i=D(i),t=D(t),r=r&&-1==r.toString().indexOf(" ... ")&&i<2e9?r:"";var C,E,S,k=1&n?" mi_unread":"";return!(2&n)&&1&n&&(k+=k?" _unread":""),a=z.wrapLinks(a,n),a=z.wrapMention(a),('<a name="msg{{msgId}}"></a><div  class="msg_item _msg{{msgId}}{{msgClass}}"  data-id="{{msgId}}"  onclick="return MessagesActions.onMessageClick(event);">  <div class="mi_iwrap">    <a class="al{{cl}}" href="{{href}}">      <img src="{{photo}}" class="mi_img {{cl}}" />    </a>  </div>  <div class="mi_cont">    <div class="mi_head">      <a class="mi_date" href="'+q("/mail?act=msg&id={{msgId}}").replace(/\&/g,"&amp;")+'">        {{time}}      </a>      {{edited}}\n      <a class="mi_author al{{cl}} {{cl}}" href="{{href}}" data-name="{{dataName}}">        {{name}}      </a>    </div>    <div class="mi_body">      {{mi_title}}      <div class="mi_text">{{text}}</div>    </div>  </div></div>').replace(/{{msgId}}/g,t).replace(/{{cl}}/g,m).replace(/{{href}}/g,g).replace("{{msgClass}}",k).replace("{{edited}}",d?'<span class="mi_edited">'+_.mobile_mail_edited+"</span>":"").replace("{{photo}}",b).replace("{{time}}",(C=new Date(1e3*o),E=C.getHours(),S=C.getMinutes(),E+":"+(S<10?"0":"")+S)).replace("{{dataName}}",B(v)).replace("{{name}}",v.split(" ").shift()).replace("{{mi_title}}",r?'<div class="mi_title">'+r+"</div>":"").split("{{text}}").join(a)},updateStickers:function(){var t=window.cur,i=window.post,o=e[n];if(o){var r=o.write_form?(t.sticker_panel||"").split("mail-0").join("mail"+n):"",a=u("stickers_panel");a&&(F(k(r),a),a=null,i.stickersInit())}},showDialog:function(i,o,r){var a=window.cur,l=window,u=l.MessagesActions,d=l.Mention,f=window.post;if(u.hasFwdMessages())return u.attachFwdMessages(o),!1;t.scroll_top=L();var A=e[o];if(A){var m=_("div",{innerHTML:c("m")}),h=y("mhb_back",m);if(h&&A.header){var g=_("div");c(g,A.header),O(g.firstElementChild,h),b(h)}var w=A.write_form?(a.sticker_panel||"").split("mail-0").join("mail"+o):"";c(y("pcont",y("mcont",m)),A.write_form+w+(o?'<div id="messages'+o+'" class="messages bl_cont">'+(A.messages||"")+'<div id="al_loading"></div></div>':"")),c("m",m.innerHTML),f.stickersInit(),R.refreshLinks(A.fv_link,A.app_link),N(),n=o,A;var D=T(i);H.go(D,null,{push_only:!0,no_push:r}),o?(V=null,z.updateTyping(o),R.click(D,v({save:o},$),{scroll:!0})):z.onShowWritePageFromCache(!0),z.onShowDialogFromCache(!0),L(0,10)}else H.al_go(A&&A.cur_link||T(i)||H.cur);H.getQuery("community")&&"unread"===H.getQuery("ctab")&&p("al_back",y("mhb_back"));var C=y("MentionContainer"),E=parseJSON(s(C,"data-mentions"))||[];return E.length&&d.init({url:!1,appendTo:C,defaultItems:E,items:E,preferDomain:!0}),!1},backToDialogs:function(e){if(t.page)H.go(t.link,null,{push_only:!0,no_push:e}),R.click(t.link,v({no_scroll:!0},U)),c("m",t.page),R.refreshLinks(s("fv_link","href")||s("fv_link","data-href"),"vkontakte://vk.com/mail"),n=null,L(t.scroll_top||0),z.onShowDialogsPageFromCache(!0);else{var i=q(t.link||"/mail");H.go(i,null,{push_only:!0,no_push:e}),H.al_go(i)}},actualizeMessagesCornerCounter:function(e){Q({caches:[{storage:t,getter:"page"},{storage:H.page_get(q("/mail")),getter:"html"}],updater:function(t){var n=y("mhi_notify",t),i=y("mh_notify_counter",n);i||(i=_("em",{className:"mh_notify_counter"}),append(i,n)),e?i.innerText=e:n.innerHTML="&nbsp;"}})}}}();function q(e){var t=window.nav.getQuery(),n=t.community,i=t.ctab,o=n&&-1===e.indexOf("community=")?"community="+n:"",r=n&&i&&-1===e.indexOf("ctab=")?"&ctab="+i:"";return o?e+(e.indexOf("?")>=0?"&":"?")+o+r:e}function W(e){return e.replace(/\[(id|club)(\d+)(?:\:([a-z0-9_\-]+))?\|([^\$]+?)\]/g,function(e,t,n,i,o){return'<a href="/'+(t+n)+'" class="mem_link">'+o+"</a>"})}function Y(e,t){var n=32768&t;return e=(e=e.replace(/([a-zA-Z\-_\.0-9]+@[a-zA-Z\-_0-9]+\.[a-zA-Z\-_\.0-9]+[a-zA-Z\-_0-9]+)/g,function(e){return'<a href="mailto:'+e+'">'+e+"</a>"})).replace(/(https?:\/\/)?(([A-Za-zА-Яа-яЁё0-9@][A-Za-zА-Яа-яЁё0-9@\-\_\.]*[A-Za-zА-Яа-яЁё0-9@])(\/([A-Za-zА-Яа-я0-9@\-\_#%&?+\/\.=;:~]*[^\.\,;\(\)\?<\&\s:])?)?)/gi,function(){var e=arguments[3],t=arguments[2],i=arguments[0],o=arguments[1]||"http://";if(-1==e.indexOf(".")||-1!=e.indexOf(".."))return i;var r=e.split(".").pop();if(r.length>7||-1==x("place,camera,info,name,academy,aero,arpa,coop,media,museum,mobi,travel,xxx,asia,biz,com,net,org,gov,mil,edu,int,tel,ac,ad,ae,af,ag,ai,al,am,an,ao,aq,ar,as,at,au,aw,ax,az,ba,bb,bd,be,bf,bg,bh,bi,bj,bm,bn,bo,br,bs,bt,bv,bw,by,bz,ca,cc,cd,cf,cg,ch,ci,ck,cl,cm,cn,co,cr,cu,cv,cx,cy,cz,de,dj,dk,dm,do,dz,ec,ee,eg,eh,er,es,et,eu,fi,fj,fk,fm,fo,fr,ga,gd,ge,gf,gg,gh,gi,gl,gm,gn,gp,gq,gr,gs,gt,gu,gw,gy,hk,hm,hn,hr,ht,hu,id,ie,il,im,in,io,iq,ir,is,it,je,jm,jo,jp,ke,kg,kh,ki,km,kn,kp,kr,kw,ky,kz,la,lb,lc,li,lk,lr,ls,lt,lu,lv,ly,ma,mc,md,me,mg,mh,mk,ml,mm,mn,mo,mp,mq,mr,ms,mt,mu,mv,mw,mx,my,mz,na,nc,ne,nf,ng,ni,nl,no,np,nr,nu,nz,om,pa,pe,pf,pg,ph,pk,pl,pm,pn,pr,ps,pt,pw,py,qa,re,ro,ru,rs,rw,sa,sb,sc,sd,se,sg,sh,si,sj,sk,sl,sm,sn,so,sr,st,su,sv,sy,sz,tc,td,tf,tg,th,tj,tk,tl,tm,tn,to,tp,tr,tt,tv,tw,tz,ua,ug,uk,um,us,uy,uz,va,vc,ve,vg,vi,vn,vu,wf,ws,ye,yt,yu,za,zm,zw,рф,укр,сайт,онлайн,срб,cat,pro,local".split(","),r))return i;if(-1!=i.indexOf("@"))return i;try{i=decodeURIComponent(i)}catch(e){}return i.length>55&&(i=i.substr(0,53)+".."),i=I(i),!n&&e.match(/^([a-zA-Z0-9\.\_\-]+\.)?(vkontakte\.ru|vk\.com|vkadre\.ru|vshtate\.ru|userapi\.com|vk\.me)$/)?'<a href="'+(o+(t=P(t).replace(/([^a-zA-Z0-9#%;_\-.\/?&=\[\]])/g,encodeURIComponent))).replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'">'+i+"</a>":'<a href="/away?to='+encodeURIComponent(o+P(t))+'" target="_blank">'+i+"</a>"})}window.mail=z,window.makeUrl=q},function(e,t,n){"use strict";Array.prototype.filter||(Array.prototype.filter=function(e){if(void 0===this||null===this)throw new TypeError;var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var i=[],o=arguments.length>=2?arguments[1]:void 0,r=0;r<n;r++)if(r in t){var a=t[r];e.call(o,a,r,t)&&i.push(a)}return i})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(264),r=(i=o)&&i.__esModule?i:{default:i};t.default=r.default,window.uMsg=r.default},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(211),r=(i=o)&&i.__esModule?i:{default:i};t.default=r.default,window.MessageRequestsPage=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Icon_wd=void 0;var i,o=n(300),r=(i=o)&&i.__esModule?i:{default:i};n(156),t.default=r.default,t.Icon_wd=o.Icon_wd,window.Icon=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Msg__replyLink=t.Msg__replyAttach=t.Msg__authorName=t.Msg__reply=t.Msg_renderRestoreInner=void 0;var i,o=n(324),r=(i=o)&&i.__esModule?i:{default:i};n(244),t.default=r.default,t.Msg_renderRestoreInner=o.Msg_renderRestoreInner,t.Msg__reply=o.Msg__reply,t.Msg__authorName=o.Msg__authorName,t.Msg__replyAttach=o.Msg__replyAttach,t.Msg__replyLink=o.Msg__replyLink,window.Msg=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{class:[e.mix?e.mix:e.class,Bem.class("Popup",{open:e.open,scrollable:e.scrollable})],ontouchmove:["Popup._onTouchMove","event"],inner:[e.rel?e.rel:null,{class:"Popup__overlay",onclick:["Popup._onOverlayClick","this",e.on_overlay_click||null,e.hide_on_overlay_click||!0]},{class:"Popup__wrap",inner:{class:"Popup__content",inner:[e.header?{class:"Popup__header",inner:[e.header.title?{class:"Popup__headerTitle",inner:e.header.title}:null,e.header.corner?{class:["Popup__headerCorner",e.header.corner.class],inner:e.header.corner.text,href:e.header.corner.url,onclick:e.header.corner.onclick,attrs:e.header.corner.attrs}:null]}:null,e.scrollable?{class:"Popup__scroll ScrollView",inner:{class:"Popup__scrollContent",inner:e.content}}:e.content,e.footer?{class:"Popup__footer",inner:e.footer}:null]}}]}}}]);